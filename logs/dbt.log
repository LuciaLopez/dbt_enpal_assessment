[0m22:57:08.228388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3B193460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3DBC0130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3D74D0D0>]}


============================== 22:57:08.228388 | 165a79b8-4e23-4e04-abaa-139d510870ba ==============================
[0m22:57:08.228388 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:57:08.228388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:57:08.480390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '165a79b8-4e23-4e04-abaa-139d510870ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3AF9C250>]}
[0m22:57:08.527164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '165a79b8-4e23-4e04-abaa-139d510870ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3AF9CE20>]}
[0m22:57:08.528661 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:57:08.532160 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing enabled: 127 files deleted, 127 files added, 0 files changed.
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\last_day.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\indexes.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\refresh.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\split_part.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\replace.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\replace.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\where_subquery.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\rename.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\columns.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename.sql
[0m22:57:08.666273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\strategies.sql
[0m22:57:08.682023 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m22:57:08.682023 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\timestamps.sql
[0m22:57:08.682599 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\strategies.sql
[0m22:57:08.682599 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\schema.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\concat.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\merge.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\timestamps.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\right.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\alter.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\drop.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\accepted_values.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\literal.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop_backup.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\drop.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\intersect.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\except.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\listagg.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\datetime.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_concat.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\rename.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\create.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\rename.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\unit.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\rename.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\validate_sql.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_database.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\catalog.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\datediff.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\position.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\persist_docs.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\helpers.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_trunc.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\seed.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\replace.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\rename.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename_intermediate.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\helpers.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\replace.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\drop.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_append.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\replace.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\materialized_view.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\generate_series.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\any_value.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\test.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\python_model\python.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\drop.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\freshness.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_backup.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\create.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\test_model.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_intermediate.sql
[0m22:57:08.683103 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\escape_single_quotes.sql
[0m22:57:08.698815 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\listagg.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\adapters.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\dateadd.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\not_null.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\safe_cast.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\clone.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\datediff.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\last_day.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\table.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_construct.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_spine.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\show.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\metadata.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\configs.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\hooks.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\sources.yml
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://tests\generic\builtin.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\split_part.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\helpers.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast_bool_to_text.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\schema.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\length.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\create.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\relation.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\view.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\incremental.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\drop.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\bool_or.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\replace.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\apply_grants.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\hash.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\data_types.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\relationships.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\unique.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\statement.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\any_value.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\dateadd.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\replace.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: added file: dbt://docs\overview.md
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename_intermediate.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/generate_series.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/helpers.sql
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs/overview.md
[0m22:57:08.698919 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/replace.sql
[0m22:57:08.714653 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/unit.sql
[0m22:57:08.715215 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/relation.sql
[0m22:57:08.715496 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/rename.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/metadata.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/indexes.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/bool_or.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/safe_cast.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/rename.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/except.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/any_value.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/clone.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/strategies.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/dateadd.sql
[0m22:57:08.715729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_concat.sql
[0m22:57:08.719506 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m22:57:08.719506 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/merge.sql
[0m22:57:08.719506 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/rename.sql
[0m22:57:08.719506 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/any_value.sql
[0m22:57:08.720590 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/statement.sql
[0m22:57:08.720590 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/apply_grants.sql
[0m22:57:08.720590 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/test.sql
[0m22:57:08.721589 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/replace.sql
[0m22:57:08.721589 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests/generic/builtin.sql
[0m22:57:08.721589 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m22:57:08.721589 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/relationships.sql
[0m22:57:08.722594 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/hooks.sql
[0m22:57:08.722594 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/table.sql
[0m22:57:08.722594 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/refresh.sql
[0m22:57:08.722594 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/drop.sql
[0m22:57:08.723594 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/replace.sql
[0m22:57:08.723594 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/listagg.sql
[0m22:57:08.723594 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/replace.sql
[0m22:57:08.723594 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename.sql
[0m22:57:08.724600 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_backup.sql
[0m22:57:08.724600 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/dateadd.sql
[0m22:57:08.724600 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot.sql
[0m22:57:08.724600 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/rename.sql
[0m22:57:08.725603 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m22:57:08.725603 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/replace.sql
[0m22:57:08.725603 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/helpers.sql
[0m22:57:08.725603 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/create.sql
[0m22:57:08.726595 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/freshness.sql
[0m22:57:08.726595 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m22:57:08.726595 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/drop.sql
[0m22:57:08.726595 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m22:57:08.727534 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/drop.sql
[0m22:57:08.727534 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/helpers.sql
[0m22:57:08.728543 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/adapters.sql
[0m22:57:08.728543 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m22:57:08.728543 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/timestamps.sql
[0m22:57:08.728543 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create.sql
[0m22:57:08.729588 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m22:57:08.729588 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/materialized_view.sql
[0m22:57:08.729588 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/literal.sql
[0m22:57:08.729588 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/listagg.sql
[0m22:57:08.730586 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/datediff.sql
[0m22:57:08.730586 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/create.sql
[0m22:57:08.730586 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast.sql
[0m22:57:08.730586 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m22:57:08.731595 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/length.sql
[0m22:57:08.731595 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/hash.sql
[0m22:57:08.731595 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/timestamps.sql
[0m22:57:08.731595 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/create.sql
[0m22:57:08.732586 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/validate_sql.sql
[0m22:57:08.732586 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/replace.sql
[0m22:57:08.732586 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_trunc.sql
[0m22:57:08.733587 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/columns.sql
[0m22:57:08.733587 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/view.sql
[0m22:57:08.733587 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/seed.sql
[0m22:57:08.733587 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m22:57:08.734584 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/persist_docs.sql
[0m22:57:08.734584 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/rename.sql
[0m22:57:08.734584 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/escape_single_quotes.sql
[0m22:57:08.734584 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m22:57:08.735588 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_database.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/schema.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/catalog.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/not_null.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast_bool_to_text.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/strategies.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/accepted_values.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/last_day.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/configs.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/intersect.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_spine.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_construct.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop_backup.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/drop.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/test_model.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/where_subquery.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/concat.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/unique.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/drop.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/right.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/last_day.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/schema.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/datetime.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_intermediate.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/position.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/data_types.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/split_part.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/alter.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/incremental.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_append.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/replace.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/datediff.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/python_model/python.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/show.sql
[0m22:57:08.736036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/split_part.sql
[0m22:57:08.736036 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros\\relations.sql'
[0m22:57:08.736036 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 399, in load
    self.load_and_parse_macros(project_parser_files)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 676, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
KeyError: 'dbt_postgres://macros\\relations.sql'

[0m22:57:08.751678 [debug] [MainThread]: Command `dbt run` failed at 22:57:08.751678 after 0.57 seconds
[0m22:57:08.754140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3B193460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3E13DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE3E0B67F0>]}
[0m22:57:08.754140 [debug] [MainThread]: Flushing usage events
[0m23:01:22.815478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F7B62490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FA5E4D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FA5E4E50>]}


============================== 23:01:22.815478 | 88d2f44e-5140-4165-81de-43d4a99e2652 ==============================
[0m23:01:22.815478 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:01:22.831137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s test_model', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:01:22.986367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88d2f44e-5140-4165-81de-43d4a99e2652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F7F3E6A0>]}
[0m23:01:23.033809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88d2f44e-5140-4165-81de-43d4a99e2652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FA5A78B0>]}
[0m23:01:23.033809 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:01:23.033809 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing enabled: 127 files deleted, 127 files added, 0 files changed.
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\helpers.sql
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_spine.sql
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_intermediate.sql
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\show.sql
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\schema.sql
[0m23:01:23.170044 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\incremental.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_construct.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\helpers.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\dateadd.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_backup.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\drop.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\listagg.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\not_null.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\helpers.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\sources.yml
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\apply_grants.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\table.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\timestamps.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\where_subquery.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\columns.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\except.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop_backup.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\rename.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\test.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://tests\generic\builtin.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\split_part.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\refresh.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\test_model.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\unique.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\materialized_view.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\last_day.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\position.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\schema.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\rename.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\drop.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\replace.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\literal.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\drop.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\merge.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\alter.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\datediff.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\adapters.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\persist_docs.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\hooks.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\replace.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_database.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\create.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\accepted_values.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\listagg.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\rename.sql
[0m23:01:23.185667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\safe_cast.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\python_model\python.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\catalog.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\create.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\rename.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\timestamps.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\datediff.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\generate_series.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_concat.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\escape_single_quotes.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\indexes.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\relationships.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\drop.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename_intermediate.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\clone.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_append.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\rename.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\create.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\last_day.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\statement.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\strategies.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\replace.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\dateadd.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\replace.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\any_value.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\intersect.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\relation.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\replace.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\view.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\any_value.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\metadata.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\datetime.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\data_types.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://docs\overview.md
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\strategies.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\validate_sql.sql
[0m23:01:23.201291 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\seed.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast_bool_to_text.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\right.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\split_part.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\configs.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_trunc.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\concat.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\bool_or.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\unit.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations.sql
[0m23:01:23.216916 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\length.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\replace.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\hash.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\drop.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\replace.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\freshness.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/drop.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_database.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs/overview.md
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/split_part.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/validate_sql.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/persist_docs.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/replace.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/create.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/any_value.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/rename.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/hooks.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/replace.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/apply_grants.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/helpers.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/except.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_spine.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/not_null.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/replace.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/freshness.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/test.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/rename.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/replace.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/datediff.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/replace.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/merge.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/columns.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_intermediate.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/literal.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_trunc.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/drop.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/statement.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/split_part.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop_backup.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/generate_series.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/helpers.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/materialized_view.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/listagg.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/where_subquery.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/unique.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/safe_cast.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/escape_single_quotes.sql
[0m23:01:23.220233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/show.sql
[0m23:01:23.236094 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/drop.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/relationships.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_append.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/alter.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/position.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/view.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/dateadd.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/python_model/python.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/accepted_values.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/refresh.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast_bool_to_text.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/datediff.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/strategies.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_backup.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_construct.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/schema.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/schema.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/create.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/incremental.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/dateadd.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/replace.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/indexes.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/test_model.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_concat.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/bool_or.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/metadata.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests/generic/builtin.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/concat.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/drop.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/helpers.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/length.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/replace.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/drop.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/strategies.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/intersect.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/seed.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/last_day.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/clone.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/datetime.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/timestamps.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/create.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m23:01:23.236615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/table.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/hash.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/catalog.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/relation.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename_intermediate.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/listagg.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/timestamps.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/rename.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/right.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/configs.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/rename.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/last_day.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/adapters.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/data_types.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/rename.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/any_value.sql
[0m23:01:23.251624 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/unit.sql
[0m23:01:23.251624 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros\\adapters.sql'
[0m23:01:23.251624 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 399, in load
    self.load_and_parse_macros(project_parser_files)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 676, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
KeyError: 'dbt_postgres://macros\\adapters.sql'

[0m23:01:23.266930 [debug] [MainThread]: Command `dbt run` failed at 23:01:23.266930 after 0.48 seconds
[0m23:01:23.268081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F7B62490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F79A22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FAA70700>]}
[0m23:01:23.268515 [debug] [MainThread]: Flushing usage events
[0m23:05:00.660338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9C4E2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9EF65D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9EF65E50>]}


============================== 23:05:00.660338 | ecfbfac3-1c52-4e0c-8379-7bdc52f6abc2 ==============================
[0m23:05:00.660338 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:05:00.660338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m test_model', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:00.822316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecfbfac3-1c52-4e0c-8379-7bdc52f6abc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9C8BE6A0>]}
[0m23:05:00.869926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecfbfac3-1c52-4e0c-8379-7bdc52f6abc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9EF288B0>]}
[0m23:05:00.869926 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:05:00.878018 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:05:01.022248 [debug] [MainThread]: Partial parsing enabled: 127 files deleted, 127 files added, 0 files changed.
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_concat.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\clone.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\refresh.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\catalog.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\create.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_construct.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\strategies.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\timestamps.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\length.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\helpers.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\unit.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\drop.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\right.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\position.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\datediff.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\replace.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\any_value.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\indexes.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\escape_single_quotes.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\helpers.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\create.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://tests\generic\builtin.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\dateadd.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\drop.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\dateadd.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\datediff.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\seed.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_intermediate.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\view.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\strategies.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\accepted_values.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\listagg.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\apply_grants.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\schema.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\materialized_view.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\split_part.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://docs\overview.md
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\configs.sql
[0m23:05:01.022748 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\last_day.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\adapters.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\where_subquery.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\last_day.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\show.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\helpers.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_database.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename_intermediate.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\relation.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\hash.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\table.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\concat.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\replace.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\safe_cast.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\rename.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\test.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\test_model.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\any_value.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\incremental.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\rename.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\statement.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\schema.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\columns.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\sources.yml
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\persist_docs.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\data_types.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\drop.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\replace.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\listagg.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\bool_or.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\hooks.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\alter.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_backup.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\generate_series.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\timestamps.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_append.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\rename.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\datetime.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\validate_sql.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\not_null.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\freshness.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\replace.sql
[0m23:05:01.038476 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\split_part.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_trunc.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\relationships.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_spine.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop_backup.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\python_model\python.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\merge.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\unique.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\intersect.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\metadata.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\rename.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast_bool_to_text.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\replace.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\rename.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\replace.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\create.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\drop.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\drop.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\literal.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\replace.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\except.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/drop.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/replace.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/datetime.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/drop.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/split_part.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/generate_series.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/catalog.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/test.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/relation.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/literal.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/last_day.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/apply_grants.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/view.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/replace.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/replace.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/python_model/python.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/last_day.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_spine.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/listagg.sql
[0m23:05:01.054105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/clone.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/rename.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/refresh.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/alter.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/freshness.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/merge.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/where_subquery.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/create.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/adapters.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/bool_or.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_construct.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/listagg.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests/generic/builtin.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/dateadd.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/incremental.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_intermediate.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/split_part.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/data_types.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/except.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename_intermediate.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/rename.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs/overview.md
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/timestamps.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/indexes.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast_bool_to_text.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/drop.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/concat.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/replace.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/test_model.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/configs.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/create.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/table.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/dateadd.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/replace.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/rename.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/validate_sql.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/replace.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/relationships.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/safe_cast.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_concat.sql
[0m23:05:01.069724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/timestamps.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/any_value.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/materialized_view.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/strategies.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/statement.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/datediff.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/metadata.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/drop.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/accepted_values.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_append.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/rename.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/position.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/length.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/hooks.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/helpers.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/any_value.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/helpers.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/persist_docs.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/unique.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_trunc.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/hash.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/columns.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/strategies.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/not_null.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/helpers.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/datediff.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/intersect.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop_backup.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/rename.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/seed.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/create.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_backup.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/show.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/schema.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/unit.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/escape_single_quotes.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/drop.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/schema.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/right.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/replace.sql
[0m23:05:01.085337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_database.sql
[0m23:05:01.085337 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros\\catalog.sql'
[0m23:05:01.085337 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 399, in load
    self.load_and_parse_macros(project_parser_files)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 676, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
KeyError: 'dbt_postgres://macros\\catalog.sql'

[0m23:05:01.107001 [debug] [MainThread]: Command `dbt run` failed at 23:05:01.106942 after 0.48 seconds
[0m23:05:01.107403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9C4E2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9C3D3D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9C35F4C0>]}
[0m23:05:01.107403 [debug] [MainThread]: Flushing usage events
[0m23:09:02.082678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B605D5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B62544970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B625448B0>]}


============================== 23:09:02.082678 | dc257ee1-3ed6-4404-ad88-221c70836492 ==============================
[0m23:09:02.082678 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:09:02.082678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m test_model', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:02.287862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6206CE80>]}
[0m23:09:02.343980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6239E4F0>]}
[0m23:09:02.344880 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:09:02.535114 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:09:02.631512 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:09:02.641982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B61FD57F0>]}
[0m23:09:03.928608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B62E0B130>]}
[0m23:09:04.029011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:09:04.029011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:09:04.045669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B62E3D820>]}
[0m23:09:04.045669 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m23:09:04.045669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B62E41EB0>]}
[0m23:09:04.045669 [info ] [MainThread]: 
[0m23:09:04.045669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:09:04.045669 [info ] [MainThread]: 
[0m23:09:04.045669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:09:04.062834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:09:04.132191 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:09:04.132191 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:09:04.132191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:04.163840 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m23:09:04.165343 [debug] [ThreadPool]: On list_postgres: Close
[0m23:09:04.166867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m23:09:04.173075 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:09:04.173612 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m23:09:04.173612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:04.189863 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m23:09:04.190662 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:09:04.191653 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m23:09:04.196173 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m23:09:04.198251 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m23:09:04.199898 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m23:09:04.205684 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:04.206186 [debug] [MainThread]: On master: BEGIN
[0m23:09:04.206685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:04.226193 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m23:09:04.227193 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:04.228286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:09:04.234723 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:09:04.236329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B62F00A90>]}
[0m23:09:04.236877 [debug] [MainThread]: On master: ROLLBACK
[0m23:09:04.238134 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:04.238645 [debug] [MainThread]: On master: BEGIN
[0m23:09:04.240718 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:09:04.241256 [debug] [MainThread]: On master: COMMIT
[0m23:09:04.242254 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:04.242759 [debug] [MainThread]: On master: COMMIT
[0m23:09:04.244321 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:09:04.245253 [debug] [MainThread]: On master: Close
[0m23:09:04.249824 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m23:09:04.250448 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m23:09:04.251944 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m23:09:04.253446 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m23:09:04.264209 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:09:04.264209 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m23:09:04.363906 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:09:04.365028 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:04.366030 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m23:09:04.367027 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:09:04.390389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m23:09:04.391470 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:04.392299 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m23:09:04.395742 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m23:09:04.403765 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:04.404244 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m23:09:04.406745 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:09:04.407246 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:04.407246 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:09:04.413545 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:09:04.429672 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:09:04.429672 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:04.429672 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:09:04.442491 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:09:04.453380 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m23:09:04.453876 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:04.453876 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:09:04.468230 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m23:09:04.470985 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m23:09:04.473632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc257ee1-3ed6-4404-ad88-221c70836492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6325C9A0>]}
[0m23:09:04.474307 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 0[0m in 0.22s]
[0m23:09:04.475670 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m23:09:04.476702 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:04.477366 [debug] [MainThread]: On master: BEGIN
[0m23:09:04.477366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:09:04.498618 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m23:09:04.499335 [debug] [MainThread]: On master: COMMIT
[0m23:09:04.499842 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:04.500341 [debug] [MainThread]: On master: COMMIT
[0m23:09:04.502338 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:09:04.502966 [debug] [MainThread]: On master: Close
[0m23:09:04.503406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:04.503834 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:09:04.504335 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m23:09:04.504834 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:09:04.505334 [info ] [MainThread]: 
[0m23:09:04.505833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m23:09:04.507836 [debug] [MainThread]: Command end result
[0m23:09:04.572200 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:09:04.579405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:09:04.596041 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:09:04.596041 [info ] [MainThread]: 
[0m23:09:04.597059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:04.598137 [info ] [MainThread]: 
[0m23:09:04.599246 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:09:04.601267 [debug] [MainThread]: Command `dbt run` succeeded at 23:09:04.601267 after 2.58 seconds
[0m23:09:04.601267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B605D5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B5F9B89D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6022BAF0>]}
[0m23:09:04.602244 [debug] [MainThread]: Flushing usage events
[0m23:09:05.045356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:11.229515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEC85F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C0BF3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C0BF3880>]}


============================== 23:09:11.233064 | aad640c5-6a51-4e0e-9737-ef98433fd868 ==============================
[0m23:09:11.233064 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:09:11.233064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s test_model', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:09:11.390764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aad640c5-6a51-4e0e-9737-ef98433fd868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BE08E550>]}
[0m23:09:11.455223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aad640c5-6a51-4e0e-9737-ef98433fd868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C0818520>]}
[0m23:09:11.455223 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:09:11.627638 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:09:11.779064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:11.779064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:11.827165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aad640c5-6a51-4e0e-9737-ef98433fd868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C12E2130>]}
[0m23:09:11.908458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:09:11.924258 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:09:11.940628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aad640c5-6a51-4e0e-9737-ef98433fd868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C12E1280>]}
[0m23:09:11.940628 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m23:09:11.940628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad640c5-6a51-4e0e-9737-ef98433fd868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C128FDC0>]}
[0m23:09:11.940628 [info ] [MainThread]: 
[0m23:09:11.940628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:09:11.940628 [info ] [MainThread]: 
[0m23:09:11.940628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:09:11.949799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:09:12.035737 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:09:12.035737 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:09:12.036738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:12.069289 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m23:09:12.070863 [debug] [ThreadPool]: On list_postgres: Close
[0m23:09:12.080412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m23:09:12.087732 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:09:12.087732 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m23:09:12.088726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:12.112414 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m23:09:12.113468 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:09:12.114606 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m23:09:12.119162 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m23:09:12.120208 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m23:09:12.121646 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m23:09:12.127175 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:12.127903 [debug] [MainThread]: On master: BEGIN
[0m23:09:12.128117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:12.145852 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:09:12.146687 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:12.147187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:09:12.151186 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:09:12.152641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad640c5-6a51-4e0e-9737-ef98433fd868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BE8D1A30>]}
[0m23:09:12.153186 [debug] [MainThread]: On master: ROLLBACK
[0m23:09:12.154185 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:12.154706 [debug] [MainThread]: On master: BEGIN
[0m23:09:12.155685 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:09:12.156413 [debug] [MainThread]: On master: COMMIT
[0m23:09:12.156686 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:12.157187 [debug] [MainThread]: On master: COMMIT
[0m23:09:12.158186 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:09:12.158707 [debug] [MainThread]: On master: Close
[0m23:09:12.167775 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m23:09:12.167775 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m23:09:12.167775 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m23:09:12.167775 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m23:09:12.167775 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:09:12.167775 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m23:09:12.224304 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:09:12.228805 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:12.229294 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m23:09:12.229561 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:09:12.246671 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m23:09:12.247424 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:12.247424 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m23:09:12.251925 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m23:09:12.258339 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:12.258339 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m23:09:12.260470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:09:12.266185 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:12.266740 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:09:12.268584 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:09:12.284699 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:09:12.284699 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:12.284699 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:09:12.296179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:09:12.304130 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m23:09:12.307878 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:09:12.308892 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:09:12.313553 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m23:09:12.316434 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m23:09:12.318436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad640c5-6a51-4e0e-9737-ef98433fd868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C1714520>]}
[0m23:09:12.319434 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 0[0m in 0.15s]
[0m23:09:12.320431 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m23:09:12.321472 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:12.321472 [debug] [MainThread]: On master: BEGIN
[0m23:09:12.322035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:09:12.337783 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m23:09:12.338122 [debug] [MainThread]: On master: COMMIT
[0m23:09:12.338629 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:12.339146 [debug] [MainThread]: On master: COMMIT
[0m23:09:12.340128 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:09:12.340128 [debug] [MainThread]: On master: Close
[0m23:09:12.341128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:12.341128 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:09:12.341677 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m23:09:12.341677 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:09:12.342256 [info ] [MainThread]: 
[0m23:09:12.343157 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m23:09:12.343629 [debug] [MainThread]: Command end result
[0m23:09:12.366708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:09:12.367825 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:09:12.367825 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:09:12.378372 [info ] [MainThread]: 
[0m23:09:12.379718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:12.380134 [info ] [MainThread]: 
[0m23:09:12.381105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:09:12.382113 [debug] [MainThread]: Command `dbt run` succeeded at 23:09:12.382113 after 1.21 seconds
[0m23:09:12.383171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEC85F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BE877BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BDFFD7F0>]}
[0m23:09:12.383171 [debug] [MainThread]: Flushing usage events
[0m23:09:12.826720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:50.909026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F956F400A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F958EA1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F958EA1670>]}


============================== 23:11:50.909026 | c609f949-c052-482a-9c8b-b169c282992e ==============================
[0m23:11:50.909026 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:11:50.909026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:11:51.077168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c609f949-c052-482a-9c8b-b169c282992e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9557F1D00>]}
[0m23:11:51.121974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c609f949-c052-482a-9c8b-b169c282992e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F958956550>]}
[0m23:11:51.121974 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:11:51.298654 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:11:51.424582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:11:51.424582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:11:51.456008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c609f949-c052-482a-9c8b-b169c282992e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F959590130>]}
[0m23:11:51.536037 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:11:51.536037 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:11:51.572161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c609f949-c052-482a-9c8b-b169c282992e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9595B73A0>]}
[0m23:11:51.572161 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m23:11:51.574257 [info ] [MainThread]: 
[0m23:11:51.575241 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:11:51.576251 [info ] [MainThread]: 
[0m23:11:51.577164 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:51.582264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:11:51.652745 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:11:51.653764 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:11:51.653764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:51.698628 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.044 seconds
[0m23:11:51.699656 [debug] [ThreadPool]: On list_postgres: Close
[0m23:11:51.704938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m23:11:51.709721 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:11:51.710359 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m23:11:51.710359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:51.746525 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m23:11:51.747102 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:11:51.747602 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m23:11:51.751607 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m23:11:51.753126 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m23:11:51.754602 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m23:11:51.759656 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:51.759656 [debug] [MainThread]: On master: BEGIN
[0m23:11:51.759656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:51.774988 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m23:11:51.775381 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:51.775765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:51.781787 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:11:51.782786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c609f949-c052-482a-9c8b-b169c282992e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F959833250>]}
[0m23:11:51.783286 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:51.784287 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:51.784787 [debug] [MainThread]: On master: BEGIN
[0m23:11:51.787403 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:11:51.788085 [debug] [MainThread]: On master: COMMIT
[0m23:11:51.788085 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:51.788609 [debug] [MainThread]: On master: COMMIT
[0m23:11:51.789586 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:11:51.790085 [debug] [MainThread]: On master: Close
[0m23:11:51.797585 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m23:11:51.798103 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m23:11:51.798584 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m23:11:51.799084 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m23:11:51.807605 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:11:51.808728 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m23:11:51.847151 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:11:51.848236 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:11:51.849196 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m23:11:51.849196 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:11:51.880253 [debug] [Thread-1  ]: SQL status: BEGIN in 0.031 seconds
[0m23:11:51.881306 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:11:51.881940 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m23:11:51.884310 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m23:11:51.890344 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:11:51.890919 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m23:11:51.892529 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:11:51.895787 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:11:51.896102 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:11:51.897489 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:11:51.904511 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:11:51.904511 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:11:51.904511 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:11:51.920548 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m23:11:51.925934 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m23:11:51.929167 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:11:51.929668 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:11:51.934884 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m23:11:51.935392 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m23:11:51.938276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c609f949-c052-482a-9c8b-b169c282992e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F959BB9C10>]}
[0m23:11:51.938276 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 0[0m in 0.14s]
[0m23:11:51.938276 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m23:11:51.942220 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:51.942739 [debug] [MainThread]: On master: BEGIN
[0m23:11:51.942739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:51.962756 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m23:11:51.963508 [debug] [MainThread]: On master: COMMIT
[0m23:11:51.963508 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:51.964025 [debug] [MainThread]: On master: COMMIT
[0m23:11:51.965703 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:11:51.966006 [debug] [MainThread]: On master: Close
[0m23:11:51.966587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:51.967094 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:11:51.967094 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m23:11:51.967634 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:11:51.967634 [info ] [MainThread]: 
[0m23:11:51.968796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:11:51.970050 [debug] [MainThread]: Command end result
[0m23:11:51.990909 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:11:51.991033 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:11:51.991033 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:11:51.991033 [info ] [MainThread]: 
[0m23:11:51.991033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:51.991033 [info ] [MainThread]: 
[0m23:11:52.001046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:11:52.003273 [debug] [MainThread]: Command `dbt build` succeeded at 23:11:52.003030 after 1.13 seconds
[0m23:11:52.003771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F956F400A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F958956550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9572F60A0>]}
[0m23:11:52.004791 [debug] [MainThread]: Flushing usage events
[0m23:11:52.465922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:19.447508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0D772040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F6D4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F6D4850>]}


============================== 17:54:19.463340 | 0a412f73-5198-47c1-8a85-0b983c8ab440 ==============================
[0m17:54:19.463340 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m17:54:19.463340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s test_model', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:19.805778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a412f73-5198-47c1-8a85-0b983c8ab440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0C02A790>]}
[0m17:54:19.853175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a412f73-5198-47c1-8a85-0b983c8ab440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0F68B5B0>]}
[0m17:54:19.853175 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:54:20.042468 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m17:54:20.248380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:20.248380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:20.278686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a412f73-5198-47c1-8a85-0b983c8ab440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0FDC19D0>]}
[0m17:54:20.349034 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m17:54:20.349034 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m17:54:20.397129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a412f73-5198-47c1-8a85-0b983c8ab440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0FD76430>]}
[0m17:54:20.397129 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m17:54:20.397129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a412f73-5198-47c1-8a85-0b983c8ab440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0FDD5D30>]}
[0m17:54:20.397129 [info ] [MainThread]: 
[0m17:54:20.397129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:20.397129 [info ] [MainThread]: 
[0m17:54:20.397129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:20.413208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:54:20.611414 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:54:20.611414 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:54:20.611414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:20.653691 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m17:54:20.653691 [debug] [ThreadPool]: On list_postgres: Close
[0m17:54:20.670631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m17:54:20.670864 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m17:54:20.670864 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m17:54:20.670864 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: BEGIN
[0m17:54:20.670864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:20.705758 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m17:54:20.706637 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m17:54:20.707473 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m17:54:20.715510 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m17:54:20.716510 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m17:54:20.717010 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m17:54:20.717510 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m17:54:20.717510 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m17:54:20.717510 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m17:54:20.725187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m17:54:20.725187 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:54:20.725187 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:54:20.725187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:20.757066 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m17:54:20.764399 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:54:20.765281 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:54:20.774360 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m17:54:20.775437 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:54:20.775437 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:54:20.775437 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:20.775437 [debug] [MainThread]: On master: BEGIN
[0m17:54:20.775437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:20.803596 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m17:54:20.810480 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:20.810975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:20.819293 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:54:20.819293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a412f73-5198-47c1-8a85-0b983c8ab440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0FA2DFD0>]}
[0m17:54:20.819293 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:20.819293 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:20.819293 [debug] [MainThread]: On master: BEGIN
[0m17:54:20.829225 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:54:20.829692 [debug] [MainThread]: On master: COMMIT
[0m17:54:20.830498 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:20.830995 [debug] [MainThread]: On master: COMMIT
[0m17:54:20.833498 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:54:20.833996 [debug] [MainThread]: On master: Close
[0m17:54:20.840494 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m17:54:20.840494 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m17:54:20.840494 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m17:54:20.840494 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m17:54:20.840494 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m17:54:20.840494 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m17:54:20.898905 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m17:54:20.900015 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m17:54:20.901025 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m17:54:20.901025 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:54:20.915228 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m17:54:20.927558 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m17:54:20.928246 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m17:54:20.928748 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.014 seconds
[0m17:54:20.945151 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m17:54:20.945151 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m17:54:20.945151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:54:20.961261 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m17:54:20.961261 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m17:54:20.961261 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m17:54:20.977252 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m17:54:20.977252 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m17:54:20.977252 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m17:54:20.977252 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m17:54:20.992880 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m17:54:20.992880 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m17:54:20.992880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a412f73-5198-47c1-8a85-0b983c8ab440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0C0064F0>]}
[0m17:54:20.992880 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.15s]
[0m17:54:20.992880 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m17:54:20.992880 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:20.992880 [debug] [MainThread]: On master: BEGIN
[0m17:54:20.992880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:21.031616 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m17:54:21.032786 [debug] [MainThread]: On master: COMMIT
[0m17:54:21.033633 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:21.034118 [debug] [MainThread]: On master: COMMIT
[0m17:54:21.036629 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:54:21.037239 [debug] [MainThread]: On master: Close
[0m17:54:21.037734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:21.038117 [debug] [MainThread]: Connection 'create_postgres_public_pipedrive_analytics' was properly closed.
[0m17:54:21.038661 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m17:54:21.039251 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m17:54:21.039684 [info ] [MainThread]: 
[0m17:54:21.040146 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m17:54:21.041120 [debug] [MainThread]: Command end result
[0m17:54:21.066487 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m17:54:21.069655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m17:54:21.081448 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m17:54:21.083444 [info ] [MainThread]: 
[0m17:54:21.094511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:21.104711 [info ] [MainThread]: 
[0m17:54:21.107315 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:54:21.110059 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:21.110059 after 1.69 seconds
[0m17:54:21.110059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0D772040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0CA8D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0D3B9400>]}
[0m17:54:21.110059 [debug] [MainThread]: Flushing usage events
[0m17:54:21.596022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:55.211898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5D2F1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5F264700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5F2647C0>]}


============================== 19:32:55.217799 | eff3c979-2f3e-4109-8d6c-434eb8b14254 ==============================
[0m19:32:55.217799 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:32:55.218794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_activity', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:32:55.407706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eff3c979-2f3e-4109-8d6c-434eb8b14254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5BBA1BE0>]}
[0m19:32:55.458314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eff3c979-2f3e-4109-8d6c-434eb8b14254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5C692DF0>]}
[0m19:32:55.458314 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:32:55.673727 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:32:55.835984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:32:55.835984 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\staging\pipedrive\stg_activity.sql
[0m19:32:55.835984 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m19:32:55.835984 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\sources.yml
[0m19:32:56.224160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eff3c979-2f3e-4109-8d6c-434eb8b14254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5FC81EB0>]}
[0m19:32:56.307123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:32:56.307123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:32:56.340357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eff3c979-2f3e-4109-8d6c-434eb8b14254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5F90FAF0>]}
[0m19:32:56.340357 [info ] [MainThread]: Found 2 models, 6 sources, 428 macros
[0m19:32:56.340357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eff3c979-2f3e-4109-8d6c-434eb8b14254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5FC810D0>]}
[0m19:32:56.340357 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:32:56.340357 [debug] [MainThread]: Command end result
[0m19:32:56.357150 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:32:56.374449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:32:56.378489 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:32:56.379490 [debug] [MainThread]: Command `dbt run` succeeded at 19:32:56.379490 after 1.23 seconds
[0m19:32:56.379490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5D2F1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5D1C56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B5C6C6700>]}
[0m19:32:56.379490 [debug] [MainThread]: Flushing usage events
[0m19:32:56.910711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:13.047020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2879C10D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E289934790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E289934850>]}


============================== 19:38:13.047020 | 3d1a7bec-445e-49c9-a381-96130e8003a7 ==============================
[0m19:38:13.047020 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:38:13.047020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_activity', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:38:13.204258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d1a7bec-445e-49c9-a381-96130e8003a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E286CD9DF0>]}
[0m19:38:13.251133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d1a7bec-445e-49c9-a381-96130e8003a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E289780A30>]}
[0m19:38:13.251133 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:38:13.419491 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:38:13.487573 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:38:13.487573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d1a7bec-445e-49c9-a381-96130e8003a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2893B5520>]}
[0m19:38:14.435015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d1a7bec-445e-49c9-a381-96130e8003a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E28A266130>]}
[0m19:38:14.503859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:38:14.503859 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:38:14.519481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d1a7bec-445e-49c9-a381-96130e8003a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E28A2AA340>]}
[0m19:38:14.519481 [info ] [MainThread]: Found 2 models, 6 sources, 428 macros
[0m19:38:14.519481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1a7bec-445e-49c9-a381-96130e8003a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E28A257070>]}
[0m19:38:14.535011 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:38:14.535011 [debug] [MainThread]: Command end result
[0m19:38:14.555178 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:38:14.557931 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:38:14.562038 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:38:14.563030 [debug] [MainThread]: Command `dbt run` succeeded at 19:38:14.563030 after 1.56 seconds
[0m19:38:14.563030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2879C10D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E289F9DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2875A77F0>]}
[0m19:38:14.563030 [debug] [MainThread]: Flushing usage events
[0m19:38:15.054918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:42.758676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021610C85F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021612BF49D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021612BF4910>]}


============================== 19:39:42.767440 | 6399d5ff-d337-47ba-a154-e29af971b419 ==============================
[0m19:39:42.767440 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:39:42.768851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_activity', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:42.988567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6399d5ff-d337-47ba-a154-e29af971b419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002160FFB4C70>]}
[0m19:39:43.042039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6399d5ff-d337-47ba-a154-e29af971b419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021612A38D60>]}
[0m19:39:43.043130 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:39:43.197894 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:39:43.325240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:39:43.325240 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m19:39:43.325240 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\stg_activity.sql
[0m19:39:43.614420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6399d5ff-d337-47ba-a154-e29af971b419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161348E130>]}
[0m19:39:43.688197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:39:43.703839 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:39:43.703839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6399d5ff-d337-47ba-a154-e29af971b419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216132CEFD0>]}
[0m19:39:43.703839 [info ] [MainThread]: Found 2 models, 6 sources, 428 macros
[0m19:39:43.719554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6399d5ff-d337-47ba-a154-e29af971b419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161348E940>]}
[0m19:39:43.719554 [info ] [MainThread]: 
[0m19:39:43.719554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:43.719554 [info ] [MainThread]: 
[0m19:39:43.719554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:43.719554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:39:43.817617 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:39:43.817617 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:39:43.817617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:43.876611 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.068 seconds
[0m19:39:43.876611 [debug] [ThreadPool]: On list_postgres: Close
[0m19:39:43.892313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m19:39:43.924514 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:39:43.924514 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:39:43.924514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:43.940585 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:39:43.940585 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:39:43.956395 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:39:43.964701 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m19:39:43.966336 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:39:43.968036 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:39:43.968689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public)
[0m19:39:43.969195 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:39:43.972233 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:39:43.972233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:43.988647 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:39:43.992426 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:39:43.992682 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:39:43.998667 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m19:39:43.999667 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:39:44.001670 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:39:44.002668 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:44.002668 [debug] [MainThread]: On master: BEGIN
[0m19:39:44.002668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:44.018630 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:39:44.028716 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:44.029039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:44.039126 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m19:39:44.039126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6399d5ff-d337-47ba-a154-e29af971b419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216132CE6A0>]}
[0m19:39:44.039126 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:44.039126 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:44.039126 [debug] [MainThread]: On master: BEGIN
[0m19:39:44.039126 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:39:44.045690 [debug] [MainThread]: On master: COMMIT
[0m19:39:44.046058 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:44.046197 [debug] [MainThread]: On master: COMMIT
[0m19:39:44.048198 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:44.048198 [debug] [MainThread]: On master: Close
[0m19:39:44.056645 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity
[0m19:39:44.056645 [info ] [Thread-1  ]: 1 of 1 START sql views model public_pipedrive_analytics.stg_activity ........... [RUN]
[0m19:39:44.056645 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activity'
[0m19:39:44.056645 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity
[0m19:39:44.056645 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m19:39:44.056645 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity
[0m19:39:44.078495 [debug] [Thread-1  ]: Compilation Error in model stg_activity (models\staging\pipedrive\stg_activity.sql)
  No materialization 'views' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m19:39:44.079631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6399d5ff-d337-47ba-a154-e29af971b419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002160FFFD610>]}
[0m19:39:44.079631 [error] [Thread-1  ]: 1 of 1 ERROR creating sql views model public_pipedrive_analytics.stg_activity .. [[31mERROR[0m in 0.02s]
[0m19:39:44.079631 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity
[0m19:39:44.082865 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.stg_activity' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_activity (models\staging\pipedrive\stg_activity.sql)
  No materialization 'views' was found for adapter postgres! (searched types 'default' and 'postgres').
[0m19:39:44.084798 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:44.084798 [debug] [MainThread]: On master: BEGIN
[0m19:39:44.086248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:44.106892 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:39:44.109948 [debug] [MainThread]: On master: COMMIT
[0m19:39:44.111076 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:44.111179 [debug] [MainThread]: On master: COMMIT
[0m19:39:44.112898 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:44.112898 [debug] [MainThread]: On master: Close
[0m19:39:44.113965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:44.113965 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:39:44.114502 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:39:44.114502 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m19:39:44.115311 [info ] [MainThread]: 
[0m19:39:44.116116 [info ] [MainThread]: Finished running 1 views model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:39:44.117611 [debug] [MainThread]: Command end result
[0m19:39:44.143425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:39:44.144564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:39:44.153295 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:39:44.153295 [info ] [MainThread]: 
[0m19:39:44.153295 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m19:39:44.153295 [info ] [MainThread]: 
[0m19:39:44.153295 [error] [MainThread]:   Compilation Error in model stg_activity (models\staging\pipedrive\stg_activity.sql)
  No materialization 'views' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m19:39:44.153295 [info ] [MainThread]: 
[0m19:39:44.153295 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:39:44.153295 [debug] [MainThread]: Command `dbt run` failed at 19:39:44.153295 after 1.45 seconds
[0m19:39:44.162050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021610C85F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021612BCE970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021612BCE550>]}
[0m19:39:44.163154 [debug] [MainThread]: Flushing usage events
[0m19:39:44.633491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:00.082987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C86310D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CA5A4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CA5A4850>]}


============================== 19:40:00.082987 | 513c6fa7-6d5f-4c73-bf82-580124886d0c ==============================
[0m19:40:00.082987 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:40:00.082987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_activity', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:40:00.228454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C7949DF0>]}
[0m19:40:00.291621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CA3EFA30>]}
[0m19:40:00.291621 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:40:00.459933 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:40:00.538047 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:40:00.538047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CA026520>]}
[0m19:40:01.446596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CAEE6130>]}
[0m19:40:01.509328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:01.525212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:01.540838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CAF2A2E0>]}
[0m19:40:01.540838 [info ] [MainThread]: Found 2 models, 6 sources, 428 macros
[0m19:40:01.540838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CAED6E20>]}
[0m19:40:01.540838 [info ] [MainThread]: 
[0m19:40:01.540838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:01.540838 [info ] [MainThread]: 
[0m19:40:01.540838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:01.540838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:40:01.600670 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:40:01.600670 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:40:01.615415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:01.644872 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m19:40:01.646765 [debug] [ThreadPool]: On list_postgres: Close
[0m19:40:01.648591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m19:40:01.648591 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:40:01.648591 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:40:01.648591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:01.664211 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:40:01.675387 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:40:01.675991 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:40:01.679891 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:40:01.681452 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:40:01.682512 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:40:01.683559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public)
[0m19:40:01.686216 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:01.686216 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:40:01.686216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:01.717333 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m19:40:01.728717 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:01.729650 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:40:01.735948 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m19:40:01.737010 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:40:01.739373 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:40:01.744116 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.744116 [debug] [MainThread]: On master: BEGIN
[0m19:40:01.744116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:01.775430 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m19:40:01.776429 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.776525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:01.781150 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:40:01.782328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CAFDAD60>]}
[0m19:40:01.782442 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:01.783727 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.784277 [debug] [MainThread]: On master: BEGIN
[0m19:40:01.786359 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:40:01.786690 [debug] [MainThread]: On master: COMMIT
[0m19:40:01.786944 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.787443 [debug] [MainThread]: On master: COMMIT
[0m19:40:01.788444 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:01.788962 [debug] [MainThread]: On master: Close
[0m19:40:01.792943 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity
[0m19:40:01.793444 [info ] [Thread-1  ]: 1 of 1 START sql view model public_pipedrive_analytics.stg_activity ............ [RUN]
[0m19:40:01.794566 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activity'
[0m19:40:01.795099 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity
[0m19:40:01.797320 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m19:40:01.797320 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity
[0m19:40:01.839778 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m19:40:01.853731 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:40:01.853731 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m19:40:01.853731 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:40:01.865949 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m19:40:01.876223 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:40:01.877231 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m19:40:01.895246 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.026 seconds
[0m19:40:01.895246 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:40:01.895246 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m19:40:01.912023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:40:01.912023 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m19:40:01.912023 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:40:01.912023 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m19:40:01.928377 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m19:40:01.928377 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m19:40:01.944236 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:40:01.944236 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m19:40:01.944236 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m19:40:01.944236 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: Close
[0m19:40:01.944236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513c6fa7-6d5f-4c73-bf82-580124886d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CB3A3E80>]}
[0m19:40:01.944236 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_pipedrive_analytics.stg_activity ....... [[32mCREATE VIEW[0m in 0.15s]
[0m19:40:01.944236 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity
[0m19:40:01.944236 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.944236 [debug] [MainThread]: On master: BEGIN
[0m19:40:01.944236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:01.966842 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:40:01.979131 [debug] [MainThread]: On master: COMMIT
[0m19:40:01.979471 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.979973 [debug] [MainThread]: On master: COMMIT
[0m19:40:01.981701 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:01.981970 [debug] [MainThread]: On master: Close
[0m19:40:01.982534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:01.982971 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:40:01.983474 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:40:01.983973 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m19:40:01.984472 [info ] [MainThread]: 
[0m19:40:01.985022 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m19:40:01.985972 [debug] [MainThread]: Command end result
[0m19:40:02.005693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:02.007673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:02.013053 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:40:02.014178 [info ] [MainThread]: 
[0m19:40:02.014497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:02.016005 [info ] [MainThread]: 
[0m19:40:02.016430 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:40:02.017941 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:02.017941 after 1.98 seconds
[0m19:40:02.018510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C86310D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1CACFA490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C82187F0>]}
[0m19:40:02.019093 [debug] [MainThread]: Flushing usage events
[0m19:40:02.468223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:46.715865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFB521070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFD494700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFD4947C0>]}


============================== 19:46:46.731990 | e6a19467-a4b5-480e-9cbf-d1168be4f0e9 ==============================
[0m19:46:46.731990 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:46:46.731990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_activity', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:46:46.874136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF9DD1BE0>]}
[0m19:46:46.921988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFA8C4DF0>]}
[0m19:46:46.921988 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:46:47.087460 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:46:47.156494 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:46:47.156494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFCF15520>]}
[0m19:46:48.086978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFDDC6130>]}
[0m19:46:48.161645 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:46:48.164655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:46:48.175286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFDE0A3A0>]}
[0m19:46:48.175286 [info ] [MainThread]: Found 2 models, 6 sources, 428 macros
[0m19:46:48.175286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFDDAAC10>]}
[0m19:46:48.175286 [info ] [MainThread]: 
[0m19:46:48.175286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:46:48.175286 [info ] [MainThread]: 
[0m19:46:48.175286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:48.175286 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:46:48.258794 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:46:48.258794 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:46:48.258794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:48.290596 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m19:46:48.290596 [debug] [ThreadPool]: On list_postgres: Close
[0m19:46:48.290596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics2)
[0m19:46:48.290596 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics2"
"
[0m19:46:48.290596 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics2"
[0m19:46:48.306131 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics2: BEGIN
[0m19:46:48.306131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:48.325982 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:46:48.326599 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics2"
[0m19:46:48.327555 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics2: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics2"} */
create schema if not exists "public_pipedrive_analytics2"
[0m19:46:48.331053 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m19:46:48.332055 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics2: COMMIT
[0m19:46:48.332557 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics2"
[0m19:46:48.332557 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics2: COMMIT
[0m19:46:48.341735 [debug] [ThreadPool]: SQL status: COMMIT in 0.008 seconds
[0m19:46:48.341936 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics2: Close
[0m19:46:48.341936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics2'
[0m19:46:48.341936 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics2"
[0m19:46:48.341936 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics2: BEGIN
[0m19:46:48.341936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:48.357699 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:46:48.369294 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics2"
[0m19:46:48.369595 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics2: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics2"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics2'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics2'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics2'
  
[0m19:46:48.369595 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:46:48.369595 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics2: ROLLBACK
[0m19:46:48.369595 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics2: Close
[0m19:46:48.369595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics2, now list_postgres_public)
[0m19:46:48.369595 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:46:48.369595 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:46:48.369595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:48.386547 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:46:48.398530 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:46:48.399039 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:46:48.403043 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m19:46:48.404044 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:46:48.405543 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:46:48.410042 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:48.410042 [debug] [MainThread]: On master: BEGIN
[0m19:46:48.410042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:48.416128 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:46:48.431633 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:48.432423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:46:48.432946 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m19:46:48.432946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFDEBAD00>]}
[0m19:46:48.432946 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:48.432946 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:48.432946 [debug] [MainThread]: On master: BEGIN
[0m19:46:48.448704 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:46:48.449261 [debug] [MainThread]: On master: COMMIT
[0m19:46:48.449547 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:48.449768 [debug] [MainThread]: On master: COMMIT
[0m19:46:48.451267 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:46:48.451267 [debug] [MainThread]: On master: Close
[0m19:46:48.454769 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity
[0m19:46:48.455270 [info ] [Thread-1  ]: 1 of 1 START sql view model public_pipedrive_analytics2.stg_activity ........... [RUN]
[0m19:46:48.456270 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activity'
[0m19:46:48.456769 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity
[0m19:46:48.463287 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m19:46:48.465366 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity
[0m19:46:48.500188 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m19:46:48.501185 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:46:48.502112 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m19:46:48.502112 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:46:48.521998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m19:46:48.523610 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:46:48.524106 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."public_pipedrive_analytics2"."stg_activity__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m19:46:48.529210 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:46:48.534759 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:46:48.534759 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics2"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m19:46:48.534759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:46:48.542366 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m19:46:48.542366 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:46:48.542366 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m19:46:48.542366 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m19:46:48.558120 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics2"."stg_activity__dbt_backup"
[0m19:46:48.558120 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m19:46:48.558120 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."public_pipedrive_analytics2"."stg_activity__dbt_backup" cascade
[0m19:46:48.558120 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m19:46:48.558120 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: Close
[0m19:46:48.558120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a19467-a4b5-480e-9cbf-d1168be4f0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFDE12040>]}
[0m19:46:48.558120 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_pipedrive_analytics2.stg_activity ...... [[32mCREATE VIEW[0m in 0.10s]
[0m19:46:48.573637 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity
[0m19:46:48.573637 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:48.573637 [debug] [MainThread]: On master: BEGIN
[0m19:46:48.573637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:48.595341 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:46:48.596341 [debug] [MainThread]: On master: COMMIT
[0m19:46:48.596842 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:48.597342 [debug] [MainThread]: On master: COMMIT
[0m19:46:48.598843 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:46:48.598843 [debug] [MainThread]: On master: Close
[0m19:46:48.599841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:48.599841 [debug] [MainThread]: Connection 'create_postgres_public_pipedrive_analytics2' was properly closed.
[0m19:46:48.600350 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:46:48.600350 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m19:46:48.600843 [info ] [MainThread]: 
[0m19:46:48.601841 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m19:46:48.602846 [debug] [MainThread]: Command end result
[0m19:46:48.630930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:46:48.632910 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:46:48.639420 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:46:48.639839 [info ] [MainThread]: 
[0m19:46:48.640737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:48.641424 [info ] [MainThread]: 
[0m19:46:48.643122 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:46:48.645116 [debug] [MainThread]: Command `dbt run` succeeded at 19:46:48.645116 after 1.96 seconds
[0m19:46:48.645619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFB521070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFB16D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CFDDB9E80>]}
[0m19:46:48.646118 [debug] [MainThread]: Flushing usage events
[0m19:46:49.123497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:27.983029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8EF15FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF90E84940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF90E84880>]}


============================== 20:51:27.983029 | ec15927c-c108-4067-9b10-c73e7260cdbb ==============================
[0m20:51:27.983029 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:51:27.983029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:28.131183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8E245310>]}
[0m20:51:28.184209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF90CE0D90>]}
[0m20:51:28.184209 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:51:28.345838 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:51:28.424959 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:51:28.424959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF909157F0>]}
[0m20:51:29.370818 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_activity' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m20:51:29.467104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF917C3DC0>]}
[0m20:51:29.529626 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:51:29.529626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:51:29.545251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF9180BAC0>]}
[0m20:51:29.545251 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m20:51:29.545251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF918056A0>]}
[0m20:51:29.545251 [info ] [MainThread]: 
[0m20:51:29.545251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:29.545251 [info ] [MainThread]: 
[0m20:51:29.561064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:29.561064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:51:29.640921 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:51:29.640921 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:51:29.641898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:29.668447 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m20:51:29.668447 [debug] [ThreadPool]: On list_postgres: Close
[0m20:51:29.684874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:51:29.684874 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:51:29.684874 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:51:29.684874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:29.716149 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m20:51:29.716149 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:51:29.718176 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:29.727893 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m20:51:29.729445 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:51:29.730369 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:51:29.732372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_pipedrive_analytics)
[0m20:51:29.732903 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:51:29.732903 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:51:29.732903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.757866 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:51:29.759293 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:51:29.759802 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:51:29.764315 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m20:51:29.765310 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:51:29.767369 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:51:29.767369 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:29.767369 [debug] [MainThread]: On master: BEGIN
[0m20:51:29.767369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:29.785064 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:51:29.798333 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:29.798844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:29.806838 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m20:51:29.808358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF91602D00>]}
[0m20:51:29.808859 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:29.808859 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:29.808859 [debug] [MainThread]: On master: BEGIN
[0m20:51:29.808859 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:51:29.813072 [debug] [MainThread]: On master: COMMIT
[0m20:51:29.813582 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:29.814081 [debug] [MainThread]: On master: COMMIT
[0m20:51:29.817086 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:51:29.817086 [debug] [MainThread]: On master: Close
[0m20:51:29.824081 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deal_changes
[0m20:51:29.824081 [info ] [Thread-1  ]: 1 of 6 START sql view model public_pipedrive_analytics.deal_changes ............ [RUN]
[0m20:51:29.824081 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.deal_changes'
[0m20:51:29.824081 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deal_changes
[0m20:51:29.824081 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deal_changes"
[0m20:51:29.824081 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deal_changes
[0m20:51:29.867961 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deal_changes"
[0m20:51:29.869996 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m20:51:29.869996 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: BEGIN
[0m20:51:29.871011 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:51:29.891663 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:51:29.892427 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m20:51:29.892785 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m20:51:29.900195 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m20:51:29.903095 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m20:51:29.903095 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."deal_changes__dbt_tmp" rename to "deal_changes"
[0m20:51:29.903095 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:29.916097 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m20:51:29.916097 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m20:51:29.916097 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m20:51:29.916097 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m20:51:29.931851 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."deal_changes__dbt_backup"
[0m20:51:29.931851 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m20:51:29.931851 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."deal_changes__dbt_backup" cascade
[0m20:51:29.931851 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:29.931851 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: Close
[0m20:51:29.931851 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8D7B64C0>]}
[0m20:51:29.947496 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_pipedrive_analytics.deal_changes ....... [[32mCREATE VIEW[0m in 0.11s]
[0m20:51:29.947496 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deal_changes
[0m20:51:29.947496 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m20:51:29.947496 [info ] [Thread-1  ]: 2 of 6 START sql view model public_pipedrive_analytics.stg_activities .......... [RUN]
[0m20:51:29.947496 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.deal_changes, now model.enpal_assessment_project.stg_activities)
[0m20:51:29.947496 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m20:51:29.947496 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m20:51:29.947496 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m20:51:29.947496 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m20:51:29.947496 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:51:29.947496 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m20:51:29.947496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:29.977063 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:51:29.985205 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:51:29.985712 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m20:51:29.987679 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:29.987679 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:51:29.987679 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m20:51:29.987679 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:29.987679 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m20:51:29.987679 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:51:29.987679 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m20:51:30.002029 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:51:30.002948 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activities__dbt_backup"
[0m20:51:30.002948 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:51:30.002948 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activities__dbt_backup" cascade
[0m20:51:30.002948 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.002948 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m20:51:30.002948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8D7B64C0>]}
[0m20:51:30.002948 [info ] [Thread-1  ]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_activities ..... [[32mCREATE VIEW[0m in 0.06s]
[0m20:51:30.013598 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m20:51:30.013598 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.013598 [info ] [Thread-1  ]: 3 of 6 START sql view model public_pipedrive_analytics.stg_activity_types ...... [RUN]
[0m20:51:30.013598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m20:51:30.013598 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.019924 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.020937 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.024945 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.024945 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.024945 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:51:30.024945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.049501 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:51:30.050153 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.050902 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity_types"
  );
[0m20:51:30.060343 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:51:30.060870 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.060870 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:51:30.066433 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.068230 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:51:30.068996 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.069228 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:51:30.069228 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:51:30.069228 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m20:51:30.069228 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.069228 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m20:51:30.079782 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:51:30.080965 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:51:30.082115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8D7B64C0>]}
[0m20:51:30.083125 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_activity_types . [[32mCREATE VIEW[0m in 0.07s]
[0m20:51:30.084175 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.084821 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m20:51:30.085444 [info ] [Thread-1  ]: 4 of 6 START sql view model public_pipedrive_analytics.stg_fields .............. [RUN]
[0m20:51:30.086835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_fields)
[0m20:51:30.087353 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m20:51:30.090656 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m20:51:30.091702 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m20:51:30.096752 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m20:51:30.097665 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.097665 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m20:51:30.098765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.123284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m20:51:30.124438 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.125305 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m20:51:30.128323 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:30.131477 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.131999 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m20:51:30.133741 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:30.135436 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:51:30.135436 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.135436 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:51:30.135436 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:51:30.135436 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m20:51:30.135436 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.135436 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m20:51:30.135436 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.135436 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m20:51:30.135436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8D7B64C0>]}
[0m20:51:30.135436 [info ] [Thread-1  ]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_fields ......... [[32mCREATE VIEW[0m in 0.05s]
[0m20:51:30.150671 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m20:51:30.151672 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:51:30.152443 [info ] [Thread-1  ]: 5 of 6 START sql view model public_pipedrive_analytics.stg_stages .............. [RUN]
[0m20:51:30.152443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m20:51:30.152443 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:51:30.152443 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:51:30.152443 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:51:30.152443 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:51:30.152443 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.152443 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:51:30.152443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.183753 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:51:30.184786 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.185593 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m20:51:30.189095 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:30.192616 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.193121 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m20:51:30.194860 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.194860 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:51:30.194860 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.194860 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:51:30.203098 [debug] [Thread-1  ]: SQL status: COMMIT in 0.016 seconds
[0m20:51:30.203098 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m20:51:30.203098 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.203098 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m20:51:30.218429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.219185 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:51:30.221986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF92DB10D0>]}
[0m20:51:30.222489 [info ] [Thread-1  ]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_stages ......... [[32mCREATE VIEW[0m in 0.07s]
[0m20:51:30.222489 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:51:30.222489 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m20:51:30.222489 [info ] [Thread-1  ]: 6 of 6 START sql view model public_pipedrive_analytics.stg_users ............... [RUN]
[0m20:51:30.222489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m20:51:30.222489 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m20:51:30.222489 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m20:51:30.222489 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m20:51:30.273059 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m20:51:30.273059 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:51:30.273059 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m20:51:30.273059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.300559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:51:30.301802 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:51:30.301886 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m20:51:30.304820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:30.307839 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:51:30.308339 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:51:30.309819 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:30.310839 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m20:51:30.311339 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:51:30.311839 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m20:51:30.314430 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:51:30.317423 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m20:51:30.317423 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:51:30.318511 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m20:51:30.319426 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:51:30.320519 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m20:51:30.322428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec15927c-c108-4067-9b10-c73e7260cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF91DC1400>]}
[0m20:51:30.322600 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_users .......... [[32mCREATE VIEW[0m in 0.10s]
[0m20:51:30.324736 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m20:51:30.325775 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.326735 [debug] [MainThread]: On master: BEGIN
[0m20:51:30.326735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:30.339607 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:51:30.347917 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.348208 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.348424 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.349923 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:51:30.350529 [debug] [MainThread]: On master: Close
[0m20:51:30.351039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:30.351731 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:51:30.351917 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m20:51:30.352426 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m20:51:30.353431 [info ] [MainThread]: 
[0m20:51:30.354935 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m20:51:30.356447 [debug] [MainThread]: Command end result
[0m20:51:30.373729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:51:30.373729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:51:30.386036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:51:30.386483 [info ] [MainThread]: 
[0m20:51:30.387548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:30.388623 [info ] [MainThread]: 
[0m20:51:30.389531 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:51:30.390653 [debug] [MainThread]: Command `dbt run` succeeded at 20:51:30.390653 after 2.44 seconds
[0m20:51:30.390653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8EF15FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8EB6CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF913A4CA0>]}
[0m20:51:30.390653 [debug] [MainThread]: Flushing usage events
[0m20:51:30.963868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:15.348990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503D7910A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503F6F37C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503F6F3880>]}


============================== 20:53:15.352557 | 2675798b-88ca-4892-8f15-6fc8a8c1f596 ==============================
[0m20:53:15.352557 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:53:15.353517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_deal_changes', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:53:15.510308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2675798b-88ca-4892-8f15-6fc8a8c1f596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503C041D00>]}
[0m20:53:15.568557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2675798b-88ca-4892-8f15-6fc8a8c1f596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503CB1C100>]}
[0m20:53:15.569637 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:53:15.746075 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:53:15.895505 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:53:15.895505 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\staging\pipedrive\stg_deal_changes.sql
[0m20:53:15.895505 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\staging\pipedrive\deal_changes.sql
[0m20:53:16.145996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2675798b-88ca-4892-8f15-6fc8a8c1f596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503FF86130>]}
[0m20:53:16.213554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:16.213554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:16.228551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2675798b-88ca-4892-8f15-6fc8a8c1f596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503FF66910>]}
[0m20:53:16.228551 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m20:53:16.228551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2675798b-88ca-4892-8f15-6fc8a8c1f596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503FF86370>]}
[0m20:53:16.228551 [info ] [MainThread]: 
[0m20:53:16.228551 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:16.228551 [info ] [MainThread]: 
[0m20:53:16.244371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:16.246154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:53:16.296951 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:53:16.296951 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:53:16.312204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:16.329056 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m20:53:16.344476 [debug] [ThreadPool]: On list_postgres: Close
[0m20:53:16.345863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m20:53:16.345863 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:53:16.345863 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:53:16.345863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:16.377784 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:53:16.378285 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:53:16.379289 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:53:16.385285 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m20:53:16.386889 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:53:16.388287 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:53:16.389286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public)
[0m20:53:16.389286 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:16.389286 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:53:16.389286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:16.414080 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:53:16.414453 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:16.415096 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:53:16.418605 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:53:16.419702 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:53:16.421105 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:53:16.426132 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:16.427146 [debug] [MainThread]: On master: BEGIN
[0m20:53:16.427146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:16.445026 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m20:53:16.445725 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:16.446191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:53:16.450689 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m20:53:16.452707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2675798b-88ca-4892-8f15-6fc8a8c1f596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150400744F0>]}
[0m20:53:16.453189 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:16.455253 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:16.455253 [debug] [MainThread]: On master: BEGIN
[0m20:53:16.455756 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:53:16.458094 [debug] [MainThread]: On master: COMMIT
[0m20:53:16.458616 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:16.459200 [debug] [MainThread]: On master: COMMIT
[0m20:53:16.460836 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:53:16.461370 [debug] [MainThread]: On master: Close
[0m20:53:16.464995 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:53:16.465543 [info ] [Thread-1  ]: 1 of 1 START sql view model public_pipedrive_analytics.stg_deal_changes ........ [RUN]
[0m20:53:16.467141 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_deal_changes'
[0m20:53:16.467688 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:53:16.475061 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:16.475061 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:53:16.513634 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:16.513634 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:16.513634 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:53:16.513634 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:53:16.529975 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:53:16.541725 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:16.542030 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m20:53:16.545042 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:53:16.581371 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:16.581371 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m20:53:16.581371 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:53:16.605201 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:53:16.605201 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:16.606203 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:53:16.609285 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:53:16.615203 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m20:53:16.619289 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:16.620279 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m20:53:16.622204 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:53:16.624279 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:53:16.626287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2675798b-88ca-4892-8f15-6fc8a8c1f596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503C026550>]}
[0m20:53:16.627742 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_pipedrive_analytics.stg_deal_changes ... [[32mCREATE VIEW[0m in 0.16s]
[0m20:53:16.627742 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:53:16.627742 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:16.627742 [debug] [MainThread]: On master: BEGIN
[0m20:53:16.627742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:16.650233 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m20:53:16.650851 [debug] [MainThread]: On master: COMMIT
[0m20:53:16.651368 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:16.651868 [debug] [MainThread]: On master: COMMIT
[0m20:53:16.653368 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:53:16.653368 [debug] [MainThread]: On master: Close
[0m20:53:16.653868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:16.654369 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:53:16.654870 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:53:16.655366 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_changes' was properly closed.
[0m20:53:16.655366 [info ] [MainThread]: 
[0m20:53:16.656434 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m20:53:16.657454 [debug] [MainThread]: Command end result
[0m20:53:16.677806 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:16.681666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:16.685377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:53:16.685377 [info ] [MainThread]: 
[0m20:53:16.685377 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:16.685377 [info ] [MainThread]: 
[0m20:53:16.685377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:53:16.685377 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:16.685377 after 1.40 seconds
[0m20:53:16.685377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503D7910A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503FE08CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503EB2CB20>]}
[0m20:53:16.685377 [debug] [MainThread]: Flushing usage events
[0m20:53:17.190860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:27.929667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024466B80070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024468AF4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024468AF4850>]}


============================== 20:57:27.929667 | 33737917-88c1-4e64-bb10-b6816565e0ad ==============================
[0m20:57:27.929667 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:57:27.943494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_activity_types', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:57:28.077112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33737917-88c1-4e64-bb10-b6816565e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024465431BE0>]}
[0m20:57:28.124233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33737917-88c1-4e64-bb10-b6816565e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244685A7280>]}
[0m20:57:28.124233 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:57:28.294775 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:57:28.420175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:28.420175 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\stg_activity_types.sql
[0m20:57:28.646342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33737917-88c1-4e64-bb10-b6816565e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024469332130>]}
[0m20:57:28.708860 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:57:28.708860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:57:28.724779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33737917-88c1-4e64-bb10-b6816565e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446937CA30>]}
[0m20:57:28.724779 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m20:57:28.724779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33737917-88c1-4e64-bb10-b6816565e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024469332820>]}
[0m20:57:28.724779 [info ] [MainThread]: 
[0m20:57:28.724779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:57:28.724779 [info ] [MainThread]: 
[0m20:57:28.724779 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:57:28.740695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:57:28.811745 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:57:28.811745 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:57:28.811745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:28.837628 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m20:57:28.844731 [debug] [ThreadPool]: On list_postgres: Close
[0m20:57:28.844731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:57:28.844731 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:57:28.844731 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:57:28.844731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:28.873668 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:57:28.876388 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:57:28.876563 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:57:28.881563 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m20:57:28.883071 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:57:28.884583 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:57:28.885670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_pipedrive_analytics)
[0m20:57:28.887146 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:57:28.887146 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:57:28.887146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:28.913417 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m20:57:28.920991 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:57:28.921498 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:57:28.921998 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:57:28.921998 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:57:28.921998 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:57:28.933380 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:28.933380 [debug] [MainThread]: On master: BEGIN
[0m20:57:28.933380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:28.953805 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m20:57:28.954689 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:28.955176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:57:28.961174 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m20:57:28.963198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33737917-88c1-4e64-bb10-b6816565e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446937C760>]}
[0m20:57:28.963674 [debug] [MainThread]: On master: ROLLBACK
[0m20:57:28.964675 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:28.964675 [debug] [MainThread]: On master: BEGIN
[0m20:57:28.967951 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:57:28.968394 [debug] [MainThread]: On master: COMMIT
[0m20:57:28.968394 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:28.968922 [debug] [MainThread]: On master: COMMIT
[0m20:57:28.970419 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:57:28.970419 [debug] [MainThread]: On master: Close
[0m20:57:28.973920 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:57:28.974438 [info ] [Thread-1  ]: 1 of 1 START sql view model public_pipedrive_analytics.stg_activity_types ...... [RUN]
[0m20:57:28.975424 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activity_types'
[0m20:57:28.975924 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:57:28.979422 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:57:28.983732 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:57:29.016763 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:57:29.017764 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:57:29.018768 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:57:29.018768 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:57:29.046566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.032 seconds
[0m20:57:29.052223 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:57:29.052570 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
[0m20:57:29.062201 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:57:29.101860 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:57:29.102392 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m20:57:29.104780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:57:29.105857 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:57:29.105857 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:57:29.105857 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:57:29.121672 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:57:29.121672 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:57:29.121672 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:57:29.121672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m20:57:29.137413 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m20:57:29.137413 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:57:29.137413 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m20:57:29.143578 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.007 seconds
[0m20:57:29.143578 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:57:29.154083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33737917-88c1-4e64-bb10-b6816565e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446981F580>]}
[0m20:57:29.154083 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_pipedrive_analytics.stg_activity_types . [[32mCREATE VIEW[0m in 0.17s]
[0m20:57:29.154083 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:57:29.154083 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:29.154083 [debug] [MainThread]: On master: BEGIN
[0m20:57:29.154083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:29.183507 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m20:57:29.189529 [debug] [MainThread]: On master: COMMIT
[0m20:57:29.190470 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:29.190968 [debug] [MainThread]: On master: COMMIT
[0m20:57:29.192473 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:57:29.192970 [debug] [MainThread]: On master: Close
[0m20:57:29.193965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:29.193965 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:57:29.194465 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m20:57:29.194965 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity_types' was properly closed.
[0m20:57:29.194965 [info ] [MainThread]: 
[0m20:57:29.195968 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m20:57:29.197551 [debug] [MainThread]: Command end result
[0m20:57:29.217582 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:57:29.217582 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:57:29.223641 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:57:29.223641 [info ] [MainThread]: 
[0m20:57:29.223641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:29.229803 [info ] [MainThread]: 
[0m20:57:29.230878 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:57:29.232064 [debug] [MainThread]: Command `dbt run` succeeded at 20:57:29.232064 after 1.34 seconds
[0m20:57:29.233066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024466B80070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244667D18E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244697C3A60>]}
[0m20:57:29.233066 [debug] [MainThread]: Flushing usage events
[0m20:57:29.722921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:14.068872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236326C00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634634760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634634820>]}


============================== 21:01:14.084478 | e645a524-8c64-478d-83ec-f9223d4aa7f7 ==============================
[0m21:01:14.084478 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m21:01:14.084478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:01:14.233913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023630F71D00>]}
[0m21:01:14.265727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023631A14D00>]}
[0m21:01:14.281357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:01:14.446754 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m21:01:14.525563 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:01:14.541256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023632A73FA0>]}
[0m21:01:15.393176 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_activity' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m21:01:15.482946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634F63E50>]}
[0m21:01:15.545681 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:01:15.545681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:01:15.562679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634FAB3D0>]}
[0m21:01:15.562679 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m21:01:15.562679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634F54C40>]}
[0m21:01:15.562679 [info ] [MainThread]: 
[0m21:01:15.578314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:01:15.578314 [info ] [MainThread]: 
[0m21:01:15.578314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:01:15.578314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:01:15.650309 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:01:15.650309 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:01:15.651394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:15.692962 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.051 seconds
[0m21:01:15.692962 [debug] [ThreadPool]: On list_postgres: Close
[0m21:01:15.692962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m21:01:15.692962 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m21:01:15.709354 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:01:15.709354 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m21:01:15.709354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:15.740621 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m21:01:15.741492 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:01:15.741685 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m21:01:15.744027 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m21:01:15.745048 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:01:15.745048 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:01:15.745548 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:01:15.749528 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m21:01:15.749528 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m21:01:15.751548 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m21:01:15.752671 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:01:15.752671 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m21:01:15.752671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:15.769454 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m21:01:15.778615 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:01:15.778615 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:01:15.784100 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:01:15.785164 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m21:01:15.786269 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m21:01:15.786820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m21:01:15.789063 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:01:15.789063 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:01:15.790089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:15.800014 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:01:15.807957 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:01:15.808119 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:01:15.811844 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:01:15.812877 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:01:15.813946 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:01:15.819204 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:15.819204 [debug] [MainThread]: On master: BEGIN
[0m21:01:15.819204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:15.843532 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:01:15.844310 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:15.844835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:01:15.852696 [debug] [MainThread]: SQL status: SELECT 6 in 0.007 seconds
[0m21:01:15.855594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634F4EBB0>]}
[0m21:01:15.855594 [debug] [MainThread]: On master: ROLLBACK
[0m21:01:15.855594 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:15.855594 [debug] [MainThread]: On master: BEGIN
[0m21:01:15.855594 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:01:15.861080 [debug] [MainThread]: On master: COMMIT
[0m21:01:15.861585 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:15.861990 [debug] [MainThread]: On master: COMMIT
[0m21:01:15.863490 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:01:15.863649 [debug] [MainThread]: On master: Close
[0m21:01:15.867488 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m21:01:15.867989 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m21:01:15.868989 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m21:01:15.869489 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m21:01:15.871996 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m21:01:15.871996 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m21:01:15.908933 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m21:01:15.910929 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:01:15.910929 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m21:01:15.911930 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:01:15.921545 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m21:01:15.932685 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:01:15.933538 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m21:01:15.938209 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:01:15.944838 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:01:15.944838 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m21:01:15.946826 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:01:15.960611 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:01:15.960611 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:01:15.961611 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:01:15.968396 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m21:01:15.973407 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m21:01:15.976402 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:01:15.977401 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m21:01:15.979430 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:01:15.982712 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m21:01:15.983830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023635400A00>]}
[0m21:01:15.983830 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.11s]
[0m21:01:15.983830 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m21:01:15.983830 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m21:01:15.983830 [info ] [Thread-1  ]: 2 of 6 START sql view model public_staging.stg_activity_types .................. [RUN]
[0m21:01:15.983830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m21:01:15.983830 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m21:01:15.983830 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m21:01:15.983830 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m21:01:15.983830 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m21:01:15.983830 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:01:15.983830 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m21:01:15.983830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:16.017193 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m21:01:16.018430 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:01:16.019471 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_staging"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
[0m21:01:16.023510 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:01:16.026536 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:01:16.027087 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m21:01:16.028420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:01:16.028420 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:01:16.028420 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:01:16.028420 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:01:16.035532 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:01:16.035532 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m21:01:16.035532 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:01:16.035532 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m21:01:16.035532 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:01:16.035532 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m21:01:16.035532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023632A7EE80>]}
[0m21:01:16.035532 [info ] [Thread-1  ]: 2 of 6 OK created sql view model public_staging.stg_activity_types ............. [[32mCREATE VIEW[0m in 0.05s]
[0m21:01:16.035532 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m21:01:16.035532 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:01:16.035532 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m21:01:16.035532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m21:01:16.035532 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:01:16.052835 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:01:16.053947 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:01:16.057940 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:01:16.057940 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:01:16.057940 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m21:01:16.057940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:16.084073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m21:01:16.085474 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:01:16.085976 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m21:01:16.089483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:01:16.093429 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:01:16.094035 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:01:16.096229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:01:16.097875 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:01:16.098599 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:01:16.099106 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:01:16.103243 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:01:16.103243 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m21:01:16.103243 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:01:16.103243 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:01:16.103243 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:01:16.103243 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:01:16.103243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023635541EB0>]}
[0m21:01:16.103243 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.07s]
[0m21:01:16.103243 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:01:16.113672 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m21:01:16.113672 [info ] [Thread-1  ]: 4 of 6 START sql view model public_staging.stg_fields .......................... [RUN]
[0m21:01:16.113672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m21:01:16.113672 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m21:01:16.119735 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m21:01:16.120843 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m21:01:16.124834 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m21:01:16.124834 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:01:16.124834 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m21:01:16.124834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:16.150108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:01:16.151505 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:01:16.152610 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."public_staging"."stg_fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m21:01:16.156504 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:01:16.160628 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:01:16.161143 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m21:01:16.161258 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:01:16.161258 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:01:16.161258 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:01:16.161258 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:01:16.169050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:01:16.169050 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m21:01:16.169050 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:01:16.169050 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m21:01:16.169050 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:01:16.169050 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m21:01:16.169050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023635541EB0>]}
[0m21:01:16.169050 [info ] [Thread-1  ]: 4 of 6 OK created sql view model public_staging.stg_fields ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m21:01:16.169050 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m21:01:16.169050 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m21:01:16.169050 [info ] [Thread-1  ]: 5 of 6 START sql view model public_staging.stg_stages .......................... [RUN]
[0m21:01:16.169050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m21:01:16.183096 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m21:01:16.187048 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m21:01:16.188146 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m21:01:16.191128 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m21:01:16.191128 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:01:16.191128 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m21:01:16.191128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:16.223236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m21:01:16.224000 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:01:16.225072 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_staging"."stg_stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m21:01:16.229503 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:01:16.235960 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:01:16.235960 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m21:01:16.235960 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:01:16.235960 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:01:16.235960 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:01:16.235960 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:01:16.235960 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:01:16.235960 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m21:01:16.235960 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:01:16.235960 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m21:01:16.250769 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:01:16.253616 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m21:01:16.255150 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363554FEB0>]}
[0m21:01:16.255661 [info ] [Thread-1  ]: 5 of 6 OK created sql view model public_staging.stg_stages ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:01:16.255661 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m21:01:16.255661 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m21:01:16.255661 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m21:01:16.255661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m21:01:16.259790 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m21:01:16.303157 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m21:01:16.303157 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m21:01:16.303157 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m21:01:16.303157 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:01:16.303157 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m21:01:16.303157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:16.332803 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m21:01:16.333924 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:01:16.334337 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m21:01:16.337845 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:01:16.340856 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:01:16.341356 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:01:16.342845 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:01:16.344354 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:01:16.344855 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:01:16.345337 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:01:16.349360 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:01:16.352394 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m21:01:16.353361 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:01:16.353361 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m21:01:16.355352 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:01:16.356432 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m21:01:16.356432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e645a524-8c64-478d-83ec-f9223d4aa7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363554FEB0>]}
[0m21:01:16.357343 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m21:01:16.359347 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m21:01:16.360344 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:16.360344 [debug] [MainThread]: On master: BEGIN
[0m21:01:16.361349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:01:16.378242 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m21:01:16.382615 [debug] [MainThread]: On master: COMMIT
[0m21:01:16.383124 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:16.383216 [debug] [MainThread]: On master: COMMIT
[0m21:01:16.384837 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:01:16.385123 [debug] [MainThread]: On master: Close
[0m21:01:16.386125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:16.386678 [debug] [MainThread]: Connection 'create_postgres_public_staging' was properly closed.
[0m21:01:16.387246 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m21:01:16.387246 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m21:01:16.387784 [info ] [MainThread]: 
[0m21:01:16.388892 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m21:01:16.390439 [debug] [MainThread]: Command end result
[0m21:01:16.407209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:01:16.407209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:01:16.423686 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m21:01:16.424892 [info ] [MainThread]: 
[0m21:01:16.424892 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:16.424892 [info ] [MainThread]: 
[0m21:01:16.424892 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:01:16.424892 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:16.424892 after 2.39 seconds
[0m21:01:16.424892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236326C00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634D05250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023634DD1730>]}
[0m21:01:16.424892 [debug] [MainThread]: Flushing usage events
[0m21:01:17.011651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:08.942136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA5EB0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA7E24700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA7E247C0>]}


============================== 21:02:08.942136 | 61690efc-ec83-477f-b380-cc4ae2b42afc ==============================
[0m21:02:08.942136 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m21:02:08.942136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:02:09.095119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA476A790>]}
[0m21:02:09.141993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA7DCB5B0>]}
[0m21:02:09.141993 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:02:09.293268 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m21:02:09.436320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:02:09.437377 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m21:02:09.562678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8603130>]}
[0m21:02:09.634713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:02:09.651163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:02:09.651163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8603100>]}
[0m21:02:09.651163 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m21:02:09.666174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA853F250>]}
[0m21:02:09.666174 [info ] [MainThread]: 
[0m21:02:09.666174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:09.666174 [info ] [MainThread]: 
[0m21:02:09.666174 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:02:09.666174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:02:09.747714 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:02:09.747714 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:02:09.747714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:09.788626 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.030 seconds
[0m21:02:09.788626 [debug] [ThreadPool]: On list_postgres: Close
[0m21:02:09.793381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m21:02:09.793381 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:02:09.793381 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:02:09.793381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:09.823076 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:02:09.826325 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:02:09.826890 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:02:09.832334 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m21:02:09.834841 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:02:09.836571 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:02:09.837671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m21:02:09.838742 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:02:09.838742 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m21:02:09.838742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:09.859552 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:02:09.866465 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:02:09.866602 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:02:09.870207 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:02:09.871855 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m21:02:09.873192 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m21:02:09.877713 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:09.877713 [debug] [MainThread]: On master: BEGIN
[0m21:02:09.877713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:09.914560 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:02:09.915834 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:09.916355 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:02:09.920789 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m21:02:09.924396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA5AC45E0>]}
[0m21:02:09.924396 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:09.925841 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:09.926473 [debug] [MainThread]: On master: BEGIN
[0m21:02:09.926983 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:02:09.926983 [debug] [MainThread]: On master: COMMIT
[0m21:02:09.929428 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:09.930154 [debug] [MainThread]: On master: COMMIT
[0m21:02:09.931545 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:02:09.932050 [debug] [MainThread]: On master: Close
[0m21:02:09.940039 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m21:02:09.940632 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m21:02:09.941131 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m21:02:09.941131 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m21:02:09.942901 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m21:02:09.942901 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m21:02:09.985127 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m21:02:09.986058 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:02:09.986058 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m21:02:09.987053 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:02:10.030108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.044 seconds
[0m21:02:10.032024 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:02:10.032809 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m21:02:10.036033 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:02:10.041034 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:02:10.041535 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities" rename to "stg_activities__dbt_backup"
[0m21:02:10.042546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:02:10.042546 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:02:10.042546 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m21:02:10.042546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:02:10.080518 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:02:10.096133 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:02:10.096673 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:02:10.097535 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m21:02:10.097535 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m21:02:10.113274 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:02:10.113274 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m21:02:10.113274 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m21:02:10.113274 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m21:02:10.122304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA47464F0>]}
[0m21:02:10.122304 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.17s]
[0m21:02:10.122304 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m21:02:10.122304 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m21:02:10.122304 [info ] [Thread-1  ]: 2 of 6 START sql view model public_staging.stg_activity_types .................. [RUN]
[0m21:02:10.122304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m21:02:10.122304 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m21:02:10.122304 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.122304 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m21:02:10.122304 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.122304 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.122304 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m21:02:10.122304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:10.156607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m21:02:10.157358 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.157990 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_staging"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
[0m21:02:10.161420 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:02:10.165508 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.166005 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m21:02:10.168004 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:10.168004 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.168004 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m21:02:10.172858 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:10.173311 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:02:10.173311 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.173311 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:02:10.182294 [debug] [Thread-1  ]: SQL status: COMMIT in 0.015 seconds
[0m21:02:10.182294 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m21:02:10.182294 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:02:10.182294 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m21:02:10.199429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m21:02:10.200490 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m21:02:10.201492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA47464F0>]}
[0m21:02:10.202441 [info ] [Thread-1  ]: 2 of 6 OK created sql view model public_staging.stg_activity_types ............. [[32mCREATE VIEW[0m in 0.08s]
[0m21:02:10.203075 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m21:02:10.204102 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:02:10.204102 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m21:02:10.205564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m21:02:10.205564 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:02:10.208569 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.209570 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:02:10.212870 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.213777 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.214807 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m21:02:10.216217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:10.236642 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m21:02:10.237642 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.238641 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m21:02:10.241643 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:02:10.245425 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.246229 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m21:02:10.249034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:02:10.249034 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.249034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:02:10.249034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:02:10.249034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:02:10.249034 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.249034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:02:10.263568 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:02:10.265019 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m21:02:10.265019 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:02:10.265019 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:02:10.273765 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:02:10.273765 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:02:10.273765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA78EA400>]}
[0m21:02:10.273765 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.07s]
[0m21:02:10.273765 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:02:10.273765 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m21:02:10.273765 [info ] [Thread-1  ]: 4 of 6 START sql view model public_staging.stg_fields .......................... [RUN]
[0m21:02:10.280805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m21:02:10.280805 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m21:02:10.284120 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m21:02:10.285121 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m21:02:10.288124 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m21:02:10.289135 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:02:10.290033 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m21:02:10.290033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:10.302885 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m21:02:10.311669 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:02:10.312173 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."public_staging"."stg_fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m21:02:10.315820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:02:10.319837 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:02:10.319837 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m21:02:10.319837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:02:10.323159 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:02:10.323159 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m21:02:10.323159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:02:10.323159 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:02:10.323159 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:02:10.330370 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:02:10.334854 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:02:10.335392 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m21:02:10.335392 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:02:10.335392 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m21:02:10.335392 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:02:10.335392 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m21:02:10.335392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8A9DDF0>]}
[0m21:02:10.335392 [info ] [Thread-1  ]: 4 of 6 OK created sql view model public_staging.stg_fields ..................... [[32mCREATE VIEW[0m in 0.05s]
[0m21:02:10.347166 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m21:02:10.347166 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m21:02:10.348444 [info ] [Thread-1  ]: 5 of 6 START sql view model public_staging.stg_stages .......................... [RUN]
[0m21:02:10.348444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m21:02:10.348444 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m21:02:10.353184 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m21:02:10.353184 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m21:02:10.353184 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m21:02:10.353184 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:02:10.353184 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m21:02:10.353184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:10.380159 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m21:02:10.381260 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:02:10.382108 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_staging"."stg_stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m21:02:10.385654 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:02:10.388693 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:02:10.389198 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m21:02:10.391114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:10.392111 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:02:10.392111 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m21:02:10.396917 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:10.398632 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:02:10.398632 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:02:10.398632 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:02:10.398632 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:02:10.398632 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m21:02:10.398632 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:02:10.398632 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m21:02:10.398632 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:02:10.413806 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m21:02:10.414919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8A5EF10>]}
[0m21:02:10.415912 [info ] [Thread-1  ]: 5 of 6 OK created sql view model public_staging.stg_stages ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m21:02:10.416863 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m21:02:10.417871 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m21:02:10.417871 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m21:02:10.419039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m21:02:10.419039 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m21:02:10.421051 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m21:02:10.422051 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m21:02:10.426438 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m21:02:10.426438 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:02:10.427438 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m21:02:10.427438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:10.452973 [debug] [Thread-1  ]: SQL status: BEGIN in 0.034 seconds
[0m21:02:10.462653 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:02:10.463660 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m21:02:10.466683 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:02:10.470181 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:02:10.470681 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users" rename to "stg_users__dbt_backup"
[0m21:02:10.472163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:10.473687 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:02:10.473687 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:02:10.473687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:02:10.473687 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:02:10.473687 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:02:10.473687 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:02:10.483379 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:02:10.485380 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m21:02:10.486379 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:02:10.486379 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m21:02:10.491045 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:02:10.492996 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m21:02:10.493996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61690efc-ec83-477f-b380-cc4ae2b42afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8AA4730>]}
[0m21:02:10.493996 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.07s]
[0m21:02:10.495997 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m21:02:10.497109 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:10.498112 [debug] [MainThread]: On master: BEGIN
[0m21:02:10.498112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:10.518797 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m21:02:10.528555 [debug] [MainThread]: On master: COMMIT
[0m21:02:10.528751 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:10.529282 [debug] [MainThread]: On master: COMMIT
[0m21:02:10.530755 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:02:10.530755 [debug] [MainThread]: On master: Close
[0m21:02:10.532050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:10.532845 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m21:02:10.533530 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m21:02:10.533530 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m21:02:10.534564 [info ] [MainThread]: 
[0m21:02:10.535562 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m21:02:10.537063 [debug] [MainThread]: Command end result
[0m21:02:10.553238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:02:10.553238 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:02:10.568926 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m21:02:10.568926 [info ] [MainThread]: 
[0m21:02:10.570083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:10.570083 [info ] [MainThread]: 
[0m21:02:10.570083 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:02:10.570083 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:10.570083 after 1.67 seconds
[0m21:02:10.570083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA5EB0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8543070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA5ACFB20>]}
[0m21:02:10.570083 [debug] [MainThread]: Flushing usage events
[0m21:02:11.124266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:24.562557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C8991FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CA9049A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CA9048E0>]}


============================== 21:55:24.577669 | 6d32329e-0aab-4fa3-b742-3f37ab6f1bee ==============================
[0m21:55:24.577669 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m21:55:24.577669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:24.722090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C725A6D0>]}
[0m21:55:24.763859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C7CBD8B0>]}
[0m21:55:24.763859 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:55:24.920384 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m21:55:25.003966 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:55:25.003966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CA37C5E0>]}
[0m21:55:25.946048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB1F3130>]}
[0m21:55:26.013932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:55:26.032360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:55:26.046204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB28D520>]}
[0m21:55:26.046204 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m21:55:26.046204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB23E190>]}
[0m21:55:26.046204 [info ] [MainThread]: 
[0m21:55:26.046204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:26.046204 [info ] [MainThread]: 
[0m21:55:26.046204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:26.046204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:55:26.132793 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:55:26.132793 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:55:26.132793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:26.172940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m21:55:26.174401 [debug] [ThreadPool]: On list_postgres: Close
[0m21:55:26.174401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m21:55:26.174401 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m21:55:26.178859 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:55:26.178859 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m21:55:26.178859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:26.195093 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:55:26.199196 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:55:26.199695 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m21:55:26.201695 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m21:55:26.203007 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:55:26.203211 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:55:26.203710 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:55:26.208695 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m21:55:26.209283 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m21:55:26.210194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m21:55:26.214092 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:55:26.214092 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:55:26.214092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:26.252378 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m21:55:26.253396 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:55:26.253396 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:55:26.259536 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m21:55:26.261036 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:55:26.262544 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:55:26.263378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m21:55:26.265453 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:55:26.265453 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m21:55:26.265453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:26.294681 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m21:55:26.298122 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:55:26.298122 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:55:26.298122 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m21:55:26.298122 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m21:55:26.298122 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m21:55:26.303865 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:26.303865 [debug] [MainThread]: On master: BEGIN
[0m21:55:26.303865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:26.325242 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m21:55:26.327904 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:26.328424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:26.332911 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:55:26.334411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB28D160>]}
[0m21:55:26.334911 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:26.335912 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:26.336411 [debug] [MainThread]: On master: BEGIN
[0m21:55:26.338047 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:55:26.338758 [debug] [MainThread]: On master: COMMIT
[0m21:55:26.339147 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:26.339147 [debug] [MainThread]: On master: COMMIT
[0m21:55:26.340693 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:55:26.340693 [debug] [MainThread]: On master: Close
[0m21:55:26.344181 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m21:55:26.344636 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m21:55:26.345681 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m21:55:26.345681 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m21:55:26.349271 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m21:55:26.349271 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m21:55:26.380075 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m21:55:26.380075 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:26.380075 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m21:55:26.380075 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:55:26.404360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m21:55:26.405258 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:26.405258 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT
   activity_id
  ,type
  ,assigned_to_user
  ,deal_id
  ,done
  ,due_to
FROM "postgres"."public"."activity"
  );
[0m21:55:26.409752 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:55:26.415252 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:26.415252 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m21:55:26.415252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:55:26.430096 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:55:26.430096 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:26.431461 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:55:26.432818 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:55:26.432818 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m21:55:26.432818 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:26.432818 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m21:55:26.445265 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:55:26.445265 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m21:55:26.445265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB798D00>]}
[0m21:55:26.445265 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:55:26.445265 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m21:55:26.445265 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m21:55:26.445265 [info ] [Thread-1  ]: 2 of 6 START sql view model public_staging.stg_activity_types .................. [RUN]
[0m21:55:26.445265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m21:55:26.445265 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m21:55:26.445265 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m21:55:26.445265 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m21:55:26.461308 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m21:55:26.461802 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:26.461802 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m21:55:26.461802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:26.481438 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m21:55:26.482270 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:26.482651 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_staging"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
[0m21:55:26.499973 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.022 seconds
[0m21:55:26.512118 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:26.512118 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m21:55:26.521010 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.008 seconds
[0m21:55:26.521010 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:55:26.521010 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:26.526889 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:55:26.529904 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:55:26.529904 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m21:55:26.540230 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:26.540730 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m21:55:26.540730 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:55:26.540730 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m21:55:26.540730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9D476D0>]}
[0m21:55:26.540730 [info ] [Thread-1  ]: 2 of 6 OK created sql view model public_staging.stg_activity_types ............. [[32mCREATE VIEW[0m in 0.10s]
[0m21:55:26.540730 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m21:55:26.540730 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:55:26.540730 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m21:55:26.549058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m21:55:26.549058 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:55:26.549058 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:26.549058 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:55:26.549058 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:26.549058 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:26.549058 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m21:55:26.549058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:26.577434 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m21:55:26.579481 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:26.579993 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"
  );
[0m21:55:26.583491 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:55:26.586575 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:26.587090 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:55:26.588491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:26.589490 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:55:26.589990 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:26.589990 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:55:26.596456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m21:55:26.596456 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m21:55:26.596456 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:26.596456 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:55:26.596456 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:55:26.596456 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:55:26.596456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9D476D0>]}
[0m21:55:26.596456 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.05s]
[0m21:55:26.596456 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:55:26.596456 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m21:55:26.596456 [info ] [Thread-1  ]: 4 of 6 START sql view model public_staging.stg_fields .......................... [RUN]
[0m21:55:26.596456 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m21:55:26.596456 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m21:55:26.613014 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m21:55:26.614330 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m21:55:26.620323 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m21:55:26.621322 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:55:26.621822 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m21:55:26.621822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:26.638522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m21:55:26.639424 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:55:26.639424 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."public_staging"."stg_fields__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields", 
 jsonb_array_elements(field_value_options) opt
  );
[0m21:55:26.644999 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" specified more than once

[0m21:55:26.645424 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: ROLLBACK
[0m21:55:26.647745 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m21:55:26.654471 [debug] [Thread-1  ]: Database Error in model stg_fields (models\staging\pipedrive\stg_fields.sql)
  column "id" specified more than once
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_fields.sql
[0m21:55:26.655428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB8241C0>]}
[0m21:55:26.655928 [error] [Thread-1  ]: 4 of 6 ERROR creating sql view model public_staging.stg_fields ................. [[31mERROR[0m in 0.06s]
[0m21:55:26.656425 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m21:55:26.656425 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m21:55:26.656425 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.stg_fields' to be skipped because of status 'error'.  Reason: Database Error in model stg_fields (models\staging\pipedrive\stg_fields.sql)
  column "id" specified more than once
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_fields.sql.
[0m21:55:26.656425 [info ] [Thread-1  ]: 5 of 6 START sql view model public_staging.stg_stages .......................... [RUN]
[0m21:55:26.656425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m21:55:26.656425 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m21:55:26.656425 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m21:55:26.656425 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m21:55:26.663957 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m21:55:26.663957 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:26.663957 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m21:55:26.663957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:26.705552 [debug] [Thread-1  ]: SQL status: BEGIN in 0.041 seconds
[0m21:55:26.710395 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:26.710904 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_staging"."stg_stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m21:55:26.713622 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:55:26.716854 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:26.717495 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m21:55:26.718775 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:26.720361 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:55:26.720361 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:26.720901 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:55:26.721452 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:55:26.721452 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m21:55:26.721452 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:26.728947 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m21:55:26.730780 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:26.730780 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m21:55:26.733837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB8281F0>]}
[0m21:55:26.734337 [info ] [Thread-1  ]: 5 of 6 OK created sql view model public_staging.stg_stages ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m21:55:26.734337 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m21:55:26.734337 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m21:55:26.734337 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m21:55:26.734337 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m21:55:26.734337 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m21:55:26.739407 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m21:55:26.739407 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m21:55:26.745450 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m21:55:26.748306 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:26.748306 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m21:55:26.748306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:26.764360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m21:55:26.768961 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:26.769355 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m21:55:26.772065 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:55:26.812369 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:26.812369 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:55:26.812369 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:55:26.820497 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:55:26.821074 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:26.821074 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:55:26.821074 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m21:55:26.821074 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m21:55:26.821074 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:26.821074 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m21:55:26.829087 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:26.829087 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m21:55:26.829087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d32329e-0aab-4fa3-b742-3f37ab6f1bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB8241C0>]}
[0m21:55:26.829087 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:55:26.833918 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m21:55:26.835497 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:26.835497 [debug] [MainThread]: On master: BEGIN
[0m21:55:26.835497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:26.853777 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m21:55:26.854179 [debug] [MainThread]: On master: COMMIT
[0m21:55:26.854680 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:26.854680 [debug] [MainThread]: On master: COMMIT
[0m21:55:26.856681 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m21:55:26.857180 [debug] [MainThread]: On master: Close
[0m21:55:26.857768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:26.858189 [debug] [MainThread]: Connection 'create_postgres_public_staging' was properly closed.
[0m21:55:26.858189 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m21:55:26.858682 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m21:55:26.859182 [info ] [MainThread]: 
[0m21:55:26.859691 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m21:55:26.861772 [debug] [MainThread]: Command end result
[0m21:55:26.895651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:55:26.896649 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:55:26.896649 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m21:55:26.896649 [info ] [MainThread]: 
[0m21:55:26.896649 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m21:55:26.896649 [info ] [MainThread]: 
[0m21:55:26.896649 [error] [MainThread]:   Database Error in model stg_fields (models\staging\pipedrive\stg_fields.sql)
  column "id" specified more than once
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_fields.sql
[0m21:55:26.896649 [info ] [MainThread]: 
[0m21:55:26.896649 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m21:55:26.896649 [debug] [MainThread]: Command `dbt run` failed at 21:55:26.896649 after 2.38 seconds
[0m21:55:26.896649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C8991FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CA357070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB0D15B0>]}
[0m21:55:26.896649 [debug] [MainThread]: Flushing usage events
[0m21:55:27.880475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:54.073839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992E8D00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029930844760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029930844820>]}


============================== 21:55:54.093113 | 9eb540f3-4ef0-4aa1-b960-de305a65af0f ==============================
[0m21:55:54.093113 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m21:55:54.093926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s staging', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:54.235622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992D181D00>]}
[0m21:55:54.274175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992EC705B0>]}
[0m21:55:54.284138 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:55:54.423888 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m21:55:54.547530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:55:54.547530 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\stg_fields.sql
[0m21:55:54.814209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299310C49D0>]}
[0m21:55:54.885480 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:55:54.885480 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:55:54.910508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993118B970>]}
[0m21:55:54.910508 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m21:55:54.910508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299310C44F0>]}
[0m21:55:54.910508 [info ] [MainThread]: 
[0m21:55:54.910508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:54.910508 [info ] [MainThread]: 
[0m21:55:54.910508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:54.910508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:55:55.012556 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:55:55.012556 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:55:55.012556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:55.044265 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m21:55:55.044265 [debug] [ThreadPool]: On list_postgres: Close
[0m21:55:55.044265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m21:55:55.044265 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m21:55:55.044265 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:55:55.044265 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m21:55:55.044265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:55.060268 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:55:55.070618 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:55:55.071126 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m21:55:55.071126 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:55:55.073770 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:55:55.073770 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:55:55.073770 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:55:55.073770 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m21:55:55.073770 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m21:55:55.073770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m21:55:55.073770 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:55:55.073770 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m21:55:55.073770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:55.091320 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:55:55.102001 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:55:55.102288 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:55:55.103819 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m21:55:55.103819 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m21:55:55.103819 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m21:55:55.103819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m21:55:55.103819 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:55:55.103819 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:55:55.103819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:55.113922 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:55:55.129119 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:55:55.129406 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:55:55.133392 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m21:55:55.135394 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:55:55.136892 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:55:55.139739 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:55.139739 [debug] [MainThread]: On master: BEGIN
[0m21:55:55.139739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:55.173572 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m21:55:55.176278 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:55.176924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:55.176924 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m21:55:55.176924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029931242EB0>]}
[0m21:55:55.176924 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:55.176924 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:55.176924 [debug] [MainThread]: On master: BEGIN
[0m21:55:55.183817 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:55:55.185131 [debug] [MainThread]: On master: COMMIT
[0m21:55:55.185637 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:55.185961 [debug] [MainThread]: On master: COMMIT
[0m21:55:55.186653 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:55:55.187149 [debug] [MainThread]: On master: Close
[0m21:55:55.190149 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m21:55:55.191149 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m21:55:55.192149 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m21:55:55.192668 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m21:55:55.196681 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m21:55:55.196681 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m21:55:55.228439 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m21:55:55.228439 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:55.228439 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m21:55:55.228439 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:55:55.253508 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:55:55.257502 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:55.257502 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT
   activity_id
  ,type
  ,assigned_to_user
  ,deal_id
  ,done
  ,due_to
FROM "postgres"."public"."activity"
  );
[0m21:55:55.259514 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:55:55.265264 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:55.265911 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m21:55:55.267495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:55.273909 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:55:55.273909 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:55.273909 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:55:55.283986 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:55:55.283986 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m21:55:55.283986 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:55:55.283986 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m21:55:55.294330 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:55:55.294330 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m21:55:55.294330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993152EE50>]}
[0m21:55:55.294330 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:55:55.294330 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m21:55:55.294330 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m21:55:55.294330 [info ] [Thread-1  ]: 2 of 6 START sql view model public_staging.stg_activity_types .................. [RUN]
[0m21:55:55.294330 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m21:55:55.294330 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m21:55:55.294330 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m21:55:55.294330 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m21:55:55.294330 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m21:55:55.294330 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:55.294330 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m21:55:55.310395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:55.334300 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m21:55:55.337640 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:55.338147 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_staging"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
[0m21:55:55.340648 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:55:55.345132 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:55.345708 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m21:55:55.347647 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:55:55.348207 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:55:55.348207 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:55.348207 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:55:55.348207 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:55:55.348207 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m21:55:55.348207 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:55:55.348207 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m21:55:55.348207 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:55:55.360735 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m21:55:55.360735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992EC8EE80>]}
[0m21:55:55.360735 [info ] [Thread-1  ]: 2 of 6 OK created sql view model public_staging.stg_activity_types ............. [[32mCREATE VIEW[0m in 0.07s]
[0m21:55:55.363649 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m21:55:55.364155 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:55:55.364155 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m21:55:55.364155 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m21:55:55.364155 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:55:55.364155 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:55.364155 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:55:55.372192 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:55.373477 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:55.374110 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m21:55:55.374110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:55.407754 [debug] [Thread-1  ]: SQL status: BEGIN in 0.033 seconds
[0m21:55:55.408310 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:55.408710 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"
  );
[0m21:55:55.415625 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:55:55.418396 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:55.418903 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:55:55.419912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:55.419912 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:55:55.419912 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:55.419912 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:55:55.419912 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m21:55:55.427147 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m21:55:55.427147 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:55:55.427147 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:55:55.427147 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:55.427147 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:55:55.433940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992EC8EE80>]}
[0m21:55:55.434816 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.06s]
[0m21:55:55.435751 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:55:55.435751 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m21:55:55.435751 [info ] [Thread-1  ]: 4 of 6 START sql view model public_staging.stg_fields .......................... [RUN]
[0m21:55:55.435751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m21:55:55.435751 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m21:55:55.435751 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m21:55:55.435751 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m21:55:55.445874 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m21:55:55.445874 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:55:55.445874 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m21:55:55.445874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:55.477203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.028 seconds
[0m21:55:55.479362 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:55:55.479862 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."public_staging"."stg_fields__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields", 
 jsonb_array_elements(field_value_options) opt
  );
[0m21:55:55.483363 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:55:55.486451 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:55:55.486451 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m21:55:55.488362 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:55.490361 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:55:55.490361 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:55:55.490361 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:55:55.495365 [debug] [Thread-1  ]: SQL status: COMMIT in 0.011 seconds
[0m21:55:55.495365 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m21:55:55.495365 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:55:55.495365 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m21:55:55.495365 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:55.495365 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m21:55:55.495365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992EC8EE80>]}
[0m21:55:55.510996 [info ] [Thread-1  ]: 4 of 6 OK created sql view model public_staging.stg_fields ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m21:55:55.511598 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m21:55:55.511598 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m21:55:55.511598 [info ] [Thread-1  ]: 5 of 6 START sql view model public_staging.stg_stages .......................... [RUN]
[0m21:55:55.511598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m21:55:55.511598 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m21:55:55.511598 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m21:55:55.511598 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m21:55:55.519692 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m21:55:55.522905 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:55.522905 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m21:55:55.522905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:55.528618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m21:55:55.543990 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:55.544869 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_staging"."stg_stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m21:55:55.547865 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:55:55.550364 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:55.550865 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m21:55:55.552864 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:55:55.554364 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:55:55.554364 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:55.554865 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:55:55.561215 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m21:55:55.561930 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m21:55:55.561930 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:55:55.561930 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m21:55:55.561930 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:55.561930 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m21:55:55.561930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993161E100>]}
[0m21:55:55.561930 [info ] [Thread-1  ]: 5 of 6 OK created sql view model public_staging.stg_stages ..................... [[32mCREATE VIEW[0m in 0.05s]
[0m21:55:55.569964 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m21:55:55.569964 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m21:55:55.569964 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m21:55:55.569964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m21:55:55.569964 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m21:55:55.569964 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m21:55:55.577122 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m21:55:55.578416 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m21:55:55.578416 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:55.578416 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m21:55:55.578416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:55.607638 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m21:55:55.608967 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:55.609471 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m21:55:55.609471 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:55:55.612873 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:55.612873 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:55:55.612873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:55:55.612873 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:55:55.612873 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:55.612873 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:55:55.629351 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m21:55:55.629351 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m21:55:55.629351 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:55:55.629351 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m21:55:55.629351 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:55.629351 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m21:55:55.629351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb540f3-4ef0-4aa1-b960-de305a65af0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993118F460>]}
[0m21:55:55.629351 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m21:55:55.629351 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m21:55:55.629351 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:55.629351 [debug] [MainThread]: On master: BEGIN
[0m21:55:55.629351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:55.655181 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m21:55:55.660431 [debug] [MainThread]: On master: COMMIT
[0m21:55:55.660868 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:55.661369 [debug] [MainThread]: On master: COMMIT
[0m21:55:55.663369 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:55:55.663870 [debug] [MainThread]: On master: Close
[0m21:55:55.664372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:55.664867 [debug] [MainThread]: Connection 'create_postgres_public_staging' was properly closed.
[0m21:55:55.665385 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m21:55:55.665385 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m21:55:55.665886 [info ] [MainThread]: 
[0m21:55:55.666867 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m21:55:55.668384 [debug] [MainThread]: Command end result
[0m21:55:55.686005 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:55:55.688628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:55:55.695600 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m21:55:55.695600 [info ] [MainThread]: 
[0m21:55:55.695600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:55.695600 [info ] [MainThread]: 
[0m21:55:55.695600 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:55:55.695600 [debug] [MainThread]: Command `dbt run` succeeded at 21:55:55.695600 after 1.65 seconds
[0m21:55:55.695600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992E8D00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992EC830A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992E4B7A30>]}
[0m21:55:55.695600 [debug] [MainThread]: Flushing usage events
[0m21:55:56.361346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:46.695272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42E601FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4305749A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4305748E0>]}


============================== 21:56:46.704080 | a2a293c1-b252-4a87-a639-f7c7163f76dd ==============================
[0m21:56:46.704080 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m21:56:46.704080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:56:46.844936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42CECA6D0>]}
[0m21:56:46.894447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42D92D8B0>]}
[0m21:56:46.894447 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:56:47.054131 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m21:56:47.175974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:56:47.175974 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m21:56:47.263898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F430D1E130>]}
[0m21:56:47.324040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:56:47.334606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:56:47.350692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F430D486A0>]}
[0m21:56:47.350692 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m21:56:47.350692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F430CD3640>]}
[0m21:56:47.350692 [info ] [MainThread]: 
[0m21:56:47.350692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:47.350692 [info ] [MainThread]: 
[0m21:56:47.350692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:47.363846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:56:47.425791 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:56:47.425791 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:56:47.425791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:47.462843 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m21:56:47.463889 [debug] [ThreadPool]: On list_postgres: Close
[0m21:56:47.463889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m21:56:47.471915 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:56:47.471915 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m21:56:47.471915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:47.503608 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m21:56:47.507105 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:56:47.507622 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:56:47.510619 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:56:47.511622 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m21:56:47.513259 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m21:56:47.513743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m21:56:47.517339 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:56:47.517829 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:56:47.517829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:47.544084 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m21:56:47.547838 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:56:47.548361 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:56:47.554084 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m21:56:47.554084 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:56:47.554084 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:56:47.557643 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:47.557643 [debug] [MainThread]: On master: BEGIN
[0m21:56:47.557643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:47.574715 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:56:47.587363 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:47.588367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:47.592365 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m21:56:47.594369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F430D41A30>]}
[0m21:56:47.594874 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:47.596398 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:47.596909 [debug] [MainThread]: On master: BEGIN
[0m21:56:47.597879 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:56:47.599703 [debug] [MainThread]: On master: COMMIT
[0m21:56:47.600209 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:47.600209 [debug] [MainThread]: On master: COMMIT
[0m21:56:47.601259 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:56:47.601802 [debug] [MainThread]: On master: Close
[0m21:56:47.610079 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m21:56:47.610579 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m21:56:47.611090 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m21:56:47.611090 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m21:56:47.611090 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m21:56:47.611090 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m21:56:47.644782 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m21:56:47.644782 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:56:47.644782 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m21:56:47.644782 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:56:47.665612 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m21:56:47.669927 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:56:47.670414 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT
   activity_id
  ,type
  ,assigned_to_user
  ,deal_id
  ,done
  ,due_to
FROM "postgres"."public"."activity"
  );
[0m21:56:47.672924 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:56:47.679036 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:56:47.679530 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities" rename to "stg_activities__dbt_backup"
[0m21:56:47.680443 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:47.680443 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:56:47.683911 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m21:56:47.683911 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:47.694551 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:56:47.694551 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:56:47.694551 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:56:47.704035 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:56:47.704936 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m21:56:47.704936 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:56:47.704936 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m21:56:47.714524 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:56:47.714524 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m21:56:47.714524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F431188F10>]}
[0m21:56:47.723478 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:56:47.723929 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m21:56:47.723929 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m21:56:47.723929 [info ] [Thread-1  ]: 2 of 6 START sql view model public_staging.stg_activity_types .................. [RUN]
[0m21:56:47.723929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m21:56:47.723929 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m21:56:47.723929 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.723929 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m21:56:47.759257 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.759257 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.759257 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m21:56:47.774057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:47.775358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m21:56:47.789791 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.790301 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_staging"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
[0m21:56:47.793328 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:56:47.796413 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.797052 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m21:56:47.799186 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:56:47.800455 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.800455 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m21:56:47.803196 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:56:47.803196 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:56:47.805305 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.805305 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:56:47.808129 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:56:47.808129 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m21:56:47.808129 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:56:47.808129 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m21:56:47.816880 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:56:47.816880 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m21:56:47.816880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42F9B76D0>]}
[0m21:56:47.816880 [info ] [Thread-1  ]: 2 of 6 OK created sql view model public_staging.stg_activity_types ............. [[32mCREATE VIEW[0m in 0.09s]
[0m21:56:47.816880 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m21:56:47.816880 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:56:47.816880 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m21:56:47.816880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m21:56:47.816880 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:56:47.825092 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.825092 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:56:47.825092 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.825092 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.825092 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m21:56:47.825092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:47.855305 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m21:56:47.856221 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.856716 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"
  );
[0m21:56:47.861005 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:56:47.867059 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.867059 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m21:56:47.867059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:56:47.867059 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.867059 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:56:47.874570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:47.875695 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:56:47.875695 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.875695 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:56:47.875695 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:56:47.875695 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m21:56:47.875695 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:56:47.875695 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:56:47.890777 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:56:47.890777 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:56:47.890777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F431193D00>]}
[0m21:56:47.893452 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.07s]
[0m21:56:47.894690 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:56:47.894690 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m21:56:47.894690 [info ] [Thread-1  ]: 4 of 6 START sql view model public_staging.stg_fields .......................... [RUN]
[0m21:56:47.894690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m21:56:47.894690 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m21:56:47.894690 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m21:56:47.894690 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m21:56:47.903614 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m21:56:47.905681 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:56:47.905681 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m21:56:47.905681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:47.925634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m21:56:47.926145 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:56:47.926943 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."public_staging"."stg_fields__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields", 
 jsonb_array_elements(field_value_options) opt
  );
[0m21:56:47.931938 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:56:47.935530 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:56:47.935530 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m21:56:47.937217 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:47.939816 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:56:47.940751 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m21:56:47.942363 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:56:47.942363 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:56:47.942363 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:56:47.942363 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:56:47.942363 [debug] [Thread-1  ]: SQL status: COMMIT in 0.011 seconds
[0m21:56:47.958068 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m21:56:47.958068 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:56:47.958068 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m21:56:47.966091 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:56:47.966091 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m21:56:47.966091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4310EBF40>]}
[0m21:56:47.966091 [info ] [Thread-1  ]: 4 of 6 OK created sql view model public_staging.stg_fields ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m21:56:47.966091 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m21:56:47.966091 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m21:56:47.966091 [info ] [Thread-1  ]: 5 of 6 START sql view model public_staging.stg_stages .......................... [RUN]
[0m21:56:47.966091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m21:56:47.966091 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m21:56:47.974468 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m21:56:47.974468 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m21:56:47.974468 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m21:56:47.974468 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:56:47.974468 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m21:56:47.974468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:47.999021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m21:56:47.999760 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:56:48.000259 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_staging"."stg_stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m21:56:48.002812 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:56:48.006264 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:56:48.006264 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m21:56:48.007891 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:48.010911 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:56:48.010911 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m21:56:48.010911 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:48.010911 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:56:48.010911 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:56:48.010911 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:56:48.024262 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m21:56:48.025535 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m21:56:48.025535 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:56:48.025535 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m21:56:48.025535 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:56:48.025535 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m21:56:48.034092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42D935850>]}
[0m21:56:48.034092 [info ] [Thread-1  ]: 5 of 6 OK created sql view model public_staging.stg_stages ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m21:56:48.034092 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m21:56:48.034092 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m21:56:48.034092 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m21:56:48.034092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m21:56:48.034092 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m21:56:48.034092 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m21:56:48.041174 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m21:56:48.044467 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m21:56:48.044467 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:56:48.044467 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m21:56:48.044467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:48.066630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m21:56:48.067305 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:56:48.067805 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m21:56:48.069808 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:56:48.072816 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:56:48.073305 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users" rename to "stg_users__dbt_backup"
[0m21:56:48.074822 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:48.077034 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:56:48.077034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:56:48.077034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:48.077034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:56:48.077034 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:56:48.077034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:56:48.090839 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m21:56:48.091891 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m21:56:48.094677 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:56:48.094677 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m21:56:48.094677 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:56:48.094677 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m21:56:48.094677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a293c1-b252-4a87-a639-f7c7163f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4310EBF40>]}
[0m21:56:48.094677 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m21:56:48.094677 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m21:56:48.103641 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:48.103641 [debug] [MainThread]: On master: BEGIN
[0m21:56:48.103641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:48.115602 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m21:56:48.120118 [debug] [MainThread]: On master: COMMIT
[0m21:56:48.120118 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:48.120770 [debug] [MainThread]: On master: COMMIT
[0m21:56:48.121822 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:56:48.122354 [debug] [MainThread]: On master: Close
[0m21:56:48.122998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:48.123499 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m21:56:48.124000 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m21:56:48.124501 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m21:56:48.125003 [info ] [MainThread]: 
[0m21:56:48.126005 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m21:56:48.126505 [debug] [MainThread]: Command end result
[0m21:56:48.144692 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:56:48.144692 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:56:48.154012 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m21:56:48.154012 [info ] [MainThread]: 
[0m21:56:48.154012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:48.157319 [info ] [MainThread]: 
[0m21:56:48.157319 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:56:48.159040 [debug] [MainThread]: Command `dbt run` succeeded at 21:56:48.159040 after 1.50 seconds
[0m21:56:48.159040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42E601FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4311ABAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F430D487F0>]}
[0m21:56:48.159040 [debug] [MainThread]: Flushing usage events
[0m21:56:49.190860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:12.223783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CD5B0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CF524700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CF5247C0>]}


============================== 21:57:12.223783 | 55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03 ==============================
[0m21:57:12.223783 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m21:57:12.223783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:57:12.382262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CBE61BE0>]}
[0m21:57:12.432087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CC907FD0>]}
[0m21:57:12.433268 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:57:12.601699 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m21:57:12.724587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:12.724587 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m21:57:12.984120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CFDAC9D0>]}
[0m21:57:13.054138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:57:13.054138 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:57:13.074243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CFE71850>]}
[0m21:57:13.074243 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m21:57:13.074243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CFDAC850>]}
[0m21:57:13.074243 [info ] [MainThread]: 
[0m21:57:13.074243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:57:13.074243 [info ] [MainThread]: 
[0m21:57:13.074243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:13.074243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:57:13.173667 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:57:13.173667 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:57:13.173667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:13.205965 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m21:57:13.205965 [debug] [ThreadPool]: On list_postgres: Close
[0m21:57:13.205965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m21:57:13.205965 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:57:13.221698 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m21:57:13.221698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:13.254182 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m21:57:13.254779 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:57:13.254779 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:57:13.258998 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:57:13.259998 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m21:57:13.260998 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m21:57:13.261999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m21:57:13.265077 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:57:13.265519 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:57:13.265519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:13.281768 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:57:13.282270 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:57:13.282773 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:57:13.287267 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m21:57:13.288766 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:57:13.289768 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:57:13.293350 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:13.293350 [debug] [MainThread]: On master: BEGIN
[0m21:57:13.293350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:13.322911 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m21:57:13.323426 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:13.323969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:13.328636 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m21:57:13.330626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D0EF5D00>]}
[0m21:57:13.331126 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:13.332624 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:13.333173 [debug] [MainThread]: On master: BEGIN
[0m21:57:13.334666 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:57:13.336529 [debug] [MainThread]: On master: COMMIT
[0m21:57:13.336850 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:13.337008 [debug] [MainThread]: On master: COMMIT
[0m21:57:13.337950 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:57:13.338448 [debug] [MainThread]: On master: Close
[0m21:57:13.341854 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m21:57:13.342374 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m21:57:13.343353 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m21:57:13.343875 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m21:57:13.347921 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m21:57:13.347921 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m21:57:13.374033 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m21:57:13.374033 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:13.374033 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m21:57:13.374033 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:57:13.397804 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m21:57:13.403009 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:13.403135 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT
   activity_id
  ,type
  ,assigned_to_user
  ,deal_id
  ,done
  ,due_to
FROM "postgres"."public"."activity"
  );
[0m21:57:13.406129 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:57:13.408815 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:13.408815 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities" rename to "stg_activities__dbt_backup"
[0m21:57:13.413921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:57:13.414328 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:13.414328 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m21:57:13.414328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.430581 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:57:13.430581 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:13.430581 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:57:13.430581 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m21:57:13.430581 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m21:57:13.447556 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:13.447556 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m21:57:13.447556 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m21:57:13.447556 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m21:57:13.456714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CF4C38E0>]}
[0m21:57:13.456714 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:57:13.456714 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m21:57:13.456714 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m21:57:13.456714 [info ] [Thread-1  ]: 2 of 6 START sql view model public_staging.stg_activity_types .................. [RUN]
[0m21:57:13.456714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m21:57:13.456714 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m21:57:13.456714 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.456714 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m21:57:13.456714 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.456714 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.456714 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m21:57:13.456714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:13.487336 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m21:57:13.488246 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.488246 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_staging"."stg_activity_types__dbt_tmp"
    
    
  as (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
[0m21:57:13.492277 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:57:13.497884 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.498386 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m21:57:13.498914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.498914 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.498914 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m21:57:13.504092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.505998 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:57:13.505998 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.505998 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:57:13.507557 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m21:57:13.514368 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m21:57:13.514368 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:13.514368 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m21:57:13.514368 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:57:13.522975 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m21:57:13.524549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CE966DF0>]}
[0m21:57:13.524868 [info ] [Thread-1  ]: 2 of 6 OK created sql view model public_staging.stg_activity_types ............. [[32mCREATE VIEW[0m in 0.07s]
[0m21:57:13.524868 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m21:57:13.524868 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:57:13.524868 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m21:57:13.524868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m21:57:13.524868 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:57:13.524868 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.524868 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:57:13.536098 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.536098 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.536098 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m21:57:13.536098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:13.564494 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m21:57:13.569852 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.570346 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"
  );
[0m21:57:13.572847 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:57:13.577204 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.577714 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m21:57:13.579400 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.580002 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.580002 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:57:13.584268 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.584268 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:57:13.584268 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.584268 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:57:13.590095 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m21:57:13.590095 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m21:57:13.590095 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:13.590095 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:57:13.590095 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:57:13.590095 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:57:13.590095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CE966DF0>]}
[0m21:57:13.590095 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.07s]
[0m21:57:13.590095 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:57:13.603679 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m21:57:13.603679 [info ] [Thread-1  ]: 4 of 6 START sql table model public_staging.stg_fields ......................... [RUN]
[0m21:57:13.603679 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m21:57:13.603679 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m21:57:13.606064 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m21:57:13.606064 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m21:57:13.623571 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m21:57:13.623571 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:13.623571 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m21:57:13.623571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:13.674401 [debug] [Thread-1  ]: SQL status: BEGIN in 0.046 seconds
[0m21:57:13.675571 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:13.675967 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields", 
 jsonb_array_elements(field_value_options) opt
  );
  
[0m21:57:13.686638 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.010 seconds
[0m21:57:13.689276 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:13.689276 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m21:57:13.689276 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.689276 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:13.689276 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m21:57:13.697326 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.697326 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:57:13.697326 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:13.697326 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:57:13.697326 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m21:57:13.706423 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m21:57:13.706423 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:13.706423 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m21:57:13.706423 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:57:13.706423 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m21:57:13.706423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D130ACA0>]}
[0m21:57:13.706423 [info ] [Thread-1  ]: 4 of 6 OK created sql table model public_staging.stg_fields .................... [[32mSELECT 14[0m in 0.10s]
[0m21:57:13.706423 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m21:57:13.706423 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m21:57:13.706423 [info ] [Thread-1  ]: 5 of 6 START sql view model public_staging.stg_stages .......................... [RUN]
[0m21:57:13.706423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m21:57:13.706423 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m21:57:13.722186 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m21:57:13.722186 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m21:57:13.722186 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m21:57:13.722186 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:13.722186 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m21:57:13.722186 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:13.747653 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m21:57:13.748560 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:13.748817 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_staging"."stg_stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m21:57:13.751815 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:57:13.755813 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:13.756316 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m21:57:13.758816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:57:13.758816 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:13.758816 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m21:57:13.763987 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.763987 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:57:13.763987 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:13.763987 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:57:13.773926 [debug] [Thread-1  ]: SQL status: COMMIT in 0.015 seconds
[0m21:57:13.773926 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m21:57:13.773926 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:13.773926 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m21:57:13.789753 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:57:13.789753 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m21:57:13.789753 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CFC61CA0>]}
[0m21:57:13.789753 [info ] [Thread-1  ]: 5 of 6 OK created sql view model public_staging.stg_stages ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:57:13.794039 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m21:57:13.794300 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m21:57:13.794300 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m21:57:13.794300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m21:57:13.794300 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m21:57:13.794300 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m21:57:13.794300 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m21:57:13.794300 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m21:57:13.794300 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:13.794300 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m21:57:13.794300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:13.821025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m21:57:13.821660 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:13.821839 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m21:57:13.824210 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:57:13.824210 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:13.824210 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users" rename to "stg_users__dbt_backup"
[0m21:57:13.824210 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.824210 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:13.824210 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:57:13.824210 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:13.824210 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:57:13.824210 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:13.824210 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:57:13.840731 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:57:13.840731 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m21:57:13.840731 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:13.840731 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m21:57:13.840731 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m21:57:13.840731 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m21:57:13.840731 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55875ca9-dcfc-4bb8-8df3-8cfb9a5f8e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CFC07250>]}
[0m21:57:13.840731 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m21:57:13.853667 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m21:57:13.853667 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:13.853667 [debug] [MainThread]: On master: BEGIN
[0m21:57:13.856072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:13.883842 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m21:57:13.885370 [debug] [MainThread]: On master: COMMIT
[0m21:57:13.885877 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:13.886383 [debug] [MainThread]: On master: COMMIT
[0m21:57:13.887377 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:57:13.887377 [debug] [MainThread]: On master: Close
[0m21:57:13.887877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:13.888878 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m21:57:13.889185 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m21:57:13.889379 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m21:57:13.889893 [info ] [MainThread]: 
[0m21:57:13.890878 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m21:57:13.891876 [debug] [MainThread]: Command end result
[0m21:57:13.907537 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:57:13.907537 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:57:13.916731 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m21:57:13.916731 [info ] [MainThread]: 
[0m21:57:13.916731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:13.916731 [info ] [MainThread]: 
[0m21:57:13.916731 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:57:13.924014 [debug] [MainThread]: Command `dbt run` succeeded at 21:57:13.923716 after 1.75 seconds
[0m21:57:13.924014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CD5B0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CD1FC8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199CFE71A00>]}
[0m21:57:13.924014 [debug] [MainThread]: Flushing usage events
[0m21:57:14.893289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:50.963921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B14BC1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B16B24910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B16B24850>]}


============================== 21:57:50.963921 | f09baa4e-4090-4ac8-9f38-9667fc979cc6 ==============================
[0m21:57:50.963921 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m21:57:50.963921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:57:51.100149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1347A790>]}
[0m21:57:51.147024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B165E6C70>]}
[0m21:57:51.147024 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:57:51.313724 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m21:57:51.433795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:51.433795 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m21:57:51.711265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B17463A00>]}
[0m21:57:51.783839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:57:51.794472 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:57:51.804039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1747F790>]}
[0m21:57:51.804039 [info ] [MainThread]: Found 7 models, 6 sources, 428 macros
[0m21:57:51.804039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B17463D90>]}
[0m21:57:51.804039 [info ] [MainThread]: 
[0m21:57:51.804039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:57:51.804039 [info ] [MainThread]: 
[0m21:57:51.804039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:51.804039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:57:51.904630 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:57:51.904630 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:57:51.904630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:51.944393 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m21:57:51.944393 [debug] [ThreadPool]: On list_postgres: Close
[0m21:57:51.944393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m21:57:51.944393 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m21:57:51.960029 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:57:51.960029 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m21:57:51.960029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:52.004272 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m21:57:52.005140 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:57:52.005730 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m21:57:52.005814 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:57:52.005814 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:57:52.005814 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m21:57:52.005814 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m21:57:52.005814 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m21:57:52.005814 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m21:57:52.014271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m21:57:52.014271 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:57:52.014271 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:57:52.014271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:52.024247 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:57:52.037797 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:57:52.038542 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:57:52.038542 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:57:52.038542 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:57:52.038542 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:57:52.044577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m21:57:52.044577 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:57:52.044577 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m21:57:52.044577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:52.073992 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m21:57:52.074431 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m21:57:52.074838 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:57:52.079757 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:57:52.081255 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m21:57:52.082753 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m21:57:52.084753 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:52.084753 [debug] [MainThread]: On master: BEGIN
[0m21:57:52.084753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:52.123631 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m21:57:52.124490 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:52.124931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:52.128922 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:57:52.129921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B13F62A60>]}
[0m21:57:52.130421 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:52.131504 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:52.132007 [debug] [MainThread]: On master: BEGIN
[0m21:57:52.134539 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:57:52.135042 [debug] [MainThread]: On master: COMMIT
[0m21:57:52.135416 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:52.135416 [debug] [MainThread]: On master: COMMIT
[0m21:57:52.135416 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:57:52.135416 [debug] [MainThread]: On master: Close
[0m21:57:52.139598 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m21:57:52.139598 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m21:57:52.139598 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m21:57:52.139598 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m21:57:52.144573 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m21:57:52.144573 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m21:57:52.174349 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m21:57:52.174349 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:52.174349 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m21:57:52.174349 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:57:52.198790 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m21:57:52.199329 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:52.199749 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT
   activity_id
  ,type
  ,assigned_to_user
  ,deal_id
  ,done
  ,due_to
FROM "postgres"."public"."activity"
  );
[0m21:57:52.202249 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:57:52.207968 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:52.208604 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m21:57:52.209308 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:52.220735 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:57:52.220735 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:52.220735 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m21:57:52.224015 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m21:57:52.232813 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m21:57:52.234941 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m21:57:52.234941 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m21:57:52.234941 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:57:52.234941 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m21:57:52.244049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1781C640>]}
[0m21:57:52.245126 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:57:52.245126 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m21:57:52.245126 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m21:57:52.245126 [info ] [Thread-1  ]: 2 of 6 START sql table model public_staging.stg_activity_types ................. [RUN]
[0m21:57:52.245126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m21:57:52.245126 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m21:57:52.245126 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m21:57:52.245126 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m21:57:52.271172 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m21:57:52.272961 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:52.273447 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m21:57:52.273806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:52.293748 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m21:57:52.294432 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:52.294937 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m21:57:52.298432 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m21:57:52.301930 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:52.302430 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m21:57:52.304430 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:52.305142 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:57:52.305142 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:52.305142 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m21:57:52.314231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:57:52.314231 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m21:57:52.314231 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m21:57:52.314231 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m21:57:52.320362 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:57:52.320362 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m21:57:52.324012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B169800D0>]}
[0m21:57:52.324851 [info ] [Thread-1  ]: 2 of 6 OK created sql table model public_staging.stg_activity_types ............ [[32mSELECT 4[0m in 0.08s]
[0m21:57:52.325805 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m21:57:52.326306 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:57:52.326306 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m21:57:52.326306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m21:57:52.326306 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:57:52.326306 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:52.326306 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:57:52.335416 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:52.335416 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:52.335416 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m21:57:52.335416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:52.357492 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m21:57:52.357993 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:52.358491 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"
  );
[0m21:57:52.360996 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:57:52.364491 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:52.364992 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:57:52.366992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:52.368490 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:57:52.368632 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:52.368632 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:57:52.371775 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m21:57:52.371775 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m21:57:52.371775 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:57:52.371775 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:57:52.371775 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:57:52.371775 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:57:52.371775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B169800D0>]}
[0m21:57:52.371775 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.05s]
[0m21:57:52.384211 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:57:52.384211 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m21:57:52.384211 [info ] [Thread-1  ]: 4 of 6 START sql table model public_staging.stg_fields ......................... [RUN]
[0m21:57:52.384211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m21:57:52.384211 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m21:57:52.388350 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m21:57:52.388350 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m21:57:52.394780 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m21:57:52.394780 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:52.394780 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m21:57:52.394780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:52.414704 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m21:57:52.415574 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:52.416074 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields", 
 jsonb_array_elements(field_value_options) opt
  );
  
[0m21:57:52.419072 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m21:57:52.423949 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:52.424774 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m21:57:52.426255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:52.426255 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:57:52.426255 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:52.429099 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m21:57:52.442527 [debug] [Thread-1  ]: SQL status: COMMIT in 0.013 seconds
[0m21:57:52.445256 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m21:57:52.445858 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m21:57:52.445858 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m21:57:52.445858 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:57:52.449255 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m21:57:52.450088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1721A790>]}
[0m21:57:52.450798 [info ] [Thread-1  ]: 4 of 6 OK created sql table model public_staging.stg_fields .................... [[32mSELECT 14[0m in 0.07s]
[0m21:57:52.451325 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m21:57:52.451325 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m21:57:52.451325 [info ] [Thread-1  ]: 5 of 6 START sql table model public_staging.stg_stages ......................... [RUN]
[0m21:57:52.454259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m21:57:52.454259 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m21:57:52.454259 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m21:57:52.454259 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m21:57:52.454259 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m21:57:52.462878 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:52.464075 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m21:57:52.464075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:52.484025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m21:57:52.484848 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:52.485341 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m21:57:52.488341 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.002 seconds
[0m21:57:52.491841 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:52.492341 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m21:57:52.494344 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:52.495353 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:57:52.495353 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:52.495353 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m21:57:52.504932 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m21:57:52.504932 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m21:57:52.504932 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m21:57:52.504932 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m21:57:52.504932 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:57:52.504932 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m21:57:52.513890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B17225820>]}
[0m21:57:52.514390 [info ] [Thread-1  ]: 5 of 6 OK created sql table model public_staging.stg_stages .................... [[32mSELECT 9[0m in 0.05s]
[0m21:57:52.514390 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m21:57:52.514390 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m21:57:52.514390 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m21:57:52.514390 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m21:57:52.514390 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m21:57:52.520507 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m21:57:52.520507 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m21:57:52.526816 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m21:57:52.527992 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:52.528535 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m21:57:52.529059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:52.544656 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m21:57:52.545159 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:52.545659 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m21:57:52.547652 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:57:52.550653 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:52.550653 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:57:52.551653 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:57:52.554152 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:57:52.554655 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:52.555238 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m21:57:52.564222 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m21:57:52.570441 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m21:57:52.571477 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m21:57:52.571477 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m21:57:52.574032 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:57:52.574032 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m21:57:52.574032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09baa4e-4090-4ac8-9f38-9667fc979cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B17225DF0>]}
[0m21:57:52.574032 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m21:57:52.574032 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m21:57:52.574032 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:52.574032 [debug] [MainThread]: On master: BEGIN
[0m21:57:52.574032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:52.597070 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m21:57:52.597778 [debug] [MainThread]: On master: COMMIT
[0m21:57:52.597778 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:52.598277 [debug] [MainThread]: On master: COMMIT
[0m21:57:52.599777 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:57:52.600277 [debug] [MainThread]: On master: Close
[0m21:57:52.600872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:52.601278 [debug] [MainThread]: Connection 'create_postgres_public_staging' was properly closed.
[0m21:57:52.601278 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m21:57:52.601778 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m21:57:52.602281 [info ] [MainThread]: 
[0m21:57:52.603298 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m21:57:52.605181 [debug] [MainThread]: Command end result
[0m21:57:52.624015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m21:57:52.624015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m21:57:52.635475 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m21:57:52.635975 [info ] [MainThread]: 
[0m21:57:52.636975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:52.637474 [info ] [MainThread]: 
[0m21:57:52.637977 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:57:52.639977 [debug] [MainThread]: Command `dbt run` succeeded at 21:57:52.639476 after 1.72 seconds
[0m21:57:52.640567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B14BC1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B13277640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1480C400>]}
[0m21:57:52.640978 [debug] [MainThread]: Flushing usage events
[0m21:57:53.487496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:08.083624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7C790070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7E704700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7E7047C0>]}


============================== 23:02:08.083624 | 6d0c4337-125b-4ff1-a149-dc140bb1f76a ==============================
[0m23:02:08.083624 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:02:08.083624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:02:08.231240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d0c4337-125b-4ff1-a149-dc140bb1f76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7B031BE0>]}
[0m23:02:08.293812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d0c4337-125b-4ff1-a149-dc140bb1f76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7BAD7FD0>]}
[0m23:02:08.293812 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:02:08.477872 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:02:08.633191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m23:02:08.633191 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m23:02:08.633191 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_activities.sql
[0m23:02:08.633191 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\stg_fields.sql
[0m23:02:08.810882 [error] [MainThread]: Encountered an error:
Compilation Error in model t_activities (models\transformations\crm\t_activities.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m23:02:08.810882 [debug] [MainThread]: Command `dbt run` failed at 23:02:08.810882 after 0.77 seconds
[0m23:02:08.810882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7C790070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7ED25910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C7EF488E0>]}
[0m23:02:08.810882 [debug] [MainThread]: Flushing usage events
[0m23:02:09.615716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:49.986307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B44B51040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B46AC4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B46AC47C0>]}


============================== 23:02:49.986307 | fe69e236-306e-4b84-aa9b-ca4ba898d5a0 ==============================
[0m23:02:49.986307 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:02:49.986307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:02:50.164561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B4340A790>]}
[0m23:02:50.241531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B46576C70>]}
[0m23:02:50.241531 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:02:50.403362 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:02:50.543907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m23:02:50.543907 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m23:02:50.543907 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_activities.sql
[0m23:02:50.543907 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\stg_fields.sql
[0m23:02:50.828447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B47319EE0>]}
[0m23:02:50.889463 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:02:50.903471 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:02:50.903471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B47403AF0>]}
[0m23:02:50.919487 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m23:02:50.919487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B473194C0>]}
[0m23:02:50.919487 [info ] [MainThread]: 
[0m23:02:50.923507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:50.923507 [info ] [MainThread]: 
[0m23:02:50.923507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:02:50.923507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:02:51.033845 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:02:51.033845 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:02:51.033845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:51.072382 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m23:02:51.072382 [debug] [ThreadPool]: On list_postgres: Close
[0m23:02:51.072382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m23:02:51.072382 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m23:02:51.083413 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m23:02:51.083413 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m23:02:51.083413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:51.102855 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:02:51.106009 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m23:02:51.106213 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m23:02:51.108707 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m23:02:51.109738 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m23:02:51.110242 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m23:02:51.110242 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m23:02:51.114148 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m23:02:51.114701 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m23:02:51.116749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m23:02:51.116749 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:02:51.116749 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:02:51.116749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:51.144112 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m23:02:51.155757 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:02:51.156008 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:02:51.160498 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m23:02:51.161496 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:02:51.162398 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:02:51.163520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m23:02:51.166106 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:02:51.166106 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:02:51.166106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:51.184300 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m23:02:51.198735 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:02:51.199248 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:02:51.206237 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:02:51.207831 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:02:51.209248 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:02:51.212491 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:51.212491 [debug] [MainThread]: On master: BEGIN
[0m23:02:51.212491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:51.238802 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m23:02:51.239212 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:51.239521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:02:51.240019 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:02:51.240019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B46B65F10>]}
[0m23:02:51.240019 [debug] [MainThread]: On master: ROLLBACK
[0m23:02:51.240019 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:51.240019 [debug] [MainThread]: On master: BEGIN
[0m23:02:51.240019 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:02:51.255148 [debug] [MainThread]: On master: COMMIT
[0m23:02:51.255451 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:51.256052 [debug] [MainThread]: On master: COMMIT
[0m23:02:51.257512 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:02:51.258043 [debug] [MainThread]: On master: Close
[0m23:02:51.260844 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m23:02:51.261975 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m23:02:51.263062 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m23:02:51.263115 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m23:02:51.266411 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m23:02:51.266411 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m23:02:51.303458 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m23:02:51.303458 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m23:02:51.303458 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m23:02:51.303458 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:02:51.341154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.035 seconds
[0m23:02:51.342135 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m23:02:51.342650 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT
   activity_id
  ,type
  ,assigned_to_user
  ,deal_id
  ,done
  ,due_to
FROM "postgres"."public"."activity"
  );
[0m23:02:51.347247 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:02:51.351984 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m23:02:51.351984 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m23:02:51.351984 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:02:51.361973 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m23:02:51.361973 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m23:02:51.361973 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m23:02:51.372091 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m23:02:51.378344 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m23:02:51.378344 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m23:02:51.383264 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m23:02:51.383264 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:02:51.383264 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m23:02:51.388133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B477AFFD0>]}
[0m23:02:51.388133 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:02:51.388133 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m23:02:51.388133 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m23:02:51.388133 [info ] [Thread-1  ]: 2 of 6 START sql table model public_staging.stg_activity_types ................. [RUN]
[0m23:02:51.388133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m23:02:51.388133 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m23:02:51.388133 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m23:02:51.388133 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m23:02:51.413663 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m23:02:51.421939 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:02:51.421939 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m23:02:51.421939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:02:51.446869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.034 seconds
[0m23:02:51.458040 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:02:51.458899 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m23:02:51.462108 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m23:02:51.465255 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:02:51.465763 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m23:02:51.467658 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:02:51.469750 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m23:02:51.469750 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:02:51.469750 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m23:02:51.469750 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:02:51.478922 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m23:02:51.478922 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:02:51.478922 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m23:02:51.478922 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m23:02:51.478922 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m23:02:51.478922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B46A4A3A0>]}
[0m23:02:51.478922 [info ] [Thread-1  ]: 2 of 6 OK created sql table model public_staging.stg_activity_types ............ [[32mSELECT 4[0m in 0.09s]
[0m23:02:51.487040 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m23:02:51.487040 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:02:51.487040 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m23:02:51.487040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m23:02:51.487040 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:02:51.487040 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:02:51.487040 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:02:51.495158 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:02:51.495158 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:02:51.495158 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m23:02:51.495158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:02:51.522442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m23:02:51.528714 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:02:51.529228 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"
  );
[0m23:02:51.533358 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:02:51.536447 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:02:51.536447 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:02:51.538902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:02:51.539967 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:02:51.540464 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:02:51.540464 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:02:51.545129 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:02:51.546518 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m23:02:51.546518 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:02:51.546518 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m23:02:51.546518 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:02:51.546518 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:02:51.553671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B46A4A3A0>]}
[0m23:02:51.553671 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.06s]
[0m23:02:51.553671 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:02:51.553671 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m23:02:51.553671 [info ] [Thread-1  ]: 4 of 6 START sql table model public_staging.stg_fields ......................... [RUN]
[0m23:02:51.553671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m23:02:51.553671 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m23:02:51.553671 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m23:02:51.562205 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m23:02:51.565993 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m23:02:51.565993 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:02:51.565993 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m23:02:51.565993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:02:51.579911 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m23:02:51.590475 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:02:51.591774 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m23:02:51.598185 [debug] [Thread-1  ]: SQL status: SELECT 16 in 0.005 seconds
[0m23:02:51.600127 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:02:51.600127 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m23:02:51.600127 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:02:51.600127 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m23:02:51.600127 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:02:51.605727 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m23:02:51.605959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:02:51.611900 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m23:02:51.613590 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:02:51.613590 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m23:02:51.613590 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m23:02:51.613590 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m23:02:51.613590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B46A4A3A0>]}
[0m23:02:51.613590 [info ] [Thread-1  ]: 4 of 6 OK created sql table model public_staging.stg_fields .................... [[32mSELECT 16[0m in 0.06s]
[0m23:02:51.613590 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m23:02:51.613590 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m23:02:51.613590 [info ] [Thread-1  ]: 5 of 6 START sql table model public_staging.stg_stages ......................... [RUN]
[0m23:02:51.613590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m23:02:51.613590 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m23:02:51.613590 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m23:02:51.613590 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m23:02:51.629047 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m23:02:51.629047 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:02:51.631920 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m23:02:51.631920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:02:51.652643 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m23:02:51.653320 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:02:51.653871 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m23:02:51.657434 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m23:02:51.660405 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:02:51.660823 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m23:02:51.663053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:02:51.663403 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m23:02:51.663403 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:02:51.663403 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m23:02:51.663403 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:02:51.663403 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m23:02:51.663403 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:02:51.663403 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m23:02:51.663403 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m23:02:51.663403 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m23:02:51.678542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B478D6460>]}
[0m23:02:51.679857 [info ] [Thread-1  ]: 5 of 6 OK created sql table model public_staging.stg_stages .................... [[32mSELECT 9[0m in 0.06s]
[0m23:02:51.680619 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m23:02:51.682235 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m23:02:51.682235 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m23:02:51.683462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m23:02:51.683462 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m23:02:51.683462 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m23:02:51.683462 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m23:02:51.683462 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m23:02:51.683462 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:02:51.683462 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m23:02:51.683462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:02:51.723333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m23:02:51.724062 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:02:51.724562 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m23:02:51.727069 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:02:51.732090 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:02:51.732568 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m23:02:51.735065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:02:51.735065 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m23:02:51.735065 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:02:51.735065 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m23:02:51.735065 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:02:51.745071 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m23:02:51.745071 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:02:51.745071 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m23:02:51.745071 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:02:51.745071 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m23:02:51.745071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe69e236-306e-4b84-aa9b-ca4ba898d5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B478D6460>]}
[0m23:02:51.745071 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m23:02:51.745071 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m23:02:51.753120 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:51.753613 [debug] [MainThread]: On master: BEGIN
[0m23:02:51.753613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:02:51.783246 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m23:02:51.786091 [debug] [MainThread]: On master: COMMIT
[0m23:02:51.786431 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:51.786931 [debug] [MainThread]: On master: COMMIT
[0m23:02:51.788431 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:02:51.788929 [debug] [MainThread]: On master: Close
[0m23:02:51.789430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:51.789929 [debug] [MainThread]: Connection 'create_postgres_public_staging' was properly closed.
[0m23:02:51.790431 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m23:02:51.790431 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m23:02:51.791428 [info ] [MainThread]: 
[0m23:02:51.791926 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m23:02:51.794023 [debug] [MainThread]: Command end result
[0m23:02:51.812940 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:02:51.815071 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:02:51.815071 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:02:51.823131 [info ] [MainThread]: 
[0m23:02:51.823939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:02:51.823939 [info ] [MainThread]: 
[0m23:02:51.823939 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:02:51.823939 [debug] [MainThread]: Command `dbt run` succeeded at 23:02:51.823939 after 1.88 seconds
[0m23:02:51.823939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B44B51040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B44ED2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B44799400>]}
[0m23:02:51.823939 [debug] [MainThread]: Flushing usage events
[0m23:02:52.514679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:04.791196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A7232070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A91A1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A91A1910>]}


============================== 19:22:04.798167 | 750a69ab-f538-4675-92eb-8ce2b9c3a35e ==============================
[0m19:22:04.798167 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:22:04.800076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:22:05.108870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '750a69ab-f538-4675-92eb-8ce2b9c3a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A5AE1BE0>]}
[0m19:22:05.161159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '750a69ab-f538-4675-92eb-8ce2b9c3a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A8C69BB0>]}
[0m19:22:05.164156 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:22:05.387165 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:22:05.596699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:05.596699 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m19:22:05.769330 [error] [MainThread]: Encountered an error:
Compilation Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m19:22:05.771834 [debug] [MainThread]: Command `dbt docs generate` failed at 19:22:05.771689 after 1.03 seconds
[0m19:22:05.772392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A7232070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A97C6FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A98BC3D0>]}
[0m19:22:05.772938 [debug] [MainThread]: Flushing usage events
[0m19:22:06.268880 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:04.701973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE0CA5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE2C217C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE2C21880>]}


============================== 19:28:04.707345 | 6eb33ae1-b89e-4c49-879e-d0fb8e5780f8 ==============================
[0m19:28:04.707345 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:28:04.709339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:28:05.078512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eb33ae1-b89e-4c49-879e-d0fb8e5780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACDF56A9D0>]}
[0m19:28:05.200027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eb33ae1-b89e-4c49-879e-d0fb8e5780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE2BED5B0>]}
[0m19:28:05.202278 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:28:05.635221 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:28:06.008895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:06.009887 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m19:28:06.660415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eb33ae1-b89e-4c49-879e-d0fb8e5780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE346E130>]}
[0m19:28:06.722781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eb33ae1-b89e-4c49-879e-d0fb8e5780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE34E7E80>]}
[0m19:28:06.724899 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m19:28:06.726410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb33ae1-b89e-4c49-879e-d0fb8e5780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE34E7E50>]}
[0m19:28:06.730220 [info ] [MainThread]: 
[0m19:28:06.732052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:06.733869 [info ] [MainThread]: 
[0m19:28:06.736100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:06.749848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:28:07.030763 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:07.031665 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:28:07.032686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:07.217682 [debug] [ThreadPool]: SQL status: BEGIN in 0.186 seconds
[0m19:28:07.219449 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:07.219449 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:07.318645 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.097 seconds
[0m19:28:07.322171 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:28:07.347187 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:28:07.349400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m19:28:07.357580 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:07.358090 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:28:07.359114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:07.497742 [debug] [ThreadPool]: SQL status: BEGIN in 0.138 seconds
[0m19:28:07.498491 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:07.499499 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:28:07.538498 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.038 seconds
[0m19:28:07.540485 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:28:07.547988 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:28:07.560423 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:07.561645 [debug] [MainThread]: On master: BEGIN
[0m19:28:07.562645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:07.687757 [debug] [MainThread]: SQL status: BEGIN in 0.125 seconds
[0m19:28:07.688762 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:07.689261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:07.797614 [debug] [MainThread]: SQL status: SELECT 3 in 0.108 seconds
[0m19:28:07.801729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb33ae1-b89e-4c49-879e-d0fb8e5780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE350A130>]}
[0m19:28:07.801729 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:07.817331 [debug] [MainThread]: On master: Close
[0m19:28:07.822619 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m19:28:07.824135 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m19:28:07.824135 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m19:28:07.841288 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m19:28:07.843512 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m19:28:07.845820 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m19:28:07.846817 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m19:28:07.847817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m19:28:07.848828 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m19:28:07.854799 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m19:28:07.856799 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m19:28:07.858798 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m19:28:07.859798 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m19:28:07.861120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m19:28:07.862221 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m19:28:07.867379 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m19:28:07.870470 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m19:28:07.872148 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m19:28:07.873171 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m19:28:07.874171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m19:28:07.875172 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m19:28:07.883721 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m19:28:07.885552 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m19:28:07.888660 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m19:28:07.889774 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m19:28:07.890832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m19:28:07.892002 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m19:28:07.899681 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m19:28:07.902667 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m19:28:07.904947 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m19:28:07.906067 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m19:28:07.907226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m19:28:07.908226 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m19:28:07.915197 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m19:28:07.917699 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m19:28:07.919593 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m19:28:07.920592 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m19:28:07.922758 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.test_model)
[0m19:28:07.924256 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m19:28:07.931566 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m19:28:07.937062 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m19:28:07.938859 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m19:28:07.940039 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m19:28:07.942426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.t_activities)
[0m19:28:07.943117 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m19:28:07.950992 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m19:28:07.958043 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m19:28:07.960748 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m19:28:07.963192 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_changes
[0m19:28:07.964487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_changes)
[0m19:28:07.965505 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_changes
[0m19:28:07.977284 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_changes"
[0m19:28:07.979779 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_changes
[0m19:28:07.982427 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_changes
[0m19:28:07.985750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:07.986750 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m19:28:07.987301 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_deal_changes' was properly closed.
[0m19:28:07.992825 [debug] [MainThread]: Command end result
[0m19:28:08.277437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:08.287981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:08.302217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:28:08.307217 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:28:08.307217 [info ] [MainThread]: Building catalog
[0m19:28:08.324577 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m19:28:08.342405 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m19:28:08.343432 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m19:28:08.343432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:08.438231 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m19:28:08.439262 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m19:28:08.440265 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fields')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('deal_changes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('t_deal_changes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('t_activities')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stages')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_fields')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_deal_changes')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_activity_types')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('activity')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('test_model')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_activities')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('activity_types')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('users')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_stages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:28:08.518029 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.077 seconds
[0m19:28:08.531397 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m19:28:08.538081 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m19:28:08.566370 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\catalog.json
[0m19:28:08.616099 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:08.620328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:08.621451 [info ] [MainThread]: Catalog written to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\catalog.json
[0m19:28:08.624621 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:28:08.624621 after 4.03 seconds
[0m19:28:08.625535 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:28:08.626034 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m19:28:08.627196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE0CA5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE0B78EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACE2BED460>]}
[0m19:28:08.627695 [debug] [MainThread]: Flushing usage events
[0m19:28:09.117071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:18.944989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD9B20040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDBA916A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDBA91760>]}


============================== 19:28:18.950513 | 61c5c546-3fff-455d-b16f-46d32eb44365 ==============================
[0m19:28:18.950513 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:28:18.952235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m19:28:19.363188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61c5c546-3fff-455d-b16f-46d32eb44365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDBA4FBE0>]}
[0m19:28:19.550675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61c5c546-3fff-455d-b16f-46d32eb44365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD8E29640>]}
[0m19:41:00.352486 [error] [MainThread]: Encountered an error:

[0m19:41:00.358935 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m19:41:00.370878 [debug] [MainThread]: Command `dbt docs serve` failed at 19:41:00.369878 after 761.54 seconds
[0m19:41:00.371760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD9B20040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDBE12BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDBE12B80>]}
[0m19:41:00.372429 [debug] [MainThread]: Flushing usage events
[0m19:41:00.924413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:43:28.948463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F69D2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F89378E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F8937820>]}


============================== 20:43:28.948463 | 1387257b-d5dd-4c92-8d64-af15a9bb9e4e ==============================
[0m20:43:28.948463 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:43:28.948463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:29.181134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F891A070>]}
[0m20:43:29.231714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F5D4BB50>]}
[0m20:43:29.231714 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:43:29.431500 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:43:29.611635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:43:29.611635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:43:29.659960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F904A130>]}
[0m20:43:29.738635 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:43:29.738635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:43:29.780945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F8CC5AC0>]}
[0m20:43:29.780945 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m20:43:29.780945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F5D4B8B0>]}
[0m20:43:29.780945 [info ] [MainThread]: 
[0m20:43:29.780945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:29.780945 [info ] [MainThread]: 
[0m20:43:29.780945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:43:29.801277 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:43:29.989013 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:43:29.989013 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:43:29.990014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:30.021654 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m20:43:30.023736 [debug] [ThreadPool]: On list_postgres: Close
[0m20:43:30.024652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m20:43:30.025655 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m20:43:30.030855 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:43:30.031353 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m20:43:30.031353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:30.031353 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m20:43:30.047612 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:43:30.048114 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m20:43:30.051111 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m20:43:30.052128 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:43:30.052629 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:43:30.053131 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:43:30.055129 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m20:43:30.055629 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m20:43:30.061167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:43:30.061167 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:43:30.061167 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:43:30.061167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:30.087140 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m20:43:30.101359 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:43:30.101632 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:43:30.110275 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m20:43:30.111790 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:43:30.112352 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:43:30.114005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m20:43:30.114005 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:43:30.114005 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:43:30.114005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:30.141169 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m20:43:30.143880 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:43:30.144430 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:43:30.148007 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m20:43:30.149048 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:43:30.150548 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:43:30.155054 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.155054 [debug] [MainThread]: On master: BEGIN
[0m20:43:30.155054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:30.161630 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m20:43:30.172935 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.173556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:43:30.181150 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m20:43:30.182145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F904F400>]}
[0m20:43:30.183143 [debug] [MainThread]: On master: ROLLBACK
[0m20:43:30.184625 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.184625 [debug] [MainThread]: On master: BEGIN
[0m20:43:30.186351 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:43:30.186745 [debug] [MainThread]: On master: COMMIT
[0m20:43:30.187143 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.187143 [debug] [MainThread]: On master: COMMIT
[0m20:43:30.188643 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:43:30.188643 [debug] [MainThread]: On master: Close
[0m20:43:30.197574 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activities
[0m20:43:30.197574 [info ] [Thread-1  ]: 1 of 6 START sql view model public_staging.stg_activities ...................... [RUN]
[0m20:43:30.197574 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_activities'
[0m20:43:30.197574 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activities
[0m20:43:30.201212 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activities"
[0m20:43:30.201212 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activities
[0m20:43:30.231944 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activities"
[0m20:43:30.231944 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:43:30.231944 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: BEGIN
[0m20:43:30.231944 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:43:30.262684 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m20:43:30.263305 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:43:30.263801 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */

  create view "postgres"."public_staging"."stg_activities__dbt_tmp"
    
    
  as (
    SELECT
   activity_id
  ,type
  ,assigned_to_user
  ,deal_id
  ,done
  ,due_to
FROM "postgres"."public"."activity"
  );
[0m20:43:30.272359 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:43:30.277379 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:43:30.278379 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
alter table "postgres"."public_staging"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m20:43:30.279790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:43:30.291565 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m20:43:30.291565 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:43:30.291565 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: COMMIT
[0m20:43:30.297536 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:43:30.298134 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activities__dbt_backup"
[0m20:43:30.298134 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activities"
[0m20:43:30.298134 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activities"} */
drop view if exists "postgres"."public_staging"."stg_activities__dbt_backup" cascade
[0m20:43:30.298134 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:43:30.311651 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activities: Close
[0m20:43:30.314609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F9110B20>]}
[0m20:43:30.314609 [info ] [Thread-1  ]: 1 of 6 OK created sql view model public_staging.stg_activities ................. [[32mCREATE VIEW[0m in 0.11s]
[0m20:43:30.314609 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activities
[0m20:43:30.314609 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:43:30.314609 [info ] [Thread-1  ]: 2 of 6 START sql table model public_staging.stg_activity_types ................. [RUN]
[0m20:43:30.314609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activities, now model.enpal_assessment_project.stg_activity_types)
[0m20:43:30.314609 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:43:30.314609 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:43:30.321943 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:43:30.340734 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:43:30.348360 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:43:30.349358 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:43:30.349358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:30.367909 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:43:30.369106 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:43:30.370117 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m20:43:30.374615 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m20:43:30.379115 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:43:30.379615 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:43:30.382170 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:43:30.382170 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:43:30.382170 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:43:30.382170 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:43:30.382170 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:43:30.382170 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m20:43:30.382170 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:43:30.382170 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m20:43:30.397742 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:43:30.400979 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:43:30.401942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F7D6C8E0>]}
[0m20:43:30.402442 [info ] [Thread-1  ]: 2 of 6 OK created sql table model public_staging.stg_activity_types ............ [[32mSELECT 4[0m in 0.09s]
[0m20:43:30.402442 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:43:30.402442 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:43:30.402442 [info ] [Thread-1  ]: 3 of 6 START sql view model public_staging.stg_deal_changes .................... [RUN]
[0m20:43:30.402442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:43:30.402442 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:43:30.402442 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:43:30.402442 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:43:30.410898 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:43:30.416620 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:43:30.417738 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:43:30.417738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:30.437332 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:43:30.438306 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:43:30.438804 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"
  );
[0m20:43:30.441531 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:43:30.465883 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:43:30.480809 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m20:43:30.482814 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:43:30.484115 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:43:30.484115 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:43:30.484115 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:43:30.500881 [debug] [Thread-1  ]: SQL status: COMMIT in 0.016 seconds
[0m20:43:30.503880 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m20:43:30.503880 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:43:30.504881 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m20:43:30.505879 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:43:30.506881 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:43:30.507880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F7D6C8E0>]}
[0m20:43:30.508879 [info ] [Thread-1  ]: 3 of 6 OK created sql view model public_staging.stg_deal_changes ............... [[32mCREATE VIEW[0m in 0.11s]
[0m20:43:30.509892 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:43:30.509892 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m20:43:30.510878 [info ] [Thread-1  ]: 4 of 6 START sql table model public_staging.stg_fields ......................... [RUN]
[0m20:43:30.511880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m20:43:30.511880 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m20:43:30.515050 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m20:43:30.517078 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m20:43:30.521076 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m20:43:30.522078 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:43:30.522078 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m20:43:30.523079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:30.549997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m20:43:30.551006 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:43:30.551601 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m20:43:30.558086 [debug] [Thread-1  ]: SQL status: SELECT 16 in 0.006 seconds
[0m20:43:30.562361 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:43:30.562861 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m20:43:30.565221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:43:30.567398 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:43:30.567398 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:43:30.568367 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:43:30.581259 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m20:43:30.582184 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m20:43:30.582184 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:43:30.582184 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m20:43:30.582184 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:43:30.582184 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m20:43:30.582184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F5D33DC0>]}
[0m20:43:30.582184 [info ] [Thread-1  ]: 4 of 6 OK created sql table model public_staging.stg_fields .................... [[32mSELECT 16[0m in 0.07s]
[0m20:43:30.582184 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m20:43:30.582184 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:43:30.591229 [info ] [Thread-1  ]: 5 of 6 START sql table model public_staging.stg_stages ......................... [RUN]
[0m20:43:30.591229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m20:43:30.591229 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:43:30.591229 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:43:30.591229 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:43:30.604250 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:43:30.606090 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:43:30.607413 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:43:30.607572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:30.618628 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:43:30.627726 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:43:30.628725 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:43:30.631722 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.002 seconds
[0m20:43:30.635773 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:43:30.636276 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m20:43:30.637790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:43:30.639428 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:43:30.639963 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:43:30.639963 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:43:30.643070 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:43:30.649288 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m20:43:30.649288 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:43:30.649288 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m20:43:30.651281 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:43:30.653272 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:43:30.653272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F95C3790>]}
[0m20:43:30.654273 [info ] [Thread-1  ]: 5 of 6 OK created sql table model public_staging.stg_stages .................... [[32mSELECT 9[0m in 0.06s]
[0m20:43:30.655272 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:43:30.656273 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m20:43:30.656273 [info ] [Thread-1  ]: 6 of 6 START sql view model public_staging.stg_users ........................... [RUN]
[0m20:43:30.657272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m20:43:30.658474 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m20:43:30.661048 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m20:43:30.662629 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m20:43:30.667345 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m20:43:30.668397 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:43:30.669512 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m20:43:30.669512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:30.687560 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m20:43:30.688799 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:43:30.689264 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_staging"."stg_users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m20:43:30.692300 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:43:30.695319 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:43:30.695818 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:43:30.697798 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:43:30.699299 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m20:43:30.699797 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:43:30.699797 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m20:43:30.702396 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:43:30.702396 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_users__dbt_backup"
[0m20:43:30.702396 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m20:43:30.702396 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_staging"."stg_users__dbt_backup" cascade
[0m20:43:30.702396 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:43:30.702396 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m20:43:30.702396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1387257b-d5dd-4c92-8d64-af15a9bb9e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F5DC8D30>]}
[0m20:43:30.702396 [info ] [Thread-1  ]: 6 of 6 OK created sql view model public_staging.stg_users ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m20:43:30.714367 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m20:43:30.715988 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.715988 [debug] [MainThread]: On master: BEGIN
[0m20:43:30.715988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:43:30.733692 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m20:43:30.734393 [debug] [MainThread]: On master: COMMIT
[0m20:43:30.734911 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.735460 [debug] [MainThread]: On master: COMMIT
[0m20:43:30.736634 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:43:30.737027 [debug] [MainThread]: On master: Close
[0m20:43:30.738092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:30.738092 [debug] [MainThread]: Connection 'create_postgres_public_staging' was properly closed.
[0m20:43:30.738635 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m20:43:30.739253 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m20:43:30.739253 [info ] [MainThread]: 
[0m20:43:30.740535 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m20:43:30.742055 [debug] [MainThread]: Command end result
[0m20:43:30.765615 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:43:30.767729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:43:30.774546 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:43:30.774546 [info ] [MainThread]: 
[0m20:43:30.774546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:30.774546 [info ] [MainThread]: 
[0m20:43:30.774546 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:43:30.774546 [debug] [MainThread]: Command `dbt run` succeeded at 20:43:30.774546 after 1.88 seconds
[0m20:43:30.774546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F69D2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F8CC5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F5D77AC0>]}
[0m20:43:30.774546 [debug] [MainThread]: Flushing usage events
[0m20:43:31.429358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:25.384246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D330040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12F2948E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12F294820>]}


============================== 20:52:25.384246 | 02d4e88e-2137-43fc-a098-a80cf13fcd48 ==============================
[0m20:52:25.384246 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:52:25.384246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s crm', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:25.533773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02d4e88e-2137-43fc-a098-a80cf13fcd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12C644850>]}
[0m20:52:25.581583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02d4e88e-2137-43fc-a098-a80cf13fcd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12C6D7250>]}
[0m20:52:25.581583 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:52:25.757416 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:52:25.851251 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:52:25.851251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02d4e88e-2137-43fc-a098-a80cf13fcd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12ED254C0>]}
[0m20:52:26.831477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02d4e88e-2137-43fc-a098-a80cf13fcd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12FC10130>]}
[0m20:52:26.917670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:52:26.917670 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:52:26.933418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02d4e88e-2137-43fc-a098-a80cf13fcd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12FC3C040>]}
[0m20:52:26.933418 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m20:52:26.933418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02d4e88e-2137-43fc-a098-a80cf13fcd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12FC356D0>]}
[0m20:52:26.933418 [warn ] [MainThread]: The selection criterion 'crm' does not match any enabled nodes
[0m20:52:26.933418 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:52:26.933418 [debug] [MainThread]: Command end result
[0m20:52:26.957873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:52:26.957873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:52:26.957873 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:52:26.957873 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:26.957873 after 1.63 seconds
[0m20:52:26.957873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D330040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12C6D7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12FAD5730>]}
[0m20:52:26.957873 [debug] [MainThread]: Flushing usage events
[0m20:52:27.478432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:23.081993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D878181070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87A0E48E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87A0E4820>]}


============================== 20:53:23.081993 | b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff ==============================
[0m20:53:23.081993 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:53:23.097771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s transformations', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:53:23.246052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87749EC40>]}
[0m20:53:23.293669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879BA6280>]}
[0m20:53:23.293669 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:53:23.464174 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:53:23.609273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:53:23.609273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:53:23.649292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87A7F9130>]}
[0m20:53:23.717896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:23.717896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:23.733669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D878042DF0>]}
[0m20:53:23.733669 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m20:53:23.733669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D878042A30>]}
[0m20:53:23.733669 [info ] [MainThread]: 
[0m20:53:23.733669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:23.749362 [info ] [MainThread]: 
[0m20:53:23.749863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:23.749863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:53:23.826121 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:53:23.827135 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:53:23.827135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:23.849414 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m20:53:23.849414 [debug] [ThreadPool]: On list_postgres: Close
[0m20:53:23.849414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_crm)
[0m20:53:23.849414 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_crm"
"
[0m20:53:23.849414 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:53:23.849414 [debug] [ThreadPool]: On create_postgres_public_crm: BEGIN
[0m20:53:23.849414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:23.878441 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m20:53:23.879105 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:53:23.879105 [debug] [ThreadPool]: On create_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_crm"} */
create schema if not exists "public_crm"
[0m20:53:23.880818 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m20:53:23.882340 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:53:23.882839 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:53:23.883434 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:53:23.886348 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m20:53:23.886883 [debug] [ThreadPool]: On create_postgres_public_crm: Close
[0m20:53:23.890361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m20:53:23.890361 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:53:23.890361 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:53:23.890361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:23.906396 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m20:53:23.915751 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:53:23.915913 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:53:23.919911 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m20:53:23.921432 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:53:23.922412 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:53:23.923415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m20:53:23.926433 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:23.926433 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:53:23.926433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:23.926433 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m20:53:23.941445 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:23.941952 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:53:23.945952 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m20:53:23.947952 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:53:23.949431 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:53:23.950457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m20:53:23.952950 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:53:23.952950 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:53:23.952950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:23.967500 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:53:23.968501 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:53:23.969008 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:53:23.973499 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m20:53:23.975017 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:53:23.975998 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:53:23.978630 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:23.978630 [debug] [MainThread]: On master: BEGIN
[0m20:53:23.978630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:23.993735 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:53:24.002137 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:24.002650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:53:24.009172 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m20:53:24.010811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87A8D66D0>]}
[0m20:53:24.011358 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:24.012447 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:24.012988 [debug] [MainThread]: On master: BEGIN
[0m20:53:24.013542 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:53:24.014567 [debug] [MainThread]: On master: COMMIT
[0m20:53:24.015146 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:24.015660 [debug] [MainThread]: On master: COMMIT
[0m20:53:24.016657 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:53:24.017156 [debug] [MainThread]: On master: Close
[0m20:53:24.024273 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:53:24.024774 [info ] [Thread-1  ]: 1 of 2 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:53:24.025773 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_activities'
[0m20:53:24.025773 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:53:24.025773 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:53:24.025773 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:53:24.068907 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:53:24.069907 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:24.070906 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:53:24.071906 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:53:24.107687 [debug] [Thread-1  ]: SQL status: BEGIN in 0.037 seconds
[0m20:53:24.109358 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:24.109865 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."stg_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:53:24.109865 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:53:24.109865 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:24.109865 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:53:24.109865 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:53:24.128595 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:53:24.128595 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:24.128595 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:53:24.128595 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:53:24.144238 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:53:24.144238 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:24.144238 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:53:24.144238 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:53:24.144238 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:53:24.144238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87ABDAA30>]}
[0m20:53:24.144238 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:53:24.144238 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:53:24.157831 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_changes
[0m20:53:24.157831 [info ] [Thread-1  ]: 2 of 2 START sql view model public_crm.t_deal_changes .......................... [RUN]
[0m20:53:24.157831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_changes)
[0m20:53:24.157831 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_changes
[0m20:53:24.157831 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_changes"
[0m20:53:24.157831 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_changes
[0m20:53:24.157831 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_changes"
[0m20:53:24.157831 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:53:24.157831 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: BEGIN
[0m20:53:24.157831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:53:24.186453 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:53:24.192469 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:53:24.192999 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_changes"} */

  create view "postgres"."public_crm"."t_deal_changes__dbt_tmp"
    
    
  as (
    SELECT 
   d.deal_id
  ,d.change_time
  ,f.name AS changed_field
  ,COALESCE(f.option, d.new_value) AS new_value
FROM "postgres"."public_staging"."stg_deal_changes" d
  LEFT JOIN "postgres"."public_staging"."stg_fields" f ON a.type = ty.type
  );
[0m20:53:24.194635 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "a"
LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON a.type = t...
                                                              ^

[0m20:53:24.195084 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: ROLLBACK
[0m20:53:24.196768 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: Close
[0m20:53:24.205200 [debug] [Thread-1  ]: Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  missing FROM-clause entry for table "a"
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON a.type = t...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql
[0m20:53:24.205719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b9f61c-0e16-4d92-a6ae-fe03dbe505ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87952D220>]}
[0m20:53:24.206228 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public_crm.t_deal_changes ................. [[31mERROR[0m in 0.05s]
[0m20:53:24.206228 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_changes
[0m20:53:24.206228 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  missing FROM-clause entry for table "a"
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON a.type = t...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql.
[0m20:53:24.206228 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:24.206228 [debug] [MainThread]: On master: BEGIN
[0m20:53:24.206228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:24.228614 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:53:24.228805 [debug] [MainThread]: On master: COMMIT
[0m20:53:24.229325 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:24.229868 [debug] [MainThread]: On master: COMMIT
[0m20:53:24.231867 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:53:24.232085 [debug] [MainThread]: On master: Close
[0m20:53:24.233086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:24.233586 [debug] [MainThread]: Connection 'create_postgres_public_crm' was properly closed.
[0m20:53:24.234086 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m20:53:24.234086 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_deal_changes' was properly closed.
[0m20:53:24.234586 [info ] [MainThread]: 
[0m20:53:24.235582 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m20:53:24.236645 [debug] [MainThread]: Command end result
[0m20:53:24.286563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:24.286563 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:24.300253 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:53:24.300253 [info ] [MainThread]: 
[0m20:53:24.300253 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:53:24.300253 [info ] [MainThread]: 
[0m20:53:24.300253 [error] [MainThread]:   Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  missing FROM-clause entry for table "a"
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON a.type = t...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql
[0m20:53:24.300253 [info ] [MainThread]: 
[0m20:53:24.307945 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:53:24.307945 [debug] [MainThread]: Command `dbt run` failed at 20:53:24.307945 after 1.26 seconds
[0m20:53:24.307945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D878181070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87A8C4A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87AC158E0>]}
[0m20:53:24.307945 [debug] [MainThread]: Flushing usage events
[0m20:53:24.760077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:49.497480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA268F00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA28864790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA28864850>]}


============================== 20:53:49.497480 | 6e7f47af-f968-476c-89a1-044fdcc6d282 ==============================
[0m20:53:49.497480 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:53:49.497480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s transformations', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:53:49.654890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25BDC4C0>]}
[0m20:53:49.698208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA286B1CA0>]}
[0m20:53:49.698208 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:53:49.880539 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:53:50.029350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:53:50.029350 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m20:53:50.323799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA290D4E80>]}
[0m20:53:50.420383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:50.430655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:50.448560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2918D2B0>]}
[0m20:53:50.448560 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m20:53:50.448560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA29102D30>]}
[0m20:53:50.448560 [info ] [MainThread]: 
[0m20:53:50.469458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:50.470720 [info ] [MainThread]: 
[0m20:53:50.471818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:50.478543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:53:50.581793 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:53:50.581793 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:53:50.581793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:50.614651 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m20:53:50.614651 [debug] [ThreadPool]: On list_postgres: Close
[0m20:53:50.614651 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m20:53:50.630365 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:53:50.630365 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:53:50.630365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:50.647055 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m20:53:50.660137 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:53:50.660645 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:53:50.664451 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m20:53:50.665994 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:53:50.667475 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:53:50.668652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m20:53:50.670974 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:53:50.670974 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:53:50.670974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:50.670974 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:53:50.686389 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:53:50.686888 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:53:50.690889 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:53:50.691887 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:53:50.692889 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:53:50.693888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m20:53:50.696912 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:50.696912 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:53:50.696912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:50.711066 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:53:50.711573 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:50.712102 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:53:50.715300 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:53:50.716351 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:53:50.717402 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:53:50.723538 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:50.724031 [debug] [MainThread]: On master: BEGIN
[0m20:53:50.724512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:50.747943 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m20:53:50.757758 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:50.758131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:53:50.762153 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m20:53:50.764257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA29253970>]}
[0m20:53:50.764836 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:50.766680 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:50.767198 [debug] [MainThread]: On master: BEGIN
[0m20:53:50.769284 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:53:50.769790 [debug] [MainThread]: On master: COMMIT
[0m20:53:50.769790 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:50.770315 [debug] [MainThread]: On master: COMMIT
[0m20:53:50.771374 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:53:50.771898 [debug] [MainThread]: On master: Close
[0m20:53:50.775173 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:53:50.776172 [info ] [Thread-1  ]: 1 of 2 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:53:50.777173 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_activities'
[0m20:53:50.777694 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:53:50.781195 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:53:50.781195 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:53:50.815600 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:53:50.815600 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:50.815600 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:53:50.815600 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:53:50.842677 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:53:50.842953 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:50.843484 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."stg_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:53:50.845637 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:53:50.853491 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:50.853767 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities" rename to "t_activities__dbt_backup"
[0m20:53:50.855528 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:53:50.858241 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:50.859411 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:53:50.861438 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:53:50.864473 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:53:50.880278 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:50.880778 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:53:50.880778 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:53:50.880778 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:53:50.880778 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:53:50.880778 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:53:50.896671 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.006 seconds
[0m20:53:50.896671 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:53:50.904486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2956F970>]}
[0m20:53:50.904486 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:53:50.908013 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:53:50.908372 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_changes
[0m20:53:50.908372 [info ] [Thread-1  ]: 2 of 2 START sql view model public_crm.t_deal_changes .......................... [RUN]
[0m20:53:50.909433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_changes)
[0m20:53:50.910016 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_changes
[0m20:53:50.910016 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_changes"
[0m20:53:50.910016 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_changes
[0m20:53:50.910016 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_changes"
[0m20:53:50.910016 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:53:50.910016 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: BEGIN
[0m20:53:50.910016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:53:50.937571 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m20:53:50.939510 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:53:50.939510 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_changes"} */

  create view "postgres"."public_crm"."t_deal_changes__dbt_tmp"
    
    
  as (
    SELECT 
   d.deal_id
  ,d.change_time
  ,f.name AS changed_field
  ,COALESCE(f.option, d.new_value) AS new_value
FROM "postgres"."public_staging"."stg_deal_changes" d
  LEFT JOIN "postgres"."public_staging"."stg_fields" f ON d.type = f.type
  );
[0m20:53:50.946116 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column d.type does not exist
LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.type = f...
                                                              ^

[0m20:53:50.947084 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: ROLLBACK
[0m20:53:50.949668 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: Close
[0m20:53:50.953614 [debug] [Thread-1  ]: Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  column d.type does not exist
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.type = f...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql
[0m20:53:50.954111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7f47af-f968-476c-89a1-044fdcc6d282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25CB0C40>]}
[0m20:53:50.955111 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public_crm.t_deal_changes ................. [[31mERROR[0m in 0.04s]
[0m20:53:50.955592 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_changes
[0m20:53:50.956591 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  column d.type does not exist
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.type = f...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql.
[0m20:53:50.957592 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:50.958092 [debug] [MainThread]: On master: BEGIN
[0m20:53:50.958092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:50.984791 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m20:53:50.993628 [debug] [MainThread]: On master: COMMIT
[0m20:53:50.994135 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:50.994135 [debug] [MainThread]: On master: COMMIT
[0m20:53:50.995191 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:53:50.995724 [debug] [MainThread]: On master: Close
[0m20:53:50.997069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:50.997589 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:53:50.998087 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:53:50.998588 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_deal_changes' was properly closed.
[0m20:53:50.999590 [info ] [MainThread]: 
[0m20:53:51.000661 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m20:53:51.001617 [debug] [MainThread]: Command end result
[0m20:53:51.021608 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:51.021608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:51.032316 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:53:51.033372 [info ] [MainThread]: 
[0m20:53:51.034372 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:53:51.035408 [info ] [MainThread]: 
[0m20:53:51.035408 [error] [MainThread]:   Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  column d.type does not exist
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.type = f...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql
[0m20:53:51.037368 [info ] [MainThread]: 
[0m20:53:51.038211 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:53:51.039226 [debug] [MainThread]: Command `dbt run` failed at 20:53:51.039226 after 1.59 seconds
[0m20:53:51.039226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA268F00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2915F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA29025D90>]}
[0m20:53:51.040681 [debug] [MainThread]: Flushing usage events
[0m20:53:51.510514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:42.250496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7E602040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB00594910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB00594850>]}


============================== 20:54:42.250496 | 8159cd60-2b48-41f6-b0cf-5418517695f6 ==============================
[0m20:54:42.250496 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:54:42.266043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s transformations', 'send_anonymous_usage_stats': 'True'}
[0m20:54:42.409185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0091EF10>]}
[0m20:54:42.462368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB008E8310>]}
[0m20:54:42.462368 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:54:42.629482 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:54:42.759952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:42.759952 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m20:54:43.048836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB00F32E20>]}
[0m20:54:43.108736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:54:43.127360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:54:43.139000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB00FFD3A0>]}
[0m20:54:43.139000 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m20:54:43.139000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB00F76A60>]}
[0m20:54:43.139000 [info ] [MainThread]: 
[0m20:54:43.139000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:43.139000 [info ] [MainThread]: 
[0m20:54:43.139000 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:43.155385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:54:43.260081 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:54:43.260081 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:54:43.260081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:43.299089 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m20:54:43.299208 [debug] [ThreadPool]: On list_postgres: Close
[0m20:54:43.302140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m20:54:43.308951 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:54:43.308951 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:54:43.308951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:43.349345 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m20:54:43.351203 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:54:43.351777 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:54:43.355717 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:54:43.357225 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:54:43.358215 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:54:43.359714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m20:54:43.362219 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:54:43.362219 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:54:43.362219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:43.389714 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m20:54:43.390531 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:54:43.391029 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:54:43.395527 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m20:54:43.397596 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:54:43.399154 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:54:43.400656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m20:54:43.401153 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:54:43.401153 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:54:43.401153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:43.417141 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m20:54:43.424665 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:54:43.425177 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:54:43.429545 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m20:54:43.431259 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:54:43.432174 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:54:43.438737 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:43.438737 [debug] [MainThread]: On master: BEGIN
[0m20:54:43.438737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:43.454408 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m20:54:43.456633 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:43.457644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:43.467001 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m20:54:43.470495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB010D7AC0>]}
[0m20:54:43.470495 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:43.473832 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:43.474831 [debug] [MainThread]: On master: BEGIN
[0m20:54:43.477021 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:54:43.477517 [debug] [MainThread]: On master: COMMIT
[0m20:54:43.478018 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:43.478018 [debug] [MainThread]: On master: COMMIT
[0m20:54:43.480899 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:43.481901 [debug] [MainThread]: On master: Close
[0m20:54:43.503722 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:54:43.504723 [info ] [Thread-1  ]: 1 of 2 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:54:43.512870 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_activities'
[0m20:54:43.512870 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:54:43.528048 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:54:43.528516 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:54:43.568684 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:54:43.577780 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:54:43.578813 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:54:43.579833 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:54:43.595350 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m20:54:43.595859 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:54:43.596924 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."stg_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:54:43.601472 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:54:43.608158 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:54:43.609158 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities" rename to "t_activities__dbt_backup"
[0m20:54:43.610844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:54:43.611936 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:54:43.611936 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:54:43.611936 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:54:43.618841 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:54:43.618841 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:54:43.618841 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:54:43.639471 [debug] [Thread-1  ]: SQL status: COMMIT in 0.013 seconds
[0m20:54:43.648480 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:54:43.659547 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:54:43.659547 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:54:43.659547 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m20:54:43.659547 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:54:43.669203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB013CFF10>]}
[0m20:54:43.669203 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:54:43.669203 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:54:43.669203 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_changes
[0m20:54:43.669203 [info ] [Thread-1  ]: 2 of 2 START sql view model public_crm.t_deal_changes .......................... [RUN]
[0m20:54:43.669203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_changes)
[0m20:54:43.669203 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_changes
[0m20:54:43.669203 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_changes"
[0m20:54:43.669203 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_changes
[0m20:54:43.669203 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_changes"
[0m20:54:43.684881 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:54:43.685173 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: BEGIN
[0m20:54:43.685699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:54:43.705711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:54:43.706221 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:54:43.706745 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_changes"} */

  create view "postgres"."public_crm"."t_deal_changes__dbt_tmp"
    
    
  as (
    SELECT 
   d.deal_id
  ,d.change_time
  ,f.name AS changed_field
  ,COALESCE(f.option, d.new_value) AS new_value
FROM "postgres"."public_staging"."stg_deal_changes" d
  LEFT JOIN "postgres"."public_staging"."stg_fields" f ON d.changed_field = f.field_key
  );
[0m20:54:43.712248 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column d.changed_field does not exist
LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.changed_...
                                                              ^

[0m20:54:43.713246 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: ROLLBACK
[0m20:54:43.715745 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: Close
[0m20:54:43.720263 [debug] [Thread-1  ]: Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  column d.changed_field does not exist
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.changed_...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql
[0m20:54:43.720764 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8159cd60-2b48-41f6-b0cf-5418517695f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7F99B8E0>]}
[0m20:54:43.721745 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public_crm.t_deal_changes ................. [[31mERROR[0m in 0.05s]
[0m20:54:43.723334 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_changes
[0m20:54:43.723334 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  column d.changed_field does not exist
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.changed_...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql.
[0m20:54:43.723334 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:43.723334 [debug] [MainThread]: On master: BEGIN
[0m20:54:43.723334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:43.731476 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:54:43.744395 [debug] [MainThread]: On master: COMMIT
[0m20:54:43.745336 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:43.746331 [debug] [MainThread]: On master: COMMIT
[0m20:54:43.748330 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:43.748968 [debug] [MainThread]: On master: Close
[0m20:54:43.749896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:43.750330 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:54:43.750829 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m20:54:43.751329 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_deal_changes' was properly closed.
[0m20:54:43.752389 [info ] [MainThread]: 
[0m20:54:43.752829 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m20:54:43.754328 [debug] [MainThread]: Command end result
[0m20:54:43.778461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:54:43.782036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:54:43.789701 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:54:43.789701 [info ] [MainThread]: 
[0m20:54:43.789701 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:54:43.789701 [info ] [MainThread]: 
[0m20:54:43.789701 [error] [MainThread]:   Database Error in model t_deal_changes (models\transformations\crm\t_deal_changes.sql)
  column d.changed_field does not exist
  LINE 13: ...OIN "postgres"."public_staging"."stg_fields" f ON d.changed_...
                                                                ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_changes.sql
[0m20:54:43.789701 [info ] [MainThread]: 
[0m20:54:43.794364 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:54:43.795997 [debug] [MainThread]: Command `dbt run` failed at 20:54:43.795997 after 1.58 seconds
[0m20:54:43.797234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB7E602040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB003FBA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB003FB220>]}
[0m20:54:43.798282 [debug] [MainThread]: Flushing usage events
[0m20:54:44.248859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:10.721962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217900600A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021791FD4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021791FD4820>]}


============================== 20:55:10.737082 | 43f1ec6c-3f65-441a-bb77-595ea638fd60 ==============================
[0m20:55:10.737082 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:55:10.737082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s transformations', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:55:10.879978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178F358340>]}
[0m20:55:10.925422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178F3841F0>]}
[0m20:55:10.925422 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:55:11.106503 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:55:11.246131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:11.246131 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m20:55:11.543517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021792843E80>]}
[0m20:55:11.619192 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:55:11.619192 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:55:11.635567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217928FE310>]}
[0m20:55:11.635567 [info ] [MainThread]: Found 9 models, 6 sources, 428 macros
[0m20:55:11.635567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217928752B0>]}
[0m20:55:11.635567 [info ] [MainThread]: 
[0m20:55:11.635567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:11.635567 [info ] [MainThread]: 
[0m20:55:11.635567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:11.635567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:55:11.749388 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:55:11.749388 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:55:11.749388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:11.776128 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m20:55:11.776831 [debug] [ThreadPool]: On list_postgres: Close
[0m20:55:11.780374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m20:55:11.780374 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:55:11.780374 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:55:11.780374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:11.805551 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m20:55:11.819044 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:55:11.819044 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:55:11.823054 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m20:55:11.824570 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:55:11.825552 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:55:11.826553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m20:55:11.829523 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:55:11.830068 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:55:11.830571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:11.843952 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:55:11.844538 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:55:11.844538 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:55:11.849179 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:55:11.849179 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:55:11.849179 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:55:11.849179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m20:55:11.849179 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:55:11.849179 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:55:11.849179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:11.860106 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m20:55:11.871241 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:55:11.871747 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:55:11.875030 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:55:11.876510 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:55:11.877513 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:55:11.883033 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:11.883033 [debug] [MainThread]: On master: BEGIN
[0m20:55:11.883033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:11.898538 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m20:55:11.898986 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:11.899485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:11.903782 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m20:55:11.905885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179287F250>]}
[0m20:55:11.906511 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:11.907574 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:11.907574 [debug] [MainThread]: On master: BEGIN
[0m20:55:11.909276 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:55:11.910029 [debug] [MainThread]: On master: COMMIT
[0m20:55:11.910283 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:11.910784 [debug] [MainThread]: On master: COMMIT
[0m20:55:11.911781 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:55:11.912281 [debug] [MainThread]: On master: Close
[0m20:55:11.915472 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:55:11.915990 [info ] [Thread-1  ]: 1 of 2 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:55:11.916972 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_activities'
[0m20:55:11.917471 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:55:11.925224 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:55:11.925224 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:55:11.958521 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:55:11.959525 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:55:11.960718 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:55:11.960718 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:55:11.977283 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m20:55:11.978190 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:55:11.978701 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."stg_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:55:11.982103 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:55:11.988394 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:55:11.988394 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities" rename to "t_activities__dbt_backup"
[0m20:55:11.988394 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:11.993880 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:55:11.994896 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:55:11.996909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:12.010717 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:55:12.011716 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:55:12.011716 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:55:12.017635 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:55:12.022737 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:55:12.027057 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:55:12.027057 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:55:12.027057 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m20:55:12.027057 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:55:12.027057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021792CBAAF0>]}
[0m20:55:12.027057 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:55:12.027057 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:55:12.027057 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_changes
[0m20:55:12.027057 [info ] [Thread-1  ]: 2 of 2 START sql view model public_crm.t_deal_changes .......................... [RUN]
[0m20:55:12.027057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_changes)
[0m20:55:12.027057 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_changes
[0m20:55:12.043652 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_changes"
[0m20:55:12.043652 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_changes
[0m20:55:12.043652 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_changes"
[0m20:55:12.043652 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:55:12.043652 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: BEGIN
[0m20:55:12.043652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:12.074263 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:55:12.075209 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:55:12.076178 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_changes"} */

  create view "postgres"."public_crm"."t_deal_changes__dbt_tmp"
    
    
  as (
    SELECT 
   d.deal_id
  ,d.change_time
  ,f.name AS changed_field
  ,COALESCE(f.option, d.new_value) AS new_value
FROM "postgres"."public_staging"."stg_deal_changes" d
  LEFT JOIN "postgres"."public_staging"."stg_fields" f ON d.changed_field_key = f.field_key
  );
[0m20:55:12.093606 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.017 seconds
[0m20:55:12.093606 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:55:12.093606 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_changes"} */
alter table "postgres"."public_crm"."t_deal_changes__dbt_tmp" rename to "t_deal_changes"
[0m20:55:12.093606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:55:12.093606 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: COMMIT
[0m20:55:12.093606 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:55:12.093606 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: COMMIT
[0m20:55:12.093606 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:55:12.093606 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_changes__dbt_backup"
[0m20:55:12.093606 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_changes"
[0m20:55:12.093606 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_changes"} */
drop view if exists "postgres"."public_crm"."t_deal_changes__dbt_backup" cascade
[0m20:55:12.093606 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:55:12.110086 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_changes: Close
[0m20:55:12.110086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f1ec6c-3f65-441a-bb77-595ea638fd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179041EE80>]}
[0m20:55:12.110086 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public_crm.t_deal_changes ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:55:12.110086 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_changes
[0m20:55:12.110086 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:12.110086 [debug] [MainThread]: On master: BEGIN
[0m20:55:12.110086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:12.133034 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m20:55:12.140518 [debug] [MainThread]: On master: COMMIT
[0m20:55:12.141028 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:12.141528 [debug] [MainThread]: On master: COMMIT
[0m20:55:12.143157 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:55:12.143660 [debug] [MainThread]: On master: Close
[0m20:55:12.144661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:12.145219 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:55:12.145771 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m20:55:12.146319 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_deal_changes' was properly closed.
[0m20:55:12.147006 [info ] [MainThread]: 
[0m20:55:12.148065 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m20:55:12.149118 [debug] [MainThread]: Command end result
[0m20:55:12.165212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:55:12.165212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:55:12.182243 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:55:12.182243 [info ] [MainThread]: 
[0m20:55:12.183241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:12.184386 [info ] [MainThread]: 
[0m20:55:12.184386 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:55:12.184386 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:12.184386 after 1.50 seconds
[0m20:55:12.184386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217900600A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178FC4B730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217904130A0>]}
[0m20:55:12.184386 [debug] [MainThread]: Flushing usage events
[0m20:55:12.659251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:40.136669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A261715F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2636849D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A263684910>]}


============================== 23:26:40.136669 | e11f3f14-6af5-4143-a354-f6a2ecebe6fe ==============================
[0m23:26:40.136669 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:26:40.136669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s transformations', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:40.326733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A260A417C0>]}
[0m23:26:40.376919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2634C9D60>]}
[0m23:26:40.385312 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:26:40.606743 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:26:40.767929 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m23:26:40.767929 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_user_deal_events.sql
[0m23:26:40.767929 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_deal_funnel_events.sql
[0m23:26:40.767929 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_deal_lost_reasons.sql
[0m23:26:40.767929 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\transformations\crm\t_deal_changes.sql
[0m23:26:41.034523 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 't_deal_changes' in the 'models' section of file 'models\transformations\crm\crm.yml'
[0m23:26:41.118045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A263FE7FD0>]}
[0m23:26:41.213848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:26:41.213848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:26:41.230047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A261362DF0>]}
[0m23:26:41.230047 [info ] [MainThread]: Found 11 models, 6 sources, 428 macros
[0m23:26:41.230047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A263A141C0>]}
[0m23:26:41.230047 [info ] [MainThread]: 
[0m23:26:41.230047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:41.230047 [info ] [MainThread]: 
[0m23:26:41.230047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:41.249165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:26:41.377320 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:26:41.393118 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:26:41.393118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:41.427462 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m23:26:41.427462 [debug] [ThreadPool]: On list_postgres: Close
[0m23:26:41.437014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m23:26:41.437014 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:26:41.437014 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:26:41.445350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:41.467607 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:26:41.468225 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:26:41.468225 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:26:41.474123 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m23:26:41.475605 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:26:41.477607 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:26:41.478606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m23:26:41.479173 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:26:41.479173 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m23:26:41.479173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:41.517811 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m23:26:41.518464 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:26:41.518684 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m23:26:41.527313 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m23:26:41.529182 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m23:26:41.529182 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m23:26:41.529182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m23:26:41.529182 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:26:41.529182 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:26:41.529182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:41.556565 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m23:26:41.558311 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:26:41.558822 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:26:41.559364 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m23:26:41.559364 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:26:41.559364 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:26:41.573852 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:41.573852 [debug] [MainThread]: On master: BEGIN
[0m23:26:41.573852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:41.606694 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m23:26:41.608580 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:41.609150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:26:41.616712 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m23:26:41.617286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A263CD0D90>]}
[0m23:26:41.617286 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:41.621798 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:41.622613 [debug] [MainThread]: On master: BEGIN
[0m23:26:41.626010 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:26:41.626611 [debug] [MainThread]: On master: COMMIT
[0m23:26:41.627115 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:41.627115 [debug] [MainThread]: On master: COMMIT
[0m23:26:41.628609 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:26:41.629111 [debug] [MainThread]: On master: Close
[0m23:26:41.633612 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m23:26:41.634170 [info ] [Thread-1  ]: 1 of 4 START sql view model public_crm.t_activities ............................ [RUN]
[0m23:26:41.635610 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_activities'
[0m23:26:41.636116 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m23:26:41.637610 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m23:26:41.637610 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m23:26:41.686747 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m23:26:41.686747 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:41.686747 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m23:26:41.686747 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:26:41.722488 [debug] [Thread-1  ]: SQL status: BEGIN in 0.033 seconds
[0m23:26:41.725875 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:41.726746 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."stg_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m23:26:41.734744 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:26:41.737522 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:41.737522 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities" rename to "t_activities__dbt_backup"
[0m23:26:41.737522 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:26:41.737522 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:41.737522 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m23:26:41.737522 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:41.767402 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m23:26:41.767402 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:41.767402 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m23:26:41.776842 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m23:26:41.776842 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m23:26:41.776842 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:41.776842 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m23:26:41.793542 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m23:26:41.793542 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m23:26:41.793542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26364A940>]}
[0m23:26:41.793542 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m23:26:41.803907 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m23:26:41.803907 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:41.803907 [info ] [Thread-1  ]: 2 of 4 START sql view model public_crm.t_deal_funnel_events .................... [RUN]
[0m23:26:41.806417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_funnel_events)
[0m23:26:41.806884 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:41.806884 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:41.806884 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:41.806884 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:41.818519 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:41.819120 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m23:26:41.819120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:41.836369 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m23:26:41.843129 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:41.843740 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM public_crm.t_activities
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN public_staging.stg_stages s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
;
  );
[0m23:26:41.846812 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 73: ;
         ^

[0m23:26:41.847309 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: ROLLBACK
[0m23:26:41.850306 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m23:26:41.856527 [debug] [Thread-1  ]: Database Error in model t_deal_funnel_events (models\transformations\crm\t_deal_funnel_events.sql)
  syntax error at or near ";"
  LINE 73: ;
           ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_funnel_events.sql
[0m23:26:41.857469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A260AF4DF0>]}
[0m23:26:41.858469 [error] [Thread-1  ]: 2 of 4 ERROR creating sql view model public_crm.t_deal_funnel_events ........... [[31mERROR[0m in 0.05s]
[0m23:26:41.859971 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:41.860502 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:41.861929 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_funnel_events' to be skipped because of status 'error'.  Reason: Database Error in model t_deal_funnel_events (models\transformations\crm\t_deal_funnel_events.sql)
  syntax error at or near ";"
  LINE 73: ;
           ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_funnel_events.sql.
[0m23:26:41.860971 [info ] [Thread-1  ]: 3 of 4 START sql view model public_crm.t_deal_lost_reasons ..................... [RUN]
[0m23:26:41.862480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m23:26:41.862967 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:41.868239 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:41.869772 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:41.877601 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:41.879042 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:41.879643 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m23:26:41.880046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:41.904290 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m23:26:41.905219 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:41.905714 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m23:26:41.910215 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:26:41.913713 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:41.914214 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m23:26:41.916221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:41.918237 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m23:26:41.918718 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:41.918718 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m23:26:41.921228 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m23:26:41.921228 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m23:26:41.921228 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:41.921228 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m23:26:41.921228 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:41.921228 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m23:26:41.921228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A263631E80>]}
[0m23:26:41.937386 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public_crm.t_deal_lost_reasons ................ [[32mCREATE VIEW[0m in 0.06s]
[0m23:26:41.937386 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:41.937386 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m23:26:41.937386 [info ] [Thread-1  ]: 4 of 4 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m23:26:41.937386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_user_deal_events)
[0m23:26:41.937386 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m23:26:41.937386 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:41.937386 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m23:26:41.954021 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:41.954021 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:41.954021 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m23:26:41.954021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:41.993277 [debug] [Thread-1  ]: SQL status: BEGIN in 0.035 seconds
[0m23:26:41.993788 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:41.994323 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m23:26:41.994816 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:41.994816 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:41.994816 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m23:26:42.003905 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:42.006820 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m23:26:42.006820 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:42.006820 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m23:26:42.006820 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m23:26:42.006820 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m23:26:42.006820 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:42.006820 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m23:26:42.020629 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:42.020629 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m23:26:42.020629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11f3f14-6af5-4143-a354-f6a2ecebe6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A263631E80>]}
[0m23:26:42.024603 [info ] [Thread-1  ]: 4 of 4 OK created sql view model public_crm.t_user_deal_events ................. [[32mCREATE VIEW[0m in 0.08s]
[0m23:26:42.025200 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m23:26:42.027062 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:42.027062 [debug] [MainThread]: On master: BEGIN
[0m23:26:42.027062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:42.054284 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:26:42.068138 [debug] [MainThread]: On master: COMMIT
[0m23:26:42.068138 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:42.068750 [debug] [MainThread]: On master: COMMIT
[0m23:26:42.070397 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:26:42.070397 [debug] [MainThread]: On master: Close
[0m23:26:42.070397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:42.070397 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:26:42.070397 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m23:26:42.070397 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_user_deal_events' was properly closed.
[0m23:26:42.070397 [info ] [MainThread]: 
[0m23:26:42.070397 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m23:26:42.070397 [debug] [MainThread]: Command end result
[0m23:26:42.097547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:26:42.104091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:26:42.104910 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:26:42.104910 [info ] [MainThread]: 
[0m23:26:42.104910 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m23:26:42.115458 [info ] [MainThread]: 
[0m23:26:42.115986 [error] [MainThread]:   Database Error in model t_deal_funnel_events (models\transformations\crm\t_deal_funnel_events.sql)
  syntax error at or near ";"
  LINE 73: ;
           ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_deal_funnel_events.sql
[0m23:26:42.115986 [info ] [MainThread]: 
[0m23:26:42.115986 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:26:42.115986 [debug] [MainThread]: Command `dbt run` failed at 23:26:42.115986 after 2.04 seconds
[0m23:26:42.122316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A261715F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26006A160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A260ACE0D0>]}
[0m23:26:42.122316 [debug] [MainThread]: Flushing usage events
[0m23:26:43.007606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:51.346811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5A171FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C0E49A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C0E48E0>]}


============================== 23:26:51.363287 | 5ed1d998-775e-40b4-9bf1-e99106e454b1 ==============================
[0m23:26:51.363287 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:26:51.363287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s transformations', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:26:51.541592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5949D040>]}
[0m23:26:51.588594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5949D8B0>]}
[0m23:26:51.604323 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:26:51.815859 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:26:51.988778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:51.988778 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_deal_funnel_events.sql
[0m23:26:52.253332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C99AE80>]}
[0m23:26:52.334397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:26:52.350030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:26:52.367668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C97E250>]}
[0m23:26:52.367668 [info ] [MainThread]: Found 11 models, 6 sources, 428 macros
[0m23:26:52.367668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C95D640>]}
[0m23:26:52.367668 [info ] [MainThread]: 
[0m23:26:52.367668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:52.367668 [info ] [MainThread]: 
[0m23:26:52.367668 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:52.367668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:26:52.461695 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:26:52.461695 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:26:52.461695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:52.519903 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.055 seconds
[0m23:26:52.519903 [debug] [ThreadPool]: On list_postgres: Close
[0m23:26:52.525528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m23:26:52.529629 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:26:52.529629 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:26:52.529629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:52.553809 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m23:26:52.559492 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:26:52.560074 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:26:52.564097 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m23:26:52.565614 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:26:52.567193 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:26:52.568773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m23:26:52.570275 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:26:52.570275 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m23:26:52.570275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:52.610769 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m23:26:52.617032 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:26:52.618027 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m23:26:52.620905 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m23:26:52.620905 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m23:26:52.625980 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m23:26:52.626766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m23:26:52.626766 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:26:52.626766 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:26:52.626766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:52.668751 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m23:26:52.669486 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:26:52.669739 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:26:52.675692 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m23:26:52.677458 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:26:52.680095 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:26:52.681959 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:52.681959 [debug] [MainThread]: On master: BEGIN
[0m23:26:52.681959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:52.714096 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m23:26:52.714793 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:52.715294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:26:52.720805 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m23:26:52.723878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5CA73970>]}
[0m23:26:52.724381 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:52.725397 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:52.725397 [debug] [MainThread]: On master: BEGIN
[0m23:26:52.725397 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:26:52.725397 [debug] [MainThread]: On master: COMMIT
[0m23:26:52.732214 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:52.732626 [debug] [MainThread]: On master: COMMIT
[0m23:26:52.736628 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:26:52.737135 [debug] [MainThread]: On master: Close
[0m23:26:52.741174 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m23:26:52.741714 [info ] [Thread-1  ]: 1 of 4 START sql view model public_crm.t_activities ............................ [RUN]
[0m23:26:52.742628 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_activities'
[0m23:26:52.743133 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m23:26:52.743133 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m23:26:52.743133 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m23:26:52.840481 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m23:26:52.840481 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:52.840481 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m23:26:52.840481 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:26:52.887669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.040 seconds
[0m23:26:52.888518 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:52.889012 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."stg_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m23:26:52.892484 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:52.898943 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:52.903525 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities" rename to "t_activities__dbt_backup"
[0m23:26:52.904763 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:52.907087 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:52.907087 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m23:26:52.907087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.927642 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m23:26:52.927642 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:52.927642 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m23:26:52.936337 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m23:26:52.937426 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m23:26:52.946788 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m23:26:52.946788 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m23:26:52.953550 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m23:26:52.953550 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m23:26:52.953550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A58A15490>]}
[0m23:26:52.953550 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:26:52.961722 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m23:26:52.961722 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:52.961722 [info ] [Thread-1  ]: 2 of 4 START sql view model public_crm.t_deal_funnel_events .................... [RUN]
[0m23:26:52.961722 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_funnel_events)
[0m23:26:52.961722 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:52.970376 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:52.970376 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:52.970376 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:52.979826 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:52.979826 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m23:26:52.980853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:53.021507 [debug] [Thread-1  ]: SQL status: BEGIN in 0.040 seconds
[0m23:26:53.022709 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:53.023706 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM public_crm.t_activities
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN public_staging.stg_stages s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m23:26:53.036714 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:26:53.037666 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:53.037666 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m23:26:53.037666 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:26:53.037666 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m23:26:53.037666 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:53.037666 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m23:26:53.053460 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:26:53.053956 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m23:26:53.053956 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m23:26:53.053956 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m23:26:53.053956 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:53.062137 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m23:26:53.062137 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5B5276D0>]}
[0m23:26:53.062137 [info ] [Thread-1  ]: 2 of 4 OK created sql view model public_crm.t_deal_funnel_events ............... [[32mCREATE VIEW[0m in 0.10s]
[0m23:26:53.062137 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m23:26:53.062137 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:53.062137 [info ] [Thread-1  ]: 3 of 4 START sql view model public_crm.t_deal_lost_reasons ..................... [RUN]
[0m23:26:53.069765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m23:26:53.070413 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:53.070413 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.070413 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:53.079116 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.079116 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.079116 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m23:26:53.079116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:53.105053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.035 seconds
[0m23:26:53.118035 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.118534 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m23:26:53.124441 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:26:53.128498 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.129009 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons" rename to "t_deal_lost_reasons__dbt_backup"
[0m23:26:53.129009 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:53.137029 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.137029 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m23:26:53.137029 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:53.137029 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m23:26:53.137029 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.137029 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m23:26:53.145077 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:26:53.145077 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m23:26:53.153556 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m23:26:53.153556 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m23:26:53.153556 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m23:26:53.153556 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m23:26:53.162100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A58A15490>]}
[0m23:26:53.162100 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public_crm.t_deal_lost_reasons ................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:26:53.162100 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m23:26:53.162100 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m23:26:53.162100 [info ] [Thread-1  ]: 4 of 4 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m23:26:53.162100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_user_deal_events)
[0m23:26:53.162100 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m23:26:53.169308 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.169308 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m23:26:53.169308 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.169308 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.169308 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m23:26:53.169308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:53.246288 [debug] [Thread-1  ]: SQL status: BEGIN in 0.066 seconds
[0m23:26:53.247873 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.248370 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m23:26:53.251873 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:53.257374 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.257374 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events" rename to "t_user_deal_events__dbt_backup"
[0m23:26:53.261841 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:53.262343 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.262343 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m23:26:53.262343 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:53.270015 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m23:26:53.270015 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.270015 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m23:26:53.270015 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m23:26:53.278048 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m23:26:53.278048 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m23:26:53.278048 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m23:26:53.278048 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m23:26:53.278048 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m23:26:53.286993 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed1d998-775e-40b4-9bf1-e99106e454b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5CE2D760>]}
[0m23:26:53.287498 [info ] [Thread-1  ]: 4 of 4 OK created sql view model public_crm.t_user_deal_events ................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:26:53.287498 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m23:26:53.287498 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:53.287498 [debug] [MainThread]: On master: BEGIN
[0m23:26:53.287498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:53.306660 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m23:26:53.314856 [debug] [MainThread]: On master: COMMIT
[0m23:26:53.315846 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:53.317480 [debug] [MainThread]: On master: COMMIT
[0m23:26:53.319354 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:26:53.320354 [debug] [MainThread]: On master: Close
[0m23:26:53.321854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:53.322354 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:26:53.322854 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m23:26:53.323853 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_user_deal_events' was properly closed.
[0m23:26:53.324354 [info ] [MainThread]: 
[0m23:26:53.325354 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m23:26:53.326855 [debug] [MainThread]: Command end result
[0m23:26:53.354196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:26:53.354196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:26:53.378034 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:26:53.378034 [info ] [MainThread]: 
[0m23:26:53.378034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:53.378034 [info ] [MainThread]: 
[0m23:26:53.378034 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:26:53.386075 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:53.385916 after 2.08 seconds
[0m23:26:53.387360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5A171FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5949D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C8F1E20>]}
[0m23:26:53.387360 [debug] [MainThread]: Flushing usage events
[0m23:26:54.053499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:31.120020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBB902040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBD864910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBD864850>]}


============================== 23:58:31.130222 | dbdcf566-b281-41ae-aa6e-2f29a935d66f ==============================
[0m23:58:31.130222 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:58:31.130222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s calendar_', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:58:31.315908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbdcf566-b281-41ae-aa6e-2f29a935d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBAC2EF10>]}
[0m23:58:31.369992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbdcf566-b281-41ae-aa6e-2f29a935d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBABF8310>]}
[0m23:58:31.369992 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:58:31.581164 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:58:31.759145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:58:31.759145 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\calendar_.sql
[0m23:58:31.759145 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_deal_funnel_events.sql
[0m23:58:31.991714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbdcf566-b281-41ae-aa6e-2f29a935d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBE12A130>]}
[0m23:58:32.061269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:58:32.061269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:58:32.092965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbdcf566-b281-41ae-aa6e-2f29a935d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBE0FB250>]}
[0m23:58:32.092965 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m23:58:32.092965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbdcf566-b281-41ae-aa6e-2f29a935d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBDF38640>]}
[0m23:58:32.092965 [info ] [MainThread]: 
[0m23:58:32.092965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:32.092965 [info ] [MainThread]: 
[0m23:58:32.092965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:32.092965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:58:32.208242 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:58:32.208242 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:58:32.209302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:32.251185 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m23:58:32.251185 [debug] [ThreadPool]: On list_postgres: Close
[0m23:58:32.251185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m23:58:32.266801 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:58:32.266801 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m23:58:32.266801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:32.299585 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m23:58:32.300229 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:58:32.300585 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m23:58:32.308085 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m23:58:32.309470 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m23:58:32.311077 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m23:58:32.312098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m23:58:32.312098 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:58:32.312098 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:58:32.312098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:32.329702 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m23:58:32.331262 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:58:32.331758 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:58:32.334982 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:58:32.334982 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:58:32.334982 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:58:32.334982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m23:58:32.334982 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:58:32.334982 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:58:32.334982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:32.350750 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m23:58:32.365587 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:58:32.366194 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:58:32.369646 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m23:58:32.370646 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:58:32.372144 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:58:32.376654 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:32.376654 [debug] [MainThread]: On master: BEGIN
[0m23:58:32.376654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:32.399753 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m23:58:32.407303 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:32.407930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:32.408434 [debug] [MainThread]: SQL status: SELECT 11 in 0.007 seconds
[0m23:58:32.408434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbdcf566-b281-41ae-aa6e-2f29a935d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBD6CBD60>]}
[0m23:58:32.408434 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:32.408434 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:32.408434 [debug] [MainThread]: On master: BEGIN
[0m23:58:32.408434 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:58:32.423177 [debug] [MainThread]: On master: COMMIT
[0m23:58:32.423724 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:32.423724 [debug] [MainThread]: On master: COMMIT
[0m23:58:32.425230 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:58:32.425747 [debug] [MainThread]: On master: Close
[0m23:58:32.432291 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m23:58:32.432291 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m23:58:32.433345 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m23:58:32.433868 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m23:58:32.474790 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m23:58:32.484272 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m23:58:32.511363 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m23:58:32.511363 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m23:58:32.511363 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m23:58:32.511363 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:58:32.540666 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m23:58:32.541015 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m23:58:32.541515 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   GENERATE_SERIES(DATE '2020-01-01', DATE '2030-12-31', '1 day') AS day
)
SELECT 
   day
  ,DATE_TRUNC('month', date) AS month
FROM generate_series
  );
[0m23:58:32.544524 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 13:   ,DATE_TRUNC('month', date) AS month
                                ^
HINT:  Perhaps you meant to reference the column "generate_series.day".

[0m23:58:32.545516 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: ROLLBACK
[0m23:58:32.548329 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m23:58:32.562778 [debug] [Thread-1  ]: Database Error in model calendar_ (models\calendar_.sql)
  column "date" does not exist
  LINE 13:   ,DATE_TRUNC('month', date) AS month
                                  ^
  HINT:  Perhaps you meant to reference the column "generate_series.day".
  compiled code at target\run\enpal_assessment_project\models\calendar_.sql
[0m23:58:32.562778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbdcf566-b281-41ae-aa6e-2f29a935d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBACA4A60>]}
[0m23:58:32.562778 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.calendar_ .......................... [[31mERROR[0m in 0.13s]
[0m23:58:32.562778 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m23:58:32.562778 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.calendar_' to be skipped because of status 'error'.  Reason: Database Error in model calendar_ (models\calendar_.sql)
  column "date" does not exist
  LINE 13:   ,DATE_TRUNC('month', date) AS month
                                  ^
  HINT:  Perhaps you meant to reference the column "generate_series.day".
  compiled code at target\run\enpal_assessment_project\models\calendar_.sql.
[0m23:58:32.562778 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:32.562778 [debug] [MainThread]: On master: BEGIN
[0m23:58:32.562778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:32.593067 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m23:58:32.593344 [debug] [MainThread]: On master: COMMIT
[0m23:58:32.594005 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:32.594754 [debug] [MainThread]: On master: COMMIT
[0m23:58:32.596452 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:58:32.596949 [debug] [MainThread]: On master: Close
[0m23:58:32.598251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:32.598925 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:58:32.599255 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m23:58:32.599751 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m23:58:32.600253 [info ] [MainThread]: 
[0m23:58:32.600753 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m23:58:32.602329 [debug] [MainThread]: Command end result
[0m23:58:32.618906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:58:32.618906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:58:32.635574 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:58:32.635574 [info ] [MainThread]: 
[0m23:58:32.635574 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m23:58:32.635574 [info ] [MainThread]: 
[0m23:58:32.635574 [error] [MainThread]:   Database Error in model calendar_ (models\calendar_.sql)
  column "date" does not exist
  LINE 13:   ,DATE_TRUNC('month', date) AS month
                                  ^
  HINT:  Perhaps you meant to reference the column "generate_series.day".
  compiled code at target\run\enpal_assessment_project\models\calendar_.sql
[0m23:58:32.635574 [info ] [MainThread]: 
[0m23:58:32.635574 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:58:32.635574 [debug] [MainThread]: Command `dbt run` failed at 23:58:32.635574 after 1.56 seconds
[0m23:58:32.635574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBB902040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBE5BF940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BBE5BF9A0>]}
[0m23:58:32.635574 [debug] [MainThread]: Flushing usage events
[0m23:58:33.159884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:43.628200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AEAB00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B0A24760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B0A24820>]}


============================== 23:58:43.628200 | 59ef549c-2a17-4a74-b029-c691971def47 ==============================
[0m23:58:43.628200 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m23:58:43.628200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s calendar_', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:58:43.792890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ef549c-2a17-4a74-b029-c691971def47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192ADDA8340>]}
[0m23:58:43.844983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ef549c-2a17-4a74-b029-c691971def47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192ADDD41F0>]}
[0m23:58:43.845455 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:58:44.086617 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m23:58:44.227610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:58:44.227610 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\calendar_.sql
[0m23:58:44.434036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ef549c-2a17-4a74-b029-c691971def47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B12EF130>]}
[0m23:58:44.512955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:58:44.512955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:58:44.528582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ef549c-2a17-4a74-b029-c691971def47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B12CE910>]}
[0m23:58:44.528582 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m23:58:44.528582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ef549c-2a17-4a74-b029-c691971def47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192ADE2B160>]}
[0m23:58:44.528582 [info ] [MainThread]: 
[0m23:58:44.528582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:44.528582 [info ] [MainThread]: 
[0m23:58:44.528582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:44.544369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:58:44.596015 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:58:44.596015 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:58:44.596015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:44.633902 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m23:58:44.634911 [debug] [ThreadPool]: On list_postgres: Close
[0m23:58:44.640836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m23:58:44.646124 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:58:44.646124 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:58:44.647125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:44.661016 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m23:58:44.672998 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:58:44.672998 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:58:44.677417 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m23:58:44.678934 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:58:44.680414 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:58:44.681515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m23:58:44.683852 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:58:44.683852 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m23:58:44.684882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:44.701177 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m23:58:44.701462 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m23:58:44.701799 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m23:58:44.704797 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m23:58:44.705815 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m23:58:44.706815 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m23:58:44.707801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m23:58:44.711146 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:58:44.711647 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:58:44.712147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:44.719582 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m23:58:44.726134 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:58:44.726633 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:58:44.732256 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m23:58:44.733520 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:58:44.735233 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:58:44.740300 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:44.740300 [debug] [MainThread]: On master: BEGIN
[0m23:58:44.740300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:44.749841 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m23:58:44.757111 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:44.757476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:44.762094 [debug] [MainThread]: SQL status: SELECT 11 in 0.004 seconds
[0m23:58:44.765180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ef549c-2a17-4a74-b029-c691971def47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B13B5D00>]}
[0m23:58:44.765681 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:44.767101 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:44.767638 [debug] [MainThread]: On master: BEGIN
[0m23:58:44.769826 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:58:44.770327 [debug] [MainThread]: On master: COMMIT
[0m23:58:44.770327 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:44.770829 [debug] [MainThread]: On master: COMMIT
[0m23:58:44.771830 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:58:44.772329 [debug] [MainThread]: On master: Close
[0m23:58:44.775684 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m23:58:44.777192 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m23:58:44.778693 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m23:58:44.779191 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m23:58:44.781697 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m23:58:44.781697 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m23:58:44.851304 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m23:58:44.852314 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m23:58:44.852314 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m23:58:44.853310 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:58:44.870632 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m23:58:44.870943 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m23:58:44.871533 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   GENERATE_SERIES(DATE '2020-01-01', DATE '2030-12-31', '1 day') AS day
)
SELECT 
   day
  ,DATE_TRUNC('month', day) AS month
FROM generate_series
  );
[0m23:58:44.877450 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:58:44.881788 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m23:58:44.881788 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m23:58:44.881788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:58:44.895317 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m23:58:44.895317 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m23:58:44.895317 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m23:58:44.895317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m23:58:44.912197 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m23:58:44.912698 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m23:58:44.912698 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m23:58:44.912698 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:58:44.912698 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m23:58:44.912698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ef549c-2a17-4a74-b029-c691971def47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B13B5A00>]}
[0m23:58:44.912698 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:58:44.912698 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m23:58:44.912698 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:44.912698 [debug] [MainThread]: On master: BEGIN
[0m23:58:44.912698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:44.942776 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m23:58:44.942849 [debug] [MainThread]: On master: COMMIT
[0m23:58:44.943358 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:44.943912 [debug] [MainThread]: On master: COMMIT
[0m23:58:44.946135 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:58:44.946847 [debug] [MainThread]: On master: Close
[0m23:58:44.947707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:44.948205 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:58:44.948205 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m23:58:44.948731 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m23:58:44.949205 [info ] [MainThread]: 
[0m23:58:44.950204 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:58:44.951204 [debug] [MainThread]: Command end result
[0m23:58:44.973648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m23:58:44.975637 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m23:58:44.983949 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m23:58:44.984531 [info ] [MainThread]: 
[0m23:58:44.985092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:44.985739 [info ] [MainThread]: 
[0m23:58:44.986374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:58:44.987435 [debug] [MainThread]: Command `dbt run` succeeded at 23:58:44.987435 after 1.41 seconds
[0m23:58:44.987979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AEAB00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B04D4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192ADE70790>]}
[0m23:58:44.988539 [debug] [MainThread]: Flushing usage events
[0m23:58:45.421908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:05.319257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0EF3F00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F1364760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F1364820>]}


============================== 00:00:05.319257 | 6a2325a1-eccb-4db8-aa2b-0a07f006b4b0 ==============================
[0m00:00:05.319257 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m00:00:05.319257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s calendar_', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:05.453935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2325a1-eccb-4db8-aa2b-0a07f006b4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0EE6E5340>]}
[0m00:00:05.502885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a2325a1-eccb-4db8-aa2b-0a07f006b4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0EE7131F0>]}
[0m00:00:05.502885 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:00:05.682398 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m00:00:05.853017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:00:05.853017 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\calendar_.sql
[0m00:00:06.077872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a2325a1-eccb-4db8-aa2b-0a07f006b4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F1C1C130>]}
[0m00:00:06.141137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:00:06.141137 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:00:06.156892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a2325a1-eccb-4db8-aa2b-0a07f006b4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F1C3D640>]}
[0m00:00:06.156892 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m00:00:06.156892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2325a1-eccb-4db8-aa2b-0a07f006b4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F1C1C880>]}
[0m00:00:06.170446 [info ] [MainThread]: 
[0m00:00:06.170446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:06.170446 [info ] [MainThread]: 
[0m00:00:06.170446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:06.170446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:00:06.224224 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:00:06.239796 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:00:06.240184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:06.273384 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m00:00:06.273384 [debug] [ThreadPool]: On list_postgres: Close
[0m00:00:06.291036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m00:00:06.291036 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:00:06.291036 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m00:00:06.291036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:06.317575 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m00:00:06.318575 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:00:06.319122 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m00:00:06.323284 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m00:00:06.324551 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m00:00:06.326350 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m00:00:06.326859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m00:00:06.329863 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:00:06.329863 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:00:06.329863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:06.348085 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m00:00:06.362339 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:00:06.362848 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:00:06.363477 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m00:00:06.363477 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:00:06.363477 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:00:06.363477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m00:00:06.370356 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:00:06.370356 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:00:06.370356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:06.402311 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m00:00:06.402816 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:00:06.403317 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:00:06.407540 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m00:00:06.408559 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:00:06.409540 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:00:06.414061 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.414061 [debug] [MainThread]: On master: BEGIN
[0m00:00:06.414061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:06.430487 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m00:00:06.443393 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.443904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:06.447009 [debug] [MainThread]: SQL status: SELECT 11 in 0.004 seconds
[0m00:00:06.447009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2325a1-eccb-4db8-aa2b-0a07f006b4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F1CF5D00>]}
[0m00:00:06.447009 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:06.447009 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.447009 [debug] [MainThread]: On master: BEGIN
[0m00:00:06.447009 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:00:06.454891 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.455399 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.455399 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.456432 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:00:06.456432 [debug] [MainThread]: On master: Close
[0m00:00:06.459556 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m00:00:06.460159 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m00:00:06.461454 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m00:00:06.462341 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m00:00:06.466837 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m00:00:06.466837 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m00:00:06.532074 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m00:00:06.533080 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:00:06.534095 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m00:00:06.534095 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:00:06.555405 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m00:00:06.560390 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:00:06.560967 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   GENERATE_SERIES(DATE '2023-01-01', DATE '2030-12-31', '1 day') AS day
)
SELECT 
   day
  ,DATE_TRUNC('month', day) AS month
FROM generate_series
  );
[0m00:00:06.560967 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:00:06.560967 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:00:06.560967 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m00:00:06.560967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:06.560967 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:00:06.560967 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m00:00:06.576691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:06.576691 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:00:06.592390 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:00:06.592390 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:00:06.592897 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m00:00:06.592897 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m00:00:06.608237 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:00:06.608237 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m00:00:06.608237 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m00:00:06.608237 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m00:00:06.608237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2325a1-eccb-4db8-aa2b-0a07f006b4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F21415E0>]}
[0m00:00:06.608237 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.15s]
[0m00:00:06.608237 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m00:00:06.608237 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.608237 [debug] [MainThread]: On master: BEGIN
[0m00:00:06.608237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:06.630509 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m00:00:06.639931 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.640434 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.641203 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.642993 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:00:06.643526 [debug] [MainThread]: On master: Close
[0m00:00:06.644437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:06.644937 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:00:06.645437 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m00:00:06.645437 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m00:00:06.645937 [info ] [MainThread]: 
[0m00:00:06.646936 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m00:00:06.648029 [debug] [MainThread]: Command end result
[0m00:00:06.662869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:00:06.662869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:00:06.679051 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m00:00:06.679728 [info ] [MainThread]: 
[0m00:00:06.680349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:06.680938 [info ] [MainThread]: 
[0m00:00:06.681950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:00:06.682952 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:06.682952 after 1.41 seconds
[0m00:00:06.683451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0EF3F00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F1B705E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F0E17A30>]}
[0m00:00:06.683951 [debug] [MainThread]: Flushing usage events
[0m00:00:07.874158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:44.741502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B3A75FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B59E4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B59E4880>]}


============================== 00:11:44.743503 | 925e99d1-c2ef-46bd-8318-f7b34824234f ==============================
[0m00:11:44.743503 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m00:11:44.745416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s calendar_', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:11:44.895892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '925e99d1-c2ef-46bd-8318-f7b34824234f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B233A8B0>]}
[0m00:11:44.931572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '925e99d1-c2ef-46bd-8318-f7b34824234f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B2D8F580>]}
[0m00:11:44.931572 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:11:45.141268 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m00:11:45.300360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:45.301225 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\calendar_.sql
[0m00:11:45.528222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '925e99d1-c2ef-46bd-8318-f7b34824234f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B62AA130>]}
[0m00:11:45.613174 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:11:45.613174 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:11:45.628815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '925e99d1-c2ef-46bd-8318-f7b34824234f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B62D0CD0>]}
[0m00:11:45.628815 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m00:11:45.628815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '925e99d1-c2ef-46bd-8318-f7b34824234f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B59B2DF0>]}
[0m00:11:45.628815 [info ] [MainThread]: 
[0m00:11:45.636138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:45.636583 [info ] [MainThread]: 
[0m00:11:45.637770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:11:45.639778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:11:45.723422 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:11:45.723422 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:11:45.724423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:45.749723 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.027 seconds
[0m00:11:45.751735 [debug] [ThreadPool]: On list_postgres: Close
[0m00:11:45.755837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m00:11:45.755837 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:11:45.755837 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m00:11:45.755837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:45.785994 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m00:11:45.786811 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:11:45.787086 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m00:11:45.794749 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m00:11:45.796411 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m00:11:45.797412 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m00:11:45.798429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m00:11:45.800430 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:11:45.802439 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:11:45.802439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:45.806046 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:11:45.819659 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:11:45.820159 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:11:45.829490 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m00:11:45.830983 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:11:45.830983 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:11:45.833446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m00:11:45.835923 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:11:45.835923 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:11:45.835923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:45.865569 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m00:11:45.867340 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:11:45.867847 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:11:45.874887 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m00:11:45.876377 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:11:45.877969 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:11:45.883048 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:45.883048 [debug] [MainThread]: On master: BEGIN
[0m00:11:45.883048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:45.899965 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m00:11:45.911631 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:45.911631 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:11:45.915810 [debug] [MainThread]: SQL status: SELECT 11 in 0.012 seconds
[0m00:11:45.915810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '925e99d1-c2ef-46bd-8318-f7b34824234f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B5843880>]}
[0m00:11:45.915810 [debug] [MainThread]: On master: ROLLBACK
[0m00:11:45.915810 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:45.915810 [debug] [MainThread]: On master: BEGIN
[0m00:11:45.932065 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:11:45.932845 [debug] [MainThread]: On master: COMMIT
[0m00:11:45.933369 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:45.933369 [debug] [MainThread]: On master: COMMIT
[0m00:11:45.935366 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:11:45.935865 [debug] [MainThread]: On master: Close
[0m00:11:45.938866 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m00:11:45.939366 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m00:11:45.940866 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m00:11:45.940866 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m00:11:45.949074 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m00:11:45.951191 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m00:11:46.016107 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m00:11:46.016107 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:11:46.016107 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m00:11:46.016107 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:11:46.048708 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m00:11:46.049761 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:11:46.050209 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day') AS day
)
SELECT 
   day
  ,DATE_TRUNC('month', day) AS month
FROM generate_series
  );
[0m00:11:46.056725 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m00:11:46.060801 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:11:46.060801 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m00:11:46.060801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:11:46.066039 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:11:46.066039 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m00:11:46.066039 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:11:46.081778 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:11:46.081778 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:11:46.081778 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:11:46.105915 [debug] [Thread-1  ]: SQL status: COMMIT in 0.023 seconds
[0m00:11:46.105915 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m00:11:46.105915 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:11:46.105915 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m00:11:46.121823 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m00:11:46.122711 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m00:11:46.122711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '925e99d1-c2ef-46bd-8318-f7b34824234f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B67D2550>]}
[0m00:11:46.122711 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m00:11:46.122711 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m00:11:46.122711 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:46.122711 [debug] [MainThread]: On master: BEGIN
[0m00:11:46.122711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:46.157237 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m00:11:46.157967 [debug] [MainThread]: On master: COMMIT
[0m00:11:46.158280 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:46.158782 [debug] [MainThread]: On master: COMMIT
[0m00:11:46.160279 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:11:46.160863 [debug] [MainThread]: On master: Close
[0m00:11:46.161359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:46.161777 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:11:46.162277 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m00:11:46.162277 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m00:11:46.162778 [info ] [MainThread]: 
[0m00:11:46.163778 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m00:11:46.164777 [debug] [MainThread]: Command end result
[0m00:11:46.189296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:11:46.190325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:11:46.196560 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m00:11:46.196560 [info ] [MainThread]: 
[0m00:11:46.196560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:11:46.200288 [info ] [MainThread]: 
[0m00:11:46.200633 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:11:46.202786 [debug] [MainThread]: Command `dbt run` succeeded at 00:11:46.202786 after 1.51 seconds
[0m00:11:46.203811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B3A75FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B62D0BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B4E27610>]}
[0m00:11:46.204819 [debug] [MainThread]: Flushing usage events
[0m00:11:47.402381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:03.016098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A59372040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5B2D4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5B2D4850>]}


============================== 00:12:03.016098 | 106acc42-d658-485a-8788-e0936f0a609e ==============================
[0m00:12:03.016098 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m00:12:03.032670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s calendar_', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:12:03.184737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '106acc42-d658-485a-8788-e0936f0a609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5869EF10>]}
[0m00:12:03.234586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '106acc42-d658-485a-8788-e0936f0a609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A58669310>]}
[0m00:12:03.234586 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:12:03.396680 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m00:12:03.536021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:03.536021 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\calendar_.sql
[0m00:12:03.745202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '106acc42-d658-485a-8788-e0936f0a609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5BB9A130>]}
[0m00:12:03.823638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:12:03.825595 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:12:03.841602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '106acc42-d658-485a-8788-e0936f0a609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5B649B80>]}
[0m00:12:03.841602 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m00:12:03.841602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '106acc42-d658-485a-8788-e0936f0a609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5B63AAC0>]}
[0m00:12:03.841602 [info ] [MainThread]: 
[0m00:12:03.841602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:03.841602 [info ] [MainThread]: 
[0m00:12:03.846549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:12:03.846549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:12:03.901991 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:12:03.901991 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:12:03.901991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:03.939492 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.026 seconds
[0m00:12:03.940490 [debug] [ThreadPool]: On list_postgres: Close
[0m00:12:03.946498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m00:12:03.951490 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:12:03.951672 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:12:03.951672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:03.965661 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:12:03.968845 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:12:03.969247 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:12:03.969247 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m00:12:03.969247 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:12:03.975202 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:12:03.975700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m00:12:03.975700 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:12:03.975700 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m00:12:03.975700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:03.992217 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m00:12:04.005682 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:12:04.005982 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m00:12:04.009498 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m00:12:04.010498 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m00:12:04.011486 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m00:12:04.012483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m00:12:04.014484 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:12:04.014484 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:12:04.015982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:04.045728 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m00:12:04.046441 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:12:04.047053 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:12:04.051949 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m00:12:04.054443 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:12:04.056075 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:12:04.057776 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:04.057776 [debug] [MainThread]: On master: BEGIN
[0m00:12:04.057776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:04.081982 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m00:12:04.096145 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:04.096664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:12:04.106373 [debug] [MainThread]: SQL status: SELECT 11 in 0.009 seconds
[0m00:12:04.108379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '106acc42-d658-485a-8788-e0936f0a609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5B13BD60>]}
[0m00:12:04.109378 [debug] [MainThread]: On master: ROLLBACK
[0m00:12:04.110423 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:04.111477 [debug] [MainThread]: On master: BEGIN
[0m00:12:04.113423 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:12:04.114177 [debug] [MainThread]: On master: COMMIT
[0m00:12:04.114280 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:04.114612 [debug] [MainThread]: On master: COMMIT
[0m00:12:04.116111 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:12:04.116635 [debug] [MainThread]: On master: Close
[0m00:12:04.119673 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m00:12:04.120756 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m00:12:04.121813 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m00:12:04.121813 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m00:12:04.125109 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m00:12:04.125109 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m00:12:04.191278 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m00:12:04.192263 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:04.193182 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m00:12:04.193182 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:12:04.225971 [debug] [Thread-1  ]: SQL status: BEGIN in 0.036 seconds
[0m00:12:04.229896 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:04.230372 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day') AS day
)
SELECT 
   DATE(day)
  ,DATE_TRUNC('month', day) AS month
FROM generate_series
  );
[0m00:12:04.234540 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:12:04.240626 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:04.240626 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m00:12:04.240626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:12:04.240626 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:04.240626 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m00:12:04.246377 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:12:04.246377 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:12:04.246377 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:04.246377 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:12:04.262255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m00:12:04.265944 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m00:12:04.265944 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:04.265944 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m00:12:04.275629 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m00:12:04.275629 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m00:12:04.275629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '106acc42-d658-485a-8788-e0936f0a609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5C0C2580>]}
[0m00:12:04.275629 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.15s]
[0m00:12:04.275629 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m00:12:04.275629 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:04.275629 [debug] [MainThread]: On master: BEGIN
[0m00:12:04.275629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:04.301528 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:12:04.307417 [debug] [MainThread]: On master: COMMIT
[0m00:12:04.307417 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:04.308026 [debug] [MainThread]: On master: COMMIT
[0m00:12:04.309434 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:12:04.309951 [debug] [MainThread]: On master: Close
[0m00:12:04.310454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:04.310935 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:12:04.311456 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m00:12:04.311953 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m00:12:04.312453 [info ] [MainThread]: 
[0m00:12:04.312453 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:12:04.312453 [debug] [MainThread]: Command end result
[0m00:12:04.336267 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:12:04.336267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:12:04.336267 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m00:12:04.336267 [info ] [MainThread]: 
[0m00:12:04.336267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:12:04.336267 [info ] [MainThread]: 
[0m00:12:04.336267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:12:04.336267 [debug] [MainThread]: Command `dbt run` succeeded at 00:12:04.336267 after 1.37 seconds
[0m00:12:04.336267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A59372040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A596F2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5ADFE250>]}
[0m00:12:04.336267 [debug] [MainThread]: Flushing usage events
[0m00:12:04.794417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:29.793885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023873F51040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023875EB4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023875EB4850>]}


============================== 00:12:29.793885 | 42dd0513-8d14-4778-9cfb-7b83f523633a ==============================
[0m00:12:29.793885 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m00:12:29.793885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s calendar_', 'send_anonymous_usage_stats': 'True'}
[0m00:12:29.948259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42dd0513-8d14-4778-9cfb-7b83f523633a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387326C250>]}
[0m00:12:29.991341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42dd0513-8d14-4778-9cfb-7b83f523633a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023873238310>]}
[0m00:12:29.991341 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:12:30.163766 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m00:12:30.315954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:30.315954 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\calendar_.sql
[0m00:12:30.527624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42dd0513-8d14-4778-9cfb-7b83f523633a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023876779130>]}
[0m00:12:30.607653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:12:30.607653 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:12:30.626820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42dd0513-8d14-4778-9cfb-7b83f523633a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023876229B80>]}
[0m00:12:30.626820 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m00:12:30.626820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42dd0513-8d14-4778-9cfb-7b83f523633a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387621AAC0>]}
[0m00:12:30.626820 [info ] [MainThread]: 
[0m00:12:30.636020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:30.636020 [info ] [MainThread]: 
[0m00:12:30.636020 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:12:30.636020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:12:30.700312 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:12:30.700312 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:12:30.700312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:30.727643 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.024 seconds
[0m00:12:30.728677 [debug] [ThreadPool]: On list_postgres: Close
[0m00:12:30.734096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m00:12:30.739997 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:12:30.739997 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:12:30.739997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:30.755912 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m00:12:30.756688 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:12:30.757067 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:12:30.760576 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m00:12:30.762095 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:12:30.763076 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:12:30.763793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m00:12:30.767537 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:12:30.767537 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m00:12:30.767537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:30.767537 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m00:12:30.781826 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:12:30.782273 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m00:12:30.782716 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m00:12:30.786420 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m00:12:30.786420 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m00:12:30.786420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m00:12:30.786420 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:12:30.786420 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:12:30.786420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:30.806046 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:12:30.815369 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:12:30.815809 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:12:30.820242 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m00:12:30.821734 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:12:30.823235 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:12:30.829800 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:30.830342 [debug] [MainThread]: On master: BEGIN
[0m00:12:30.830342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:30.846454 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m00:12:30.846825 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:30.847156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:12:30.852032 [debug] [MainThread]: SQL status: SELECT 11 in 0.004 seconds
[0m00:12:30.854511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42dd0513-8d14-4778-9cfb-7b83f523633a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023875D1BD60>]}
[0m00:12:30.855136 [debug] [MainThread]: On master: ROLLBACK
[0m00:12:30.856191 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:30.856719 [debug] [MainThread]: On master: BEGIN
[0m00:12:30.859106 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:12:30.859335 [debug] [MainThread]: On master: COMMIT
[0m00:12:30.859740 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:30.859740 [debug] [MainThread]: On master: COMMIT
[0m00:12:30.861235 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:12:30.861235 [debug] [MainThread]: On master: Close
[0m00:12:30.865526 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m00:12:30.866747 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m00:12:30.868236 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m00:12:30.868736 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m00:12:30.874741 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m00:12:30.875741 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m00:12:30.940483 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m00:12:30.941572 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:30.942480 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m00:12:30.942480 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:12:30.961256 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m00:12:30.961801 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:30.961801 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE_TRUNC('month', day) AS month
FROM generate_series
  );
[0m00:12:30.962301 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m00:12:30.966603 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:30.966603 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m00:12:30.966603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:12:30.966603 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:30.966603 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m00:12:30.966603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:12:30.982475 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:12:30.982475 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:30.982475 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:12:30.999133 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m00:12:30.999133 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m00:12:31.006179 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:31.006179 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m00:12:31.006179 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m00:12:31.006179 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m00:12:31.006179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42dd0513-8d14-4778-9cfb-7b83f523633a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023876855AF0>]}
[0m00:12:31.006179 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m00:12:31.022033 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m00:12:31.022033 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:31.022033 [debug] [MainThread]: On master: BEGIN
[0m00:12:31.022033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:31.027116 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:12:31.042722 [debug] [MainThread]: On master: COMMIT
[0m00:12:31.043147 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:31.043577 [debug] [MainThread]: On master: COMMIT
[0m00:12:31.044801 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:12:31.045674 [debug] [MainThread]: On master: Close
[0m00:12:31.046481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:31.046481 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:12:31.047579 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m00:12:31.047579 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m00:12:31.047579 [info ] [MainThread]: 
[0m00:12:31.049039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m00:12:31.050310 [debug] [MainThread]: Command end result
[0m00:12:31.072553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:12:31.072553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:12:31.072553 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m00:12:31.072553 [info ] [MainThread]: 
[0m00:12:31.072553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:12:31.082289 [info ] [MainThread]: 
[0m00:12:31.082792 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:12:31.085276 [debug] [MainThread]: Command `dbt run` succeeded at 00:12:31.085276 after 1.33 seconds
[0m00:12:31.085276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023873F51040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023875306F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023876798FA0>]}
[0m00:12:31.086276 [debug] [MainThread]: Flushing usage events
[0m00:12:32.233695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:50.447103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE644C10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66434760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66434820>]}


============================== 00:12:50.447103 | 0318e1a1-d875-471f-b8e8-8da8f93f141a ==============================
[0m00:12:50.447103 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m00:12:50.447103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s calendar_', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:12:50.596408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0318e1a1-d875-471f-b8e8-8da8f93f141a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE637A6340>]}
[0m00:12:50.646812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0318e1a1-d875-471f-b8e8-8da8f93f141a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE637D4040>]}
[0m00:12:50.646812 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:12:50.806192 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m00:12:50.948334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:50.948334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:50.979843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0318e1a1-d875-471f-b8e8-8da8f93f141a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66B3E130>]}
[0m00:12:51.054715 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:12:51.054715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:12:51.070343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0318e1a1-d875-471f-b8e8-8da8f93f141a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66B3F7C0>]}
[0m00:12:51.070343 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m00:12:51.070343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0318e1a1-d875-471f-b8e8-8da8f93f141a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66B5F280>]}
[0m00:12:51.070343 [info ] [MainThread]: 
[0m00:12:51.070343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:51.070343 [info ] [MainThread]: 
[0m00:12:51.070343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:12:51.070343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:12:51.148761 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:12:51.148761 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:12:51.148761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:51.185851 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.036 seconds
[0m00:12:51.185851 [debug] [ThreadPool]: On list_postgres: Close
[0m00:12:51.185851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m00:12:51.197740 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:12:51.197740 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:12:51.197740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:51.222862 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:12:51.225187 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:12:51.225746 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:12:51.226179 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m00:12:51.226179 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:12:51.226179 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:12:51.226179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m00:12:51.226179 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:12:51.226179 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:12:51.226179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:51.250464 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:12:51.250768 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:12:51.251286 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:12:51.256259 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m00:12:51.257286 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:12:51.259285 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:12:51.259785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m00:12:51.261790 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:12:51.261790 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m00:12:51.261790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:51.279995 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m00:12:51.280282 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:12:51.280648 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m00:12:51.284529 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m00:12:51.285795 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m00:12:51.287029 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m00:12:51.291597 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.291597 [debug] [MainThread]: On master: BEGIN
[0m00:12:51.291597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:51.305894 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m00:12:51.312012 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.312346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:12:51.312855 [debug] [MainThread]: SQL status: SELECT 11 in 0.004 seconds
[0m00:12:51.312855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0318e1a1-d875-471f-b8e8-8da8f93f141a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE662847C0>]}
[0m00:12:51.312855 [debug] [MainThread]: On master: ROLLBACK
[0m00:12:51.312855 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.312855 [debug] [MainThread]: On master: BEGIN
[0m00:12:51.312855 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:12:51.325620 [debug] [MainThread]: On master: COMMIT
[0m00:12:51.326131 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.326131 [debug] [MainThread]: On master: COMMIT
[0m00:12:51.328137 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:12:51.328733 [debug] [MainThread]: On master: Close
[0m00:12:51.336434 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m00:12:51.336434 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m00:12:51.336434 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m00:12:51.336434 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m00:12:51.343685 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m00:12:51.343685 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m00:12:51.363536 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m00:12:51.363536 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:51.363536 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m00:12:51.363536 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:12:51.379787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m00:12:51.395897 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:51.396384 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE_TRUNC('month', day) AS month
FROM generate_series
  );
[0m00:12:51.399073 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:12:51.404711 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:51.405240 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m00:12:51.406507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:12:51.406507 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:51.406507 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m00:12:51.411212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:12:51.411753 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:12:51.411753 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:51.411753 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:12:51.429206 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m00:12:51.429206 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m00:12:51.429206 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:12:51.429206 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m00:12:51.444876 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m00:12:51.444876 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m00:12:51.448745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0318e1a1-d875-471f-b8e8-8da8f93f141a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE62D46550>]}
[0m00:12:51.448745 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m00:12:51.448745 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m00:12:51.448745 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.448745 [debug] [MainThread]: On master: BEGIN
[0m00:12:51.448745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:51.471213 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:12:51.471748 [debug] [MainThread]: On master: COMMIT
[0m00:12:51.471748 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.472288 [debug] [MainThread]: On master: COMMIT
[0m00:12:51.472288 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:12:51.472288 [debug] [MainThread]: On master: Close
[0m00:12:51.472288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:51.472288 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:12:51.472288 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m00:12:51.472288 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m00:12:51.472288 [info ] [MainThread]: 
[0m00:12:51.476264 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m00:12:51.476264 [debug] [MainThread]: Command end result
[0m00:12:51.492639 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:12:51.492639 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:12:51.492639 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m00:12:51.492639 [info ] [MainThread]: 
[0m00:12:51.492639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:12:51.509025 [info ] [MainThread]: 
[0m00:12:51.509814 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:12:51.509814 [debug] [MainThread]: Command `dbt run` succeeded at 00:12:51.509814 after 1.10 seconds
[0m00:12:51.509814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE644C10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE658430A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65830490>]}
[0m00:12:51.509814 [debug] [MainThread]: Flushing usage events
[0m00:12:51.959458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:13:09.639351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B9200040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BB164910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BB164850>]}


============================== 00:13:09.647177 | b346cc59-da72-4525-8619-66543ea5779d ==============================
[0m00:13:09.647177 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m00:13:09.647177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s calendar_', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:13:09.778100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b346cc59-da72-4525-8619-66543ea5779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B852C250>]}
[0m00:13:09.836383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b346cc59-da72-4525-8619-66543ea5779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B84F9310>]}
[0m00:13:09.836383 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:13:10.012762 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m00:13:10.144911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:10.144911 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\calendar_.sql
[0m00:13:10.363394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b346cc59-da72-4525-8619-66543ea5779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BBA28130>]}
[0m00:13:10.436404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:13:10.436404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:13:10.447522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b346cc59-da72-4525-8619-66543ea5779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BB4D8B80>]}
[0m00:13:10.447522 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m00:13:10.447522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b346cc59-da72-4525-8619-66543ea5779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BB4C9AC0>]}
[0m00:13:10.463453 [info ] [MainThread]: 
[0m00:13:10.464104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:10.464104 [info ] [MainThread]: 
[0m00:13:10.464104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:13:10.464104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:13:10.531413 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:13:10.531413 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:13:10.531413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:10.559204 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m00:13:10.560318 [debug] [ThreadPool]: On list_postgres: Close
[0m00:13:10.566181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m00:13:10.571175 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:13:10.572176 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:13:10.572176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:10.581218 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:13:10.589168 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:13:10.589430 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:13:10.592941 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m00:13:10.594124 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:13:10.595718 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:13:10.596559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m00:13:10.600067 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:13:10.600568 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m00:13:10.600568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:10.600568 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m00:13:10.614212 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m00:13:10.614396 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m00:13:10.614396 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m00:13:10.614396 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m00:13:10.614396 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m00:13:10.614396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m00:13:10.614396 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:13:10.614396 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:13:10.614396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:10.637145 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m00:13:10.639794 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:13:10.639794 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:13:10.643300 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m00:13:10.644319 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:13:10.645300 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:13:10.650820 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:10.650820 [debug] [MainThread]: On master: BEGIN
[0m00:13:10.650820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:13:10.676428 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m00:13:10.686189 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:10.686583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:13:10.686583 [debug] [MainThread]: SQL status: SELECT 11 in 0.003 seconds
[0m00:13:10.686583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b346cc59-da72-4525-8619-66543ea5779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BAFCBD60>]}
[0m00:13:10.686583 [debug] [MainThread]: On master: ROLLBACK
[0m00:13:10.686583 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:10.686583 [debug] [MainThread]: On master: BEGIN
[0m00:13:10.696550 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:13:10.697051 [debug] [MainThread]: On master: COMMIT
[0m00:13:10.698047 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:10.698047 [debug] [MainThread]: On master: COMMIT
[0m00:13:10.700101 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:13:10.700446 [debug] [MainThread]: On master: Close
[0m00:13:10.703302 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m00:13:10.703929 [info ] [Thread-1  ]: 1 of 1 START sql view model public.calendar_ ................................... [RUN]
[0m00:13:10.704971 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m00:13:10.704971 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m00:13:10.708025 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m00:13:10.708025 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m00:13:10.775975 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m00:13:10.776911 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:13:10.776911 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m00:13:10.777894 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:13:10.797299 [debug] [Thread-1  ]: SQL status: BEGIN in 0.032 seconds
[0m00:13:10.810648 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:13:10.811155 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m00:13:10.813843 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m00:13:10.818889 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:13:10.819397 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m00:13:10.821233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:13:10.821779 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:13:10.821779 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m00:13:10.821779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:13:10.845765 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:13:10.845765 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:13:10.845765 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m00:13:10.845765 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m00:13:10.845765 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m00:13:10.865682 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m00:13:10.865682 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m00:13:10.870689 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m00:13:10.872759 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m00:13:10.874766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b346cc59-da72-4525-8619-66543ea5779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BBB05AF0>]}
[0m00:13:10.875685 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.17s]
[0m00:13:10.876620 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m00:13:10.877733 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:10.877733 [debug] [MainThread]: On master: BEGIN
[0m00:13:10.877733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:13:10.897789 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:13:10.898466 [debug] [MainThread]: On master: COMMIT
[0m00:13:10.898965 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:10.899466 [debug] [MainThread]: On master: COMMIT
[0m00:13:10.901037 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:13:10.901557 [debug] [MainThread]: On master: Close
[0m00:13:10.902060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:10.902539 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:13:10.902539 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m00:13:10.903159 [debug] [MainThread]: Connection 'model.enpal_assessment_project.calendar_' was properly closed.
[0m00:13:10.903542 [info ] [MainThread]: 
[0m00:13:10.904041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m00:13:10.905044 [debug] [MainThread]: Command end result
[0m00:13:10.921529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m00:13:10.921529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m00:13:10.932406 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m00:13:10.932406 [info ] [MainThread]: 
[0m00:13:10.932406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:13:10.932406 [info ] [MainThread]: 
[0m00:13:10.932406 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:13:10.932406 [debug] [MainThread]: Command `dbt run` succeeded at 00:13:10.932406 after 1.34 seconds
[0m00:13:10.932406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B9200040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BA5B6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BBA48FA0>]}
[0m00:13:10.932406 [debug] [MainThread]: Flushing usage events
[0m00:13:11.391099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:29.025858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD51851040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD537C4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD537C47C0>]}


============================== 10:03:29.025858 | a3f58749-0a4a-4c38-bf7f-d055a1d97460 ==============================
[0m10:03:29.025858 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m10:03:29.025858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s t_user_deal_events', 'send_anonymous_usage_stats': 'True'}
[0m10:03:29.256576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3f58749-0a4a-4c38-bf7f-d055a1d97460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5010A790>]}
[0m10:03:29.303559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3f58749-0a4a-4c38-bf7f-d055a1d97460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD52C84910>]}
[0m10:03:29.303559 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:03:29.500764 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m10:03:29.691363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:29.691363 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_user_deal_events.sql
[0m10:03:29.924558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3f58749-0a4a-4c38-bf7f-d055a1d97460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5408F130>]}
[0m10:03:30.004095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:03:30.004095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:03:30.036140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3f58749-0a4a-4c38-bf7f-d055a1d97460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD540B3C70>]}
[0m10:03:30.036140 [info ] [MainThread]: Found 12 models, 6 sources, 428 macros
[0m10:03:30.036140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3f58749-0a4a-4c38-bf7f-d055a1d97460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD540AB220>]}
[0m10:03:30.036140 [info ] [MainThread]: 
[0m10:03:30.036140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:30.036140 [info ] [MainThread]: 
[0m10:03:30.051919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:30.051919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:03:30.186644 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:03:30.186644 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:03:30.186644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:30.246812 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m10:03:30.246812 [debug] [ThreadPool]: On list_postgres: Close
[0m10:03:30.246812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m10:03:30.266072 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:03:30.266072 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m10:03:30.267345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:30.308873 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m10:03:30.309872 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:03:30.310877 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:03:30.323062 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m10:03:30.325271 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m10:03:30.327256 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m10:03:30.329146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m10:03:30.337170 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:03:30.338029 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m10:03:30.338922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:30.365123 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m10:03:30.365622 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:03:30.366623 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m10:03:30.371622 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m10:03:30.373122 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m10:03:30.374623 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m10:03:30.375626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m10:03:30.379625 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:03:30.379625 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:03:30.380212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:30.412124 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m10:03:30.413126 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:03:30.414125 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:03:30.418759 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m10:03:30.421258 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:03:30.422762 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:03:30.431343 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:30.431844 [debug] [MainThread]: On master: BEGIN
[0m10:03:30.432345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:30.454800 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m10:03:30.458744 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:30.459773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:30.469773 [debug] [MainThread]: SQL status: SELECT 11 in 0.009 seconds
[0m10:03:30.473340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3f58749-0a4a-4c38-bf7f-d055a1d97460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5018F9A0>]}
[0m10:03:30.474194 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:30.476273 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:30.476772 [debug] [MainThread]: On master: BEGIN
[0m10:03:30.480290 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:03:30.480931 [debug] [MainThread]: On master: COMMIT
[0m10:03:30.481272 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:30.481775 [debug] [MainThread]: On master: COMMIT
[0m10:03:30.483778 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:03:30.484359 [debug] [MainThread]: On master: Close
[0m10:03:30.492274 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m10:03:30.493281 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m10:03:30.494780 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_user_deal_events'
[0m10:03:30.495279 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m10:03:30.503275 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.505271 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m10:03:30.574725 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.576122 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.576676 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m10:03:30.577314 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:03:30.601748 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m10:03:30.602262 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.602815 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m10:03:30.612455 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:03:30.612455 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.619639 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events" rename to "t_user_deal_events__dbt_backup"
[0m10:03:30.619839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:03:30.619839 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.619839 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m10:03:30.619839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:03:30.636725 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:03:30.636725 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.636725 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:03:30.636725 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m10:03:30.656636 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m10:03:30.660647 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:03:30.660647 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m10:03:30.667795 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.007 seconds
[0m10:03:30.670793 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m10:03:30.670793 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f58749-0a4a-4c38-bf7f-d055a1d97460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5018F9A0>]}
[0m10:03:30.675009 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_crm.t_user_deal_events ................. [[32mCREATE VIEW[0m in 0.18s]
[0m10:03:30.675009 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m10:03:30.675009 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:30.675009 [debug] [MainThread]: On master: BEGIN
[0m10:03:30.675009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:30.706322 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m10:03:30.707938 [debug] [MainThread]: On master: COMMIT
[0m10:03:30.707938 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:30.708498 [debug] [MainThread]: On master: COMMIT
[0m10:03:30.710848 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:03:30.711235 [debug] [MainThread]: On master: Close
[0m10:03:30.711792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:30.712297 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:03:30.712297 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m10:03:30.712835 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_user_deal_events' was properly closed.
[0m10:03:30.712949 [info ] [MainThread]: 
[0m10:03:30.714078 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m10:03:30.715605 [debug] [MainThread]: Command end result
[0m10:03:30.739790 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:03:30.741899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:03:30.745030 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m10:03:30.745030 [info ] [MainThread]: 
[0m10:03:30.745030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:30.745030 [info ] [MainThread]: 
[0m10:03:30.745030 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:03:30.745030 [debug] [MainThread]: Command `dbt run` succeeded at 10:03:30.745030 after 1.77 seconds
[0m10:03:30.745030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD51851040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD52C84910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD51BD30D0>]}
[0m10:03:30.745030 [debug] [MainThread]: Flushing usage events
[0m10:03:31.235874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:53.567967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011674581FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116764F49A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116764F48E0>]}


============================== 18:41:53.567967 | 2a07b52a-8f30-45a1-86f0-6611320dfb08 ==============================
[0m18:41:53.567967 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:41:53.567967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s t_sales_funnel_monthly_columns', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:53.743659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a07b52a-8f30-45a1-86f0-6611320dfb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116738AD040>]}
[0m18:41:53.790553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a07b52a-8f30-45a1-86f0-6611320dfb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116738AD8B0>]}
[0m18:41:53.790553 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:41:53.979376 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m18:41:54.128153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:41:54.128153 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_sales_funnel_monthly_columns.sql
[0m18:41:54.346522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a07b52a-8f30-45a1-86f0-6611320dfb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011676DB4130>]}
[0m18:41:54.414639 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:41:54.414639 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:41:54.461695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a07b52a-8f30-45a1-86f0-6611320dfb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011676DD7C40>]}
[0m18:41:54.461695 [info ] [MainThread]: Found 13 models, 6 sources, 428 macros
[0m18:41:54.461695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a07b52a-8f30-45a1-86f0-6611320dfb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011676D8FF40>]}
[0m18:41:54.461695 [info ] [MainThread]: 
[0m18:41:54.461695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:54.461695 [info ] [MainThread]: 
[0m18:41:54.477702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:54.477702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:41:54.563404 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:41:54.563404 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:41:54.563404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:54.598981 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.038 seconds
[0m18:41:54.598981 [debug] [ThreadPool]: On list_postgres: Close
[0m18:41:54.598981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m18:41:54.598981 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:41:54.598981 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:41:54.598981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:54.629068 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m18:41:54.638452 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:41:54.638886 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:41:54.645833 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m18:41:54.647396 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:41:54.649210 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:41:54.649755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m18:41:54.649755 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:41:54.649755 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:41:54.649755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:54.671753 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m18:41:54.675721 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:41:54.676252 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:41:54.676252 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m18:41:54.676252 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:41:54.676252 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:41:54.676252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m18:41:54.676252 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:41:54.676252 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m18:41:54.676252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:54.709096 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:41:54.709899 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:41:54.710417 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m18:41:54.714910 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m18:41:54.716491 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m18:41:54.718405 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m18:41:54.721515 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:54.721515 [debug] [MainThread]: On master: BEGIN
[0m18:41:54.721515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:54.754886 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m18:41:54.755235 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:54.755749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:54.763745 [debug] [MainThread]: SQL status: SELECT 11 in 0.007 seconds
[0m18:41:54.765451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a07b52a-8f30-45a1-86f0-6611320dfb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011676E119A0>]}
[0m18:41:54.765451 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:54.765451 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:54.769458 [debug] [MainThread]: On master: BEGIN
[0m18:41:54.769458 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m18:41:54.774286 [debug] [MainThread]: On master: COMMIT
[0m18:41:54.774795 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:54.774795 [debug] [MainThread]: On master: COMMIT
[0m18:41:54.776700 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:41:54.777244 [debug] [MainThread]: On master: Close
[0m18:41:54.782929 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:41:54.783613 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_sales_funnel_monthly_columns .......... [RUN]
[0m18:41:54.784640 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_sales_funnel_monthly_columns'
[0m18:41:54.784640 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:41:54.784640 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:41:54.784640 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:41:54.865092 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:41:54.865092 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:41:54.865092 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: BEGIN
[0m18:41:54.865092 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:41:54.881914 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m18:41:54.897764 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:41:54.897764 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events"
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, kpi_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,avg_users_per_deal
  ,conversion_rate -- ignoring [optional] steps
FROM kpi_conversion_rate
-- ORDER BY month, stage_id
  );
[0m18:41:54.902231 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "ud"
LINE 61:       ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN...
                  ^

[0m18:41:54.902708 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: ROLLBACK
[0m18:41:54.905234 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: Close
[0m18:41:54.926414 [debug] [Thread-1  ]: Database Error in model t_sales_funnel_monthly_columns (models\transformations\crm\t_sales_funnel_monthly_columns.sql)
  missing FROM-clause entry for table "ud"
  LINE 61:       ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN...
                    ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_sales_funnel_monthly_columns.sql
[0m18:41:54.928416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a07b52a-8f30-45a1-86f0-6611320dfb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116772D6F70>]}
[0m18:41:54.929503 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public_crm.t_sales_funnel_monthly_columns . [[31mERROR[0m in 0.14s]
[0m18:41:54.931446 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:41:54.931446 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' to be skipped because of status 'error'.  Reason: Database Error in model t_sales_funnel_monthly_columns (models\transformations\crm\t_sales_funnel_monthly_columns.sql)
  missing FROM-clause entry for table "ud"
  LINE 61:       ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN...
                    ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_sales_funnel_monthly_columns.sql.
[0m18:41:54.932742 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:54.932742 [debug] [MainThread]: On master: BEGIN
[0m18:41:54.932742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:54.965832 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:41:54.967036 [debug] [MainThread]: On master: COMMIT
[0m18:41:54.967522 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:54.968040 [debug] [MainThread]: On master: COMMIT
[0m18:41:54.970608 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:41:54.970976 [debug] [MainThread]: On master: Close
[0m18:41:54.971979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:54.972477 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:41:54.972477 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m18:41:54.972982 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' was properly closed.
[0m18:41:54.973481 [info ] [MainThread]: 
[0m18:41:54.974478 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:41:54.975481 [debug] [MainThread]: Command end result
[0m18:41:54.998116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:41:55.001456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:41:55.006765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m18:41:55.006765 [info ] [MainThread]: 
[0m18:41:55.006765 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m18:41:55.006765 [info ] [MainThread]: 
[0m18:41:55.006765 [error] [MainThread]:   Database Error in model t_sales_funnel_monthly_columns (models\transformations\crm\t_sales_funnel_monthly_columns.sql)
  missing FROM-clause entry for table "ud"
  LINE 61:       ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN...
                    ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_sales_funnel_monthly_columns.sql
[0m18:41:55.006765 [info ] [MainThread]: 
[0m18:41:55.006765 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:55.017452 [debug] [MainThread]: Command `dbt run` failed at 18:41:55.017452 after 1.50 seconds
[0m18:41:55.017452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011674581FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001167685AD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001167685A190>]}
[0m18:41:55.018446 [debug] [MainThread]: Flushing usage events
[0m18:41:55.514702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:13.284765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B53C5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7334940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7334880>]}


============================== 18:42:13.284765 | a1321c96-073e-470e-8aee-5242f7243436 ==============================
[0m18:42:13.284765 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:42:13.284765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s t_sales_funnel_monthly_columns', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:42:13.443207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1321c96-073e-470e-8aee-5242f7243436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B3C8A8B0>]}
[0m18:42:13.490525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1321c96-073e-470e-8aee-5242f7243436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B3EE0580>]}
[0m18:42:13.490525 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:42:13.661938 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m18:42:13.804364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:13.804364 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_sales_funnel_monthly_columns.sql
[0m18:42:14.041555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1321c96-073e-470e-8aee-5242f7243436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7C13130>]}
[0m18:42:14.132902 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:42:14.132902 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:42:14.155747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1321c96-073e-470e-8aee-5242f7243436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7BE4130>]}
[0m18:42:14.155747 [info ] [MainThread]: Found 13 models, 6 sources, 428 macros
[0m18:42:14.155747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1321c96-073e-470e-8aee-5242f7243436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7A21940>]}
[0m18:42:14.155747 [info ] [MainThread]: 
[0m18:42:14.155747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:14.155747 [info ] [MainThread]: 
[0m18:42:14.155747 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:42:14.155747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:42:14.265166 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:42:14.270920 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:42:14.271883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:14.299166 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.028 seconds
[0m18:42:14.299166 [debug] [ThreadPool]: On list_postgres: Close
[0m18:42:14.299166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m18:42:14.299166 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:42:14.299166 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m18:42:14.299166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:14.332139 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:42:14.332981 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:42:14.333042 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m18:42:14.337482 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m18:42:14.338562 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m18:42:14.340547 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m18:42:14.341424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m18:42:14.343438 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:42:14.343438 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:42:14.343438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:14.361985 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m18:42:14.367111 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:42:14.367621 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:42:14.372118 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:42:14.373619 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:42:14.375122 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:42:14.376124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m18:42:14.377790 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:42:14.377790 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:42:14.377790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:14.413714 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:42:14.414419 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:42:14.414746 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:42:14.419282 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m18:42:14.420749 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:42:14.422813 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:42:14.424563 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:14.424563 [debug] [MainThread]: On master: BEGIN
[0m18:42:14.429770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:42:14.461569 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:42:14.462070 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:14.462572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:42:14.467636 [debug] [MainThread]: SQL status: SELECT 11 in 0.004 seconds
[0m18:42:14.470216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1321c96-073e-470e-8aee-5242f7243436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7CC6E20>]}
[0m18:42:14.470708 [debug] [MainThread]: On master: ROLLBACK
[0m18:42:14.472617 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:14.472617 [debug] [MainThread]: On master: BEGIN
[0m18:42:14.473112 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:42:14.476075 [debug] [MainThread]: On master: COMMIT
[0m18:42:14.476595 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:14.476957 [debug] [MainThread]: On master: COMMIT
[0m18:42:14.479151 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:42:14.479671 [debug] [MainThread]: On master: Close
[0m18:42:14.485403 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:42:14.486309 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_sales_funnel_monthly_columns .......... [RUN]
[0m18:42:14.487887 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_sales_funnel_monthly_columns'
[0m18:42:14.487887 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:42:14.498833 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:42:14.501821 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:42:14.565402 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:42:14.565402 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:42:14.565402 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: BEGIN
[0m18:42:14.565402 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:42:14.595972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m18:42:14.596968 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:42:14.597472 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, kpi_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,avg_users_per_deal
  ,conversion_rate -- ignoring [optional] steps
FROM kpi_conversion_rate
-- ORDER BY month, stage_id
  );
[0m18:42:14.615265 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.017 seconds
[0m18:42:14.616394 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:42:14.616394 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp" rename to "t_sales_funnel_monthly_columns"
[0m18:42:14.616394 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:42:14.639647 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m18:42:14.639647 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:42:14.639647 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m18:42:14.639647 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m18:42:14.653567 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup"
[0m18:42:14.659587 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:42:14.659587 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup" cascade
[0m18:42:14.662684 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m18:42:14.664076 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: Close
[0m18:42:14.668528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1321c96-073e-470e-8aee-5242f7243436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B8121A60>]}
[0m18:42:14.671428 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_crm.t_sales_funnel_monthly_columns ..... [[32mCREATE VIEW[0m in 0.18s]
[0m18:42:14.672679 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:42:14.672679 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:14.672679 [debug] [MainThread]: On master: BEGIN
[0m18:42:14.672679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:42:14.705473 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:42:14.706165 [debug] [MainThread]: On master: COMMIT
[0m18:42:14.706663 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:14.706663 [debug] [MainThread]: On master: COMMIT
[0m18:42:14.708165 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:42:14.708663 [debug] [MainThread]: On master: Close
[0m18:42:14.709164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:14.709664 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:42:14.710165 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m18:42:14.710165 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' was properly closed.
[0m18:42:14.710666 [info ] [MainThread]: 
[0m18:42:14.711667 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m18:42:14.713015 [debug] [MainThread]: Command end result
[0m18:42:14.734460 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:42:14.734460 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:42:14.734460 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m18:42:14.734460 [info ] [MainThread]: 
[0m18:42:14.734460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:14.747303 [info ] [MainThread]: 
[0m18:42:14.747986 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:42:14.749515 [debug] [MainThread]: Command `dbt run` succeeded at 18:42:14.749515 after 1.51 seconds
[0m18:42:14.749515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B53C5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B501AAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B80200A0>]}
[0m18:42:14.750648 [debug] [MainThread]: Flushing usage events
[0m18:42:15.180886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:58.157741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025742E81040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025744DF4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025744DF47C0>]}


============================== 18:43:58.157741 | 9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16 ==============================
[0m18:43:58.157741 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:43:58.157741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s t_sales_funnel_monthly_rows', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:43:58.320452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257421AEF10>]}
[0m18:43:58.358150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025742178310>]}
[0m18:43:58.358150 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:43:58.578392 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m18:43:58.705088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:43:58.705088 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformations\crm\t_sales_funnel_monthly_rows.sql
[0m18:43:58.942758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257456CBEB0>]}
[0m18:43:59.022336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:43:59.022336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:43:59.038320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002574565CCA0>]}
[0m18:43:59.038320 [info ] [MainThread]: Found 14 models, 6 sources, 428 macros
[0m18:43:59.038320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002574535F310>]}
[0m18:43:59.038320 [info ] [MainThread]: 
[0m18:43:59.038320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:59.038320 [info ] [MainThread]: 
[0m18:43:59.038320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:59.038320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:43:59.117600 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:43:59.118614 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:43:59.118614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:59.158183 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m18:43:59.158751 [debug] [ThreadPool]: On list_postgres: Close
[0m18:43:59.161989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m18:43:59.161989 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:43:59.161989 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m18:43:59.161989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:59.178988 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m18:43:59.194206 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:43:59.194708 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m18:43:59.199204 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m18:43:59.200704 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m18:43:59.202205 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m18:43:59.203269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m18:43:59.205293 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:43:59.205293 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:43:59.205293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:59.221897 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m18:43:59.228821 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:43:59.229463 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:43:59.233692 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m18:43:59.235191 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:43:59.237198 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:43:59.237691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m18:43:59.239691 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:43:59.239691 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:43:59.239691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:59.261013 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:43:59.261694 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:43:59.262726 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:43:59.267522 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:43:59.269015 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:43:59.271013 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:43:59.273613 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.273613 [debug] [MainThread]: On master: BEGIN
[0m18:43:59.273613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:59.292597 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m18:43:59.300342 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.300809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:59.305841 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m18:43:59.309927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025744C4BD60>]}
[0m18:43:59.310539 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:59.311149 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.311149 [debug] [MainThread]: On master: BEGIN
[0m18:43:59.311149 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:43:59.316822 [debug] [MainThread]: On master: COMMIT
[0m18:43:59.316822 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.317472 [debug] [MainThread]: On master: COMMIT
[0m18:43:59.318835 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:43:59.319420 [debug] [MainThread]: On master: Close
[0m18:43:59.324829 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:43:59.326332 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_sales_funnel_monthly_rows ............. [RUN]
[0m18:43:59.327376 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows'
[0m18:43:59.327920 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:43:59.377527 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:43:59.378457 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:43:59.407311 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:43:59.408747 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:43:59.408747 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m18:43:59.408747 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:43:59.430778 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m18:43:59.431951 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:43:59.432968 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, kpi_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m18:43:59.436967 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "funnel_with_conversion_rate" does not exist
LINE 113: FROM funnel_with_conversion_rate
               ^

[0m18:43:59.437956 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: ROLLBACK
[0m18:43:59.439458 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m18:43:59.444459 [debug] [Thread-1  ]: Database Error in model t_sales_funnel_monthly_rows (models\transformations\crm\t_sales_funnel_monthly_rows.sql)
  relation "funnel_with_conversion_rate" does not exist
  LINE 113: FROM funnel_with_conversion_rate
                 ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_sales_funnel_monthly_rows.sql
[0m18:43:59.446945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b00bbc5-5fe0-4194-9b72-cd0a7a8fdb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025742217490>]}
[0m18:43:59.447462 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public_crm.t_sales_funnel_monthly_rows .... [[31mERROR[0m in 0.12s]
[0m18:43:59.448983 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:43:59.450369 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' to be skipped because of status 'error'.  Reason: Database Error in model t_sales_funnel_monthly_rows (models\transformations\crm\t_sales_funnel_monthly_rows.sql)
  relation "funnel_with_conversion_rate" does not exist
  LINE 113: FROM funnel_with_conversion_rate
                 ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_sales_funnel_monthly_rows.sql.
[0m18:43:59.451984 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.452484 [debug] [MainThread]: On master: BEGIN
[0m18:43:59.452484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:59.476041 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m18:43:59.486859 [debug] [MainThread]: On master: COMMIT
[0m18:43:59.487432 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.487432 [debug] [MainThread]: On master: COMMIT
[0m18:43:59.489512 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:43:59.490361 [debug] [MainThread]: On master: Close
[0m18:43:59.491094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:59.491694 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:43:59.492191 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m18:43:59.492802 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' was properly closed.
[0m18:43:59.493198 [info ] [MainThread]: 
[0m18:43:59.494190 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m18:43:59.495929 [debug] [MainThread]: Command end result
[0m18:43:59.512561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:43:59.512561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:43:59.530189 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m18:43:59.530189 [info ] [MainThread]: 
[0m18:43:59.531317 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m18:43:59.532811 [info ] [MainThread]: 
[0m18:43:59.533823 [error] [MainThread]:   Database Error in model t_sales_funnel_monthly_rows (models\transformations\crm\t_sales_funnel_monthly_rows.sql)
  relation "funnel_with_conversion_rate" does not exist
  LINE 113: FROM funnel_with_conversion_rate
                 ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_sales_funnel_monthly_rows.sql
[0m18:43:59.534932 [info ] [MainThread]: 
[0m18:43:59.534932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:43:59.537041 [debug] [MainThread]: Command `dbt run` failed at 18:43:59.537041 after 1.43 seconds
[0m18:43:59.538136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025742E81040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002574565CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257421EDAF0>]}
[0m18:43:59.538136 [debug] [MainThread]: Flushing usage events
[0m18:44:00.008212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:37.683049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014324191070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014326104700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143261047C0>]}


============================== 18:44:37.683049 | c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b ==============================
[0m18:44:37.683049 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:44:37.683049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s t_sales_funnel_monthly_columns', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:37.854236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143260E33D0>]}
[0m18:44:37.899039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014325F5B7F0>]}
[0m18:44:37.899039 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:44:38.100884 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m18:44:38.245558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:38.245558 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_sales_funnel_monthly_columns.sql
[0m18:44:38.464640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143269DCEB0>]}
[0m18:44:38.543693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:44:38.543693 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:44:38.559428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143269F9130>]}
[0m18:44:38.559428 [info ] [MainThread]: Found 14 models, 6 sources, 428 macros
[0m18:44:38.559428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143269614F0>]}
[0m18:44:38.559428 [info ] [MainThread]: 
[0m18:44:38.559428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:38.559428 [info ] [MainThread]: 
[0m18:44:38.559428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:38.559428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:44:38.642675 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:44:38.643760 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:44:38.643760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:38.671827 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.028 seconds
[0m18:44:38.673094 [debug] [ThreadPool]: On list_postgres: Close
[0m18:44:38.673094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:44:38.673094 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:44:38.673094 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:44:38.673094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:38.689563 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m18:44:38.704801 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:44:38.705608 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:44:38.710606 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m18:44:38.712204 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:44:38.714051 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:44:38.714670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m18:44:38.715771 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:44:38.715771 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:44:38.715771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:38.755977 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m18:44:38.756752 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:44:38.756752 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:44:38.761981 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:44:38.763554 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:44:38.765244 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:44:38.766345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m18:44:38.767488 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:44:38.767488 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m18:44:38.767488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:38.789110 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:44:38.790112 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:44:38.790975 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m18:44:38.795597 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m18:44:38.797514 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m18:44:38.799252 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m18:44:38.804606 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:38.804606 [debug] [MainThread]: On master: BEGIN
[0m18:44:38.804606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:38.822502 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m18:44:38.835930 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:38.836465 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:38.842507 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m18:44:38.846049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014323D93670>]}
[0m18:44:38.846553 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:38.846997 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:38.846997 [debug] [MainThread]: On master: BEGIN
[0m18:44:38.851478 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:44:38.851977 [debug] [MainThread]: On master: COMMIT
[0m18:44:38.852477 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:38.852477 [debug] [MainThread]: On master: COMMIT
[0m18:44:38.854906 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:44:38.855417 [debug] [MainThread]: On master: Close
[0m18:44:38.860784 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:44:38.861443 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_sales_funnel_monthly_columns .......... [RUN]
[0m18:44:38.862678 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_sales_funnel_monthly_columns'
[0m18:44:38.863186 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:44:38.910688 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:38.911591 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:44:38.939740 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:38.939740 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:38.939740 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: BEGIN
[0m18:44:38.939740 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:44:38.978844 [debug] [Thread-1  ]: SQL status: BEGIN in 0.035 seconds
[0m18:44:38.980000 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:38.980497 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,avg_users_per_deal
  ,conversion_rate -- ignoring [optional] steps
FROM funnel_with_conversion_rate
-- ORDER BY month, stage_id
  );
[0m18:44:38.987317 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:44:38.990799 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:38.990799 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_columns" rename to "t_sales_funnel_monthly_columns__dbt_backup"
[0m18:44:38.995432 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:44:38.995432 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:38.995432 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp" rename to "t_sales_funnel_monthly_columns"
[0m18:44:38.995432 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:44:39.012066 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m18:44:39.012066 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:39.012066 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m18:44:39.012066 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m18:44:39.027799 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup"
[0m18:44:39.027799 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m18:44:39.027799 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup" cascade
[0m18:44:39.027799 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.006 seconds
[0m18:44:39.043415 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: Close
[0m18:44:39.043415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c749e4ff-1fc6-4d48-a8fa-b8f16e05ad7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014325F5B040>]}
[0m18:44:39.043415 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_crm.t_sales_funnel_monthly_columns ..... [[32mCREATE VIEW[0m in 0.18s]
[0m18:44:39.043415 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m18:44:39.043415 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:39.043415 [debug] [MainThread]: On master: BEGIN
[0m18:44:39.043415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:39.074413 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m18:44:39.076037 [debug] [MainThread]: On master: COMMIT
[0m18:44:39.076519 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:39.077128 [debug] [MainThread]: On master: COMMIT
[0m18:44:39.079045 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:44:39.079045 [debug] [MainThread]: On master: Close
[0m18:44:39.080049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:39.080544 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:44:39.081044 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m18:44:39.082047 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' was properly closed.
[0m18:44:39.082624 [info ] [MainThread]: 
[0m18:44:39.083634 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m18:44:39.085116 [debug] [MainThread]: Command end result
[0m18:44:39.107916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:44:39.107916 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:44:39.107916 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m18:44:39.107916 [info ] [MainThread]: 
[0m18:44:39.107916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:39.107916 [info ] [MainThread]: 
[0m18:44:39.121565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:44:39.122893 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:39.122893 after 1.48 seconds
[0m18:44:39.123916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014324191070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143245360A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143234A46D0>]}
[0m18:44:39.124995 [debug] [MainThread]: Flushing usage events
[0m18:44:39.579141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:53.867710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476E160040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247700D4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247700D47C0>]}


============================== 18:44:53.883232 | 36110e44-ece2-4681-9a49-660f94bba842 ==============================
[0m18:44:53.883232 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:44:53.883232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s t_sales_funnel_monthly_rows', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:54.036064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36110e44-ece2-4681-9a49-660f94bba842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476D48EF10>]}
[0m18:44:54.078603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36110e44-ece2-4681-9a49-660f94bba842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476D458310>]}
[0m18:44:54.078603 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:44:54.251412 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m18:44:54.401193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:54.401193 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_sales_funnel_monthly_rows.sql
[0m18:44:54.624409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36110e44-ece2-4681-9a49-660f94bba842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024770971EB0>]}
[0m18:44:54.702911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:44:54.702911 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:44:54.719075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36110e44-ece2-4681-9a49-660f94bba842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024770955100>]}
[0m18:44:54.719075 [info ] [MainThread]: Found 14 models, 6 sources, 428 macros
[0m18:44:54.719075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36110e44-ece2-4681-9a49-660f94bba842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477095B0D0>]}
[0m18:44:54.719075 [info ] [MainThread]: 
[0m18:44:54.719075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:54.719075 [info ] [MainThread]: 
[0m18:44:54.719075 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:54.733094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:44:54.802652 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:44:54.802652 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:44:54.802652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:54.822269 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m18:44:54.822269 [debug] [ThreadPool]: On list_postgres: Close
[0m18:44:54.838985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m18:44:54.838985 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:44:54.838985 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:44:54.838985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:54.870603 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m18:44:54.870981 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:44:54.871986 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:44:54.876484 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:44:54.877573 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:44:54.879479 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:44:54.879996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m18:44:54.882818 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:44:54.882818 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m18:44:54.882818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:54.898625 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:44:54.914558 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:44:54.915056 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m18:44:54.920060 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m18:44:54.921559 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m18:44:54.923595 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m18:44:54.924593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m18:44:54.924593 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:44:54.924593 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:44:54.924593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:54.941177 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:44:54.956810 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:44:54.957319 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:44:54.961331 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m18:44:54.962944 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:44:54.965007 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:44:54.967373 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:54.967373 [debug] [MainThread]: On master: BEGIN
[0m18:44:54.967373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:54.992442 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m18:44:54.992979 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:54.994115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:54.999990 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m18:44:55.003187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36110e44-ece2-4681-9a49-660f94bba842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247709B2C10>]}
[0m18:44:55.003834 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:55.003834 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:55.003834 [debug] [MainThread]: On master: BEGIN
[0m18:44:55.008901 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:44:55.010011 [debug] [MainThread]: On master: COMMIT
[0m18:44:55.010325 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:55.010972 [debug] [MainThread]: On master: COMMIT
[0m18:44:55.012734 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:44:55.013199 [debug] [MainThread]: On master: Close
[0m18:44:55.017967 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:44:55.018619 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_sales_funnel_monthly_rows ............. [RUN]
[0m18:44:55.020020 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows'
[0m18:44:55.020020 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:44:55.057659 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:44:55.057659 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:44:55.097914 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:44:55.098925 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:44:55.099930 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m18:44:55.099930 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:44:55.121533 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m18:44:55.122080 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:44:55.122748 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m18:44:55.122748 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m18:44:55.138740 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:44:55.138740 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp" rename to "t_sales_funnel_monthly_rows"
[0m18:44:55.138740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:44:55.138740 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m18:44:55.154839 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:44:55.155336 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m18:44:55.155336 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m18:44:55.155336 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup"
[0m18:44:55.155336 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m18:44:55.155336 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup" cascade
[0m18:44:55.171295 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m18:44:55.172293 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m18:44:55.172293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36110e44-ece2-4681-9a49-660f94bba842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024770DD7C70>]}
[0m18:44:55.172293 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_crm.t_sales_funnel_monthly_rows ........ [[32mCREATE VIEW[0m in 0.15s]
[0m18:44:55.172293 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m18:44:55.172293 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:55.172293 [debug] [MainThread]: On master: BEGIN
[0m18:44:55.172293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:55.196191 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m18:44:55.204829 [debug] [MainThread]: On master: COMMIT
[0m18:44:55.205288 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:55.206392 [debug] [MainThread]: On master: COMMIT
[0m18:44:55.208787 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:44:55.209286 [debug] [MainThread]: On master: Close
[0m18:44:55.209786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:55.210286 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:44:55.210785 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m18:44:55.210785 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' was properly closed.
[0m18:44:55.211286 [info ] [MainThread]: 
[0m18:44:55.212290 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:44:55.213290 [debug] [MainThread]: Command end result
[0m18:44:55.229467 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:44:55.239259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:44:55.247482 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m18:44:55.247482 [info ] [MainThread]: 
[0m18:44:55.247482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:55.247482 [info ] [MainThread]: 
[0m18:44:55.247482 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:44:55.247482 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:55.247482 after 1.42 seconds
[0m18:44:55.247482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476E160040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476DDAD400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476E4E2850>]}
[0m18:44:55.247482 [debug] [MainThread]: Flushing usage events
[0m18:44:55.696459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:03.738917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A742C31FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A744BA4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A744BA48B0>]}


============================== 18:53:03.738917 | f5a6ff4d-7575-4012-ba72-acb67d440053 ==============================
[0m18:53:03.738917 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:53:03.738917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_deal_changes', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:03.890336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a6ff4d-7575-4012-ba72-acb67d440053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A741F3AE50>]}
[0m18:53:03.976590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a6ff4d-7575-4012-ba72-acb67d440053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A741FAE5B0>]}
[0m18:53:03.976590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:53:04.273984 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m18:53:04.449431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:53:04.465148 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m18:53:04.465148 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\stg_deal_changes.sql
[0m18:53:04.845517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a6ff4d-7575-4012-ba72-acb67d440053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A745560130>]}
[0m18:53:04.924534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:53:04.924534 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:53:04.950698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a6ff4d-7575-4012-ba72-acb67d440053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A745523790>]}
[0m18:53:04.951215 [info ] [MainThread]: Found 14 models, 6 sources, 428 macros
[0m18:53:04.952412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a6ff4d-7575-4012-ba72-acb67d440053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A742B089D0>]}
[0m18:53:04.952825 [info ] [MainThread]: 
[0m18:53:04.952825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:04.952825 [info ] [MainThread]: 
[0m18:53:04.952825 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:53:04.952825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:53:05.077949 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:53:05.077949 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:53:05.077949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:05.104406 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.030 seconds
[0m18:53:05.104406 [debug] [ThreadPool]: On list_postgres: Close
[0m18:53:05.120232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m18:53:05.120232 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:53:05.120232 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m18:53:05.120232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:05.152112 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m18:53:05.152706 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:53:05.153413 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m18:53:05.158647 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m18:53:05.160198 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m18:53:05.162169 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m18:53:05.162787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m18:53:05.163294 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:53:05.163294 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:53:05.163294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:05.186367 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:53:05.187269 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:53:05.188169 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:53:05.193067 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:53:05.194672 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:53:05.196584 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:53:05.197569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m18:53:05.197569 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:53:05.197569 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:53:05.197569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:05.214615 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m18:53:05.220962 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:53:05.221471 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:53:05.227074 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m18:53:05.229159 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:53:05.230983 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:53:05.234490 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:05.234490 [debug] [MainThread]: On master: BEGIN
[0m18:53:05.234490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:05.265370 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m18:53:05.265869 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:05.266370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:05.271870 [debug] [MainThread]: SQL status: SELECT 17 in 0.005 seconds
[0m18:53:05.276867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a6ff4d-7575-4012-ba72-acb67d440053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A742852100>]}
[0m18:53:05.276867 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:05.278831 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:05.278831 [debug] [MainThread]: On master: BEGIN
[0m18:53:05.278831 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:53:05.283966 [debug] [MainThread]: On master: COMMIT
[0m18:53:05.284475 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:05.284974 [debug] [MainThread]: On master: COMMIT
[0m18:53:05.287480 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:53:05.287974 [debug] [MainThread]: On master: Close
[0m18:53:05.294472 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m18:53:05.294472 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public_staging.stg_deal_changes ............. [RUN]
[0m18:53:05.294472 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_deal_changes'
[0m18:53:05.294472 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m18:53:05.294472 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.294472 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m18:53:05.346176 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.361461 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.361999 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m18:53:05.361999 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:53:05.381645 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m18:53:05.382621 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.383173 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  );
  
  
[0m18:53:05.399789 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.018 seconds
[0m18:53:05.406381 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.406381 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m18:53:05.408548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:53:05.408548 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.408548 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m18:53:05.408548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:53:05.425165 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m18:53:05.425165 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.425165 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m18:53:05.441026 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m18:53:05.441026 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_deal_changes__dbt_backup"
[0m18:53:05.441026 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:05.441026 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_staging"."stg_deal_changes__dbt_backup" cascade
[0m18:53:05.457409 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.007 seconds
[0m18:53:05.457409 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m18:53:05.462169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a6ff4d-7575-4012-ba72-acb67d440053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7451E0D30>]}
[0m18:53:05.462169 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public_staging.stg_deal_changes ........ [[32mSELECT 15406[0m in 0.16s]
[0m18:53:05.465137 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m18:53:05.465137 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:05.465137 [debug] [MainThread]: On master: BEGIN
[0m18:53:05.465137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:05.497038 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m18:53:05.497797 [debug] [MainThread]: On master: COMMIT
[0m18:53:05.498219 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:05.498586 [debug] [MainThread]: On master: COMMIT
[0m18:53:05.500588 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:53:05.500588 [debug] [MainThread]: On master: Close
[0m18:53:05.501580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:05.502084 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:53:05.502084 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m18:53:05.502618 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_changes' was properly closed.
[0m18:53:05.502618 [info ] [MainThread]: 
[0m18:53:05.503675 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m18:53:05.505458 [debug] [MainThread]: Command end result
[0m18:53:05.529238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:53:05.532785 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:53:05.535934 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m18:53:05.535934 [info ] [MainThread]: 
[0m18:53:05.535934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:05.535934 [info ] [MainThread]: 
[0m18:53:05.535934 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:05.535934 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:05.535934 after 1.85 seconds
[0m18:53:05.544600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A742C31FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A745523790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A741F64640>]}
[0m18:53:05.544600 [debug] [MainThread]: Flushing usage events
[0m18:53:06.056007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:51.259863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE0AA00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE2A14760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE2A14820>]}


============================== 18:53:51.259863 | 9bed10ff-60db-49dc-901e-9c29f9baaeec ==============================
[0m18:53:51.259863 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m18:53:51.259863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_deal_changes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:51.423481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bed10ff-60db-49dc-901e-9c29f9baaeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE2A148B0>]}
[0m18:53:51.470779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bed10ff-60db-49dc-901e-9c29f9baaeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE29DF280>]}
[0m18:53:51.470779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:53:51.639772 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m18:53:51.793449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:51.793449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:51.839592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bed10ff-60db-49dc-901e-9c29f9baaeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE3128130>]}
[0m18:53:51.907412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:53:51.907412 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:53:51.924000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bed10ff-60db-49dc-901e-9c29f9baaeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE314D490>]}
[0m18:53:51.924000 [info ] [MainThread]: Found 14 models, 6 sources, 428 macros
[0m18:53:51.924000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bed10ff-60db-49dc-901e-9c29f9baaeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE068B730>]}
[0m18:53:51.924000 [info ] [MainThread]: 
[0m18:53:51.924000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:51.924000 [info ] [MainThread]: 
[0m18:53:51.924000 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:53:51.944413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:53:52.015866 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:53:52.015866 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:53:52.015866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:52.044019 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m18:53:52.059718 [debug] [ThreadPool]: On list_postgres: Close
[0m18:53:52.060403 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m18:53:52.060403 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:53:52.060403 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m18:53:52.060403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:52.093004 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:53:52.094394 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m18:53:52.094903 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m18:53:52.099402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m18:53:52.100901 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m18:53:52.102407 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m18:53:52.103473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m18:53:52.105490 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:53:52.105490 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:53:52.105490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:52.121531 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m18:53:52.127506 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:53:52.127577 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:53:52.128158 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m18:53:52.128158 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:53:52.128158 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:53:52.135340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m18:53:52.135841 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:53:52.135841 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:53:52.135841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:52.152766 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:53:52.168534 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:53:52.168925 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:53:52.173237 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m18:53:52.174980 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:53:52.177092 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:53:52.179410 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:52.179410 [debug] [MainThread]: On master: BEGIN
[0m18:53:52.179410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:52.216906 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:53:52.217334 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:52.217835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:52.222835 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m18:53:52.224408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bed10ff-60db-49dc-901e-9c29f9baaeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDF3DFA00>]}
[0m18:53:52.224877 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:52.226854 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:52.227392 [debug] [MainThread]: On master: BEGIN
[0m18:53:52.227855 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:53:52.230822 [debug] [MainThread]: On master: COMMIT
[0m18:53:52.230822 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:52.231352 [debug] [MainThread]: On master: COMMIT
[0m18:53:52.232973 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:53:52.233511 [debug] [MainThread]: On master: Close
[0m18:53:52.241956 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m18:53:52.242455 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public_staging.stg_deal_changes ............. [RUN]
[0m18:53:52.242455 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.stg_deal_changes'
[0m18:53:52.242455 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m18:53:52.242455 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.242455 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m18:53:52.307280 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.307280 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp185352277036"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m18:53:52.308605 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:53:52.342195 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.037 seconds
[0m18:53:52.342195 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.342195 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m18:53:52.360352 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m18:53:52.361414 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.361922 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp185352277036'
        
      order by ordinal_position

  
[0m18:53:52.376773 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.016 seconds
[0m18:53:52.376773 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.376773 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m18:53:52.376773 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.006 seconds
[0m18:53:52.395667 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.396671 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m18:53:52.399712 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m18:53:52.409113 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.409113 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.409113 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp185352277036"
            where (
                
                    "stg_deal_changes__dbt_tmp185352277036".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp185352277036".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp185352277036".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp185352277036"
    )
  
[0m18:53:52.409113 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.004 seconds
[0m18:53:52.424760 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m18:53:52.424760 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m18:53:52.424760 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m18:53:52.424760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m18:53:52.440469 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m18:53:52.442089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bed10ff-60db-49dc-901e-9c29f9baaeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDF336550>]}
[0m18:53:52.444744 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public_staging.stg_deal_changes ........ [[32mINSERT 0 0[0m in 0.20s]
[0m18:53:52.444744 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m18:53:52.444744 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:52.444744 [debug] [MainThread]: On master: BEGIN
[0m18:53:52.444744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:52.477735 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m18:53:52.484609 [debug] [MainThread]: On master: COMMIT
[0m18:53:52.485551 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:52.485551 [debug] [MainThread]: On master: COMMIT
[0m18:53:52.488061 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:53:52.488653 [debug] [MainThread]: On master: Close
[0m18:53:52.489202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:52.489745 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:53:52.489745 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m18:53:52.490274 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_changes' was properly closed.
[0m18:53:52.490383 [info ] [MainThread]: 
[0m18:53:52.491446 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m18:53:52.493007 [debug] [MainThread]: Command end result
[0m18:53:52.544947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m18:53:52.544947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m18:53:52.560586 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m18:53:52.560586 [info ] [MainThread]: 
[0m18:53:52.560586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:52.560586 [info ] [MainThread]: 
[0m18:53:52.560586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:52.560586 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:52.560586 after 1.35 seconds
[0m18:53:52.560586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE0AA00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE0E3F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CE24B70D0>]}
[0m18:53:52.560586 [debug] [MainThread]: Flushing usage events
[0m18:53:53.005687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:28.436136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979FA300D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A19A3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A19A3850>]}


============================== 19:05:28.436136 | f5f101ac-57e9-46c6-953c-3a3d21996924 ==============================
[0m19:05:28.436136 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:05:28.436136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s users_snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:05:28.590512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5f101ac-57e9-46c6-953c-3a3d21996924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979ED70490>]}
[0m19:05:28.638307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5f101ac-57e9-46c6-953c-3a3d21996924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A192A280>]}
[0m19:05:28.638307 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:05:28.825543 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:05:28.952941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:05:28.952941 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://snapshots\users_snapshot.sql
[0m19:05:29.224685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5f101ac-57e9-46c6-953c-3a3d21996924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A22B9130>]}
[0m19:05:29.303441 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:05:29.303441 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:05:29.319155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5f101ac-57e9-46c6-953c-3a3d21996924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A22A01F0>]}
[0m19:05:29.319155 [info ] [MainThread]: Found 14 models, 1 snapshot, 6 sources, 428 macros
[0m19:05:29.319155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f101ac-57e9-46c6-953c-3a3d21996924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A1FB2D00>]}
[0m19:05:29.334784 [info ] [MainThread]: 
[0m19:05:29.334784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:29.334784 [info ] [MainThread]: 
[0m19:05:29.337942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:05:29.338134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:05:29.405589 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:29.421119 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:29.421119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:29.448277 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.027 seconds
[0m19:05:29.449273 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:29.455363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m19:05:29.455363 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:05:29.455363 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:05:29.455363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:29.472129 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:05:29.485898 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:05:29.486351 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:05:29.491928 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m19:05:29.493812 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:05:29.495466 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:05:29.496185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:05:29.496692 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:05:29.496692 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:05:29.496692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:29.518974 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:05:29.519979 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:05:29.520982 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:05:29.526218 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:05:29.527323 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:05:29.529852 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:05:29.529852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:05:29.531731 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:05:29.531731 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:05:29.531731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:29.554857 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:05:29.555476 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:05:29.555979 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:05:29.560220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:05:29.561961 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:05:29.563412 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:05:29.600317 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:29.600317 [debug] [MainThread]: On master: BEGIN
[0m19:05:29.600317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:29.631690 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m19:05:29.632679 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:29.632679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:05:29.632679 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:05:29.632679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f101ac-57e9-46c6-953c-3a3d21996924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979E36FA30>]}
[0m19:05:29.632679 [debug] [MainThread]: On master: ROLLBACK
[0m19:05:29.632679 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:29.632679 [debug] [MainThread]: On master: BEGIN
[0m19:05:29.632679 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:05:29.645315 [debug] [MainThread]: On master: COMMIT
[0m19:05:29.645669 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:29.646207 [debug] [MainThread]: On master: COMMIT
[0m19:05:29.647274 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:05:29.647677 [debug] [MainThread]: On master: Close
[0m19:05:29.655203 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:29.655785 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.users_snapshot ............................ [RUN]
[0m19:05:29.656289 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.users_snapshot'
[0m19:05:29.656289 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:29.656289 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:29.718923 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:05:29.719924 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM FROM "postgres"."public"."users"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:05:29.719924 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:05:29.738167 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 23: FROM FROM "postgres"."public"."users"
              ^

[0m19:05:29.754289 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: Close
[0m19:05:29.758623 [debug] [Thread-1  ]: Database Error in snapshot users_snapshot (snapshots\users_snapshot.sql)
  syntax error at or near "FROM"
  LINE 23: FROM FROM "postgres"."public"."users"
                ^
[0m19:05:29.760117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f101ac-57e9-46c6-953c-3a3d21996924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A1A4EAC0>]}
[0m19:05:29.761139 [error] [Thread-1  ]: 1 of 1 ERROR snapshotting public_staging.users_snapshot ........................ [[31mERROR[0m in 0.10s]
[0m19:05:29.762036 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:29.762568 [debug] [Thread-4  ]: Marking all children of 'snapshot.enpal_assessment_project.users_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot users_snapshot (snapshots\users_snapshot.sql)
  syntax error at or near "FROM"
  LINE 23: FROM FROM "postgres"."public"."users"
                ^.
[0m19:05:29.764033 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:29.764534 [debug] [MainThread]: On master: BEGIN
[0m19:05:29.764534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:29.784159 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:05:29.784678 [debug] [MainThread]: On master: COMMIT
[0m19:05:29.785179 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:29.785785 [debug] [MainThread]: On master: COMMIT
[0m19:05:29.788227 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:05:29.788910 [debug] [MainThread]: On master: Close
[0m19:05:29.789826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:29.790232 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:05:29.790771 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:05:29.790771 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.users_snapshot' was properly closed.
[0m19:05:29.791236 [info ] [MainThread]: 
[0m19:05:29.792234 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m19:05:29.793732 [debug] [MainThread]: Command end result
[0m19:05:29.813986 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:05:29.813986 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:05:29.826952 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:05:29.827970 [info ] [MainThread]: 
[0m19:05:29.827970 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m19:05:29.827970 [info ] [MainThread]: 
[0m19:05:29.827970 [error] [MainThread]:   Database Error in snapshot users_snapshot (snapshots\users_snapshot.sql)
  syntax error at or near "FROM"
  LINE 23: FROM FROM "postgres"."public"."users"
                ^
[0m19:05:29.827970 [info ] [MainThread]: 
[0m19:05:29.827970 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:05:29.827970 [debug] [MainThread]: Command `dbt snapshot` failed at 19:05:29.827970 after 1.45 seconds
[0m19:05:29.834956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979FA300D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A20AF3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A20AF760>]}
[0m19:05:29.834956 [debug] [MainThread]: Flushing usage events
[0m19:05:30.324384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:39.941411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF8875FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFA7F36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFA7F3790>]}


============================== 19:05:39.941411 | a1d041a0-168e-456f-ad7d-72801bfe73ac ==============================
[0m19:05:39.941411 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:05:39.941411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s users_snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:40.098865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1d041a0-168e-456f-ad7d-72801bfe73ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF713A8B0>]}
[0m19:05:40.154797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1d041a0-168e-456f-ad7d-72801bfe73ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF7B8F580>]}
[0m19:05:40.154797 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:05:40.348083 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:05:40.511805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:05:40.511805 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\users_snapshot.sql
[0m19:05:40.746151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1d041a0-168e-456f-ad7d-72801bfe73ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFB0E3130>]}
[0m19:05:40.827687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:05:40.843429 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:05:40.859077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1d041a0-168e-456f-ad7d-72801bfe73ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF7BDAF70>]}
[0m19:05:40.859077 [info ] [MainThread]: Found 14 models, 1 snapshot, 6 sources, 428 macros
[0m19:05:40.859077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d041a0-168e-456f-ad7d-72801bfe73ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFB0D3CA0>]}
[0m19:05:40.859077 [info ] [MainThread]: 
[0m19:05:40.859077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:40.859077 [info ] [MainThread]: 
[0m19:05:40.859077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:05:40.859077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:05:40.938397 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:40.938397 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:40.938397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:40.967036 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.026 seconds
[0m19:05:40.968092 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:40.979828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m19:05:40.984836 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:05:40.984836 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:05:40.984836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:41.004710 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m19:05:41.019429 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:05:41.019938 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:05:41.023940 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:05:41.025028 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:05:41.026959 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:05:41.028440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:05:41.030439 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:05:41.030943 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:05:41.030943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:41.047848 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:05:41.050302 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:05:41.050841 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:05:41.055996 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m19:05:41.057693 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:05:41.060116 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:05:41.060736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:05:41.062339 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:05:41.063296 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:05:41.064355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:41.103219 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m19:05:41.104034 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:05:41.104221 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:05:41.109226 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:05:41.110317 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:05:41.112218 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:05:41.147031 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:41.147031 [debug] [MainThread]: On master: BEGIN
[0m19:05:41.147031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:41.179203 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:05:41.179918 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:41.180470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:05:41.186353 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:05:41.188302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d041a0-168e-456f-ad7d-72801bfe73ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFB05F4C0>]}
[0m19:05:41.188713 [debug] [MainThread]: On master: ROLLBACK
[0m19:05:41.190505 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:41.190627 [debug] [MainThread]: On master: BEGIN
[0m19:05:41.191131 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:05:41.193169 [debug] [MainThread]: On master: COMMIT
[0m19:05:41.193481 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:41.193954 [debug] [MainThread]: On master: COMMIT
[0m19:05:41.195498 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:05:41.196012 [debug] [MainThread]: On master: Close
[0m19:05:41.199442 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:41.199961 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.users_snapshot ............................ [RUN]
[0m19:05:41.200941 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.users_snapshot'
[0m19:05:41.201468 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:41.205030 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:41.266304 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:05:41.266304 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:05:41.266304 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:05:41.285501 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.019 seconds
[0m19:05:41.287858 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:05:41.287858 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:05:41.287858 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:05:41.287858 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.users_snapshot"
[0m19:05:41.287858 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:05:41.287858 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: BEGIN
[0m19:05:41.287858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m19:05:41.299960 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:05:41.300179 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      
  
    

  create  table "postgres"."public_staging"."users_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



  );
  
  
[0m19:05:41.311240 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.011 seconds
[0m19:05:41.311240 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: COMMIT
[0m19:05:41.327332 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:05:41.327860 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: COMMIT
[0m19:05:41.364309 [debug] [Thread-1  ]: SQL status: COMMIT in 0.038 seconds
[0m19:05:41.367676 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: Close
[0m19:05:41.372073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1d041a0-168e-456f-ad7d-72801bfe73ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF6F50070>]}
[0m19:05:41.375778 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.users_snapshot ............................ [[32mSELECT 1787[0m in 0.17s]
[0m19:05:41.378709 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.users_snapshot
[0m19:05:41.379426 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:41.379426 [debug] [MainThread]: On master: BEGIN
[0m19:05:41.379426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:41.398958 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:05:41.399546 [debug] [MainThread]: On master: COMMIT
[0m19:05:41.400235 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:41.400597 [debug] [MainThread]: On master: COMMIT
[0m19:05:41.402646 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:05:41.403197 [debug] [MainThread]: On master: Close
[0m19:05:41.403721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:41.404301 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:05:41.404301 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:05:41.404925 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.users_snapshot' was properly closed.
[0m19:05:41.404925 [info ] [MainThread]: 
[0m19:05:41.406221 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m19:05:41.407392 [debug] [MainThread]: Command end result
[0m19:05:41.422018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:05:41.422018 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:05:41.438462 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:05:41.439400 [info ] [MainThread]: 
[0m19:05:41.440934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:41.440934 [info ] [MainThread]: 
[0m19:05:41.440934 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:05:41.440934 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:05:41.440934 after 1.54 seconds
[0m19:05:41.440934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF8875FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF8758520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFA2A39A0>]}
[0m19:05:41.440934 [debug] [MainThread]: Flushing usage events
[0m19:05:41.876642 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:06:21.810956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ADB20070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AFA93700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AFA937C0>]}


============================== 19:06:21.810956 | 573ac956-5469-4914-a070-02bc223cf067 ==============================
[0m19:06:21.810956 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:06:21.810956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot -s users_snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:21.965095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '573ac956-5469-4914-a070-02bc223cf067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AFA713D0>]}
[0m19:06:22.013760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '573ac956-5469-4914-a070-02bc223cf067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AF8EB7F0>]}
[0m19:06:22.013760 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:06:22.201357 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:06:22.353343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:06:22.353343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:06:22.410040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '573ac956-5469-4914-a070-02bc223cf067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B01C0130>]}
[0m19:06:22.505664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:06:22.506156 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:06:22.522010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '573ac956-5469-4914-a070-02bc223cf067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ACE95070>]}
[0m19:06:22.522010 [info ] [MainThread]: Found 14 models, 1 snapshot, 6 sources, 428 macros
[0m19:06:22.522010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573ac956-5469-4914-a070-02bc223cf067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B01E2520>]}
[0m19:06:22.522010 [info ] [MainThread]: 
[0m19:06:22.522010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:06:22.522010 [info ] [MainThread]: 
[0m19:06:22.522010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:06:22.532122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:06:22.605344 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:06:22.606346 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:06:22.606346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:22.635879 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.031 seconds
[0m19:06:22.635879 [debug] [ThreadPool]: On list_postgres: Close
[0m19:06:22.635879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:06:22.651596 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:06:22.651596 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:06:22.651596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:22.673626 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:06:22.674333 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:06:22.674899 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:06:22.678937 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:06:22.680552 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:06:22.682481 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:06:22.683905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m19:06:22.684972 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:06:22.684972 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:06:22.684972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:22.700948 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m19:06:22.717022 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:06:22.717571 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:06:22.722082 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:06:22.723195 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:06:22.725145 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:06:22.725145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m19:06:22.728088 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:06:22.728088 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:06:22.728088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:22.735241 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:06:22.749561 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:06:22.750077 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:06:22.754171 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:06:22.755161 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:06:22.757162 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:06:22.762801 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:22.762801 [debug] [MainThread]: On master: BEGIN
[0m19:06:22.763805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:22.768942 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:06:22.783958 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:22.785745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:06:22.791820 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:06:22.793691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573ac956-5469-4914-a070-02bc223cf067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B02D6A30>]}
[0m19:06:22.794198 [debug] [MainThread]: On master: ROLLBACK
[0m19:06:22.794198 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:22.794198 [debug] [MainThread]: On master: BEGIN
[0m19:06:22.799712 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:06:22.800425 [debug] [MainThread]: On master: COMMIT
[0m19:06:22.800927 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:22.800927 [debug] [MainThread]: On master: COMMIT
[0m19:06:22.803927 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:06:22.804423 [debug] [MainThread]: On master: Close
[0m19:06:22.810609 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.users_snapshot
[0m19:06:22.810609 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.users_snapshot ............................ [RUN]
[0m19:06:22.810609 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.users_snapshot'
[0m19:06:22.810609 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.users_snapshot
[0m19:06:22.815825 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.users_snapshot
[0m19:06:22.871562 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.872538 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: BEGIN
[0m19:06:22.872538 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:06:22.893538 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m19:06:22.894518 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.895066 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'users_snapshot'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:06:22.904813 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m19:06:22.930481 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.930481 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

        
  
    

  create temporary table "users_snapshot__dbt_tmp190622930481"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:06:22.946309 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m19:06:22.946309 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.946309 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'users_snapshot__dbt_tmp190622930481'
        
      order by ordinal_position

  
[0m19:06:22.946309 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:06:22.946309 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.946309 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'users_snapshot'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:06:22.962057 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:06:22.962057 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.962057 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'users_snapshot__dbt_tmp190622930481'
        
      order by ordinal_position

  
[0m19:06:22.962057 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:06:22.962057 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.962057 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'users_snapshot'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:06:22.962057 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m19:06:22.978182 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.978182 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'users_snapshot__dbt_tmp190622930481'
        
      order by ordinal_position

  
[0m19:06:22.978182 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:06:22.994067 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.994067 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m19:06:22.994067 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:06:22.994067 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:22.994067 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:06:23.010379 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:06:23.010379 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:23.010379 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:23.010379 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.users_snapshot"} */

      update "postgres"."public_staging"."users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "users_snapshot__dbt_tmp190622930481" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."users_snapshot".dbt_valid_to is null;

    insert into "postgres"."public_staging"."users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "users_snapshot__dbt_tmp190622930481" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:06:23.010379 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m19:06:23.026844 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: COMMIT
[0m19:06:23.026844 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.users_snapshot"
[0m19:06:23.026844 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: COMMIT
[0m19:06:23.026844 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m19:06:23.026844 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.users_snapshot: Close
[0m19:06:23.026844 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573ac956-5469-4914-a070-02bc223cf067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B0713B50>]}
[0m19:06:23.026844 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.users_snapshot ............................ [[32mINSERT 0 0[0m in 0.22s]
[0m19:06:23.043649 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.users_snapshot
[0m19:06:23.046125 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:23.046125 [debug] [MainThread]: On master: BEGIN
[0m19:06:23.046125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:23.069434 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m19:06:23.078970 [debug] [MainThread]: On master: COMMIT
[0m19:06:23.079560 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:23.080066 [debug] [MainThread]: On master: COMMIT
[0m19:06:23.080066 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:06:23.080066 [debug] [MainThread]: On master: Close
[0m19:06:23.080066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:23.080066 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:06:23.080066 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:06:23.080066 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.users_snapshot' was properly closed.
[0m19:06:23.080066 [info ] [MainThread]: 
[0m19:06:23.085141 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m19:06:23.086386 [debug] [MainThread]: Command end result
[0m19:06:23.137047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:06:23.137047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:06:23.137047 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:06:23.137047 [info ] [MainThread]: 
[0m19:06:23.151256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:23.152315 [info ] [MainThread]: 
[0m19:06:23.152837 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:06:23.153849 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:06:23.153849 after 1.38 seconds
[0m19:06:23.154926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ADB20070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ADEC50A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ACE41AC0>]}
[0m19:06:23.154926 [debug] [MainThread]: Flushing usage events
[0m19:06:23.603153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:06.096567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AD0A00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF0147F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF0148B0>]}


============================== 19:07:06.099731 | 24d29f58-3ad3-44b3-8f0a-30ab7a797ea5 ==============================
[0m19:07:06.099731 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:07:06.100765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s t_user_deal_events', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:07:06.245502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24d29f58-3ad3-44b3-8f0a-30ab7a797ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AC3BCE80>]}
[0m19:07:06.292374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24d29f58-3ad3-44b3-8f0a-30ab7a797ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AEAB7670>]}
[0m19:07:06.292374 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:07:06.461255 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:07:06.632419 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m19:07:06.632419 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\staging\pipedrive\stg_users.sql
[0m19:07:06.632419 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_user_deal_events.sql
[0m19:07:06.838082 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_users' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m19:07:06.916078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24d29f58-3ad3-44b3-8f0a-30ab7a797ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF96FEE0>]}
[0m19:07:07.011225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:07:07.011225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:07:07.026854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24d29f58-3ad3-44b3-8f0a-30ab7a797ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF99FF70>]}
[0m19:07:07.026854 [info ] [MainThread]: Found 13 models, 1 snapshot, 6 sources, 428 macros
[0m19:07:07.026854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d29f58-3ad3-44b3-8f0a-30ab7a797ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF9BEFA0>]}
[0m19:07:07.026854 [info ] [MainThread]: 
[0m19:07:07.026854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:07.026854 [info ] [MainThread]: 
[0m19:07:07.026854 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:07:07.026854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:07:07.152637 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:07:07.152637 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:07:07.152637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:07.228732 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.085 seconds
[0m19:07:07.228732 [debug] [ThreadPool]: On list_postgres: Close
[0m19:07:07.244352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:07:07.244352 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:07:07.244352 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:07:07.244352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:07.276574 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m19:07:07.277138 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:07:07.277658 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:07:07.281643 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m19:07:07.282748 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:07:07.284644 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:07:07.285644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m19:07:07.288644 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:07:07.288644 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:07:07.289215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:07.308420 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:07:07.308922 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:07:07.309384 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:07:07.312937 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m19:07:07.314419 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:07:07.315921 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:07:07.316922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m19:07:07.320940 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:07:07.321441 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:07:07.321441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:07.352700 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m19:07:07.353760 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:07:07.354396 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:07:07.358405 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:07:07.360001 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:07:07.361944 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:07:07.364204 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:07.364204 [debug] [MainThread]: On master: BEGIN
[0m19:07:07.364204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:07.399730 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m19:07:07.412832 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:07.413353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:07:07.418902 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:07:07.421351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d29f58-3ad3-44b3-8f0a-30ab7a797ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF8808E0>]}
[0m19:07:07.421351 [debug] [MainThread]: On master: ROLLBACK
[0m19:07:07.423351 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:07.423851 [debug] [MainThread]: On master: BEGIN
[0m19:07:07.423851 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:07:07.426964 [debug] [MainThread]: On master: COMMIT
[0m19:07:07.427251 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:07.427813 [debug] [MainThread]: On master: COMMIT
[0m19:07:07.429764 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:07:07.430263 [debug] [MainThread]: On master: Close
[0m19:07:07.434265 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m19:07:07.435319 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m19:07:07.436287 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_user_deal_events'
[0m19:07:07.436875 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m19:07:07.438352 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m19:07:07.438352 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m19:07:07.467932 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m19:07:07.467932 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m19:07:07.467932 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m19:07:07.467932 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:07:07.500359 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m19:07:07.501108 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m19:07:07.501680 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."users_snapshot" dc
WHERE changed_field_key = 'user_id'
  );
[0m19:07:07.504476 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "deal_id" does not exist
LINE 8:    deal_id
           ^

[0m19:07:07.505415 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: ROLLBACK
[0m19:07:07.507209 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m19:07:07.510759 [debug] [Thread-1  ]: Database Error in model t_user_deal_events (models\transformations\crm\t_user_deal_events.sql)
  column "deal_id" does not exist
  LINE 8:    deal_id
             ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_user_deal_events.sql
[0m19:07:07.512818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d29f58-3ad3-44b3-8f0a-30ab7a797ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF80D790>]}
[0m19:07:07.513724 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public_crm.t_user_deal_events ............. [[31mERROR[0m in 0.08s]
[0m19:07:07.515228 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m19:07:07.515831 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_user_deal_events' to be skipped because of status 'error'.  Reason: Database Error in model t_user_deal_events (models\transformations\crm\t_user_deal_events.sql)
  column "deal_id" does not exist
  LINE 8:    deal_id
             ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_user_deal_events.sql.
[0m19:07:07.515831 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:07.515831 [debug] [MainThread]: On master: BEGIN
[0m19:07:07.515831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:07:07.539462 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:07:07.541295 [debug] [MainThread]: On master: COMMIT
[0m19:07:07.541718 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:07.542219 [debug] [MainThread]: On master: COMMIT
[0m19:07:07.544174 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:07:07.544250 [debug] [MainThread]: On master: Close
[0m19:07:07.544877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:07.545399 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:07:07.545399 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:07:07.546014 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_user_deal_events' was properly closed.
[0m19:07:07.546014 [info ] [MainThread]: 
[0m19:07:07.547141 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m19:07:07.548935 [debug] [MainThread]: Command end result
[0m19:07:07.572320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:07:07.573335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:07:07.573335 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:07:07.573335 [info ] [MainThread]: 
[0m19:07:07.582118 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m19:07:07.583916 [info ] [MainThread]: 
[0m19:07:07.583916 [error] [MainThread]:   Database Error in model t_user_deal_events (models\transformations\crm\t_user_deal_events.sql)
  column "deal_id" does not exist
  LINE 8:    deal_id
             ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_user_deal_events.sql
[0m19:07:07.583916 [info ] [MainThread]: 
[0m19:07:07.583916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:07:07.588752 [debug] [MainThread]: Command `dbt run` failed at 19:07:07.588752 after 1.55 seconds
[0m19:07:07.589910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AD0A00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AEAB7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163ACF2D9A0>]}
[0m19:07:07.589910 [debug] [MainThread]: Flushing usage events
[0m19:07:08.069480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:36.172054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F759510040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75B483700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75B4837C0>]}


============================== 19:10:36.172054 | 91d6d829-0090-46e6-940c-9eb1c39645d1 ==============================
[0m19:10:36.172054 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:10:36.172054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_users', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:36.317987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d6d829-0090-46e6-940c-9eb1c39645d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75883DF10>]}
[0m19:10:36.371019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d6d829-0090-46e6-940c-9eb1c39645d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F758809310>]}
[0m19:10:36.371019 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:10:36.548470 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:10:36.720933 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m19:10:36.720933 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:10:36.720933 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:10:36.720933 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://snapshots\users_snapshot.sql
[0m19:10:37.095013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d6d829-0090-46e6-940c-9eb1c39645d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BEB7130>]}
[0m19:10:37.190206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:10:37.190206 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:10:37.206140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d6d829-0090-46e6-940c-9eb1c39645d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7593D77C0>]}
[0m19:10:37.206140 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:10:37.206140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d6d829-0090-46e6-940c-9eb1c39645d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BB63640>]}
[0m19:10:37.206140 [info ] [MainThread]: 
[0m19:10:37.206140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:10:37.206140 [info ] [MainThread]: 
[0m19:10:37.206140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:10:37.222035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:10:37.337123 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:10:37.338125 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:10:37.338621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:37.358437 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.031 seconds
[0m19:10:37.358437 [debug] [ThreadPool]: On list_postgres: Close
[0m19:10:37.374296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m19:10:37.374296 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:10:37.374296 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:10:37.374296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:37.390102 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:10:37.406405 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:10:37.407148 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:10:37.411187 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:10:37.412778 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:10:37.414214 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:10:37.414812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:10:37.417781 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:10:37.417781 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:10:37.418404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:37.437436 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:10:37.439125 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:10:37.439626 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:10:37.444097 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:10:37.445818 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:10:37.447250 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:10:37.448491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:10:37.450520 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:10:37.450520 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:10:37.450520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:37.466527 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m19:10:37.482743 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:10:37.483234 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:10:37.487718 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:10:37.489922 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:10:37.492068 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:10:37.498120 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:37.498120 [debug] [MainThread]: On master: BEGIN
[0m19:10:37.498120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:37.514191 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:10:37.520841 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:37.521356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:10:37.526352 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:10:37.527853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d6d829-0090-46e6-940c-9eb1c39645d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BE91EE0>]}
[0m19:10:37.528354 [debug] [MainThread]: On master: ROLLBACK
[0m19:10:37.530353 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:37.530853 [debug] [MainThread]: On master: BEGIN
[0m19:10:37.531357 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:10:37.534984 [debug] [MainThread]: On master: COMMIT
[0m19:10:37.535495 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:37.535495 [debug] [MainThread]: On master: COMMIT
[0m19:10:37.537359 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:10:37.537941 [debug] [MainThread]: On master: Close
[0m19:10:37.543218 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m19:10:37.544134 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_users .................................. [RUN]
[0m19:10:37.545321 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_users'
[0m19:10:37.545895 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m19:10:37.545895 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m19:10:37.613324 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:10:37.613324 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:10:37.614326 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:10:37.622443 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.020 seconds
[0m19:10:37.638813 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:10:37.638813 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:10:37.638813 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:10:37.638813 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m19:10:37.638813 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:10:37.638813 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m19:10:37.638813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m19:10:37.647186 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:10:37.647262 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      
  
    

  create  table "postgres"."public_staging"."sn_users"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



  );
  
  
[0m19:10:37.657371 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.009 seconds
[0m19:10:37.669046 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:10:37.669046 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:10:37.669046 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:10:37.669046 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m19:10:37.669046 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m19:10:37.669046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d6d829-0090-46e6-940c-9eb1c39645d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75CED14F0>]}
[0m19:10:37.669046 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_users .................................. [[32mSELECT 1787[0m in 0.12s]
[0m19:10:37.684724 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m19:10:37.684724 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:37.684724 [debug] [MainThread]: On master: BEGIN
[0m19:10:37.684724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:37.707842 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m19:10:37.717312 [debug] [MainThread]: On master: COMMIT
[0m19:10:37.717576 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:37.717799 [debug] [MainThread]: On master: COMMIT
[0m19:10:37.720339 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:10:37.721041 [debug] [MainThread]: On master: Close
[0m19:10:37.721766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:37.722286 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:10:37.723271 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:10:37.723769 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m19:10:37.724269 [info ] [MainThread]: 
[0m19:10:37.725269 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m19:10:37.726980 [debug] [MainThread]: Command end result
[0m19:10:37.742931 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:10:37.742931 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:10:37.759120 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:10:37.759120 [info ] [MainThread]: 
[0m19:10:37.760287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:10:37.760287 [info ] [MainThread]: 
[0m19:10:37.760287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:10:37.764508 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:10:37.764407 after 1.63 seconds
[0m19:10:37.765042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F759510040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75A8C6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BB7B310>]}
[0m19:10:37.765680 [debug] [MainThread]: Flushing usage events
[0m19:10:38.258657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:27.794050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA2241040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA41B3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA41B37C0>]}


============================== 19:12:27.794050 | 2a6ce8a2-3709-4fe3-ab88-bc728cb9e17f ==============================
[0m19:12:27.794050 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:12:27.794050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:12:27.947145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a6ce8a2-3709-4fe3-ab88-bc728cb9e17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA156C250>]}
[0m19:12:28.012002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a6ce8a2-3709-4fe3-ab88-bc728cb9e17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA1538310>]}
[0m19:12:28.012002 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:12:28.185760 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:12:28.358592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:12:28.358592 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:12:28.358592 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:12:28.542795 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:12:28.542795 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:12:28.556852 [debug] [MainThread]: Command `dbt snapshot` failed at 19:12:28.556852 after 0.81 seconds
[0m19:12:28.556852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA2241040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA4A2FBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA4A2FD60>]}
[0m19:12:28.556852 [debug] [MainThread]: Flushing usage events
[0m19:12:29.055046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:03.604226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D72B55FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D74AD36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D74AD3790>]}


============================== 19:13:03.604226 | 25e3bee3-fd98-4fee-ad7d-d1e61c036540 ==============================
[0m19:13:03.604226 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:13:03.604226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:13:03.759546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e3bee3-fd98-4fee-ad7d-d1e61c036540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7141A8B0>]}
[0m19:13:03.806486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e3bee3-fd98-4fee-ad7d-d1e61c036540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D71E6F580>]}
[0m19:13:03.806486 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:13:03.989675 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:13:04.147296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:13:04.147296 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:13:04.147296 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:13:04.326190 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:13:04.326190 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:13:04.336589 [debug] [MainThread]: Command `dbt snapshot` failed at 19:13:04.336589 after 0.78 seconds
[0m19:13:04.337542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D72B55FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D751E7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D751E74C0>]}
[0m19:13:04.337542 [debug] [MainThread]: Flushing usage events
[0m19:13:04.801556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:59.771604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002880FCC5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028811C339A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028811C338E0>]}


============================== 19:15:59.771604 | 954a6d42-73ea-4e49-aeda-0182314ba3ca ==============================
[0m19:15:59.771604 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:15:59.771604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s sn_users', 'send_anonymous_usage_stats': 'True'}
[0m19:15:59.935304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954a6d42-73ea-4e49-aeda-0182314ba3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002880EFED040>]}
[0m19:16:00.043930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954a6d42-73ea-4e49-aeda-0182314ba3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002880EFED8B0>]}
[0m19:16:00.043930 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:16:00.217723 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:16:00.411080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:16:00.411080 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:16:00.411080 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:16:00.603817 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:16:00.603817 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:16:00.617436 [debug] [MainThread]: Command `dbt snapshot` failed at 19:16:00.617436 after 0.90 seconds
[0m19:16:00.617436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002880FCC5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028812327280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288124BFA90>]}
[0m19:16:00.618440 [debug] [MainThread]: Flushing usage events
[0m19:16:01.187856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:29.067044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A6CD5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A8C536D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A8C53790>]}


============================== 19:18:29.067044 | 64b09da0-a77f-4b05-9cff-7102e3bb2482 ==============================
[0m19:18:29.067044 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:18:29.067044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:29.239737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64b09da0-a77f-4b05-9cff-7102e3bb2482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A559A8B0>]}
[0m19:18:29.276658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64b09da0-a77f-4b05-9cff-7102e3bb2482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A57EF580>]}
[0m19:18:29.276658 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:29.461421 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:18:29.622513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:18:29.622513 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:18:29.622513 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:18:29.795028 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:18:29.795028 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:18:29.812737 [debug] [MainThread]: Command `dbt snapshot` failed at 19:18:29.812010 after 0.78 seconds
[0m19:18:29.812737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A6CD5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A9368070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A93684C0>]}
[0m19:18:29.813756 [debug] [MainThread]: Flushing usage events
[0m19:18:30.287853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:37.738518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592C591040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592E503700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592E5037C0>]}


============================== 19:18:37.738518 | abb134d3-7d18-4624-91ce-e16cd60a8d3a ==============================
[0m19:18:37.738518 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:18:37.738518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s sn_users', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:37.902875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abb134d3-7d18-4624-91ce-e16cd60a8d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592B0BEF10>]}
[0m19:18:37.949595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abb134d3-7d18-4624-91ce-e16cd60a8d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592B08A310>]}
[0m19:18:37.949595 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:38.129350 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:18:38.282821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:18:38.282821 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:18:38.282821 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:18:38.457449 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:18:38.473587 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:18:38.482887 [debug] [MainThread]: Command `dbt snapshot` failed at 19:18:38.482887 after 0.78 seconds
[0m19:18:38.482887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592C591040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592EBE8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001592ED7FAF0>]}
[0m19:18:38.482887 [debug] [MainThread]: Flushing usage events
[0m19:18:38.927684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:02.792063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020577A210D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020579993790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020579993850>]}


============================== 19:19:02.797238 | edf05c97-6b56-4382-9b04-2b465d8035de ==============================
[0m19:19:02.797238 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:19:02.798246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:19:02.976234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edf05c97-6b56-4382-9b04-2b465d8035de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020576D60490>]}
[0m19:19:03.035781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edf05c97-6b56-4382-9b04-2b465d8035de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057991A280>]}
[0m19:19:03.036783 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:19:03.236518 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:19:03.409064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:19:03.409064 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:19:03.409064 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:19:03.578061 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:19:03.578061 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:19:03.600377 [debug] [MainThread]: Command `dbt snapshot` failed at 19:19:03.600377 after 0.87 seconds
[0m19:19:03.601375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020577A210D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A076370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A20FBB0>]}
[0m19:19:03.601375 [debug] [MainThread]: Flushing usage events
[0m19:19:04.048286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:17.478075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46A0C0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46C033700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46C0337C0>]}


============================== 19:20:17.478075 | 11e1e9b8-d826-4982-bb2b-1993411d50e6 ==============================
[0m19:20:17.478075 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:20:17.478075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s sn_users', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:20:17.672609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11e1e9b8-d826-4982-bb2b-1993411d50e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46C0123D0>]}
[0m19:20:17.721374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11e1e9b8-d826-4982-bb2b-1993411d50e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46BE8B7F0>]}
[0m19:20:17.721374 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:17.919757 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:20:18.094233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:20:18.094233 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:20:18.094233 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:20:18.272354 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:20:18.272354 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:20:18.287738 [debug] [MainThread]: Command `dbt snapshot` failed at 19:20:18.287738 after 0.85 seconds
[0m19:20:18.288736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46A0C0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46942C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46C8AFBB0>]}
[0m19:20:18.288736 [debug] [MainThread]: Flushing usage events
[0m19:20:18.773896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:24.891179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B90C5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BB0436D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BB043790>]}


============================== 19:21:24.891179 | afddd794-94ca-4428-ac01-5544d141a373 ==============================
[0m19:21:24.891179 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:21:24.891179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:21:25.046832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afddd794-94ca-4428-ac01-5544d141a373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B798A8B0>]}
[0m19:21:25.101143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afddd794-94ca-4428-ac01-5544d141a373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B83DF580>]}
[0m19:21:25.101143 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:21:25.282024 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:21:25.443288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:21:25.443288 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:21:25.443288 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:21:25.619257 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:21:25.619257 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:21:25.637195 [debug] [MainThread]: Command `dbt snapshot` failed at 19:21:25.636740 after 0.78 seconds
[0m19:21:25.637195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B90C5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BB757070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BB7574C0>]}
[0m19:21:25.638248 [debug] [MainThread]: Flushing usage events
[0m19:21:26.203951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:37.500170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5AA720070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5AC67F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5AC67F670>]}


============================== 19:22:37.500170 | fb4dee33-12a8-4941-98f5-59c99aae16eb ==============================
[0m19:22:37.500170 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:22:37.500170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:22:37.624070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb4dee33-12a8-4941-98f5-59c99aae16eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5AC665B20>]}
[0m19:22:37.688911 [debug] [MainThread]: Command `dbt clean` succeeded at 19:22:37.688911 after 0.25 seconds
[0m19:22:37.690003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5AA720070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5AC7996A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5AC6FAE50>]}
[0m19:22:37.690003 [debug] [MainThread]: Flushing usage events
[0m19:22:38.165135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:51.430622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF4271070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF61E3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF61E37C0>]}


============================== 19:22:51.430622 | feb18e04-8567-49c7-9d83-426430fcc83f ==============================
[0m19:22:51.430622 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:22:51.430622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s sn_users', 'send_anonymous_usage_stats': 'True'}
[0m19:22:51.596754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feb18e04-8567-49c7-9d83-426430fcc83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF61C23D0>]}
[0m19:22:51.645402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feb18e04-8567-49c7-9d83-426430fcc83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF603B7F0>]}
[0m19:22:51.645402 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:22:51.812016 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:22:51.812016 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:22:51.828299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'feb18e04-8567-49c7-9d83-426430fcc83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF65435B0>]}
[0m19:22:53.015135 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_users' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m19:22:53.031326 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 't_deal_changes' in the 'models' section of file 'models\transformations\crm\crm.yml'
[0m19:22:53.053203 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:22:53.053203 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:22:53.068364 [debug] [MainThread]: Command `dbt snapshot` failed at 19:22:53.067362 after 1.68 seconds
[0m19:22:53.068364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF4271070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF45B25B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAF69E8CD0>]}
[0m19:22:53.069897 [debug] [MainThread]: Flushing usage events
[0m19:22:53.511202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:59.932722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80B565FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80D4E36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80D4E3790>]}


============================== 19:23:59.932722 | 7137b11a-62bd-41bf-bd7a-a1f7dcda3ca9 ==============================
[0m19:23:59.932722 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:23:59.932722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_users', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:00.138219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7137b11a-62bd-41bf-bd7a-a1f7dcda3ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E809E2A8B0>]}
[0m19:24:00.185413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7137b11a-62bd-41bf-bd7a-a1f7dcda3ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80A87F580>]}
[0m19:24:00.195483 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:24:00.357028 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:24:00.373236 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:24:00.374004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7137b11a-62bd-41bf-bd7a-a1f7dcda3ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80D4837F0>]}
[0m19:24:01.541308 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_users' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m19:24:01.543935 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 't_deal_changes' in the 'models' section of file 'models\transformations\crm\crm.yml'
[0m19:24:01.566696 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:24:01.566696 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:24:01.580290 [debug] [MainThread]: Command `dbt snapshot` failed at 19:24:01.580290 after 1.69 seconds
[0m19:24:01.580290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80B565FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80DE8FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80DE8FA60>]}
[0m19:24:01.583545 [debug] [MainThread]: Flushing usage events
[0m19:24:02.784267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:00.912320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6024C00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A604433760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A604433820>]}


============================== 19:25:00.912320 | 64789185-1612-4464-b47e-a739e5eabbca ==============================
[0m19:25:00.912320 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:25:00.912320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s sn_users', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:25:01.069071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64789185-1612-4464-b47e-a739e5eabbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6017B8340>]}
[0m19:25:01.116281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64789185-1612-4464-b47e-a739e5eabbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6017E41F0>]}
[0m19:25:01.116281 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:25:01.304342 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:25:01.304342 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:25:01.304342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64789185-1612-4464-b47e-a739e5eabbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60478AD00>]}
[0m19:25:02.306420 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot sn_activities (snapshots\sn_activities.sql)
  expected token ',', got '='
    line 5
      --     target_schema='public_staging',
[0m19:25:02.322672 [debug] [MainThread]: Command `dbt snapshot` failed at 19:25:02.322672 after 1.46 seconds
[0m19:25:02.322672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6024C00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A604B455B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A604B45C70>]}
[0m19:25:02.322672 [debug] [MainThread]: Flushing usage events
[0m19:25:02.819849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:21.952810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42FE51FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C431DC39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C431DC38E0>]}


============================== 19:25:21.952810 | f8d3b385-8215-4396-ac23-16b8b26cf1f8 ==============================
[0m19:25:21.952810 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:25:21.952810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:25:22.118449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8d3b385-8215-4396-ac23-16b8b26cf1f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42F17E040>]}
[0m19:25:22.165643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8d3b385-8215-4396-ac23-16b8b26cf1f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42F17E8B0>]}
[0m19:25:22.181664 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:25:22.339545 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:25:22.339545 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:25:22.355178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8d3b385-8215-4396-ac23-16b8b26cf1f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42F18E370>]}
[0m19:25:23.333586 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot sn_activities (snapshots\sn_activities.sql)
  expected token ',', got '='
    line 5
      --     target_schema='public_staging',
[0m19:25:23.333586 [debug] [MainThread]: Command `dbt snapshot` failed at 19:25:23.333586 after 1.42 seconds
[0m19:25:23.333586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42FE51FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43249A130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C432477610>]}
[0m19:25:23.333586 [debug] [MainThread]: Flushing usage events
[0m19:25:23.790976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:47.555600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0FA531FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0FC4A39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0FC4A38E0>]}


============================== 19:25:47.571306 | 7e5b1cee-41d6-440c-b342-ab64479cc692 ==============================
[0m19:25:47.571306 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:25:47.571306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot -m sn_users', 'send_anonymous_usage_stats': 'True'}
[0m19:25:47.718639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5b1cee-41d6-440c-b342-ab64479cc692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F985D040>]}
[0m19:25:47.765435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e5b1cee-41d6-440c-b342-ab64479cc692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F985D8B0>]}
[0m19:25:47.765435 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:25:47.933200 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:25:47.933200 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:25:47.948848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e5b1cee-41d6-440c-b342-ab64479cc692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0F986CD30>]}
[0m19:25:49.090091 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot sn_activities (snapshots\sn_activities.sql)
  expected token ',', got '='
    line 5
      --     target_schema='public_staging',
[0m19:25:49.106176 [debug] [MainThread]: Command `dbt snapshot` failed at 19:25:49.106176 after 1.58 seconds
[0m19:25:49.106176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0FA531FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0FCB7A130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0FCB57610>]}
[0m19:25:49.106176 [debug] [MainThread]: Flushing usage events
[0m19:25:49.549435 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:28.539792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE08DB1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0AD22700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0AD227C0>]}


============================== 19:26:28.539792 | 25889d8d-bd1a-4e47-8819-5f671ae41958 ==============================
[0m19:26:28.539792 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:26:28.539792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select sn_users', 'send_anonymous_usage_stats': 'True'}
[0m19:26:28.699311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25889d8d-bd1a-4e47-8819-5f671ae41958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0ACFF3D0>]}
[0m19:26:28.766847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25889d8d-bd1a-4e47-8819-5f671ae41958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0AB7B7F0>]}
[0m19:26:28.767165 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:26:28.959758 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:26:28.959758 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:26:28.959758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25889d8d-bd1a-4e47-8819-5f671ae41958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0B0835B0>]}
[0m19:26:29.992797 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot sn_activities (snapshots\sn_activities.sql)
  expected token ',', got '='
    line 5
      --     target_schema='public_staging',
[0m19:26:29.992797 [debug] [MainThread]: Command `dbt snapshot` failed at 19:26:29.992797 after 1.50 seconds
[0m19:26:29.992797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE08DB1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0B2A9A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE081C0D00>]}
[0m19:26:29.992797 [debug] [MainThread]: Flushing usage events
[0m19:26:30.468458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:01.529375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD88630100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8A5A27F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8A5A28B0>]}


============================== 19:27:01.546171 | 7a9ef14f-9b41-4fef-921e-c00db4bd58db ==============================
[0m19:27:01.546171 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:27:01.547581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --select sn_users --debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:01.713117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a9ef14f-9b41-4fef-921e-c00db4bd58db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8A580220>]}
[0m19:27:01.767024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a9ef14f-9b41-4fef-921e-c00db4bd58db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8A54AE80>]}
[0m19:27:01.783340 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:27:01.965224 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:27:01.966849 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:27:01.966849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a9ef14f-9b41-4fef-921e-c00db4bd58db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8A9121F0>]}
[0m19:27:03.022629 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot sn_activities (snapshots\sn_activities.sql)
  expected token ',', got '='
    line 5
      --     target_schema='public_staging',
[0m19:27:03.022629 [debug] [MainThread]: Command `dbt snapshot` failed at 19:27:03.022629 after 1.54 seconds
[0m19:27:03.022629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD88630100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8ABA4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8ABA41F0>]}
[0m19:27:03.022629 [debug] [MainThread]: Flushing usage events
[0m19:27:03.516202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:45.744749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014318621070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001431A593700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001431A5937C0>]}


============================== 19:27:45.744749 | 9697df3d-1a4a-4f97-9e08-0ad33dc2254f ==============================
[0m19:27:45.744749 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:27:45.744749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:27:45.901293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9697df3d-1a4a-4f97-9e08-0ad33dc2254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001431A5713D0>]}
[0m19:27:45.948875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9697df3d-1a4a-4f97-9e08-0ad33dc2254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001431A3EB7F0>]}
[0m19:27:45.948875 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:27:46.126276 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:27:46.126276 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:27:46.126276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9697df3d-1a4a-4f97-9e08-0ad33dc2254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001431A8F35B0>]}
[0m19:27:47.325491 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_users' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m19:27:47.325491 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 't_deal_changes' in the 'models' section of file 'models\transformations\crm\crm.yml'
[0m19:27:47.325491 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.t_user_deal_events' (models\transformations\crm\t_user_deal_events.sql) depends on a node named 'users_snapshot' which was not found
[0m19:27:47.341100 [debug] [MainThread]: Command `dbt snapshot` failed at 19:27:47.341100 after 1.64 seconds
[0m19:27:47.342107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014318621070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143179B7DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001431A8DE6D0>]}
[0m19:27:47.342161 [debug] [MainThread]: Flushing usage events
[0m19:27:47.818270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:07.653789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A6391070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A8303700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A83037C0>]}


============================== 19:28:07.653789 | 0f1ab08b-e93b-4553-bdbf-b00aa65e2080 ==============================
[0m19:28:07.653789 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:28:07.653789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s sn_users', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:07.811479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A82E13D0>]}
[0m19:28:07.859721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A815B7F0>]}
[0m19:28:07.859721 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:28:08.107806 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:28:08.107806 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:28:08.107806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A86635B0>]}
[0m19:28:09.243818 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_users' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m19:28:09.243818 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 't_deal_changes' in the 'models' section of file 'models\transformations\crm\crm.yml'
[0m19:28:09.331364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A8D02130>]}
[0m19:28:09.437583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:09.437583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:09.453976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A8CCD3D0>]}
[0m19:28:09.453976 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:28:09.469173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A8D1DFD0>]}
[0m19:28:09.469173 [info ] [MainThread]: 
[0m19:28:09.469173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:09.469173 [info ] [MainThread]: 
[0m19:28:09.469173 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:09.474792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:28:09.559200 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:28:09.560211 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:28:09.560211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:09.589342 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.029 seconds
[0m19:28:09.590302 [debug] [ThreadPool]: On list_postgres: Close
[0m19:28:09.596211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m19:28:09.596745 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:09.596745 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:28:09.596745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:09.627523 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m19:28:09.628163 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:09.628671 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:28:09.633171 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:28:09.634773 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:28:09.636672 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:28:09.637470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m19:28:09.639261 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:09.639261 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:28:09.639261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:09.657728 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m19:28:09.671741 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:09.672244 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:09.677108 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m19:28:09.678820 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:28:09.680612 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:28:09.681552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m19:28:09.682061 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:09.682061 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:28:09.682061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:09.703635 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:28:09.705411 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:09.705411 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:28:09.710364 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m19:28:09.711629 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:28:09.713837 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:28:09.716345 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:09.716345 [debug] [MainThread]: On master: BEGIN
[0m19:28:09.716345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:09.747957 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m19:28:09.748781 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:09.749335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:09.755553 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m19:28:09.757300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A815B040>]}
[0m19:28:09.757915 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:09.759055 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:09.759055 [debug] [MainThread]: On master: BEGIN
[0m19:28:09.759055 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:28:09.763680 [debug] [MainThread]: On master: COMMIT
[0m19:28:09.764092 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:09.764782 [debug] [MainThread]: On master: COMMIT
[0m19:28:09.766807 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:28:09.767429 [debug] [MainThread]: On master: Close
[0m19:28:09.772426 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m19:28:09.773009 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_users .................................. [RUN]
[0m19:28:09.774799 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_users'
[0m19:28:09.774799 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m19:28:09.785106 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m19:28:09.839016 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:09.839016 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:09.839016 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:28:09.879617 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.041 seconds
[0m19:28:09.879617 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:09.879617 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:09.879617 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:28:09.879617 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m19:28:09.879617 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:09.879617 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m19:28:09.879617 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m19:28:09.893844 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:09.894356 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      
  
    

  create  table "postgres"."public_staging"."sn_users"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



  );
  
  
[0m19:28:09.904294 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.011 seconds
[0m19:28:09.910065 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:09.910065 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:09.910065 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:09.926164 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m19:28:09.926164 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m19:28:09.926164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f1ab08b-e93b-4553-bdbf-b00aa65e2080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0AA261940>]}
[0m19:28:09.926164 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_users .................................. [[32mSELECT 1787[0m in 0.15s]
[0m19:28:09.926164 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m19:28:09.926164 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:09.926164 [debug] [MainThread]: On master: BEGIN
[0m19:28:09.926164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:09.948372 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:28:09.961804 [debug] [MainThread]: On master: COMMIT
[0m19:28:09.962349 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:09.962349 [debug] [MainThread]: On master: COMMIT
[0m19:28:09.964579 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:28:09.965593 [debug] [MainThread]: On master: Close
[0m19:28:09.966592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:09.967585 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:28:09.967929 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m19:28:09.967929 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m19:28:09.967929 [info ] [MainThread]: 
[0m19:28:09.969025 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m19:28:09.970939 [debug] [MainThread]: Command end result
[0m19:28:09.996270 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:09.999544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:10.001796 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:28:10.001796 [info ] [MainThread]: 
[0m19:28:10.001796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:10.001796 [info ] [MainThread]: 
[0m19:28:10.001796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:28:10.001796 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:28:10.001796 after 2.40 seconds
[0m19:28:10.001796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A6391070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A5FDD8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A772B070>]}
[0m19:28:10.001796 [debug] [MainThread]: Flushing usage events
[0m19:28:11.166945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:15.166720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028028C42040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802ABB3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802ABB37C0>]}


============================== 19:28:15.166720 | b7988c51-bdd9-471f-8296-31a319752eda ==============================
[0m19:28:15.166720 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:28:15.166720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_users', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:15.334167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7988c51-bdd9-471f-8296-31a319752eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028027F6B250>]}
[0m19:28:15.386806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7988c51-bdd9-471f-8296-31a319752eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028027F39310>]}
[0m19:28:15.386806 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:28:15.559705 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:28:15.719356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:15.719356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:15.766712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7988c51-bdd9-471f-8296-31a319752eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802B2E1130>]}
[0m19:28:15.861979 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:15.861979 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:15.877706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7988c51-bdd9-471f-8296-31a319752eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802B2ECFD0>]}
[0m19:28:15.877706 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:28:15.877706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7988c51-bdd9-471f-8296-31a319752eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802B3048B0>]}
[0m19:28:15.877706 [info ] [MainThread]: 
[0m19:28:15.893786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:15.893786 [info ] [MainThread]: 
[0m19:28:15.893786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:15.893786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:28:15.964664 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:28:15.964664 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:28:15.964664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:16.000445 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.029 seconds
[0m19:28:16.001347 [debug] [ThreadPool]: On list_postgres: Close
[0m19:28:16.012912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m19:28:16.014304 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:16.014304 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:28:16.014304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:16.029936 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:28:16.040450 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:16.041005 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:28:16.045549 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:28:16.046843 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:28:16.049553 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:28:16.050098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:28:16.050098 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:16.050098 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:28:16.050098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:16.061256 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:28:16.076945 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:16.078015 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:28:16.082946 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:28:16.084036 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:28:16.085954 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:28:16.086786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:28:16.087796 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:16.087796 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:28:16.087796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:16.108049 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:28:16.109810 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:16.110202 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:16.115096 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:28:16.116596 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:28:16.118645 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:28:16.123514 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:16.123514 [debug] [MainThread]: On master: BEGIN
[0m19:28:16.123514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:16.145095 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:28:16.146604 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:16.147119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:16.153118 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:28:16.155315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7988c51-bdd9-471f-8296-31a319752eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802AA0BD60>]}
[0m19:28:16.155415 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:16.156839 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:16.156839 [debug] [MainThread]: On master: BEGIN
[0m19:28:16.156839 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:28:16.160265 [debug] [MainThread]: On master: COMMIT
[0m19:28:16.160547 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:16.161218 [debug] [MainThread]: On master: COMMIT
[0m19:28:16.163376 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:28:16.163974 [debug] [MainThread]: On master: Close
[0m19:28:16.171408 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m19:28:16.171408 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_users .................................. [RUN]
[0m19:28:16.171408 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_users'
[0m19:28:16.171408 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m19:28:16.171408 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m19:28:16.230214 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.231295 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m19:28:16.231295 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:28:16.247259 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m19:28:16.262756 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.263756 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:16.263756 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m19:28:16.295245 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.295245 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp192816295245"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:28:16.311433 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m19:28:16.311433 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.311433 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192816295245'
        
      order by ordinal_position

  
[0m19:28:16.311433 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:28:16.327416 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.327416 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:16.327416 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m19:28:16.327416 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.327416 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192816295245'
        
      order by ordinal_position

  
[0m19:28:16.327416 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:28:16.327416 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.327416 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:16.343164 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:28:16.343164 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.343164 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192816295245'
        
      order by ordinal_position

  
[0m19:28:16.343164 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:28:16.358799 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.358799 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:16.358799 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:28:16.374429 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.374429 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:16.374429 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:28:16.374429 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.374429 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.374429 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp192816295245" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp192816295245" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:28:16.374429 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m19:28:16.390150 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:16.390150 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:16.390150 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:16.390150 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m19:28:16.406015 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m19:28:16.406015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7988c51-bdd9-471f-8296-31a319752eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802B834DF0>]}
[0m19:28:16.406015 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_users .................................. [[32mINSERT 0 0[0m in 0.23s]
[0m19:28:16.406015 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m19:28:16.406015 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:16.406015 [debug] [MainThread]: On master: BEGIN
[0m19:28:16.406015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:16.431482 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:28:16.437662 [debug] [MainThread]: On master: COMMIT
[0m19:28:16.438181 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:16.438670 [debug] [MainThread]: On master: COMMIT
[0m19:28:16.440782 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:28:16.441172 [debug] [MainThread]: On master: Close
[0m19:28:16.441675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:16.442169 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:28:16.442169 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:28:16.442669 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m19:28:16.443169 [info ] [MainThread]: 
[0m19:28:16.443676 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m19:28:16.444675 [debug] [MainThread]: Command end result
[0m19:28:16.498449 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:16.498449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:16.498449 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:28:16.498449 [info ] [MainThread]: 
[0m19:28:16.498449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:16.498449 [info ] [MainThread]: 
[0m19:28:16.498449 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:28:16.498449 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:28:16.498449 after 1.38 seconds
[0m19:28:16.512773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028028C42040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028029FCE1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028027F393A0>]}
[0m19:28:16.512937 [debug] [MainThread]: Flushing usage events
[0m19:28:16.955347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:35.060204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AA3500A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AC2B3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AC2B3820>]}


============================== 19:28:35.060204 | 8b91118b-d0bd-4030-aec6-21c481258998 ==============================
[0m19:28:35.060204 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:28:35.060204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_users', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:35.226621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b91118b-d0bd-4030-aec6-21c481258998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269A9649340>]}
[0m19:28:35.274489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b91118b-d0bd-4030-aec6-21c481258998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269A96741F0>]}
[0m19:28:35.274489 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:28:35.442381 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:28:35.608915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:35.608915 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_users.sql
[0m19:28:35.857551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b91118b-d0bd-4030-aec6-21c481258998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269ACBB4130>]}
[0m19:28:35.953383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:35.953383 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:35.969620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b91118b-d0bd-4030-aec6-21c481258998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269ACBA33D0>]}
[0m19:28:35.969620 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:28:35.969620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b91118b-d0bd-4030-aec6-21c481258998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269A8B19A30>]}
[0m19:28:35.969620 [info ] [MainThread]: 
[0m19:28:35.969620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:35.969620 [info ] [MainThread]: 
[0m19:28:35.985504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:35.985504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:28:36.046874 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:28:36.046874 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:28:36.046874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:36.090018 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.029 seconds
[0m19:28:36.091093 [debug] [ThreadPool]: On list_postgres: Close
[0m19:28:36.094995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m19:28:36.094995 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:36.094995 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:28:36.094995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:36.111255 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m19:28:36.126331 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:36.126745 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:28:36.132481 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m19:28:36.134336 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:28:36.135894 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:28:36.137101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m19:28:36.137761 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:36.137761 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:28:36.137761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:36.154525 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m19:28:36.169960 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:36.170469 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:28:36.174989 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:28:36.176079 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:28:36.178230 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:28:36.178806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m19:28:36.180915 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:36.180915 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:28:36.180915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:36.197583 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:28:36.197583 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:36.203783 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:36.207757 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:28:36.208836 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:28:36.208836 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:28:36.245594 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.245594 [debug] [MainThread]: On master: BEGIN
[0m19:28:36.245594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:36.276863 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:28:36.278937 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.279882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:36.284281 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m19:28:36.286587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b91118b-d0bd-4030-aec6-21c481258998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269A8C8FA00>]}
[0m19:28:36.286854 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:36.289192 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.289192 [debug] [MainThread]: On master: BEGIN
[0m19:28:36.292834 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:28:36.293210 [debug] [MainThread]: On master: COMMIT
[0m19:28:36.293669 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.294168 [debug] [MainThread]: On master: COMMIT
[0m19:28:36.296169 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:28:36.296169 [debug] [MainThread]: On master: Close
[0m19:28:36.304322 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m19:28:36.304322 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_users .................................. [RUN]
[0m19:28:36.304322 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_users'
[0m19:28:36.304322 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m19:28:36.309267 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m19:28:36.363843 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.364863 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m19:28:36.364863 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:28:36.393757 [debug] [Thread-1  ]: SQL status: BEGIN in 0.028 seconds
[0m19:28:36.394800 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.395029 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:36.402531 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m19:28:36.441690 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.441690 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp192836425881"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:28:36.441690 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.009 seconds
[0m19:28:36.441690 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.441690 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192836425881'
        
      order by ordinal_position

  
[0m19:28:36.457228 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:28:36.457228 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.457228 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:36.457228 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:28:36.457228 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.457228 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192836425881'
        
      order by ordinal_position

  
[0m19:28:36.472934 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:28:36.472934 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.472934 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:36.472934 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m19:28:36.488475 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.488475 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192836425881'
        
      order by ordinal_position

  
[0m19:28:36.488475 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:28:36.504203 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.504203 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:36.504203 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:28:36.504203 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.504203 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:36.504203 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:28:36.504203 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.504203 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.519825 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp192836425881" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp192836425881" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:28:36.519825 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m19:28:36.536709 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:36.536963 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:36.537690 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:36.538103 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m19:28:36.538103 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m19:28:36.548727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b91118b-d0bd-4030-aec6-21c481258998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269A8A20070>]}
[0m19:28:36.548727 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_users .................................. [[32mINSERT 0 0[0m in 0.23s]
[0m19:28:36.548727 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m19:28:36.548727 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.548727 [debug] [MainThread]: On master: BEGIN
[0m19:28:36.548727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:36.571434 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:28:36.577305 [debug] [MainThread]: On master: COMMIT
[0m19:28:36.578147 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:36.578313 [debug] [MainThread]: On master: COMMIT
[0m19:28:36.580812 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:28:36.581333 [debug] [MainThread]: On master: Close
[0m19:28:36.582315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:36.582815 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:28:36.582815 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:28:36.583525 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m19:28:36.584055 [info ] [MainThread]: 
[0m19:28:36.584626 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m19:28:36.586464 [debug] [MainThread]: Command end result
[0m19:28:36.607768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:36.609855 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:36.617025 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:28:36.617025 [info ] [MainThread]: 
[0m19:28:36.617025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:36.617025 [info ] [MainThread]: 
[0m19:28:36.617025 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:28:36.617025 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:28:36.617025 after 1.60 seconds
[0m19:28:36.617025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AA3500A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AC10F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AC236BE0>]}
[0m19:28:36.617025 [debug] [MainThread]: Flushing usage events
[0m19:28:37.070555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:39.968864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0BA75FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0D9F36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0D9F3790>]}


============================== 19:28:39.968864 | 387850c6-5bb7-4fe4-860b-9636894c4dd2 ==============================
[0m19:28:39.968864 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:28:39.968864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:40.125664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '387850c6-5bb7-4fe4-860b-9636894c4dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0A33A8B0>]}
[0m19:28:40.173222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '387850c6-5bb7-4fe4-860b-9636894c4dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0AD90580>]}
[0m19:28:40.173222 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:28:40.359504 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:28:40.584825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:40.584825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:40.631727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '387850c6-5bb7-4fe4-860b-9636894c4dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0E121130>]}
[0m19:28:40.727684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:40.727684 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:40.743899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '387850c6-5bb7-4fe4-860b-9636894c4dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0E12FCA0>]}
[0m19:28:40.743899 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:28:40.759650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387850c6-5bb7-4fe4-860b-9636894c4dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0E143340>]}
[0m19:28:40.759650 [info ] [MainThread]: 
[0m19:28:40.759650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:40.759650 [info ] [MainThread]: 
[0m19:28:40.764998 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:40.771080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:28:40.851548 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:28:40.851548 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:28:40.851548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:40.878510 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.028 seconds
[0m19:28:40.878510 [debug] [ThreadPool]: On list_postgres: Close
[0m19:28:40.878510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:28:40.894468 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:40.894468 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:28:40.894468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:40.910219 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:28:40.916310 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:40.916989 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:40.921517 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:28:40.922765 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:28:40.924508 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:28:40.925694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m19:28:40.929378 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:40.929886 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:28:40.930415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:40.942472 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:28:40.953112 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:28:40.953363 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:28:40.957888 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:28:40.959396 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:28:40.961394 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:28:40.962107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m19:28:40.964387 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:40.964387 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:28:40.964387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:40.980790 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:28:40.987536 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:28:40.988046 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:28:40.992043 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:28:40.993130 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:28:40.994544 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:28:40.998804 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:40.998804 [debug] [MainThread]: On master: BEGIN
[0m19:28:40.998804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:41.014887 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:28:41.022759 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:41.023255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:41.038521 [debug] [MainThread]: SQL status: SELECT 4 in 0.015 seconds
[0m19:28:41.038521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387850c6-5bb7-4fe4-860b-9636894c4dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0E237910>]}
[0m19:28:41.038521 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:41.038521 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:41.038521 [debug] [MainThread]: On master: BEGIN
[0m19:28:41.038521 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:28:41.046868 [debug] [MainThread]: On master: COMMIT
[0m19:28:41.047318 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:41.047318 [debug] [MainThread]: On master: COMMIT
[0m19:28:41.049928 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:28:41.050410 [debug] [MainThread]: On master: Close
[0m19:28:41.057862 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m19:28:41.057862 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_users .................................. [RUN]
[0m19:28:41.057862 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_users'
[0m19:28:41.057862 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m19:28:41.057862 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m19:28:41.120234 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.120234 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m19:28:41.121139 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:28:41.145159 [debug] [Thread-1  ]: SQL status: BEGIN in 0.039 seconds
[0m19:28:41.161452 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.161987 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:41.170746 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.008 seconds
[0m19:28:41.210077 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.210077 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp192841193924"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:28:41.210077 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m19:28:41.210077 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.210077 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192841193924'
        
      order by ordinal_position

  
[0m19:28:41.227322 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:28:41.228724 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.228724 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:41.228724 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m19:28:41.228724 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.228724 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192841193924'
        
      order by ordinal_position

  
[0m19:28:41.228724 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:28:41.245188 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.245188 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:28:41.245188 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:28:41.245188 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.245188 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp192841193924'
        
      order by ordinal_position

  
[0m19:28:41.260835 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:28:41.260835 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.260835 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:41.276952 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:28:41.276952 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.276952 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:28:41.276952 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:28:41.276952 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.276952 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.276952 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp192841193924" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp192841193924" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:28:41.276952 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m19:28:41.292672 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:41.292672 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:28:41.292672 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:28:41.292672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m19:28:41.308376 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m19:28:41.308376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387850c6-5bb7-4fe4-860b-9636894c4dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0E5B0DC0>]}
[0m19:28:41.308376 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_users .................................. [[32mINSERT 0 0[0m in 0.25s]
[0m19:28:41.308376 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m19:28:41.308376 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:41.308376 [debug] [MainThread]: On master: BEGIN
[0m19:28:41.308376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:41.330522 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:28:41.340085 [debug] [MainThread]: On master: COMMIT
[0m19:28:41.340237 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:41.340979 [debug] [MainThread]: On master: COMMIT
[0m19:28:41.342877 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:28:41.342877 [debug] [MainThread]: On master: Close
[0m19:28:41.343881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:41.344607 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:28:41.344956 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:28:41.345385 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m19:28:41.346475 [info ] [MainThread]: 
[0m19:28:41.347591 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m19:28:41.349200 [debug] [MainThread]: Command end result
[0m19:28:41.396167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:28:41.411591 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:28:41.418050 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:28:41.419052 [info ] [MainThread]: 
[0m19:28:41.420079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:41.421009 [info ] [MainThread]: 
[0m19:28:41.422018 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:28:41.423017 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:28:41.423017 after 1.50 seconds
[0m19:28:41.423017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0BA75FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0B6CBAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0D9F3BE0>]}
[0m19:28:41.424018 [debug] [MainThread]: Flushing usage events
[0m19:28:41.861686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:40.750733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C70F131040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7110A3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7110A37C0>]}


============================== 19:29:40.750733 | 63788009-d8df-4717-a029-82d8e59e9ea3 ==============================
[0m19:29:40.750733 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:29:40.750733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s sn_activities', 'send_anonymous_usage_stats': 'True'}
[0m19:29:40.905138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63788009-d8df-4717-a029-82d8e59e9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C70E45C250>]}
[0m19:29:40.952002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63788009-d8df-4717-a029-82d8e59e9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C70E428310>]}
[0m19:29:40.952002 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:29:41.124460 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:29:41.292172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:41.292172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:41.339042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63788009-d8df-4717-a029-82d8e59e9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7117D1130>]}
[0m19:29:41.431329 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:29:41.431329 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:29:41.458958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63788009-d8df-4717-a029-82d8e59e9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7117DF040>]}
[0m19:29:41.458958 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:29:41.458958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63788009-d8df-4717-a029-82d8e59e9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7117F48B0>]}
[0m19:29:41.458958 [info ] [MainThread]: 
[0m19:29:41.458958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:41.458958 [info ] [MainThread]: 
[0m19:29:41.469015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:29:41.474634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:29:41.547556 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:29:41.547556 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:29:41.547556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:41.575616 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.030 seconds
[0m19:29:41.575616 [debug] [ThreadPool]: On list_postgres: Close
[0m19:29:41.575616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:29:41.593942 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:29:41.593942 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:29:41.593942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:41.616969 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:29:41.617652 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:29:41.618476 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:29:41.622369 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:29:41.624393 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:29:41.626111 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:29:41.627335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:29:41.630448 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:29:41.630448 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:29:41.631404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:41.642065 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:29:41.652280 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:29:41.652522 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:29:41.656228 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m19:29:41.657848 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:29:41.659855 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:29:41.660851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:29:41.663391 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:29:41.663391 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:29:41.663391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:41.695030 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m19:29:41.696376 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:29:41.696921 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:29:41.702061 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:29:41.703281 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:29:41.704692 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:29:41.708860 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:41.708860 [debug] [MainThread]: On master: BEGIN
[0m19:29:41.708860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:41.725660 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:29:41.734930 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:41.735535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:29:41.741194 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:29:41.743047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63788009-d8df-4717-a029-82d8e59e9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C711811AF0>]}
[0m19:29:41.743614 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:41.745719 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:41.745719 [debug] [MainThread]: On master: BEGIN
[0m19:29:41.745719 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:29:41.745719 [debug] [MainThread]: On master: COMMIT
[0m19:29:41.749384 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:41.749947 [debug] [MainThread]: On master: COMMIT
[0m19:29:41.752100 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:29:41.752173 [debug] [MainThread]: On master: Close
[0m19:29:41.760475 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:29:41.760475 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:29:41.760475 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:29:41.760475 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:29:41.760475 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:29:41.825851 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:41.825851 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:29:41.825851 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:29:41.842149 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.021 seconds
[0m19:29:41.858222 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:41.858222 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:29:41.858222 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m19:29:41.858222 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:41.858222 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:41.858222 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:29:41.858222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m19:29:41.867797 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:41.868304 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m19:29:41.889441 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.021 seconds
[0m19:29:41.905849 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:29:41.905849 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:41.905849 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:29:41.922097 [debug] [Thread-1  ]: SQL status: COMMIT in 0.016 seconds
[0m19:29:41.922097 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:29:41.928078 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63788009-d8df-4717-a029-82d8e59e9ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C70D9C54F0>]}
[0m19:29:41.928078 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mSELECT 4579[0m in 0.16s]
[0m19:29:41.928078 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:29:41.928078 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:41.928078 [debug] [MainThread]: On master: BEGIN
[0m19:29:41.928078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:41.958657 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m19:29:41.959376 [debug] [MainThread]: On master: COMMIT
[0m19:29:41.960003 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:41.960378 [debug] [MainThread]: On master: COMMIT
[0m19:29:41.962376 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:29:41.962947 [debug] [MainThread]: On master: Close
[0m19:29:41.963876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:41.964431 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:29:41.965417 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m19:29:41.965959 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:29:41.965959 [info ] [MainThread]: 
[0m19:29:41.967382 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m19:29:41.968377 [debug] [MainThread]: Command end result
[0m19:29:41.991430 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:29:41.994783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:29:41.999220 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:29:41.999220 [info ] [MainThread]: 
[0m19:29:41.999220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:41.999220 [info ] [MainThread]: 
[0m19:29:41.999220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:29:41.999220 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:29:41.999220 after 1.30 seconds
[0m19:29:41.999220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C70F131040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7104E6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C70ED7D400>]}
[0m19:29:41.999220 [debug] [MainThread]: Flushing usage events
[0m19:29:42.493011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:45.531325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D0FC5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D2F436D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D2F43790>]}


============================== 19:29:45.531325 | 4408ccb6-c074-4156-a620-aeff527a888d ==============================
[0m19:29:45.531325 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:29:45.531325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_activities', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:29:45.692509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4408ccb6-c074-4156-a620-aeff527a888d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210CF88A8B0>]}
[0m19:29:45.741319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4408ccb6-c074-4156-a620-aeff527a888d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210CFADF580>]}
[0m19:29:45.741319 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:29:45.921573 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:29:46.078514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:46.078514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:46.125635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4408ccb6-c074-4156-a620-aeff527a888d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D3671130>]}
[0m19:29:46.222008 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:29:46.222008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:29:46.237642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4408ccb6-c074-4156-a620-aeff527a888d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D367CCA0>]}
[0m19:29:46.237642 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:29:46.237642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4408ccb6-c074-4156-a620-aeff527a888d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D3693340>]}
[0m19:29:46.237642 [info ] [MainThread]: 
[0m19:29:46.237642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:46.237642 [info ] [MainThread]: 
[0m19:29:46.237642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:29:46.258520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:29:46.327110 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:29:46.328125 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:29:46.328125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:46.380879 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.053 seconds
[0m19:29:46.381968 [debug] [ThreadPool]: On list_postgres: Close
[0m19:29:46.390994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:29:46.392283 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:29:46.392283 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:29:46.392283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:46.418581 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:29:46.418892 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:29:46.419710 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:29:46.424745 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m19:29:46.426733 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:29:46.428988 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:29:46.429704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:29:46.430240 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:29:46.430240 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:29:46.430240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:46.458767 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m19:29:46.471534 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:29:46.472542 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:29:46.477046 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:29:46.478542 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:29:46.480543 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:29:46.481635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:29:46.482176 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:29:46.482176 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:29:46.482176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:46.520295 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m19:29:46.521936 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:29:46.522465 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:29:46.526444 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m19:29:46.527444 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:29:46.529445 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:29:46.530978 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:46.530978 [debug] [MainThread]: On master: BEGIN
[0m19:29:46.536212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:46.549075 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:29:46.557256 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:46.558161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:29:46.563654 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:29:46.565194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4408ccb6-c074-4156-a620-aeff527a888d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D36A5130>]}
[0m19:29:46.565745 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:46.567670 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:46.568214 [debug] [MainThread]: On master: BEGIN
[0m19:29:46.568214 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:29:46.572048 [debug] [MainThread]: On master: COMMIT
[0m19:29:46.572590 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:46.572753 [debug] [MainThread]: On master: COMMIT
[0m19:29:46.575144 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:29:46.575647 [debug] [MainThread]: On master: Close
[0m19:29:46.579640 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:29:46.579640 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:29:46.579640 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:29:46.579640 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:29:46.579640 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:29:46.646428 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.646428 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:29:46.646428 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:29:46.659769 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.023 seconds
[0m19:29:46.685071 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.685071 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:29:46.687551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:29:46.688438 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.688960 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:29:46.698949 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.010 seconds
[0m19:29:46.699466 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.699466 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:29:46.699466 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.005 seconds
[0m19:29:46.732503 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.732503 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp192946732503"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:29:46.748350 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0.012 seconds
[0m19:29:46.758736 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.758736 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp192946732503'
        
      order by ordinal_position

  
[0m19:29:46.764252 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m19:29:46.764252 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.764252 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:29:46.764252 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:29:46.764252 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.764252 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp192946732503'
        
      order by ordinal_position

  
[0m19:29:46.764252 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m19:29:46.779982 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.779982 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:29:46.779982 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:29:46.779982 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.811233 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp192946732503'
        
      order by ordinal_position

  
[0m19:29:46.826969 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:29:46.826969 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.826969 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:29:46.826969 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:29:46.843255 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.843255 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:29:46.843255 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:29:46.843255 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.843255 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.843255 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp192946732503" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp192946732503" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:29:46.843255 [debug] [Thread-1  ]: SQL status: INSERT 0 14 in 0.006 seconds
[0m19:29:46.858932 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:29:46.858932 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:29:46.858932 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:29:46.874642 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m19:29:46.874642 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:29:46.874642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408ccb6-c074-4156-a620-aeff527a888d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210CF8654C0>]}
[0m19:29:46.874642 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 14[0m in 0.30s]
[0m19:29:46.874642 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:29:46.874642 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:46.874642 [debug] [MainThread]: On master: BEGIN
[0m19:29:46.874642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:46.907679 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:29:46.908126 [debug] [MainThread]: On master: COMMIT
[0m19:29:46.909238 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:46.909625 [debug] [MainThread]: On master: COMMIT
[0m19:29:46.911629 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:29:46.912160 [debug] [MainThread]: On master: Close
[0m19:29:46.912706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:46.913123 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:29:46.913627 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m19:29:46.913627 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:29:46.914128 [info ] [MainThread]: 
[0m19:29:46.915126 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m19:29:46.916186 [debug] [MainThread]: Command end result
[0m19:29:46.931101 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:29:46.941169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:29:46.948986 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:29:46.948986 [info ] [MainThread]: 
[0m19:29:46.948986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:46.948986 [info ] [MainThread]: 
[0m19:29:46.948986 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:29:46.948986 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:29:46.948986 after 1.47 seconds
[0m19:29:46.948986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D0FC5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D36A8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210D328E2E0>]}
[0m19:29:46.948986 [debug] [MainThread]: Flushing usage events
[0m19:29:47.391316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:25.728503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19A6C5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19C6436D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19C643790>]}


============================== 19:30:25.744487 | 1d889709-2da2-4c91-a6d6-8066d85587da ==============================
[0m19:30:25.744487 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:30:25.744487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot -s sn_activities', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:30:25.900923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d889709-2da2-4c91-a6d6-8066d85587da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B198F8A8B0>]}
[0m19:30:25.952481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d889709-2da2-4c91-a6d6-8066d85587da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1999DF580>]}
[0m19:30:25.953481 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:30:26.121267 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:30:26.317606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:26.317606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:26.381509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d889709-2da2-4c91-a6d6-8066d85587da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19CD71130>]}
[0m19:30:26.473552 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:30:26.476544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:30:26.489523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d889709-2da2-4c91-a6d6-8066d85587da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19CD7E370>]}
[0m19:30:26.489523 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:30:26.489523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d889709-2da2-4c91-a6d6-8066d85587da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19CD93340>]}
[0m19:30:26.489523 [info ] [MainThread]: 
[0m19:30:26.489523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:26.489523 [info ] [MainThread]: 
[0m19:30:26.489523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:26.489523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:30:26.572828 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:30:26.572828 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:30:26.572828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:26.610934 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.028 seconds
[0m19:30:26.612025 [debug] [ThreadPool]: On list_postgres: Close
[0m19:30:26.621945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:30:26.628725 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:30:26.628725 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:30:26.628725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:26.644501 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m19:30:26.659624 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:30:26.660162 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:30:26.664462 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:30:26.665447 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:30:26.667446 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:30:26.668627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m19:30:26.670329 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:30:26.670329 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:30:26.670329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:26.712929 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m19:30:26.723295 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:30:26.723818 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:30:26.727313 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m19:30:26.729305 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:30:26.731234 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:30:26.732154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m19:30:26.733934 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:30:26.733934 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:30:26.733934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:26.746464 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:30:26.756403 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:30:26.756902 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:30:26.762903 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m19:30:26.764404 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:30:26.766403 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:30:26.768474 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:26.768474 [debug] [MainThread]: On master: BEGIN
[0m19:30:26.768474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:26.784972 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:30:26.796809 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:26.797404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:26.797909 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m19:30:26.797909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d889709-2da2-4c91-a6d6-8066d85587da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19C494880>]}
[0m19:30:26.797909 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:26.797909 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:26.797909 [debug] [MainThread]: On master: BEGIN
[0m19:30:26.797909 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:30:26.810217 [debug] [MainThread]: On master: COMMIT
[0m19:30:26.810724 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:26.811225 [debug] [MainThread]: On master: COMMIT
[0m19:30:26.813226 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:30:26.813226 [debug] [MainThread]: On master: Close
[0m19:30:26.821009 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:30:26.821009 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:30:26.821009 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:30:26.821009 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:30:26.826338 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:30:26.906618 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:26.906618 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:30:26.906618 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:30:26.938938 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.036 seconds
[0m19:30:26.938938 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:26.938938 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:30:26.955400 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:30:26.955400 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:26.955400 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:26.955400 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:30:26.955400 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:30:26.961099 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:26.961246 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m19:30:26.976338 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.015 seconds
[0m19:30:26.994563 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:30:26.995567 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:26.995567 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:30:27.005869 [debug] [Thread-1  ]: SQL status: COMMIT in 0.013 seconds
[0m19:30:27.005869 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:30:27.005869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d889709-2da2-4c91-a6d6-8066d85587da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B198F674C0>]}
[0m19:30:27.005869 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mSELECT 4579[0m in 0.18s]
[0m19:30:27.005869 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:30:27.005869 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:27.005869 [debug] [MainThread]: On master: BEGIN
[0m19:30:27.005869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:27.038917 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:30:27.039650 [debug] [MainThread]: On master: COMMIT
[0m19:30:27.040449 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:27.041151 [debug] [MainThread]: On master: COMMIT
[0m19:30:27.043155 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:30:27.043652 [debug] [MainThread]: On master: Close
[0m19:30:27.044650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:27.045149 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:30:27.045149 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:30:27.045650 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:30:27.046150 [info ] [MainThread]: 
[0m19:30:27.046654 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m19:30:27.048306 [debug] [MainThread]: Command end result
[0m19:30:27.072257 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:30:27.075268 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:30:27.078718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:30:27.078718 [info ] [MainThread]: 
[0m19:30:27.078718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:27.078718 [info ] [MainThread]: 
[0m19:30:27.078718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:30:27.078718 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:30:27.078718 after 1.39 seconds
[0m19:30:27.078718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19A6C5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19A31BAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B19CDAC460>]}
[0m19:30:27.078718 [debug] [MainThread]: Flushing usage events
[0m19:30:27.541528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:40.367778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE93095FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE950039A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE950038E0>]}


============================== 19:30:40.367778 | 6b8405c2-b906-421a-9275-4d02151a5e18 ==============================
[0m19:30:40.367778 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:30:40.367778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_activities', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:30:40.529378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b8405c2-b906-421a-9275-4d02151a5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE923BE040>]}
[0m19:30:40.579808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b8405c2-b906-421a-9275-4d02151a5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE923BE8B0>]}
[0m19:30:40.579808 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:30:40.783416 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:30:40.941658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:40.941658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:40.989120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b8405c2-b906-421a-9275-4d02151a5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE95741130>]}
[0m19:30:41.083999 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:30:41.083999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:30:41.099530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b8405c2-b906-421a-9275-4d02151a5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE95747DF0>]}
[0m19:30:41.099530 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:30:41.099530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8405c2-b906-421a-9275-4d02151a5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE95763490>]}
[0m19:30:41.099530 [info ] [MainThread]: 
[0m19:30:41.099530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:41.099530 [info ] [MainThread]: 
[0m19:30:41.115155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:41.115155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:30:41.193221 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:30:41.193221 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:30:41.194222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:41.222846 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.029 seconds
[0m19:30:41.223827 [debug] [ThreadPool]: On list_postgres: Close
[0m19:30:41.232825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m19:30:41.238161 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:30:41.238662 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:30:41.238662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:41.254873 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m19:30:41.270987 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:30:41.271495 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:30:41.275993 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:30:41.277090 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:30:41.279504 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:30:41.280068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:30:41.282000 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:30:41.282000 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:30:41.282000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:41.302778 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:30:41.303781 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:30:41.304285 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:30:41.308928 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:30:41.310717 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:30:41.312447 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:30:41.313138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:30:41.314178 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:30:41.314178 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:30:41.314178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:41.337944 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:30:41.338425 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:30:41.338933 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:30:41.339433 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m19:30:41.339433 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:30:41.339433 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:30:41.350270 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:41.350270 [debug] [MainThread]: On master: BEGIN
[0m19:30:41.350270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:41.366027 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m19:30:41.381619 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:41.382294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:41.387997 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:30:41.390467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8405c2-b906-421a-9275-4d02151a5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE95776160>]}
[0m19:30:41.390967 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:41.392224 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:41.392224 [debug] [MainThread]: On master: BEGIN
[0m19:30:41.392224 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:30:41.392224 [debug] [MainThread]: On master: COMMIT
[0m19:30:41.397508 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:41.397852 [debug] [MainThread]: On master: COMMIT
[0m19:30:41.399844 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:30:41.400346 [debug] [MainThread]: On master: Close
[0m19:30:41.408345 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:30:41.408972 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:30:41.408972 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:30:41.408972 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:30:41.419814 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:30:41.469217 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.470210 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:30:41.470210 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:30:41.488920 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.022 seconds
[0m19:30:41.504695 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.504695 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:30:41.504695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:30:41.508479 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.508935 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:30:41.515930 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.007 seconds
[0m19:30:41.519537 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.519537 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:30:41.519537 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:30:41.551192 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.551192 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp193041551192"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:30:41.573468 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0.014 seconds
[0m19:30:41.573468 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.573468 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193041551192'
        
      order by ordinal_position

  
[0m19:30:41.583020 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m19:30:41.583020 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.583020 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:30:41.583020 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:30:41.583020 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.583020 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193041551192'
        
      order by ordinal_position

  
[0m19:30:41.583020 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m19:30:41.598658 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.598658 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:30:41.598658 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:30:41.598658 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.630010 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193041551192'
        
      order by ordinal_position

  
[0m19:30:41.645727 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:30:41.645727 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.645727 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:30:41.661612 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:30:41.661612 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.661612 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:30:41.661612 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m19:30:41.661612 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.661612 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.661612 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp193041551192" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp193041551192" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:30:41.661612 [debug] [Thread-1  ]: SQL status: INSERT 0 14 in 0.006 seconds
[0m19:30:41.689261 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:30:41.689766 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:30:41.690269 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:30:41.690269 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m19:30:41.690269 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:30:41.690269 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8405c2-b906-421a-9275-4d02151a5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE91936490>]}
[0m19:30:41.690269 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 14[0m in 0.28s]
[0m19:30:41.690269 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:30:41.706524 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:41.706524 [debug] [MainThread]: On master: BEGIN
[0m19:30:41.706524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:41.741201 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m19:30:41.742046 [debug] [MainThread]: On master: COMMIT
[0m19:30:41.742560 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:41.743045 [debug] [MainThread]: On master: COMMIT
[0m19:30:41.745044 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:30:41.745044 [debug] [MainThread]: On master: Close
[0m19:30:41.746044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:41.746586 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:30:41.746586 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m19:30:41.747128 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:30:41.747128 [info ] [MainThread]: 
[0m19:30:41.748051 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m19:30:41.749572 [debug] [MainThread]: Command end result
[0m19:30:41.775479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:30:41.778483 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:30:41.778483 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:30:41.778483 [info ] [MainThread]: 
[0m19:30:41.778483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:41.778483 [info ] [MainThread]: 
[0m19:30:41.778483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:30:41.790066 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:30:41.789523 after 1.46 seconds
[0m19:30:41.790426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE93095FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE95CE3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE95CE3DC0>]}
[0m19:30:41.790927 [debug] [MainThread]: Flushing usage events
[0m19:30:42.669031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:47.345631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF855F1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF875639A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF875638E0>]}


============================== 19:32:47.345631 | 812ee8c3-ca02-4feb-8984-1e1c6bdc3750 ==============================
[0m19:32:47.345631 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:32:47.345631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s sn_activities', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:32:47.500293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '812ee8c3-ca02-4feb-8984-1e1c6bdc3750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF8490D040>]}
[0m19:32:47.549034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '812ee8c3-ca02-4feb-8984-1e1c6bdc3750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF8490D8B0>]}
[0m19:32:47.549034 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:32:47.735493 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:32:47.887618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:32:47.887618 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:32:48.050657 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot sn_activities (snapshots\sn_activities.sql)
  expected token ',', got '='
    line 9
      -- invalidate_hard_deletes=True
[0m19:32:48.050657 [debug] [MainThread]: Command `dbt snapshot` failed at 19:32:48.050657 after 0.75 seconds
[0m19:32:48.050657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF855F1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF87C95370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF87DC4C70>]}
[0m19:32:48.050657 [debug] [MainThread]: Flushing usage events
[0m19:32:49.261400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:11.422340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B7551040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B94C3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B94C37C0>]}


============================== 19:33:11.422340 | 0676856c-5613-4b47-b4a5-0fc3701cb835 ==============================
[0m19:33:11.422340 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:33:11.422340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_activities', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:11.576918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0676856c-5613-4b47-b4a5-0fc3701cb835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B687EF10>]}
[0m19:33:11.623790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0676856c-5613-4b47-b4a5-0fc3701cb835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B684A310>]}
[0m19:33:11.623790 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:33:11.793772 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:33:11.959980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:33:11.959980 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:33:12.133574 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot sn_activities (snapshots\sn_activities.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:33:12.133574 [debug] [MainThread]: Command `dbt snapshot` failed at 19:33:12.133574 after 0.76 seconds
[0m19:33:12.133574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B7551040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B9BE53D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B9D14D30>]}
[0m19:33:12.133574 [debug] [MainThread]: Flushing usage events
[0m19:33:12.579783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:57.834159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4BFA5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4DF236D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4DF23790>]}


============================== 19:33:57.834159 | a7b4265d-337f-435d-850a-d3b454727199 ==============================
[0m19:33:57.834159 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:33:57.834159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s sn_activities', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:33:57.992769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b4265d-337f-435d-850a-d3b454727199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4A86A8B0>]}
[0m19:33:58.040130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7b4265d-337f-435d-850a-d3b454727199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4B2BF580>]}
[0m19:33:58.040130 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:33:58.206611 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:33:58.378786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:33:58.378786 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:33:58.620132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b4265d-337f-435d-850a-d3b454727199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4E806130>]}
[0m19:33:58.722435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:33:58.725442 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:33:58.741307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b4265d-337f-435d-850a-d3b454727199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4E6138E0>]}
[0m19:33:58.741307 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:33:58.741307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b4265d-337f-435d-850a-d3b454727199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4E662EE0>]}
[0m19:33:58.741307 [info ] [MainThread]: 
[0m19:33:58.741307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:58.741307 [info ] [MainThread]: 
[0m19:33:58.741307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:33:58.741307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:33:58.822773 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:33:58.822773 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:33:58.823765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:58.854314 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.030 seconds
[0m19:33:58.855402 [debug] [ThreadPool]: On list_postgres: Close
[0m19:33:58.860573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m19:33:58.860573 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:33:58.860573 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:33:58.860573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:58.876679 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:33:58.892603 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:33:58.893478 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:33:58.897975 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:33:58.898973 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:33:58.900478 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:33:58.901670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:33:58.904036 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:33:58.904036 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:33:58.904036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:58.940526 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m19:33:58.941772 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:33:58.942105 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:33:58.946863 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:33:58.947859 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:33:58.949860 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:33:58.951063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:33:58.952862 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:33:58.953362 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:33:58.953956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:58.960474 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:33:58.972978 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:33:58.973597 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:33:58.978615 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m19:33:58.981144 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:33:58.983566 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:33:59.020426 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:59.020426 [debug] [MainThread]: On master: BEGIN
[0m19:33:59.020426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:59.036675 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:33:59.043985 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:59.044555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:33:59.049013 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m19:33:59.050996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b4265d-337f-435d-850a-d3b454727199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4EC4AC10>]}
[0m19:33:59.051599 [debug] [MainThread]: On master: ROLLBACK
[0m19:33:59.053607 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:59.053607 [debug] [MainThread]: On master: BEGIN
[0m19:33:59.054518 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:33:59.056967 [debug] [MainThread]: On master: COMMIT
[0m19:33:59.057476 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:59.057476 [debug] [MainThread]: On master: COMMIT
[0m19:33:59.059225 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:33:59.059746 [debug] [MainThread]: On master: Close
[0m19:33:59.067468 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:33:59.068513 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:33:59.069064 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:33:59.069064 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:33:59.069064 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:33:59.142591 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:33:59.142591 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:33:59.143607 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:33:59.161008 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.020 seconds
[0m19:33:59.161008 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:33:59.161008 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:33:59.161008 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:33:59.161008 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:33:59.161008 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:33:59.161008 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:33:59.161008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m19:33:59.173111 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:33:59.173745 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m19:33:59.184628 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.015 seconds
[0m19:33:59.191379 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:33:59.191379 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:33:59.191379 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:33:59.207109 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m19:33:59.207109 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:33:59.207109 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b4265d-337f-435d-850a-d3b454727199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4E7B5DC0>]}
[0m19:33:59.207109 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mSELECT 4579[0m in 0.14s]
[0m19:33:59.207109 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:33:59.207109 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:59.207109 [debug] [MainThread]: On master: BEGIN
[0m19:33:59.207109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:59.239482 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:33:59.240417 [debug] [MainThread]: On master: COMMIT
[0m19:33:59.241051 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:59.241808 [debug] [MainThread]: On master: COMMIT
[0m19:33:59.243790 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:33:59.244432 [debug] [MainThread]: On master: Close
[0m19:33:59.245482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:59.245998 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:33:59.246536 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:33:59.247077 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:33:59.247077 [info ] [MainThread]: 
[0m19:33:59.248004 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m19:33:59.249596 [debug] [MainThread]: Command end result
[0m19:33:59.263131 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:33:59.263131 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:33:59.282527 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:33:59.283654 [info ] [MainThread]: 
[0m19:33:59.283654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:59.283654 [info ] [MainThread]: 
[0m19:33:59.283654 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:33:59.283654 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:33:59.283654 after 1.49 seconds
[0m19:33:59.283654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4BFA5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4E6134F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4D362460>]}
[0m19:33:59.283654 [debug] [MainThread]: Flushing usage events
[0m19:33:59.765074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:10.006888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A686D91040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A688D03700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A688D037C0>]}


============================== 19:34:10.024065 | 8c375ce7-a959-4afc-b7a3-d3c64a71e015 ==============================
[0m19:34:10.024065 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:34:10.024065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s sn_activities', 'send_anonymous_usage_stats': 'True'}
[0m19:34:10.176165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c375ce7-a959-4afc-b7a3-d3c64a71e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6860BC250>]}
[0m19:34:10.225275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c375ce7-a959-4afc-b7a3-d3c64a71e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A68608A310>]}
[0m19:34:10.225275 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:34:10.416275 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:34:10.571475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:10.571475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:10.636538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c375ce7-a959-4afc-b7a3-d3c64a71e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A689431130>]}
[0m19:34:10.717512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:34:10.733682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:34:10.750389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c375ce7-a959-4afc-b7a3-d3c64a71e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A68943FFD0>]}
[0m19:34:10.750389 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:34:10.750389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c375ce7-a959-4afc-b7a3-d3c64a71e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6894548B0>]}
[0m19:34:10.750389 [info ] [MainThread]: 
[0m19:34:10.750389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:10.750389 [info ] [MainThread]: 
[0m19:34:10.750389 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:10.750389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:34:10.813918 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:34:10.813918 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:34:10.813918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:10.847997 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.028 seconds
[0m19:34:10.847997 [debug] [ThreadPool]: On list_postgres: Close
[0m19:34:10.863800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m19:34:10.863800 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:34:10.863800 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:34:10.863800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:10.894416 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:34:10.895027 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:34:10.895529 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:34:10.899538 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m19:34:10.900809 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:34:10.902485 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:34:10.903134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:34:10.905363 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:34:10.905363 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:34:10.905363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:10.926748 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m19:34:10.942377 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:34:10.943383 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:34:10.947883 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:34:10.949383 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:34:10.951383 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:34:10.952007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:34:10.953983 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:34:10.953983 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:34:10.953983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:10.970870 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m19:34:10.985902 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:34:10.986542 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:34:10.990571 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:34:10.991768 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:34:10.993821 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:34:10.996617 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:10.996617 [debug] [MainThread]: On master: BEGIN
[0m19:34:10.996617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:11.018015 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:34:11.021442 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:11.021973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:34:11.027456 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:34:11.029839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c375ce7-a959-4afc-b7a3-d3c64a71e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A689468160>]}
[0m19:34:11.030377 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:11.031988 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:11.031988 [debug] [MainThread]: On master: BEGIN
[0m19:34:11.033996 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:34:11.036172 [debug] [MainThread]: On master: COMMIT
[0m19:34:11.036687 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:11.037279 [debug] [MainThread]: On master: COMMIT
[0m19:34:11.039726 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:34:11.039726 [debug] [MainThread]: On master: Close
[0m19:34:11.047295 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:34:11.047295 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:34:11.047295 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:34:11.047295 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:34:11.047295 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:34:11.096731 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.096731 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:34:11.096731 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:34:11.127021 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.021 seconds
[0m19:34:11.127021 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.127021 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:34:11.144183 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:34:11.144659 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.145177 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:34:11.153266 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.008 seconds
[0m19:34:11.155762 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.155762 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:34:11.155762 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:34:11.196563 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.196563 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp193411180204"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:34:11.196563 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0.009 seconds
[0m19:34:11.214813 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.214813 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193411180204'
        
      order by ordinal_position

  
[0m19:34:11.214813 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:34:11.214813 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.214813 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:34:11.214813 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:34:11.230691 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.230691 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193411180204'
        
      order by ordinal_position

  
[0m19:34:11.230691 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m19:34:11.230691 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.230691 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:34:11.230691 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:34:11.246550 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.246550 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193411180204'
        
      order by ordinal_position

  
[0m19:34:11.246550 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:34:11.295150 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.295150 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m19:34:11.295150 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:34:11.295150 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.295150 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:34:11.295150 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:34:11.295150 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.295150 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.295150 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp193411180204" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp193411180204" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:34:11.311623 [debug] [Thread-1  ]: SQL status: INSERT 0 14 in 0.005 seconds
[0m19:34:11.311623 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:34:11.311623 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:34:11.311623 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:34:11.327342 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m19:34:11.327342 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:34:11.344092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c375ce7-a959-4afc-b7a3-d3c64a71e015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6856254F0>]}
[0m19:34:11.344092 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 14[0m in 0.28s]
[0m19:34:11.344092 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:34:11.344092 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:11.344092 [debug] [MainThread]: On master: BEGIN
[0m19:34:11.344092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:11.359847 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:34:11.369753 [debug] [MainThread]: On master: COMMIT
[0m19:34:11.369753 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:11.369753 [debug] [MainThread]: On master: COMMIT
[0m19:34:11.369753 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:34:11.369753 [debug] [MainThread]: On master: Close
[0m19:34:11.369753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:11.369753 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:34:11.369753 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:34:11.369753 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:34:11.369753 [info ] [MainThread]: 
[0m19:34:11.376055 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m19:34:11.376425 [debug] [MainThread]: Command end result
[0m19:34:11.392811 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:34:11.392811 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:34:11.392811 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:34:11.392811 [info ] [MainThread]: 
[0m19:34:11.392811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:34:11.409059 [info ] [MainThread]: 
[0m19:34:11.409059 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:34:11.411153 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:34:11.411153 after 1.44 seconds
[0m19:34:11.411153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A686D91040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A687112850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6871727C0>]}
[0m19:34:11.411153 [debug] [MainThread]: Flushing usage events
[0m19:34:11.856304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:03.028248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C4FF2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C6F63700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C6F637C0>]}


============================== 19:35:03.033056 | 10cf8d55-c8e5-4f94-879e-90ffcf36063d ==============================
[0m19:35:03.033056 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:35:03.034057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot -s sn_users', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:35:03.273937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10cf8d55-c8e5-4f94-879e-90ffcf36063d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C431C250>]}
[0m19:35:03.343252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10cf8d55-c8e5-4f94-879e-90ffcf36063d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C42E9310>]}
[0m19:35:03.343252 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:35:03.561661 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:35:03.811924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:03.811924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:03.881378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10cf8d55-c8e5-4f94-879e-90ffcf36063d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C7691130>]}
[0m19:35:03.994269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:35:03.997267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:35:04.007235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10cf8d55-c8e5-4f94-879e-90ffcf36063d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C7697FD0>]}
[0m19:35:04.007235 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:35:04.007235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10cf8d55-c8e5-4f94-879e-90ffcf36063d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C76B38B0>]}
[0m19:35:04.007235 [info ] [MainThread]: 
[0m19:35:04.023018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:04.023795 [info ] [MainThread]: 
[0m19:35:04.025506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:04.030791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:35:04.109450 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:35:04.110365 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:35:04.111473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:04.141487 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.032 seconds
[0m19:35:04.141487 [debug] [ThreadPool]: On list_postgres: Close
[0m19:35:04.150658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m19:35:04.150658 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:35:04.150658 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:35:04.150658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:04.180139 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:35:04.181175 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:35:04.181594 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:35:04.185774 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:35:04.187012 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:35:04.188093 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:35:04.189268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:35:04.192466 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:35:04.192466 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:35:04.192466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:04.215302 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:35:04.215809 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:35:04.216310 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:35:04.223808 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m19:35:04.226814 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:35:04.228786 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:35:04.230649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:35:04.234205 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:35:04.234205 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:35:04.238364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:04.261739 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m19:35:04.262553 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:35:04.263053 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:35:04.269051 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m19:35:04.271552 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:35:04.273604 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:35:04.281943 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.281943 [debug] [MainThread]: On master: BEGIN
[0m19:35:04.281943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:04.311301 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:35:04.312043 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.313042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:04.320541 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m19:35:04.324043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10cf8d55-c8e5-4f94-879e-90ffcf36063d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C6DBBD60>]}
[0m19:35:04.324981 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:04.327024 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.328023 [debug] [MainThread]: On master: BEGIN
[0m19:35:04.330364 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:35:04.330863 [debug] [MainThread]: On master: COMMIT
[0m19:35:04.331364 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.331866 [debug] [MainThread]: On master: COMMIT
[0m19:35:04.333864 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:35:04.334863 [debug] [MainThread]: On master: Close
[0m19:35:04.345863 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m19:35:04.346864 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_users .................................. [RUN]
[0m19:35:04.348363 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_users'
[0m19:35:04.349363 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m19:35:04.362749 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m19:35:04.431854 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.431854 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m19:35:04.431854 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:35:04.463074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:35:04.464075 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.465074 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:35:04.475074 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.013 seconds
[0m19:35:04.522385 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.523766 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp193504514885"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:35:04.524538 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m19:35:04.524538 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.524538 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp193504514885'
        
      order by ordinal_position

  
[0m19:35:04.524538 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:35:04.541888 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.542887 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:35:04.543948 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:35:04.543948 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.543948 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp193504514885'
        
      order by ordinal_position

  
[0m19:35:04.543948 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:35:04.543948 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.543948 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:35:04.560734 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:35:04.560734 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.560734 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp193504514885'
        
      order by ordinal_position

  
[0m19:35:04.571456 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:35:04.591165 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.591165 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:35:04.591165 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m19:35:04.591165 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.591165 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:35:04.591165 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m19:35:04.591165 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.591165 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.591165 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp193504514885" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp193504514885" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:35:04.591165 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.001 seconds
[0m19:35:04.606805 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:35:04.606805 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:35:04.622441 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:35:04.622441 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m19:35:04.630536 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m19:35:04.633131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10cf8d55-c8e5-4f94-879e-90ffcf36063d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C38864F0>]}
[0m19:35:04.633131 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_users .................................. [[32mINSERT 0 0[0m in 0.28s]
[0m19:35:04.633131 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m19:35:04.633131 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.633131 [debug] [MainThread]: On master: BEGIN
[0m19:35:04.633131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:04.657796 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:35:04.658483 [debug] [MainThread]: On master: COMMIT
[0m19:35:04.659441 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.659945 [debug] [MainThread]: On master: COMMIT
[0m19:35:04.661447 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:35:04.662016 [debug] [MainThread]: On master: Close
[0m19:35:04.663038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:04.663038 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:35:04.663546 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:35:04.664064 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m19:35:04.664064 [info ] [MainThread]: 
[0m19:35:04.665046 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m19:35:04.666552 [debug] [MainThread]: Command end result
[0m19:35:04.750074 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:35:04.752205 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:35:04.765188 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:35:04.765678 [info ] [MainThread]: 
[0m19:35:04.767677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:04.768253 [info ] [MainThread]: 
[0m19:35:04.769250 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:35:04.771315 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:35:04.770814 after 1.80 seconds
[0m19:35:04.771814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C4FF2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C63A6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C6F21EE0>]}
[0m19:35:04.772813 [debug] [MainThread]: Flushing usage events
[0m19:35:05.257717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:37.487276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A19651FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1B5D0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1B5D0700>]}


============================== 19:38:37.487276 | 09293ce3-1992-4e44-851d-d8c2f403a29a ==============================
[0m19:38:37.487276 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:38:37.487276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:38:37.653309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A17F1A6D0>]}
[0m19:38:37.701107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1B1E6580>]}
[0m19:38:37.701107 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:38:37.907485 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:38:38.062418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:38:38.062418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:38:38.112619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1BCFC130>]}
[0m19:38:38.220162 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:38:38.223223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:38:38.228944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1BD06340>]}
[0m19:38:38.228944 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:38:38.228944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1BD23430>]}
[0m19:38:38.228944 [info ] [MainThread]: 
[0m19:38:38.228944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:38.244570 [info ] [MainThread]: 
[0m19:38:38.244570 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:38:38.244570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:38:38.328879 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:38:38.329885 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:38:38.329885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:38.359148 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.029 seconds
[0m19:38:38.360179 [debug] [ThreadPool]: On list_postgres: Close
[0m19:38:38.362381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m19:38:38.362381 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:38:38.362381 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:38:38.362381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:38.378059 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:38:38.393111 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:38:38.393409 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:38:38.397703 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m19:38:38.398931 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:38:38.401101 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:38:38.401723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:38:38.404001 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:38:38.404001 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:38:38.404001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:38.409117 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:38:38.425192 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:38:38.426137 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:38:38.431004 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m19:38:38.432814 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:38:38.434709 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:38:38.435416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:38:38.436527 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:38:38.436527 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:38:38.436527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:38.449824 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:38:38.460073 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:38:38.460575 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:38:38.467428 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m19:38:38.468523 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:38:38.470426 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:38:38.471427 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:38.471427 [debug] [MainThread]: On master: BEGIN
[0m19:38:38.471427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:38.487452 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:38:38.497765 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:38.498289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:38:38.503945 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:38:38.506014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A17F9F9A0>]}
[0m19:38:38.506513 [debug] [MainThread]: On master: ROLLBACK
[0m19:38:38.508363 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:38.508363 [debug] [MainThread]: On master: BEGIN
[0m19:38:38.511982 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:38:38.512482 [debug] [MainThread]: On master: COMMIT
[0m19:38:38.512482 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:38.513078 [debug] [MainThread]: On master: COMMIT
[0m19:38:38.514988 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:38:38.515525 [debug] [MainThread]: On master: Close
[0m19:38:38.523484 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:38:38.523484 [info ] [Thread-1  ]: 1 of 2 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:38:38.523484 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:38:38.523484 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:38:38.536099 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:38:38.590348 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.590348 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:38:38.590348 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:38:38.612486 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.022 seconds
[0m19:38:38.612486 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.612486 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:38:38.629111 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:38:38.629626 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.630613 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:38:38.640643 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.011 seconds
[0m19:38:38.640643 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.640643 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:38:38.640643 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:38:38.689022 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.689022 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp193838673376"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:38:38.689022 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0.011 seconds
[0m19:38:38.704647 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.704647 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193838673376'
        
      order by ordinal_position

  
[0m19:38:38.704647 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m19:38:38.712608 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.712608 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:38:38.712608 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:38:38.712608 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.712608 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193838673376'
        
      order by ordinal_position

  
[0m19:38:38.712608 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m19:38:38.728566 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.729236 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:38:38.729236 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:38:38.729236 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.729236 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp193838673376'
        
      order by ordinal_position

  
[0m19:38:38.729236 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:38:38.777964 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.777964 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m19:38:38.777964 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:38:38.793572 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.793572 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:38:38.793572 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m19:38:38.793572 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.793572 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.793572 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp193838673376" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp193838673376" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:38:38.793572 [debug] [Thread-1  ]: SQL status: INSERT 0 14 in 0.003 seconds
[0m19:38:38.809208 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:38:38.809208 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:38:38.809208 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:38:38.809208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m19:38:38.824830 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:38:38.824830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A17EF7490>]}
[0m19:38:38.824830 [info ] [Thread-1  ]: 1 of 2 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 14[0m in 0.30s]
[0m19:38:38.824830 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:38:38.824830 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m19:38:38.824830 [info ] [Thread-1  ]: 2 of 2 START snapshot public_staging.sn_users .................................. [RUN]
[0m19:38:38.833141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m19:38:38.833141 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m19:38:38.833141 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m19:38:38.833141 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.833141 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m19:38:38.833141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:38.866576 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m19:38:38.867302 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.867802 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:38:38.875301 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m19:38:38.880389 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.880389 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp193838877800"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:38:38.880389 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m19:38:38.880389 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.880389 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp193838877800'
        
      order by ordinal_position

  
[0m19:38:38.895560 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:38:38.897285 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.897285 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:38:38.897285 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m19:38:38.897285 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.897285 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp193838877800'
        
      order by ordinal_position

  
[0m19:38:38.911994 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:38:38.915651 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.916670 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:38:38.919654 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:38:38.923748 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.923748 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp193838877800'
        
      order by ordinal_position

  
[0m19:38:38.927667 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:38:38.929712 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.930821 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:38:38.932747 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:38:38.933825 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.933825 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:38:38.936603 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:38:38.936603 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.937612 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.938611 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp193838877800" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp193838877800" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:38:38.941120 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m19:38:38.942123 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:38:38.943155 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m19:38:38.943155 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m19:38:38.946294 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m19:38:38.946294 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m19:38:38.946294 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09293ce3-1992-4e44-851d-d8c2f403a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1BAE3F10>]}
[0m19:38:38.946294 [info ] [Thread-1  ]: 2 of 2 OK snapshotted public_staging.sn_users .................................. [[32mINSERT 0 0[0m in 0.11s]
[0m19:38:38.946294 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m19:38:38.946294 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:38.946294 [debug] [MainThread]: On master: BEGIN
[0m19:38:38.946294 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:38:38.976783 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:38:38.977464 [debug] [MainThread]: On master: COMMIT
[0m19:38:38.977669 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:38.978009 [debug] [MainThread]: On master: COMMIT
[0m19:38:38.979984 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:38:38.980592 [debug] [MainThread]: On master: Close
[0m19:38:38.981644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:38.982185 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:38:38.982185 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:38:38.982743 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m19:38:38.983286 [info ] [MainThread]: 
[0m19:38:38.984503 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m19:38:38.986335 [debug] [MainThread]: Command end result
[0m19:38:39.002274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:38:39.002274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:38:39.018598 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:38:39.018598 [info ] [MainThread]: 
[0m19:38:39.018598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:39.018598 [info ] [MainThread]: 
[0m19:38:39.018598 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:38:39.018598 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:38:39.018598 after 1.58 seconds
[0m19:38:39.018598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A19651FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1A9E62B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1B0BE730>]}
[0m19:38:39.018598 [debug] [MainThread]: Flushing usage events
[0m19:38:39.532083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:55.739322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E2BE0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E4B53700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E4B537C0>]}


============================== 19:39:55.755077 | d5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc ==============================
[0m19:39:55.755077 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:39:55.755300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s sn_activities', 'send_anonymous_usage_stats': 'True'}
[0m19:39:55.907435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E1EFDF10>]}
[0m19:39:55.956063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E1EC9310>]}
[0m19:39:55.956063 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:39:56.121560 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:39:56.287860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:56.287860 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:39:56.537306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E5438130>]}
[0m19:39:56.618772 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:39:56.618772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:39:56.650542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E542CCA0>]}
[0m19:39:56.650542 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:39:56.653210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E5334220>]}
[0m19:39:56.653210 [info ] [MainThread]: 
[0m19:39:56.653210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:56.653210 [info ] [MainThread]: 
[0m19:39:56.653210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:56.653210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:39:56.732147 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:39:56.733079 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:39:56.733079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:56.758720 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.029 seconds
[0m19:39:56.758720 [debug] [ThreadPool]: On list_postgres: Close
[0m19:39:56.758720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m19:39:56.774714 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:39:56.774714 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:39:56.774714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:56.790901 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:39:56.802264 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:39:56.802784 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:39:56.807282 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:39:56.808872 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:39:56.810783 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:39:56.811782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m19:39:56.812901 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:39:56.812901 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:39:56.812901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:56.828698 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:39:56.836115 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:39:56.836650 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:39:56.841494 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:39:56.842423 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:39:56.844532 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:39:56.846053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m19:39:56.847050 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:39:56.847050 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:39:56.847050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:56.860259 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:39:56.869202 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:39:56.869824 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:39:56.875550 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m19:39:56.877128 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:39:56.878944 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:39:56.907956 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.907956 [debug] [MainThread]: On master: BEGIN
[0m19:39:56.907956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:56.923906 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:39:56.939577 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.940026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:56.945559 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:39:56.947526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E150F9A0>]}
[0m19:39:56.947526 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:56.949527 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.949527 [debug] [MainThread]: On master: BEGIN
[0m19:39:56.951049 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:39:56.953020 [debug] [MainThread]: On master: COMMIT
[0m19:39:56.953020 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.953746 [debug] [MainThread]: On master: COMMIT
[0m19:39:56.955483 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:56.956027 [debug] [MainThread]: On master: Close
[0m19:39:56.965256 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:39:56.966345 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:39:56.967267 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:39:56.967267 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:39:56.976707 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:39:57.041471 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:39:57.042514 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:39:57.042514 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:39:57.058511 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.030 seconds
[0m19:39:57.074350 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:39:57.074350 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:39:57.074350 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m19:39:57.074350 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:39:57.074350 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:39:57.074350 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:39:57.074350 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m19:39:57.082708 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:39:57.082931 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m19:39:57.095953 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.013 seconds
[0m19:39:57.106144 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:39:57.106144 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:39:57.106144 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:39:57.124547 [debug] [Thread-1  ]: SQL status: COMMIT in 0.015 seconds
[0m19:39:57.124547 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:39:57.124547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5aba5a1-ebf8-4c1b-8d2a-1e3e2ecdb0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E53E6AF0>]}
[0m19:39:57.133459 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mSELECT 4579[0m in 0.16s]
[0m19:39:57.133459 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:39:57.133459 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:57.133459 [debug] [MainThread]: On master: BEGIN
[0m19:39:57.133459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:57.157737 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:39:57.158627 [debug] [MainThread]: On master: COMMIT
[0m19:39:57.159627 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:57.160127 [debug] [MainThread]: On master: COMMIT
[0m19:39:57.162402 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:39:57.163040 [debug] [MainThread]: On master: Close
[0m19:39:57.163560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:57.164098 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:39:57.164098 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m19:39:57.164718 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:39:57.165341 [info ] [MainThread]: 
[0m19:39:57.165885 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m19:39:57.166997 [debug] [MainThread]: Command end result
[0m19:39:57.192212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:39:57.192212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:39:57.192212 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:39:57.192212 [info ] [MainThread]: 
[0m19:39:57.192212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:57.192212 [info ] [MainThread]: 
[0m19:39:57.192212 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:39:57.192212 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:39:57.192212 after 1.50 seconds
[0m19:39:57.192212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E2BE0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E3F96F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E5515670>]}
[0m19:39:57.192212 [debug] [MainThread]: Flushing usage events
[0m19:39:57.701921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:07.810267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681BD65FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681DCE36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681DCE3790>]}


============================== 19:40:07.810267 | 9b88368d-4e72-4fd3-a5c8-c6efdb0659d0 ==============================
[0m19:40:07.810267 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:40:07.826320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s sn_activities', 'send_anonymous_usage_stats': 'True'}
[0m19:40:07.973406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b88368d-4e72-4fd3-a5c8-c6efdb0659d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681A62A8B0>]}
[0m19:40:08.034603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b88368d-4e72-4fd3-a5c8-c6efdb0659d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681B07F580>]}
[0m19:40:08.034603 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:40:08.194248 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:40:08.353051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:08.353051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:08.400635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b88368d-4e72-4fd3-a5c8-c6efdb0659d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681E411130>]}
[0m19:40:08.497258 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:08.497258 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:08.513345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b88368d-4e72-4fd3-a5c8-c6efdb0659d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681E41FCA0>]}
[0m19:40:08.513345 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:40:08.513345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b88368d-4e72-4fd3-a5c8-c6efdb0659d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681E433340>]}
[0m19:40:08.528989 [info ] [MainThread]: 
[0m19:40:08.528989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:08.528989 [info ] [MainThread]: 
[0m19:40:08.528989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:08.528989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:40:08.595353 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:40:08.595353 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:40:08.595353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:08.627742 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.027 seconds
[0m19:40:08.627742 [debug] [ThreadPool]: On list_postgres: Close
[0m19:40:08.634009 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m19:40:08.634009 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:40:08.634009 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:40:08.634009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:08.666507 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:40:08.668378 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:40:08.668572 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:40:08.677216 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m19:40:08.678494 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:40:08.679127 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:40:08.679127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m19:40:08.682485 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:40:08.682485 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:40:08.682485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:08.714773 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m19:40:08.716593 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:40:08.717087 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:40:08.721496 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:40:08.722538 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:40:08.724777 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:40:08.725525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m19:40:08.726031 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:08.726031 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:40:08.726031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:08.763304 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m19:40:08.764028 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:08.764527 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:40:08.768529 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:40:08.769628 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:40:08.771561 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:40:08.774534 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:08.774534 [debug] [MainThread]: On master: BEGIN
[0m19:40:08.774534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:08.791299 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:40:08.800643 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:08.801152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:08.806152 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:40:08.809243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b88368d-4e72-4fd3-a5c8-c6efdb0659d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681E446130>]}
[0m19:40:08.809745 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:08.811469 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:08.811469 [debug] [MainThread]: On master: BEGIN
[0m19:40:08.811469 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:40:08.815243 [debug] [MainThread]: On master: COMMIT
[0m19:40:08.815789 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:08.815789 [debug] [MainThread]: On master: COMMIT
[0m19:40:08.817741 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:40:08.818433 [debug] [MainThread]: On master: Close
[0m19:40:08.825925 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:40:08.825925 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:40:08.825925 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:40:08.825925 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:40:08.825925 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:40:08.875795 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:08.875795 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:40:08.875795 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:40:08.909116 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.021 seconds
[0m19:40:08.909116 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:08.924792 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:40:08.927747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:40:08.928530 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:08.929033 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:08.937531 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.008 seconds
[0m19:40:08.939616 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:08.939616 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:08.939616 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:40:08.971310 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:08.971310 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp194008971310"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:40:08.987028 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0.012 seconds
[0m19:40:08.987028 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:08.987028 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp194008971310'
        
      order by ordinal_position

  
[0m19:40:09.005865 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:40:09.008455 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.008455 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:09.008455 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:40:09.008455 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.008455 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp194008971310'
        
      order by ordinal_position

  
[0m19:40:09.019208 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:40:09.019208 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.019208 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:09.019208 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m19:40:09.034220 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.066327 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp194008971310'
        
      order by ordinal_position

  
[0m19:40:09.066327 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:40:09.082010 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.082010 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:40:09.082010 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:40:09.082010 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.082010 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:40:09.082010 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:40:09.082010 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.082010 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.082010 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp194008971310" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp194008971310" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:40:09.097240 [debug] [Thread-1  ]: SQL status: INSERT 0 14 in 0.003 seconds
[0m19:40:09.097240 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:40:09.113239 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:09.113549 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:40:09.113549 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m19:40:09.113549 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:40:09.113549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b88368d-4e72-4fd3-a5c8-c6efdb0659d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681A6074C0>]}
[0m19:40:09.113549 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 14[0m in 0.29s]
[0m19:40:09.113549 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:40:09.129877 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:09.129877 [debug] [MainThread]: On master: BEGIN
[0m19:40:09.129877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:09.163167 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m19:40:09.163919 [debug] [MainThread]: On master: COMMIT
[0m19:40:09.163919 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:09.164476 [debug] [MainThread]: On master: COMMIT
[0m19:40:09.166178 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:09.166811 [debug] [MainThread]: On master: Close
[0m19:40:09.167241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:09.167747 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:40:09.167747 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:40:09.168372 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:40:09.168879 [info ] [MainThread]: 
[0m19:40:09.169598 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m19:40:09.170950 [debug] [MainThread]: Command end result
[0m19:40:09.194117 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:09.194117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:09.194117 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:40:09.194117 [info ] [MainThread]: 
[0m19:40:09.194117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:09.194117 [info ] [MainThread]: 
[0m19:40:09.194117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:40:09.194117 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:40:09.194117 after 1.44 seconds
[0m19:40:09.194117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681BD65FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681B9BBAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002681D117610>]}
[0m19:40:09.194117 [debug] [MainThread]: Flushing usage events
[0m19:40:09.648039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:36.604712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015882C95FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015884C136D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015884C13790>]}


============================== 19:40:36.610880 | 998e0140-b142-4e9e-a622-7169916fce18 ==============================
[0m19:40:36.610880 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:40:36.610880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot -s sn_activities', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:36.749773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '998e0140-b142-4e9e-a622-7169916fce18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588156A8B0>]}
[0m19:40:36.797553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '998e0140-b142-4e9e-a622-7169916fce18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015881FBF580>]}
[0m19:40:36.797553 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:40:36.977362 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:40:37.149115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:40:37.149115 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:40:37.373629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '998e0140-b142-4e9e-a622-7169916fce18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158854F7130>]}
[0m19:40:37.468422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:37.468422 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:37.484632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '998e0140-b142-4e9e-a622-7169916fce18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158853038E0>]}
[0m19:40:37.484632 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:40:37.484632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998e0140-b142-4e9e-a622-7169916fce18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588535DEE0>]}
[0m19:40:37.484632 [info ] [MainThread]: 
[0m19:40:37.484632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:37.484632 [info ] [MainThread]: 
[0m19:40:37.500143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:37.501626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:40:37.565761 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:40:37.565761 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:40:37.565761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:37.598356 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.028 seconds
[0m19:40:37.598356 [debug] [ThreadPool]: On list_postgres: Close
[0m19:40:37.598356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m19:40:37.614195 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:40:37.614195 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:40:37.614195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:37.644111 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m19:40:37.646151 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:40:37.646931 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:40:37.651213 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:40:37.652531 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:40:37.654497 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:40:37.655440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m19:40:37.656948 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:40:37.656948 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:40:37.656948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:37.688428 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m19:40:37.689432 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:40:37.689931 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:40:37.694432 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:40:37.695935 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:40:37.697444 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:40:37.698431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:40:37.700015 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:37.700015 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:40:37.700015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:37.720154 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m19:40:37.736237 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:37.736767 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:40:37.740905 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:40:37.742782 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:40:37.744671 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:40:37.784564 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:37.784564 [debug] [MainThread]: On master: BEGIN
[0m19:40:37.784564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:37.800745 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m19:40:37.816690 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:37.817036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:37.821430 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m19:40:37.823432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998e0140-b142-4e9e-a622-7169916fce18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015884BFEFA0>]}
[0m19:40:37.823932 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:37.825933 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:37.825933 [debug] [MainThread]: On master: BEGIN
[0m19:40:37.827479 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:40:37.829769 [debug] [MainThread]: On master: COMMIT
[0m19:40:37.829841 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:37.830348 [debug] [MainThread]: On master: COMMIT
[0m19:40:37.831959 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:40:37.832359 [debug] [MainThread]: On master: Close
[0m19:40:37.840127 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:40:37.840752 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:40:37.841268 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:40:37.841268 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:40:37.848647 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:40:37.913957 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:37.913957 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m19:40:37.913957 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:40:37.946263 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.030 seconds
[0m19:40:37.946263 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:37.946263 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:40:37.946263 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m19:40:37.946263 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:37.946263 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:37.946263 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:40:37.946263 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:40:37.957430 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:37.958056 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m19:40:37.966426 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.011 seconds
[0m19:40:37.978111 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:40:37.978111 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:37.978111 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:40:37.993884 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m19:40:37.993884 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:40:37.993884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998e0140-b142-4e9e-a622-7169916fce18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158854CD5E0>]}
[0m19:40:37.993884 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mSELECT 4579[0m in 0.15s]
[0m19:40:37.993884 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:40:38.003602 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.004154 [debug] [MainThread]: On master: BEGIN
[0m19:40:38.004154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:38.023811 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:40:38.024319 [debug] [MainThread]: On master: COMMIT
[0m19:40:38.024917 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.024917 [debug] [MainThread]: On master: COMMIT
[0m19:40:38.026815 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:38.027350 [debug] [MainThread]: On master: Close
[0m19:40:38.028421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:38.028824 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:40:38.028824 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:40:38.029314 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:40:38.029314 [info ] [MainThread]: 
[0m19:40:38.030317 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m19:40:38.031313 [debug] [MainThread]: Command end result
[0m19:40:38.053410 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:38.057165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:38.057165 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:40:38.057165 [info ] [MainThread]: 
[0m19:40:38.057165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:38.057165 [info ] [MainThread]: 
[0m19:40:38.057165 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:40:38.057165 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:40:38.057165 after 1.51 seconds
[0m19:40:38.057165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015882C95FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015885303580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588401F310>]}
[0m19:40:38.057165 [debug] [MainThread]: Flushing usage events
[0m19:40:38.504348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:48.279830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7669E1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7689539A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7689538E0>]}


============================== 19:40:48.279830 | f14c2282-ca76-4ad1-be36-599a27648a16 ==============================
[0m19:40:48.279830 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:40:48.279830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_activities', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:48.436550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14c2282-ca76-4ad1-be36-599a27648a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B765D0D040>]}
[0m19:40:48.484078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14c2282-ca76-4ad1-be36-599a27648a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B765D0D8B0>]}
[0m19:40:48.484078 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:40:48.652489 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:40:48.827606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:48.827606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:48.874929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14c2282-ca76-4ad1-be36-599a27648a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B769091130>]}
[0m19:40:48.970274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:48.970274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:48.985821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14c2282-ca76-4ad1-be36-599a27648a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B76909E220>]}
[0m19:40:48.985821 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m19:40:48.985821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14c2282-ca76-4ad1-be36-599a27648a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7690B3490>]}
[0m19:40:48.985821 [info ] [MainThread]: 
[0m19:40:48.985821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:48.985821 [info ] [MainThread]: 
[0m19:40:49.001774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:49.003777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:40:49.073753 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:40:49.073753 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:40:49.073753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:49.105568 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.028 seconds
[0m19:40:49.105568 [debug] [ThreadPool]: On list_postgres: Close
[0m19:40:49.105568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m19:40:49.121439 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:40:49.121439 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m19:40:49.121439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:49.143923 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:40:49.144422 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m19:40:49.144924 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:40:49.149028 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m19:40:49.150653 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m19:40:49.152053 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m19:40:49.153493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m19:40:49.155648 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:49.155648 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:40:49.155648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:49.174647 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:40:49.177940 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:49.178447 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:40:49.183134 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m19:40:49.184172 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:40:49.186000 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:40:49.187656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m19:40:49.189301 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:40:49.189301 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m19:40:49.189301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:49.210465 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:40:49.212674 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m19:40:49.213063 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m19:40:49.217687 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:40:49.219216 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m19:40:49.221026 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m19:40:49.224002 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:49.224002 [debug] [MainThread]: On master: BEGIN
[0m19:40:49.224002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:49.246661 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m19:40:49.255034 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:49.255681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:49.260541 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m19:40:49.262541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14c2282-ca76-4ad1-be36-599a27648a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7689244C0>]}
[0m19:40:49.263541 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:49.265248 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:49.265778 [debug] [MainThread]: On master: BEGIN
[0m19:40:49.265778 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:40:49.269135 [debug] [MainThread]: On master: COMMIT
[0m19:40:49.269649 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:49.269649 [debug] [MainThread]: On master: COMMIT
[0m19:40:49.271845 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:49.271845 [debug] [MainThread]: On master: Close
[0m19:40:49.273923 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m19:40:49.273923 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m19:40:49.273923 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m19:40:49.273923 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m19:40:49.290369 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m19:40:49.339249 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.339249 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done, assigned_to_user from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:40:49.339249 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:40:49.421899 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.087 seconds
[0m19:40:49.438114 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.438114 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m19:40:49.443033 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:40:49.443720 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.444335 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:49.451769 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.007 seconds
[0m19:40:49.454314 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.454314 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:49.454314 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:40:49.486520 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.486520 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp194049486520"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ) or snapshotted_data."assigned_to_user" != source_data."assigned_to_user"
        or
        (
            ((snapshotted_data."assigned_to_user" is null) and not (source_data."assigned_to_user" is null))
            or
            ((not snapshotted_data."assigned_to_user" is null) and (source_data."assigned_to_user" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ) or snapshotted_data."assigned_to_user" != source_data."assigned_to_user"
        or
        (
            ((snapshotted_data."assigned_to_user" is null) and not (source_data."assigned_to_user" is null))
            or
            ((not snapshotted_data."assigned_to_user" is null) and (source_data."assigned_to_user" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:40:49.502671 [debug] [Thread-1  ]: SQL status: SELECT 44 in 0.014 seconds
[0m19:40:49.502671 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.502671 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp194049486520'
        
      order by ordinal_position

  
[0m19:40:49.521169 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:40:49.521169 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.521169 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:49.521169 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:40:49.521169 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.521169 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp194049486520'
        
      order by ordinal_position

  
[0m19:40:49.534350 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:40:49.534350 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.534350 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m19:40:49.534350 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m19:40:49.550034 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.582627 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp194049486520'
        
      order by ordinal_position

  
[0m19:40:49.582627 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.004 seconds
[0m19:40:49.593482 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.593482 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        activity_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ) or snapshotted_data."assigned_to_user" != source_data."assigned_to_user"
        or
        (
            ((snapshotted_data."assigned_to_user" is null) and not (source_data."assigned_to_user" is null))
            or
            ((not snapshotted_data."assigned_to_user" is null) and (source_data."assigned_to_user" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ) or snapshotted_data."assigned_to_user" != source_data."assigned_to_user"
        or
        (
            ((snapshotted_data."assigned_to_user" is null) and not (source_data."assigned_to_user" is null))
            or
            ((not snapshotted_data."assigned_to_user" is null) and (source_data."assigned_to_user" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:40:49.593482 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:40:49.593482 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.593482 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:40:49.593482 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m19:40:49.609306 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.611022 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.611543 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp194049486520" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp194049486520" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:40:49.616215 [debug] [Thread-1  ]: SQL status: INSERT 0 22 in 0.009 seconds
[0m19:40:49.634290 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:40:49.634290 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m19:40:49.634290 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m19:40:49.634290 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m19:40:49.634290 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m19:40:49.634290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14c2282-ca76-4ad1-be36-599a27648a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B765286490>]}
[0m19:40:49.634290 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 22[0m in 0.36s]
[0m19:40:49.634290 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m19:40:49.650029 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:49.650029 [debug] [MainThread]: On master: BEGIN
[0m19:40:49.650029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:49.673173 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:40:49.674171 [debug] [MainThread]: On master: COMMIT
[0m19:40:49.675169 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:49.675169 [debug] [MainThread]: On master: COMMIT
[0m19:40:49.677165 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:40:49.677667 [debug] [MainThread]: On master: Close
[0m19:40:49.678174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:49.679182 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:40:49.679665 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m19:40:49.680166 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m19:40:49.680665 [info ] [MainThread]: 
[0m19:40:49.681699 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m19:40:49.683062 [debug] [MainThread]: Command end result
[0m19:40:49.698411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m19:40:49.698411 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m19:40:49.714632 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m19:40:49.714632 [info ] [MainThread]: 
[0m19:40:49.714632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:49.714632 [info ] [MainThread]: 
[0m19:40:49.714632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:40:49.714632 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:40:49.714632 after 1.49 seconds
[0m19:40:49.714632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7669E1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B769195640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B769195610>]}
[0m19:40:49.714632 [debug] [MainThread]: Flushing usage events
[0m19:40:50.153428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:41:13.776255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E53500A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E72C06D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E72C0790>]}


============================== 19:41:13.776255 | b20c3719-6be4-4a8e-831a-d5df3b0a9682 ==============================
[0m19:41:13.776255 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m19:41:13.776255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:13.930664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b20c3719-6be4-4a8e-831a-d5df3b0a9682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E726A340>]}
[0m19:41:13.977542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b20c3719-6be4-4a8e-831a-d5df3b0a9682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E4693F10>]}
[0m19:41:13.977542 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:14.151565 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m19:41:14.312112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:14.312112 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m19:41:14.490734 [error] [MainThread]: Encountered an error:
Invalid value for 'check_cols': done. Expected 'all' or a list of strings.
[0m19:41:14.490734 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 2011, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 474, in load
    self.check_valid_snapshot_config()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\parser\manifest.py", line 1390, in check_valid_snapshot_config
    node.config.final_validate()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 54, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for 'check_cols': done. Expected 'all' or a list of strings.

[0m19:41:14.510278 [debug] [MainThread]: Command `dbt snapshot` failed at 19:41:14.509627 after 0.78 seconds
[0m19:41:14.510278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E53500A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E79E23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E79E2340>]}
[0m19:41:14.511390 [debug] [MainThread]: Flushing usage events
[0m19:41:14.999867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:54.608774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B6E91FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B8E039A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B8E038E0>]}


============================== 20:00:54.608774 | e9587a0a-3882-4030-8618-94253ddf649f ==============================
[0m20:00:54.608774 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:00:54.608774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s sn_activities', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:00:54.763382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9587a0a-3882-4030-8618-94253ddf649f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B59BD040>]}
[0m20:00:54.810964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9587a0a-3882-4030-8618-94253ddf649f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B59BD8B0>]}
[0m20:00:54.810964 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:00:54.991590 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:00:55.166831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:55.166831 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m20:00:55.404606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9587a0a-3882-4030-8618-94253ddf649f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B96F8130>]}
[0m20:00:55.504730 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:00:55.504730 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:00:55.520658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9587a0a-3882-4030-8618-94253ddf649f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B9503B20>]}
[0m20:00:55.520658 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m20:00:55.537081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9587a0a-3882-4030-8618-94253ddf649f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B9615A90>]}
[0m20:00:55.537081 [info ] [MainThread]: 
[0m20:00:55.537081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:00:55.537081 [info ] [MainThread]: 
[0m20:00:55.537081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:00:55.537081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:00:55.632138 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:00:55.633126 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:00:55.633126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:55.662444 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.032 seconds
[0m20:00:55.662444 [debug] [ThreadPool]: On list_postgres: Close
[0m20:00:55.662444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m20:00:55.678492 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:00:55.678492 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:00:55.678492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:55.710317 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m20:00:55.710966 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:00:55.711762 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:00:55.715975 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:00:55.717570 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:00:55.719483 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:00:55.720486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m20:00:55.722982 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:00:55.722982 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:00:55.722982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:55.755767 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m20:00:55.756524 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:00:55.756809 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:00:55.763044 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m20:00:55.764901 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:00:55.766725 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:00:55.766725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m20:00:55.766725 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:00:55.766725 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:00:55.766725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:55.805338 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m20:00:55.805584 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:00:55.806097 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:00:55.810623 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:00:55.811689 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:00:55.813594 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:00:55.856140 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:55.856140 [debug] [MainThread]: On master: BEGIN
[0m20:00:55.856140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:55.872199 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:00:55.883053 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:55.883270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:00:55.890013 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m20:00:55.892646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9587a0a-3882-4030-8618-94253ddf649f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B57E09A0>]}
[0m20:00:55.893178 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:55.893178 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:55.893178 [debug] [MainThread]: On master: BEGIN
[0m20:00:55.899142 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:00:55.899439 [debug] [MainThread]: On master: COMMIT
[0m20:00:55.900151 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:55.900151 [debug] [MainThread]: On master: COMMIT
[0m20:00:55.902374 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:00:55.903066 [debug] [MainThread]: On master: Close
[0m20:00:55.909772 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:00:55.909772 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m20:00:55.909772 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m20:00:55.909772 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:00:55.923243 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:00:55.978942 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:00:55.978942 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:00:55.978942 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:00:56.011288 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.022 seconds
[0m20:00:56.011288 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:00:56.011288 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:00:56.011288 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:00:56.011288 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m20:00:56.011288 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:00:56.011288 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m20:00:56.011288 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:00:56.023121 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:00:56.023645 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m20:00:56.039527 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.015 seconds
[0m20:00:56.042071 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:00:56.042071 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:00:56.042071 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:00:56.064859 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m20:00:56.066807 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:00:56.069311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9587a0a-3882-4030-8618-94253ddf649f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B5736490>]}
[0m20:00:56.070330 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mSELECT 4579[0m in 0.16s]
[0m20:00:56.071812 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:00:56.071812 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:56.071812 [debug] [MainThread]: On master: BEGIN
[0m20:00:56.071812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:56.096435 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m20:00:56.106243 [debug] [MainThread]: On master: COMMIT
[0m20:00:56.106919 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:56.107425 [debug] [MainThread]: On master: COMMIT
[0m20:00:56.109811 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:00:56.109811 [debug] [MainThread]: On master: Close
[0m20:00:56.110807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:56.110807 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:00:56.111401 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:00:56.111810 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m20:00:56.112311 [info ] [MainThread]: 
[0m20:00:56.113320 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m20:00:56.115022 [debug] [MainThread]: Command end result
[0m20:00:56.132590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:00:56.132590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:00:56.147449 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:00:56.147937 [info ] [MainThread]: 
[0m20:00:56.149017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:56.149937 [info ] [MainThread]: 
[0m20:00:56.151096 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:00:56.153219 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:00:56.152588 after 1.59 seconds
[0m20:00:56.153219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B6E91FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B931BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B94D91F0>]}
[0m20:00:56.154162 [debug] [MainThread]: Flushing usage events
[0m20:00:56.996297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:12.744187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AE400070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B03716D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B0371790>]}


============================== 20:02:12.744187 | 625ed735-6bd8-4f7c-97ed-1dd2ee2150c8 ==============================
[0m20:02:12.744187 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:02:12.744187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:02:12.910135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5ACCB1BE0>]}
[0m20:02:12.972687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD6F57C0>]}
[0m20:02:12.972687 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:02:13.137644 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:02:13.325201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:02:13.325201 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots\sn_activities.sql
[0m20:02:13.563904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B0C6D130>]}
[0m20:02:13.658415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:02:13.658415 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:02:13.679626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B0A614F0>]}
[0m20:02:13.679626 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m20:02:13.679626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B0C6B430>]}
[0m20:02:13.679626 [info ] [MainThread]: 
[0m20:02:13.679626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:13.679626 [info ] [MainThread]: 
[0m20:02:13.679626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:13.688553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:02:13.761060 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:02:13.761060 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:02:13.761060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:13.801642 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.031 seconds
[0m20:02:13.801642 [debug] [ThreadPool]: On list_postgres: Close
[0m20:02:13.809801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:02:13.817919 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:02:13.817919 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:02:13.817919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:13.825917 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:02:13.839744 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:02:13.840285 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:13.845888 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m20:02:13.847460 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:02:13.849427 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:02:13.850570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m20:02:13.850874 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:02:13.850874 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:02:13.850874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:13.875255 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:02:13.876255 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:02:13.876873 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:02:13.881999 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m20:02:13.883114 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:02:13.884904 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:02:13.885434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m20:02:13.886920 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:02:13.886920 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:02:13.886920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:13.905968 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:02:13.911802 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:02:13.912303 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:02:13.917482 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m20:02:13.918772 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:02:13.920447 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:02:13.961824 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:13.961824 [debug] [MainThread]: On master: BEGIN
[0m20:02:13.961824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:13.978112 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m20:02:13.987070 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:13.987706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:13.991988 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m20:02:13.994002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B0D49AF0>]}
[0m20:02:13.994002 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:13.995893 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:13.996423 [debug] [MainThread]: On master: BEGIN
[0m20:02:13.997260 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:02:14.000039 [debug] [MainThread]: On master: COMMIT
[0m20:02:14.000728 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:14.000728 [debug] [MainThread]: On master: COMMIT
[0m20:02:14.002546 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:02:14.002546 [debug] [MainThread]: On master: Close
[0m20:02:14.006553 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:02:14.007051 [info ] [Thread-1  ]: 1 of 2 START snapshot public_staging.sn_activities ............................. [RUN]
[0m20:02:14.008060 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m20:02:14.008710 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:02:14.011635 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:02:14.075843 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:14.075843 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:14.075843 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:02:14.092621 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.021 seconds
[0m20:02:14.108953 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:14.108953 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:14.108953 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:02:14.108953 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:14.108953 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:14.108953 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m20:02:14.115757 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m20:02:14.116222 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:14.116502 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m20:02:14.127412 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.014 seconds
[0m20:02:14.140689 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:02:14.140689 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:14.140689 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:02:14.156989 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m20:02:14.156989 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:02:14.156989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B0B5D8E0>]}
[0m20:02:14.156989 [info ] [Thread-1  ]: 1 of 2 OK snapshotted public_staging.sn_activities ............................. [[32mSELECT 4579[0m in 0.15s]
[0m20:02:14.156989 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:02:14.156989 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m20:02:14.156989 [info ] [Thread-1  ]: 2 of 2 START snapshot public_staging.sn_users .................................. [RUN]
[0m20:02:14.156989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m20:02:14.156989 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m20:02:14.156989 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m20:02:14.173290 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.173290 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m20:02:14.173290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:14.207398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:02:14.208056 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.209058 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:14.218246 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m20:02:14.241925 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.241925 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp200214241925"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:02:14.241925 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m20:02:14.259826 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.259826 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp200214241925'
        
      order by ordinal_position

  
[0m20:02:14.259826 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:14.266297 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.266297 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:14.274268 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m20:02:14.280657 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.281188 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp200214241925'
        
      order by ordinal_position

  
[0m20:02:14.285418 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:14.285418 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.285418 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:14.285418 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m20:02:14.285418 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.285418 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp200214241925'
        
      order by ordinal_position

  
[0m20:02:14.302070 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:14.302070 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.302070 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:14.302070 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:02:14.302070 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.302070 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:14.302070 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:02:14.302070 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.317822 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.317822 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp200214241925" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp200214241925" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:02:14.317822 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m20:02:14.317822 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m20:02:14.317822 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:02:14.317822 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m20:02:14.317822 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:02:14.317822 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m20:02:14.317822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625ed735-6bd8-4f7c-97ed-1dd2ee2150c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AF7B6DF0>]}
[0m20:02:14.317822 [info ] [Thread-1  ]: 2 of 2 OK snapshotted public_staging.sn_users .................................. [[32mINSERT 0 0[0m in 0.16s]
[0m20:02:14.317822 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m20:02:14.333581 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:14.333581 [debug] [MainThread]: On master: BEGIN
[0m20:02:14.333581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:14.366577 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m20:02:14.367292 [debug] [MainThread]: On master: COMMIT
[0m20:02:14.367419 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:14.368018 [debug] [MainThread]: On master: COMMIT
[0m20:02:14.370250 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:02:14.370754 [debug] [MainThread]: On master: Close
[0m20:02:14.370861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:14.371484 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:02:14.372078 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m20:02:14.372078 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m20:02:14.372693 [info ] [MainThread]: 
[0m20:02:14.373742 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m20:02:14.374818 [debug] [MainThread]: Command end result
[0m20:02:14.396306 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:02:14.396306 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:02:14.396306 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:02:14.396306 [info ] [MainThread]: 
[0m20:02:14.396306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:14.396306 [info ] [MainThread]: 
[0m20:02:14.396306 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:02:14.396306 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:02:14.396306 after 1.70 seconds
[0m20:02:14.396306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AE400070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AF79B070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AE04D8E0>]}
[0m20:02:14.396306 [debug] [MainThread]: Flushing usage events
[0m20:02:14.876882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:23.954751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C5270070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C71E3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C71E37C0>]}


============================== 20:02:23.970482 | 6b2ddde0-a7bb-400a-af55-67c58a826078 ==============================
[0m20:02:23.970482 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:02:23.970482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s sn_activities', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:02:24.120616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b2ddde0-a7bb-400a-af55-67c58a826078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C71C13D0>]}
[0m20:02:24.169405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b2ddde0-a7bb-400a-af55-67c58a826078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C703B7F0>]}
[0m20:02:24.169405 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:02:24.336405 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:02:24.493440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:24.493440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:24.557070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b2ddde0-a7bb-400a-af55-67c58a826078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C7911130>]}
[0m20:02:24.637105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:02:24.637105 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:02:24.652954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b2ddde0-a7bb-400a-af55-67c58a826078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C46457C0>]}
[0m20:02:24.652954 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m20:02:24.652954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2ddde0-a7bb-400a-af55-67c58a826078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C78D3760>]}
[0m20:02:24.652954 [info ] [MainThread]: 
[0m20:02:24.652954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:24.668481 [info ] [MainThread]: 
[0m20:02:24.668481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:24.675093 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:02:24.747146 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:02:24.748175 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:02:24.748175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:24.775621 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.028 seconds
[0m20:02:24.775621 [debug] [ThreadPool]: On list_postgres: Close
[0m20:02:24.779415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:02:24.779415 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:02:24.779415 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:02:24.779415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:24.811654 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:02:24.814708 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:02:24.815271 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:24.820207 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m20:02:24.821707 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:02:24.823448 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:02:24.824585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m20:02:24.825074 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:02:24.825074 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:02:24.825074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:24.857301 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m20:02:24.857810 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:02:24.858542 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:02:24.862895 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m20:02:24.864296 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:02:24.865874 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:02:24.866457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m20:02:24.868809 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:02:24.868809 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:02:24.868809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:24.905187 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m20:02:24.905467 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:02:24.906468 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:02:24.910469 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:02:24.912068 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:02:24.913969 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:02:24.916487 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:24.916487 [debug] [MainThread]: On master: BEGIN
[0m20:02:24.916487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:24.947742 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m20:02:24.949669 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:24.950091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:24.955861 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:02:24.957629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2ddde0-a7bb-400a-af55-67c58a826078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C7D34F40>]}
[0m20:02:24.958190 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:24.959666 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:24.959666 [debug] [MainThread]: On master: BEGIN
[0m20:02:24.960308 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:02:24.962640 [debug] [MainThread]: On master: COMMIT
[0m20:02:24.962883 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:24.963483 [debug] [MainThread]: On master: COMMIT
[0m20:02:24.965118 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:02:24.965648 [debug] [MainThread]: On master: Close
[0m20:02:24.973772 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:02:24.974305 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m20:02:24.974305 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m20:02:24.974305 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:02:24.974305 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:02:25.032981 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.032981 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m20:02:25.033981 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:02:25.073118 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.041 seconds
[0m20:02:25.073118 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.073118 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m20:02:25.088749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:02:25.090973 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.091664 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:25.099493 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.008 seconds
[0m20:02:25.102073 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.102073 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:25.102073 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:25.141439 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.141439 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp200225125578"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:02:25.160796 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.015 seconds
[0m20:02:25.160796 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.160796 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200225125578'
        
      order by ordinal_position

  
[0m20:02:25.168897 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m20:02:25.173001 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.173124 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:25.173623 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:25.173623 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.173623 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200225125578'
        
      order by ordinal_position

  
[0m20:02:25.173623 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m20:02:25.173623 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.173623 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:25.189367 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:25.226061 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.226061 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200225125578'
        
      order by ordinal_position

  
[0m20:02:25.236609 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m20:02:25.236609 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.236609 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:25.252255 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m20:02:25.256308 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.256308 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:25.256308 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:02:25.256308 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.256308 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.256308 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp200225125578" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp200225125578" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:02:25.256308 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m20:02:25.272348 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:02:25.272348 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:25.272348 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:02:25.272348 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:02:25.288064 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:02:25.288064 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2ddde0-a7bb-400a-af55-67c58a826078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C3B06520>]}
[0m20:02:25.288064 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 0[0m in 0.31s]
[0m20:02:25.288064 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:02:25.288064 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:25.288064 [debug] [MainThread]: On master: BEGIN
[0m20:02:25.295902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:25.316396 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:02:25.316956 [debug] [MainThread]: On master: COMMIT
[0m20:02:25.317457 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:25.318220 [debug] [MainThread]: On master: COMMIT
[0m20:02:25.319956 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:02:25.320491 [debug] [MainThread]: On master: Close
[0m20:02:25.321041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:25.321454 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:02:25.321991 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m20:02:25.322543 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m20:02:25.322543 [info ] [MainThread]: 
[0m20:02:25.323782 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m20:02:25.324954 [debug] [MainThread]: Command end result
[0m20:02:25.347416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:02:25.347416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:02:25.357059 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:02:25.357059 [info ] [MainThread]: 
[0m20:02:25.358795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:25.359439 [info ] [MainThread]: 
[0m20:02:25.360527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:02:25.362498 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:02:25.362498 after 1.44 seconds
[0m20:02:25.362498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C5270070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C561F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C76E7340>]}
[0m20:02:25.363484 [debug] [MainThread]: Flushing usage events
[0m20:02:26.546228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:56.505393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A1421FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A33939A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A33938E0>]}


============================== 20:02:56.505393 | b1c5ae92-ba3d-4c45-9305-a852bc4b61bb ==============================
[0m20:02:56.505393 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:02:56.505393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s sn_activities', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:02:56.667872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c5ae92-ba3d-4c45-9305-a852bc4b61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A074C040>]}
[0m20:02:56.716463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c5ae92-ba3d-4c45-9305-a852bc4b61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A074C8B0>]}
[0m20:02:56.716463 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:02:56.881927 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:02:57.041346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:57.041346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:57.103876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c5ae92-ba3d-4c45-9305-a852bc4b61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A3AD1130>]}
[0m20:02:57.183380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:02:57.183380 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:02:57.200272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c5ae92-ba3d-4c45-9305-a852bc4b61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A3AD7DF0>]}
[0m20:02:57.200272 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m20:02:57.200272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c5ae92-ba3d-4c45-9305-a852bc4b61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A3AF3490>]}
[0m20:02:57.200272 [info ] [MainThread]: 
[0m20:02:57.215900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:57.215900 [info ] [MainThread]: 
[0m20:02:57.215900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:57.215900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:02:57.292410 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:02:57.292410 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:02:57.292410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:57.324282 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.028 seconds
[0m20:02:57.324282 [debug] [ThreadPool]: On list_postgres: Close
[0m20:02:57.324282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m20:02:57.341279 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:02:57.341279 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:02:57.341279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:57.373099 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m20:02:57.373761 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:02:57.374263 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:02:57.379262 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m20:02:57.380349 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:02:57.381771 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:02:57.382765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m20:02:57.384350 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:02:57.384350 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:02:57.384350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:57.401555 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m20:02:57.417195 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:02:57.418299 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:57.422763 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:02:57.424367 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:02:57.426258 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:02:57.427380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m20:02:57.428756 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:02:57.428756 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:02:57.428756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:57.445330 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m20:02:57.460023 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:02:57.460465 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:02:57.464466 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:02:57.465560 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:02:57.467164 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:02:57.471079 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:57.471079 [debug] [MainThread]: On master: BEGIN
[0m20:02:57.471079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:57.491902 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:02:57.495052 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:57.495959 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:57.495959 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m20:02:57.495959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c5ae92-ba3d-4c45-9305-a852bc4b61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A3B04130>]}
[0m20:02:57.495959 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:57.495959 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:57.495959 [debug] [MainThread]: On master: BEGIN
[0m20:02:57.495959 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:02:57.508862 [debug] [MainThread]: On master: COMMIT
[0m20:02:57.509518 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:57.509518 [debug] [MainThread]: On master: COMMIT
[0m20:02:57.511619 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:02:57.512223 [debug] [MainThread]: On master: Close
[0m20:02:57.519164 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:02:57.519164 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m20:02:57.519164 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m20:02:57.519164 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:02:57.524399 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:02:57.573328 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.573328 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m20:02:57.573328 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:02:57.606225 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.028 seconds
[0m20:02:57.606225 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.606225 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m20:02:57.622084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:02:57.622491 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.622980 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:57.631372 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.007 seconds
[0m20:02:57.633367 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.633367 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:57.633367 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:57.665770 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.665770 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp200257665770"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:02:57.681422 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.014 seconds
[0m20:02:57.697390 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.697913 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200257665770'
        
      order by ordinal_position

  
[0m20:02:57.697913 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.004 seconds
[0m20:02:57.697913 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.697913 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:57.697913 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:57.712926 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.712926 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200257665770'
        
      order by ordinal_position

  
[0m20:02:57.712926 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.004 seconds
[0m20:02:57.712926 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.712926 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:02:57.712926 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:02:57.760166 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.760166 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200257665770'
        
      order by ordinal_position

  
[0m20:02:57.760166 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.004 seconds
[0m20:02:57.776397 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.776397 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:57.776397 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:02:57.776397 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.776397 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:02:57.776397 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:02:57.776397 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.776397 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.792196 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp200257665770" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp200257665770" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:02:57.792196 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m20:02:57.792196 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:02:57.792196 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:02:57.808190 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:02:57.809191 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:02:57.809191 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:02:57.809191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c5ae92-ba3d-4c45-9305-a852bc4b61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B99FCC6490>]}
[0m20:02:57.809191 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 0[0m in 0.29s]
[0m20:02:57.809191 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:02:57.809191 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:57.809191 [debug] [MainThread]: On master: BEGIN
[0m20:02:57.809191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:57.841772 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:02:57.842633 [debug] [MainThread]: On master: COMMIT
[0m20:02:57.843134 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:57.843134 [debug] [MainThread]: On master: COMMIT
[0m20:02:57.845136 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:02:57.845635 [debug] [MainThread]: On master: Close
[0m20:02:57.846133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:57.846634 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:02:57.846634 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m20:02:57.847217 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m20:02:57.847719 [info ] [MainThread]: 
[0m20:02:57.848635 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m20:02:57.849633 [debug] [MainThread]: Command end result
[0m20:02:57.869676 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:02:57.869676 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:02:57.869676 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:02:57.869676 [info ] [MainThread]: 
[0m20:02:57.869676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:57.869676 [info ] [MainThread]: 
[0m20:02:57.869676 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:02:57.869676 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:02:57.869676 after 1.42 seconds
[0m20:02:57.869676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A1421FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A36F9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A4064D60>]}
[0m20:02:57.885568 [debug] [MainThread]: Flushing usage events
[0m20:02:58.377729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:03.720953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023202311FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232042839A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232042838E0>]}


============================== 20:03:03.720953 | 0f6d305e-84ba-470e-9ce0-db4b92d76593 ==============================
[0m20:03:03.720953 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:03:03.720953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot -s sn_activities', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:03:03.881777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f6d305e-84ba-470e-9ce0-db4b92d76593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002320163E040>]}
[0m20:03:03.955504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f6d305e-84ba-470e-9ce0-db4b92d76593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002320163E8B0>]}
[0m20:03:03.959924 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:03:04.183409 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:03:04.356288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:04.356934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:04.406146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f6d305e-84ba-470e-9ce0-db4b92d76593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232049C1130>]}
[0m20:03:04.526332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:03:04.541683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:03:04.566272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f6d305e-84ba-470e-9ce0-db4b92d76593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232049CFDF0>]}
[0m20:03:04.572156 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m20:03:04.573442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f6d305e-84ba-470e-9ce0-db4b92d76593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232049E3490>]}
[0m20:03:04.573834 [info ] [MainThread]: 
[0m20:03:04.576428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:03:04.576428 [info ] [MainThread]: 
[0m20:03:04.579273 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:03:04.594646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:03:04.689733 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:03:04.689733 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:03:04.689733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:04.715770 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.030 seconds
[0m20:03:04.715770 [debug] [ThreadPool]: On list_postgres: Close
[0m20:03:04.731446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m20:03:04.731446 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:03:04.731446 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:03:04.731446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:04.746190 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m20:03:04.760935 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:03:04.761614 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:03:04.767507 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m20:03:04.768600 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:03:04.770505 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:03:04.771004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m20:03:04.771532 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:03:04.771532 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:03:04.771532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:04.837117 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m20:03:04.838517 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:03:04.839488 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:03:04.847486 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m20:03:04.849245 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:03:04.850589 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:03:04.852071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m20:03:04.855899 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:03:04.856566 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:03:04.857061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:04.878033 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:03:04.878533 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:03:04.879549 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:03:04.884034 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:03:04.885554 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:03:04.886552 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:03:04.889380 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:04.889380 [debug] [MainThread]: On master: BEGIN
[0m20:03:04.889380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:03:04.907540 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:03:04.913681 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:04.914191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:03:04.919692 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:03:04.923066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f6d305e-84ba-470e-9ce0-db4b92d76593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232042544C0>]}
[0m20:03:04.923750 [debug] [MainThread]: On master: ROLLBACK
[0m20:03:04.924764 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:04.924764 [debug] [MainThread]: On master: BEGIN
[0m20:03:04.924764 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:03:04.928795 [debug] [MainThread]: On master: COMMIT
[0m20:03:04.929141 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:04.929239 [debug] [MainThread]: On master: COMMIT
[0m20:03:04.930740 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:03:04.930740 [debug] [MainThread]: On master: Close
[0m20:03:04.938280 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:03:04.938781 [info ] [Thread-1  ]: 1 of 1 START snapshot public_staging.sn_activities ............................. [RUN]
[0m20:03:04.939280 [debug] [Thread-1  ]: Acquiring new postgres connection 'snapshot.enpal_assessment_project.sn_activities'
[0m20:03:04.939280 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:03:04.939280 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:03:04.991440 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:04.991440 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m20:03:04.991440 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:03:05.006607 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.020 seconds
[0m20:03:05.022726 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.022726 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m20:03:05.036572 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:03:05.037172 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.037572 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:03:05.046800 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.009 seconds
[0m20:03:05.054764 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.055761 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:03:05.061107 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.005 seconds
[0m20:03:05.102994 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.102994 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp200305093474"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:03:05.122284 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.018 seconds
[0m20:03:05.125767 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.126767 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200305093474'
        
      order by ordinal_position

  
[0m20:03:05.130271 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m20:03:05.134274 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.135199 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:03:05.138872 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:03:05.143250 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.143250 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200305093474'
        
      order by ordinal_position

  
[0m20:03:05.148067 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.004 seconds
[0m20:03:05.152425 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.152425 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:03:05.157152 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m20:03:05.205535 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.206329 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp200305093474'
        
      order by ordinal_position

  
[0m20:03:05.209739 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m20:03:05.224142 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.225268 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:03:05.227984 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:03:05.231409 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.232512 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:03:05.234313 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:03:05.235302 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.236366 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.236366 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp200305093474" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp200305093474" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:03:05.240014 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m20:03:05.253637 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:03:05.254650 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:03:05.255364 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:03:05.262611 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:03:05.266536 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:03:05.269430 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6d305e-84ba-470e-9ce0-db4b92d76593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023200BB7490>]}
[0m20:03:05.270858 [info ] [Thread-1  ]: 1 of 1 OK snapshotted public_staging.sn_activities ............................. [[32mINSERT 0 0[0m in 0.33s]
[0m20:03:05.272365 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:03:05.274729 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:05.275065 [debug] [MainThread]: On master: BEGIN
[0m20:03:05.275065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:03:05.298882 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:03:05.299728 [debug] [MainThread]: On master: COMMIT
[0m20:03:05.300048 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:05.300549 [debug] [MainThread]: On master: COMMIT
[0m20:03:05.302044 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:03:05.302620 [debug] [MainThread]: On master: Close
[0m20:03:05.303192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:05.303192 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:03:05.303811 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:03:05.303811 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_activities' was properly closed.
[0m20:03:05.304350 [info ] [MainThread]: 
[0m20:03:05.305064 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m20:03:05.307162 [debug] [MainThread]: Command end result
[0m20:03:05.335381 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:03:05.337795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:03:05.346641 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:03:05.346641 [info ] [MainThread]: 
[0m20:03:05.347746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:05.348657 [info ] [MainThread]: 
[0m20:03:05.349925 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:03:05.351781 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:03:05.351781 after 1.67 seconds
[0m20:03:05.351781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023202311FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023204FA1E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023204FA16D0>]}
[0m20:03:05.351781 [debug] [MainThread]: Flushing usage events
[0m20:03:06.501182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:22.079896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268FEA0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022691E14700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022691E147C0>]}


============================== 20:04:22.079896 | 1f63602d-18f4-42c2-9281-6cbdb40f23b1 ==============================
[0m20:04:22.079896 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:04:22.079896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s t_activities', 'send_anonymous_usage_stats': 'True'}
[0m20:04:22.230990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f63602d-18f4-42c2-9281-6cbdb40f23b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022691DF43D0>]}
[0m20:04:22.279103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f63602d-18f4-42c2-9281-6cbdb40f23b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022691C6B7F0>]}
[0m20:04:22.279103 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:04:22.469337 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:04:22.636972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:04:22.636972 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_activities.sql
[0m20:04:22.928942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f63602d-18f4-42c2-9281-6cbdb40f23b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226927CB130>]}
[0m20:04:23.031772 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:04:23.034308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:04:23.049936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f63602d-18f4-42c2-9281-6cbdb40f23b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269278A520>]}
[0m20:04:23.049936 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m20:04:23.049936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f63602d-18f4-42c2-9281-6cbdb40f23b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226927C6850>]}
[0m20:04:23.049936 [info ] [MainThread]: 
[0m20:04:23.049936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:23.049936 [info ] [MainThread]: 
[0m20:04:23.049936 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:23.059718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:04:23.168008 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:04:23.168008 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:04:23.168008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:23.191339 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.029 seconds
[0m20:04:23.191339 [debug] [ThreadPool]: On list_postgres: Close
[0m20:04:23.207181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:04:23.207181 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:04:23.207181 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:04:23.207181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:23.223669 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:04:23.234877 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:04:23.235423 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:04:23.240156 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:04:23.241939 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:04:23.243957 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:04:23.244595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m20:04:23.246247 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:04:23.246247 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:04:23.246247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:23.267919 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:04:23.268927 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:04:23.269698 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:04:23.274938 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m20:04:23.276243 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:04:23.278055 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:04:23.278678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m20:04:23.279809 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:04:23.279809 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:04:23.279809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:23.303051 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m20:04:23.318539 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:04:23.319219 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:04:23.323084 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:04:23.324183 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:04:23.325834 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:04:23.329653 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.329653 [debug] [MainThread]: On master: BEGIN
[0m20:04:23.329653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:23.351705 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:04:23.352339 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.352775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:23.359085 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m20:04:23.360930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f63602d-18f4-42c2-9281-6cbdb40f23b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269278A6D0>]}
[0m20:04:23.360930 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:23.362661 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.363174 [debug] [MainThread]: On master: BEGIN
[0m20:04:23.363174 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:04:23.366276 [debug] [MainThread]: On master: COMMIT
[0m20:04:23.366812 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.367377 [debug] [MainThread]: On master: COMMIT
[0m20:04:23.369327 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:04:23.369871 [debug] [MainThread]: On master: Close
[0m20:04:23.373509 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:04:23.374466 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:04:23.375678 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_activities'
[0m20:04:23.376827 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:04:23.377412 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:04:23.377412 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:04:23.421099 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:04:23.423019 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:04:23.424029 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:04:23.424029 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:04:23.443462 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:04:23.445262 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:04:23.445759 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:04:23.449268 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:04:23.451825 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:04:23.451825 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities" rename to "t_activities__dbt_backup"
[0m20:04:23.451825 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:04:23.451825 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:04:23.451825 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:04:23.451825 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:04:23.468038 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:04:23.468038 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:04:23.468038 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:04:23.484519 [debug] [Thread-1  ]: SQL status: COMMIT in 0.013 seconds
[0m20:04:23.484519 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:04:23.500472 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:04:23.500472 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:04:23.500472 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m20:04:23.500472 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:04:23.500472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f63602d-18f4-42c2-9281-6cbdb40f23b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022692BC32E0>]}
[0m20:04:23.500472 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:04:23.500472 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:04:23.500472 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.500472 [debug] [MainThread]: On master: BEGIN
[0m20:04:23.500472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:23.539324 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:04:23.539754 [debug] [MainThread]: On master: COMMIT
[0m20:04:23.540294 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.540857 [debug] [MainThread]: On master: COMMIT
[0m20:04:23.542755 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:04:23.543341 [debug] [MainThread]: On master: Close
[0m20:04:23.543847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:23.544257 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:04:23.544758 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m20:04:23.544758 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_activities' was properly closed.
[0m20:04:23.545259 [info ] [MainThread]: 
[0m20:04:23.546258 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m20:04:23.547759 [debug] [MainThread]: Command end result
[0m20:04:23.569622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:04:23.569622 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:04:23.569622 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:04:23.569622 [info ] [MainThread]: 
[0m20:04:23.569622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:04:23.569622 [info ] [MainThread]: 
[0m20:04:23.584656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:04:23.586958 [debug] [MainThread]: Command `dbt run` succeeded at 20:04:23.586958 after 1.55 seconds
[0m20:04:23.586958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268FEA0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268FD61A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022692BE2C70>]}
[0m20:04:23.586958 [debug] [MainThread]: Flushing usage events
[0m20:04:24.461892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:17.392018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765DA2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022767D14700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022767D147C0>]}


============================== 20:05:17.392018 | 8a79de40-2706-4bb5-98be-a4faff2a9c62 ==============================
[0m20:05:17.392018 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:05:17.392018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s +t_sales_funnel_monthly_rows', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:17.543662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022767CF33D0>]}
[0m20:05:17.606171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022767B6B7F0>]}
[0m20:05:17.606171 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:05:17.781561 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:05:17.950146 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m20:05:17.950146 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\staging\pipedrive\stg_activities.sql
[0m20:05:18.013235 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_activities' in the 'models' section of file 'models\staging\pipedrive\pipedrive.yml'
[0m20:05:18.146411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022768527EB0>]}
[0m20:05:18.241006 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:05:18.241006 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:05:18.256639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276844A070>]}
[0m20:05:18.256639 [info ] [MainThread]: Found 12 models, 2 snapshots, 6 sources, 428 macros
[0m20:05:18.256639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765C62DF0>]}
[0m20:05:18.256639 [info ] [MainThread]: 
[0m20:05:18.256639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:18.256639 [info ] [MainThread]: 
[0m20:05:18.272354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:05:18.272940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:05:18.352890 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:05:18.353890 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:05:18.353890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:18.380753 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.027 seconds
[0m20:05:18.382773 [debug] [ThreadPool]: On list_postgres: Close
[0m20:05:18.387738 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:05:18.387738 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:05:18.387738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:18.420455 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.032 seconds
[0m20:05:18.420455 [debug] [ThreadPool]: On list_postgres: Close
[0m20:05:18.420455 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:05:18.420455 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:05:18.420455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:18.443032 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.020 seconds
[0m20:05:18.443032 [debug] [ThreadPool]: On list_postgres: Close
[0m20:05:18.449057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:05:18.449057 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:05:18.449057 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:05:18.449057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:18.467341 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:05:18.480141 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:05:18.480573 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:05:18.485461 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:05:18.486591 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:05:18.488580 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:05:18.489684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m20:05:18.493541 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:05:18.494054 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:05:18.494355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:18.514452 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m20:05:18.529401 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:05:18.529707 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:05:18.536710 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m20:05:18.538209 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:05:18.540053 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:05:18.540053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m20:05:18.540053 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:05:18.540053 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:05:18.540053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:18.564157 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:05:18.564680 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:05:18.565695 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:05:18.570198 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m20:05:18.571248 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:05:18.572694 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:05:18.575833 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:18.575833 [debug] [MainThread]: On master: BEGIN
[0m20:05:18.575833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:18.599212 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m20:05:18.599764 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:18.600255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:05:18.605779 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:05:18.608296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227646DF9D0>]}
[0m20:05:18.608838 [debug] [MainThread]: On master: ROLLBACK
[0m20:05:18.610427 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:18.610427 [debug] [MainThread]: On master: BEGIN
[0m20:05:18.611020 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:05:18.614541 [debug] [MainThread]: On master: COMMIT
[0m20:05:18.615049 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:18.615049 [debug] [MainThread]: On master: COMMIT
[0m20:05:18.617389 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:05:18.617634 [debug] [MainThread]: On master: Close
[0m20:05:18.647970 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m20:05:18.647970 [info ] [Thread-1  ]: 1 of 8 START sql view model public.calendar_ ................................... [RUN]
[0m20:05:18.647970 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m20:05:18.647970 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m20:05:18.647970 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m20:05:18.647970 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m20:05:18.683777 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m20:05:18.683777 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:05:18.683777 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m20:05:18.683777 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:05:18.728518 [debug] [Thread-1  ]: SQL status: BEGIN in 0.032 seconds
[0m20:05:18.729838 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:05:18.730360 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m20:05:18.734864 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:05:18.740863 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:05:18.740863 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m20:05:18.740863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:05:18.740863 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:05:18.740863 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m20:05:18.740863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:05:18.757215 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:05:18.757215 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:05:18.757215 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:05:18.757215 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:05:18.772855 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m20:05:18.772855 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:05:18.772855 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m20:05:18.772855 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m20:05:18.772855 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m20:05:18.772855 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276473FCA0>]}
[0m20:05:18.788481 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m20:05:18.788481 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m20:05:18.788481 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:05:18.788481 [info ] [Thread-1  ]: 2 of 8 START sql table model public_staging.stg_activity_types ................. [RUN]
[0m20:05:18.788481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m20:05:18.788481 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:05:18.788481 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.788481 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:05:18.820311 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.822405 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.822405 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:05:18.822405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:18.847892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m20:05:18.848601 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.849601 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m20:05:18.854733 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.005 seconds
[0m20:05:18.858190 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.858798 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m20:05:18.859338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:05:18.859338 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.859338 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:05:18.864455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:05:18.870841 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:05:18.870841 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.870841 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:05:18.877489 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:05:18.880475 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m20:05:18.883605 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:05:18.883605 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m20:05:18.889141 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m20:05:18.890241 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:05:18.891147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765156C10>]}
[0m20:05:18.891147 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public_staging.stg_activity_types ............ [[32mSELECT 4[0m in 0.10s]
[0m20:05:18.892249 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:05:18.893150 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:05:18.893150 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public_staging.stg_deal_changes ............. [RUN]
[0m20:05:18.894151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:05:18.895153 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:05:18.899312 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:18.899312 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:05:18.934583 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:18.935580 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp200518921382"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m20:05:18.935580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:18.967311 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.033 seconds
[0m20:05:18.981605 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:18.982635 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:05:18.984627 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:05:18.985597 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:18.986286 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp200518921382'
        
      order by ordinal_position

  
[0m20:05:18.993068 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.006 seconds
[0m20:05:18.997966 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:18.997966 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:05:19.002410 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m20:05:19.009513 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:19.009513 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:05:19.012508 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m20:05:19.015659 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:19.015659 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:19.015659 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp200518921382"
            where (
                
                    "stg_deal_changes__dbt_tmp200518921382".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp200518921382".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp200518921382".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp200518921382"
    )
  
[0m20:05:19.031288 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m20:05:19.031288 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:05:19.031288 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:05:19.031288 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:05:19.031288 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:05:19.031288 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:05:19.031288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022768223CA0>]}
[0m20:05:19.031288 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public_staging.stg_deal_changes ........ [[32mINSERT 0 0[0m in 0.14s]
[0m20:05:19.031288 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:05:19.031288 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:05:19.031288 [info ] [Thread-1  ]: 4 of 8 START sql table model public_staging.stg_stages ......................... [RUN]
[0m20:05:19.031288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_stages)
[0m20:05:19.047107 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:05:19.047608 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:05:19.047608 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:05:19.047608 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:05:19.047608 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:05:19.047608 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:05:19.047608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:19.070699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:05:19.078559 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:05:19.078978 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:05:19.082840 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m20:05:19.086698 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:05:19.087652 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m20:05:19.088823 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:05:19.092570 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:05:19.092570 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m20:05:19.092570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:05:19.092570 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:05:19.098012 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:05:19.098515 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:05:19.099956 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:05:19.099956 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m20:05:19.099956 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:05:19.099956 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m20:05:19.099956 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m20:05:19.099956 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:05:19.099956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022768438AF0>]}
[0m20:05:19.099956 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public_staging.stg_stages .................... [[32mSELECT 9[0m in 0.07s]
[0m20:05:19.115587 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:05:19.116770 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m20:05:19.117590 [info ] [Thread-1  ]: 5 of 8 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m20:05:19.119588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.t_user_deal_events)
[0m20:05:19.120084 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m20:05:19.122084 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:05:19.123084 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m20:05:19.127097 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:05:19.128091 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:05:19.128585 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m20:05:19.129085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:19.155517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.034 seconds
[0m20:05:19.163601 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:05:19.164295 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."sn_users" dc
WHERE changed_field_key = 'user_id'
  );
[0m20:05:19.167112 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "deal_id" does not exist
LINE 8:    deal_id
           ^

[0m20:05:19.167648 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: ROLLBACK
[0m20:05:19.170670 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m20:05:19.183142 [debug] [Thread-1  ]: Database Error in model t_user_deal_events (models\transformations\crm\t_user_deal_events.sql)
  column "deal_id" does not exist
  LINE 8:    deal_id
             ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_user_deal_events.sql
[0m20:05:19.183142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022768259550>]}
[0m20:05:19.183142 [error] [Thread-1  ]: 5 of 8 ERROR creating sql view model public_crm.t_user_deal_events ............. [[31mERROR[0m in 0.06s]
[0m20:05:19.183142 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m20:05:19.183142 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:05:19.183142 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_user_deal_events' to be skipped because of status 'error'.  Reason: Database Error in model t_user_deal_events (models\transformations\crm\t_user_deal_events.sql)
  column "deal_id" does not exist
  LINE 8:    deal_id
             ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_user_deal_events.sql.
[0m20:05:19.183142 [info ] [Thread-1  ]: 6 of 8 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:05:19.183142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_activities)
[0m20:05:19.183142 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:05:19.183142 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:05:19.183142 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:05:19.201448 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:05:19.202474 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:05:19.203457 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:05:19.203457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:19.224937 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:05:19.225484 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:05:19.225820 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:05:19.225820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:05:19.233645 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:05:19.233645 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:05:19.233645 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:05:19.233645 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:05:19.233645 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:05:19.233645 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:05:19.233645 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:05:19.249305 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:05:19.249305 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:05:19.249305 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:05:19.249305 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:05:19.249305 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:05:19.249305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765C42F40>]}
[0m20:05:19.249305 [info ] [Thread-1  ]: 6 of 8 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m20:05:19.257777 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:05:19.257777 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:05:19.257777 [info ] [Thread-1  ]: 7 of 8 START sql view model public_crm.t_deal_funnel_events .................... [RUN]
[0m20:05:19.257777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_funnel_events)
[0m20:05:19.257777 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m20:05:19.257777 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:05:19.265553 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m20:05:19.271327 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:05:19.271327 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:05:19.271327 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m20:05:19.271327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:19.298198 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m20:05:19.299706 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:05:19.300196 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM "postgres"."public_crm"."t_activities"
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN "postgres"."public_staging"."stg_stages" s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m20:05:19.307196 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:05:19.309694 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:05:19.309694 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m20:05:19.309694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:05:19.314925 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:05:19.316980 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:05:19.317941 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:05:19.319102 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:05:19.319102 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m20:05:19.319102 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:05:19.319102 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m20:05:19.319102 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:05:19.319102 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m20:05:19.331631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a79de40-2706-4bb5-98be-a4faff2a9c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022768B2F850>]}
[0m20:05:19.332649 [info ] [Thread-1  ]: 7 of 8 OK created sql view model public_crm.t_deal_funnel_events ............... [[32mCREATE VIEW[0m in 0.07s]
[0m20:05:19.333655 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:05:19.334645 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:05:19.335729 [info ] [Thread-1  ]: 8 of 8 SKIP relation public_crm.t_sales_funnel_monthly_rows .................... [[33mSKIP[0m]
[0m20:05:19.336665 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:05:19.337648 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:19.338734 [debug] [MainThread]: On master: BEGIN
[0m20:05:19.338734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:19.370917 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m20:05:19.380844 [debug] [MainThread]: On master: COMMIT
[0m20:05:19.381340 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:19.381460 [debug] [MainThread]: On master: COMMIT
[0m20:05:19.383611 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:05:19.384447 [debug] [MainThread]: On master: Close
[0m20:05:19.385020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:19.385582 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:05:19.385582 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m20:05:19.385582 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_deal_funnel_events' was properly closed.
[0m20:05:19.386330 [info ] [MainThread]: 
[0m20:05:19.387519 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 5 view models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m20:05:19.389301 [debug] [MainThread]: Command end result
[0m20:05:19.404609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:05:19.404609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:05:19.417196 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:05:19.417196 [info ] [MainThread]: 
[0m20:05:19.417196 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:05:19.417196 [info ] [MainThread]: 
[0m20:05:19.417196 [error] [MainThread]:   Database Error in model t_user_deal_events (models\transformations\crm\t_user_deal_events.sql)
  column "deal_id" does not exist
  LINE 8:    deal_id
             ^
  compiled code at target\run\enpal_assessment_project\models\transformations\crm\t_user_deal_events.sql
[0m20:05:19.417196 [info ] [MainThread]: 
[0m20:05:19.417196 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m20:05:19.429878 [debug] [MainThread]: Command `dbt run` failed at 20:05:19.429878 after 2.08 seconds
[0m20:05:19.430879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765DA2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276844A070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227651B2DC0>]}
[0m20:05:19.431989 [debug] [MainThread]: Flushing usage events
[0m20:05:20.283098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:13.746124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803AA70070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803C9E4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803C9E47C0>]}


============================== 20:06:13.746124 | 36693d3a-2843-4194-982b-978cfe968bc2 ==============================
[0m20:06:13.746124 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:06:13.746124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s +t_sales_funnel_monthly_rows', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:06:13.891720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803C9C23D0>]}
[0m20:06:13.938946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803C83B7F0>]}
[0m20:06:13.938946 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:06:14.119452 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:06:14.288020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:06:14.288020 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\t_user_deal_events.sql
[0m20:06:14.524181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D2D2EB0>]}
[0m20:06:14.619408 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:06:14.619408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:06:14.635034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D2A62E0>]}
[0m20:06:14.635034 [info ] [MainThread]: Found 12 models, 2 snapshots, 6 sources, 428 macros
[0m20:06:14.635034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D2D1CA0>]}
[0m20:06:14.635034 [info ] [MainThread]: 
[0m20:06:14.650670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:06:14.650670 [info ] [MainThread]: 
[0m20:06:14.650670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:06:14.658394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:06:14.742377 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:14.743399 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:14.743899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:14.789392 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.045 seconds
[0m20:06:14.789919 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:14.793440 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:14.793440 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:14.793440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:14.811700 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.016 seconds
[0m20:06:14.811700 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:14.811700 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:14.811700 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:14.811700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:14.834283 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.018 seconds
[0m20:06:14.834283 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:14.837758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m20:06:14.845494 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:06:14.845963 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:06:14.845963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:14.877536 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m20:06:14.883083 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:06:14.883644 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:06:14.888215 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:06:14.889604 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:06:14.891426 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:06:14.892121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m20:06:14.894564 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:06:14.894564 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:06:14.894564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:14.927548 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m20:06:14.930801 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:06:14.931310 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:06:14.936175 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m20:06:14.937885 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:06:14.939748 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:06:14.940461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m20:06:14.975299 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:06:14.975299 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:06:14.975299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:15.006795 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m20:06:15.007642 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:06:15.008151 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:06:15.012649 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:06:15.013648 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:06:15.015656 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:06:15.018150 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:15.018150 [debug] [MainThread]: On master: BEGIN
[0m20:06:15.018150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:15.038062 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m20:06:15.051547 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:15.052046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:06:15.057751 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m20:06:15.060771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D269DC0>]}
[0m20:06:15.061276 [debug] [MainThread]: On master: ROLLBACK
[0m20:06:15.062452 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:15.062452 [debug] [MainThread]: On master: BEGIN
[0m20:06:15.066977 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:06:15.067523 [debug] [MainThread]: On master: COMMIT
[0m20:06:15.068031 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:15.068031 [debug] [MainThread]: On master: COMMIT
[0m20:06:15.070522 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:06:15.071116 [debug] [MainThread]: On master: Close
[0m20:06:15.075024 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m20:06:15.075618 [info ] [Thread-1  ]: 1 of 8 START sql view model public.calendar_ ................................... [RUN]
[0m20:06:15.077022 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m20:06:15.077521 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m20:06:15.079020 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m20:06:15.079020 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m20:06:15.113795 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m20:06:15.113795 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:15.113795 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m20:06:15.113795 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:06:15.144417 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m20:06:15.145042 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:15.145770 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m20:06:15.149259 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:06:15.154337 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:15.154841 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m20:06:15.156021 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.160755 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:15.161951 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m20:06:15.162643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.178269 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:06:15.178269 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:15.178269 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:06:15.178269 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:06:15.178269 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m20:06:15.193900 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:15.193900 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m20:06:15.193900 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m20:06:15.193900 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m20:06:15.193900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018039E82AC0>]}
[0m20:06:15.193900 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m20:06:15.193900 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m20:06:15.193900 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:06:15.193900 [info ] [Thread-1  ]: 2 of 8 START sql table model public_staging.stg_activity_types ................. [RUN]
[0m20:06:15.193900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m20:06:15.209610 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:06:15.209610 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.209610 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:06:15.232255 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.232255 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.232255 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:06:15.232255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:15.251431 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:06:15.259412 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.259976 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m20:06:15.264959 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m20:06:15.268957 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.269458 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m20:06:15.269957 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.269957 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.269957 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:06:15.269957 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:06:15.280203 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:06:15.280203 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.280203 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:06:15.280203 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:15.280203 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m20:06:15.294830 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:15.295344 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m20:06:15.300843 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m20:06:15.301931 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:06:15.302840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803CFD30D0>]}
[0m20:06:15.303928 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public_staging.stg_activity_types ............ [[32mSELECT 4[0m in 0.11s]
[0m20:06:15.304839 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:06:15.305840 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:06:15.305840 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public_staging.stg_deal_changes ............. [RUN]
[0m20:06:15.306867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:06:15.307902 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:06:15.316272 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.316272 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:06:15.329121 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.344867 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp200615329121"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m20:06:15.345395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:15.363439 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.025 seconds
[0m20:06:15.383666 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.384671 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:06:15.386806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:06:15.387623 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.388352 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp200615329121'
        
      order by ordinal_position

  
[0m20:06:15.396007 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.007 seconds
[0m20:06:15.400992 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.400992 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:06:15.405613 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m20:06:15.412133 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.412133 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:06:15.412133 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m20:06:15.427893 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.427893 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.427893 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp200615329121"
            where (
                
                    "stg_deal_changes__dbt_tmp200615329121".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp200615329121".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp200615329121".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp200615329121"
    )
  
[0m20:06:15.427893 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m20:06:15.427893 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:06:15.427893 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:15.427893 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:06:15.443595 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:06:15.443595 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:06:15.443595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D738880>]}
[0m20:06:15.443595 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public_staging.stg_deal_changes ........ [[32mINSERT 0 0[0m in 0.14s]
[0m20:06:15.448514 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:06:15.448514 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:06:15.448514 [info ] [Thread-1  ]: 4 of 8 START sql table model public_staging.stg_stages ......................... [RUN]
[0m20:06:15.448514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_stages)
[0m20:06:15.448514 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:06:15.448514 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:06:15.448514 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:06:15.448514 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:06:15.448514 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:15.448514 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:06:15.448514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:15.480707 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:06:15.481454 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:15.481925 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:06:15.485371 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m20:06:15.489093 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:15.489093 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m20:06:15.491366 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.491366 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:15.491366 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m20:06:15.495806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:06:15.497986 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:06:15.497986 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:15.497986 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:06:15.497986 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:15.497986 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m20:06:15.497986 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:15.497986 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m20:06:15.513348 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m20:06:15.513348 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:06:15.517951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018039E82730>]}
[0m20:06:15.517951 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public_staging.stg_stages .................... [[32mSELECT 9[0m in 0.06s]
[0m20:06:15.517951 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:06:15.517951 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:06:15.517951 [info ] [Thread-1  ]: 5 of 8 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:06:15.517951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.t_activities)
[0m20:06:15.517951 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:06:15.517951 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:06:15.517951 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:06:15.532700 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:06:15.533728 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:15.534731 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:06:15.534731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:15.546298 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:06:15.558043 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:15.558554 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:06:15.563058 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:06:15.567554 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:15.567922 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:06:15.568603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.568603 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:06:15.568603 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:15.568603 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:06:15.577805 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:15.580780 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:06:15.580780 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:15.580780 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:06:15.580780 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:06:15.580780 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:06:15.580780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D7FE400>]}
[0m20:06:15.580780 [info ] [Thread-1  ]: 5 of 8 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.06s]
[0m20:06:15.580780 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:06:15.580780 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m20:06:15.580780 [info ] [Thread-1  ]: 6 of 8 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m20:06:15.580780 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_user_deal_events)
[0m20:06:15.580780 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m20:06:15.580780 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:15.596069 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m20:06:15.601822 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:15.602835 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:15.602835 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m20:06:15.602835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:15.613719 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:06:15.626501 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:15.626664 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m20:06:15.630391 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:06:15.634940 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:15.635472 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m20:06:15.636175 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.636175 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:06:15.636175 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:15.636175 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:06:15.645294 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:15.646927 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m20:06:15.646927 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:15.646927 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m20:06:15.646927 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:06:15.646927 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m20:06:15.646927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D7F4D00>]}
[0m20:06:15.646927 [info ] [Thread-1  ]: 6 of 8 OK created sql view model public_crm.t_user_deal_events ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:06:15.657414 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m20:06:15.657414 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:15.657414 [info ] [Thread-1  ]: 7 of 8 START sql view model public_crm.t_deal_funnel_events .................... [RUN]
[0m20:06:15.657414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_deal_funnel_events)
[0m20:06:15.657414 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:15.665633 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:15.667551 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:15.670635 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:15.671654 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:15.672552 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m20:06:15.672552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:15.709842 [debug] [Thread-1  ]: SQL status: BEGIN in 0.037 seconds
[0m20:06:15.710652 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:15.711325 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM "postgres"."public_crm"."t_activities"
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN "postgres"."public_staging"."stg_stages" s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m20:06:15.717816 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:06:15.720025 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:15.720025 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m20:06:15.720025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.720025 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:06:15.720025 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:15.720025 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:06:15.730135 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:06:15.732233 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m20:06:15.733241 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:15.733241 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m20:06:15.735143 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:06:15.736142 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m20:06:15.737679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D7F4D00>]}
[0m20:06:15.737679 [info ] [Thread-1  ]: 7 of 8 OK created sql view model public_crm.t_deal_funnel_events ............... [[32mCREATE VIEW[0m in 0.08s]
[0m20:06:15.739704 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:15.740755 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:06:15.740755 [info ] [Thread-1  ]: 8 of 8 START sql view model public_crm.t_sales_funnel_monthly_rows ............. [RUN]
[0m20:06:15.741698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_sales_funnel_monthly_rows)
[0m20:06:15.742793 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:06:15.746936 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:06:15.747918 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:06:15.752007 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:06:15.752916 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:06:15.752916 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m20:06:15.753915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:15.776244 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:06:15.776750 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:06:15.777300 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m20:06:15.786315 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:06:15.786839 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:06:15.786839 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp" rename to "t_sales_funnel_monthly_rows"
[0m20:06:15.786839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:15.786839 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:06:15.786839 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:06:15.786839 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:06:15.796677 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:15.796677 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup"
[0m20:06:15.796677 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:06:15.796677 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup" cascade
[0m20:06:15.796677 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:06:15.796677 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m20:06:15.796677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36693d3a-2843-4194-982b-978cfe968bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803D7F47C0>]}
[0m20:06:15.796677 [info ] [Thread-1  ]: 8 of 8 OK created sql view model public_crm.t_sales_funnel_monthly_rows ........ [[32mCREATE VIEW[0m in 0.05s]
[0m20:06:15.796677 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:06:15.796677 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:15.796677 [debug] [MainThread]: On master: BEGIN
[0m20:06:15.812317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:15.833750 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m20:06:15.834527 [debug] [MainThread]: On master: COMMIT
[0m20:06:15.835113 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:15.835699 [debug] [MainThread]: On master: COMMIT
[0m20:06:15.837664 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:06:15.838151 [debug] [MainThread]: On master: Close
[0m20:06:15.838724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:15.839134 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:06:15.839134 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:06:15.839633 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' was properly closed.
[0m20:06:15.840218 [info ] [MainThread]: 
[0m20:06:15.841136 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 5 view models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m20:06:15.843632 [debug] [MainThread]: Command end result
[0m20:06:15.864395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:06:15.864395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:06:15.878011 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:06:15.878011 [info ] [MainThread]: 
[0m20:06:15.879372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:15.880249 [info ] [MainThread]: 
[0m20:06:15.880249 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:06:15.880249 [debug] [MainThread]: Command `dbt run` succeeded at 20:06:15.880249 after 2.19 seconds
[0m20:06:15.880249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803AA70070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803A6BC8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803C44C7F0>]}
[0m20:06:15.880249 [debug] [MainThread]: Flushing usage events
[0m20:06:19.878681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:25.697184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074D525FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074F494940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074F494880>]}


============================== 20:06:25.697184 | c052f6c8-80d0-45fb-ac12-673a833a216e ==============================
[0m20:06:25.697184 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:06:25.697184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s +t_sales_funnel_monthly_columns', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:06:25.856739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074BDEA8B0>]}
[0m20:06:25.903707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074C840580>]}
[0m20:06:25.903707 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:06:26.089073 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:06:26.245187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:26.245187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:26.293202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074FBCC130>]}
[0m20:06:26.403821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:06:26.405097 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:06:26.420863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074FBF3700>]}
[0m20:06:26.420863 [info ] [MainThread]: Found 12 models, 2 snapshots, 6 sources, 428 macros
[0m20:06:26.420863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074FBD13D0>]}
[0m20:06:26.420863 [info ] [MainThread]: 
[0m20:06:26.420863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:06:26.420863 [info ] [MainThread]: 
[0m20:06:26.420863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:06:26.437582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:06:26.510898 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:26.510898 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:26.511992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:26.528691 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.028 seconds
[0m20:06:26.528691 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:26.546455 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:26.546902 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:26.547577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:26.555160 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.020 seconds
[0m20:06:26.555160 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:26.573316 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:26.573316 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:26.573316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:26.588956 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.020 seconds
[0m20:06:26.588956 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:26.588956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m20:06:26.604685 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:06:26.604685 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:06:26.604685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:26.627777 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m20:06:26.637342 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:06:26.638326 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:06:26.642783 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m20:06:26.644282 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:06:26.646304 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:06:26.647393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m20:06:26.649286 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:06:26.649286 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:06:26.649286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:26.665189 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:06:26.672707 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:06:26.673438 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:06:26.673438 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:06:26.673438 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:06:26.673438 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:06:26.673438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m20:06:26.673438 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:06:26.673438 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:06:26.673438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:26.706294 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:06:26.707793 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:06:26.708364 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:06:26.714795 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m20:06:26.716383 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:06:26.717296 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:06:26.717296 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:26.717296 [debug] [MainThread]: On master: BEGIN
[0m20:06:26.717296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:26.730963 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:06:26.746252 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:26.746765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:06:26.747271 [debug] [MainThread]: SQL status: SELECT 11 in 0.004 seconds
[0m20:06:26.747271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074C8A72E0>]}
[0m20:06:26.747271 [debug] [MainThread]: On master: ROLLBACK
[0m20:06:26.747271 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:26.747271 [debug] [MainThread]: On master: BEGIN
[0m20:06:26.760763 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:06:26.760939 [debug] [MainThread]: On master: COMMIT
[0m20:06:26.761453 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:26.761952 [debug] [MainThread]: On master: COMMIT
[0m20:06:26.764458 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:06:26.764458 [debug] [MainThread]: On master: Close
[0m20:06:26.771680 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m20:06:26.771680 [info ] [Thread-1  ]: 1 of 8 START sql view model public.calendar_ ................................... [RUN]
[0m20:06:26.771680 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m20:06:26.771680 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m20:06:26.777925 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m20:06:26.777925 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m20:06:26.812517 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m20:06:26.812517 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:26.818261 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m20:06:26.818261 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:06:26.838035 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:06:26.838950 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:26.839434 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m20:06:26.842457 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:06:26.850049 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:26.850557 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m20:06:26.852990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:26.855456 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:26.855456 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m20:06:26.857462 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:26.861630 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:06:26.861630 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:26.861630 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:06:26.878525 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:06:26.878525 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m20:06:26.878525 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:06:26.878525 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m20:06:26.878525 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m20:06:26.894196 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m20:06:26.898511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207501476A0>]}
[0m20:06:26.898511 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m20:06:26.898511 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m20:06:26.898511 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:06:26.898511 [info ] [Thread-1  ]: 2 of 8 START sql table model public_staging.stg_activity_types ................. [RUN]
[0m20:06:26.898511 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m20:06:26.898511 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:06:26.898511 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:06:26.898511 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:06:26.929424 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:06:26.929424 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:26.929424 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:06:26.929424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:26.955935 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:06:26.956568 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:26.957131 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m20:06:26.960998 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m20:06:27.000493 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:27.001387 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m20:06:27.003474 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:27.005388 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:27.006390 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:06:27.007700 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:06:27.012368 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:06:27.012368 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:27.012368 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:06:27.012368 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:06:27.012368 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m20:06:27.012368 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:06:27.012368 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m20:06:27.028417 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m20:06:27.029005 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:06:27.029005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074D462550>]}
[0m20:06:27.029005 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public_staging.stg_activity_types ............ [[32mSELECT 4[0m in 0.13s]
[0m20:06:27.029005 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:06:27.029005 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:06:27.029005 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public_staging.stg_deal_changes ............. [RUN]
[0m20:06:27.029005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:06:27.029005 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:06:27.029005 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.029005 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:06:27.068598 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.068598 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp200627066459"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m20:06:27.068598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:27.098286 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.027 seconds
[0m20:06:27.113566 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.113566 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:06:27.116629 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:06:27.118023 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.118023 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp200627066459'
        
      order by ordinal_position

  
[0m20:06:27.124536 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.006 seconds
[0m20:06:27.129684 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.130675 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:06:27.134587 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m20:06:27.140660 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.141675 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m20:06:27.144667 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m20:06:27.144667 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.160564 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.161572 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp200627066459"
            where (
                
                    "stg_deal_changes__dbt_tmp200627066459".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp200627066459".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp200627066459".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp200627066459"
    )
  
[0m20:06:27.161572 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m20:06:27.161572 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:06:27.161572 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:27.161572 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:06:27.161572 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:06:27.161572 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:06:27.161572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074D462550>]}
[0m20:06:27.161572 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public_staging.stg_deal_changes ........ [[32mINSERT 0 0[0m in 0.13s]
[0m20:06:27.161572 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:06:27.161572 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:06:27.161572 [info ] [Thread-1  ]: 4 of 8 START sql table model public_staging.stg_stages ......................... [RUN]
[0m20:06:27.161572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_stages)
[0m20:06:27.161572 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:06:27.177831 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:06:27.177831 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:06:27.177831 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:06:27.177831 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:27.177831 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:06:27.177831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:27.206266 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:06:27.206777 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:27.207610 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:06:27.211084 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m20:06:27.216273 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:27.216775 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m20:06:27.218805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:27.218805 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:27.218805 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m20:06:27.218805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:06:27.218805 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:06:27.218805 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:27.218805 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:06:27.229302 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:06:27.229302 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m20:06:27.229302 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:06:27.229302 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m20:06:27.229302 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:06:27.229302 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:06:27.229302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074FCADF10>]}
[0m20:06:27.229302 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public_staging.stg_stages .................... [[32mSELECT 9[0m in 0.07s]
[0m20:06:27.229302 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:06:27.229302 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:06:27.229302 [info ] [Thread-1  ]: 5 of 8 START sql view model public_crm.t_activities ............................ [RUN]
[0m20:06:27.244772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.t_activities)
[0m20:06:27.245476 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:06:27.245476 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:06:27.245476 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:06:27.245476 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:06:27.245476 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:27.245476 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:06:27.245476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:27.267697 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:06:27.275923 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:27.276741 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:06:27.281092 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:06:27.284670 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:27.285165 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:06:27.286727 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:06:27.286727 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:06:27.286727 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:27.286727 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:06:27.294064 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:06:27.297914 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:06:27.297914 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:06:27.297914 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:06:27.297914 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:06:27.297914 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:06:27.297914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074FCADF10>]}
[0m20:06:27.297914 [info ] [Thread-1  ]: 5 of 8 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.05s]
[0m20:06:27.297914 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:06:27.297914 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m20:06:27.297914 [info ] [Thread-1  ]: 6 of 8 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m20:06:27.297914 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_user_deal_events)
[0m20:06:27.297914 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m20:06:27.310753 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.312805 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m20:06:27.318487 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.318593 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.318593 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m20:06:27.318593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:27.335385 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:06:27.341154 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.341555 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m20:06:27.344306 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:06:27.347720 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.347720 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events" rename to "t_user_deal_events__dbt_backup"
[0m20:06:27.347720 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:27.347720 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.347720 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m20:06:27.347720 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:27.347720 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:06:27.347720 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.347720 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:06:27.362065 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:27.362065 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m20:06:27.362065 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:06:27.362065 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m20:06:27.362065 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m20:06:27.362065 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m20:06:27.362065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074FCADF10>]}
[0m20:06:27.362065 [info ] [Thread-1  ]: 6 of 8 OK created sql view model public_crm.t_user_deal_events ................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:06:27.377818 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m20:06:27.378900 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:27.378900 [info ] [Thread-1  ]: 7 of 8 START sql view model public_crm.t_deal_funnel_events .................... [RUN]
[0m20:06:27.380920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_deal_funnel_events)
[0m20:06:27.380920 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:27.383901 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:27.384902 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:27.388902 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:27.389901 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:27.389901 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m20:06:27.390912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:27.399593 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:06:27.411080 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:27.412321 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM "postgres"."public_crm"."t_activities"
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN "postgres"."public_staging"."stg_stages" s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m20:06:27.417483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:06:27.420909 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:27.421401 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m20:06:27.421899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:27.421899 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:06:27.421899 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:27.421899 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:06:27.429566 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:27.429566 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m20:06:27.429566 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:06:27.429566 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m20:06:27.429566 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:06:27.429566 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m20:06:27.429566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002075023AFA0>]}
[0m20:06:27.429566 [info ] [Thread-1  ]: 7 of 8 OK created sql view model public_crm.t_deal_funnel_events ............... [[32mCREATE VIEW[0m in 0.05s]
[0m20:06:27.429566 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:06:27.429566 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:06:27.444368 [info ] [Thread-1  ]: 8 of 8 START sql view model public_crm.t_sales_funnel_monthly_columns .......... [RUN]
[0m20:06:27.445701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_sales_funnel_monthly_columns)
[0m20:06:27.445701 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:06:27.445701 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:06:27.445701 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:06:27.445701 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:06:27.445701 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:06:27.445701 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: BEGIN
[0m20:06:27.445701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:06:27.477242 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:06:27.478308 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:06:27.479307 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,avg_users_per_deal
  ,conversion_rate -- ignoring [optional] steps
FROM funnel_with_conversion_rate
-- ORDER BY month, stage_id
  );
[0m20:06:27.486805 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:06:27.488805 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:06:27.488805 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp" rename to "t_sales_funnel_monthly_columns"
[0m20:06:27.488805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:06:27.494594 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m20:06:27.494594 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:06:27.495968 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m20:06:27.495968 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:06:27.495968 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup"
[0m20:06:27.495968 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:06:27.495968 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup" cascade
[0m20:06:27.495968 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:06:27.495968 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: Close
[0m20:06:27.508756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c052f6c8-80d0-45fb-ac12-673a833a216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074C89CDF0>]}
[0m20:06:27.508756 [info ] [Thread-1  ]: 8 of 8 OK created sql view model public_crm.t_sales_funnel_monthly_columns ..... [[32mCREATE VIEW[0m in 0.05s]
[0m20:06:27.511266 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:06:27.512290 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:27.512290 [debug] [MainThread]: On master: BEGIN
[0m20:06:27.512290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:27.533987 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m20:06:27.544418 [debug] [MainThread]: On master: COMMIT
[0m20:06:27.544931 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:27.545821 [debug] [MainThread]: On master: COMMIT
[0m20:06:27.548465 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:06:27.548465 [debug] [MainThread]: On master: Close
[0m20:06:27.549431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:27.549965 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:06:27.549965 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:06:27.550429 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' was properly closed.
[0m20:06:27.550928 [info ] [MainThread]: 
[0m20:06:27.551927 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 5 view models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m20:06:27.554065 [debug] [MainThread]: Command end result
[0m20:06:27.577753 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:06:27.579178 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:06:27.579178 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:06:27.579178 [info ] [MainThread]: 
[0m20:06:27.579178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:27.589336 [info ] [MainThread]: 
[0m20:06:27.590332 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:06:27.591345 [debug] [MainThread]: Command `dbt run` succeeded at 20:06:27.591345 after 1.93 seconds
[0m20:06:27.592332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074D525FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074D17BAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002075012DE50>]}
[0m20:06:27.592332 [debug] [MainThread]: Flushing usage events
[0m20:06:28.777968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:29.123693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCD722070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCF694700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCF6947C0>]}


============================== 20:11:29.123693 | 12873b4d-3bc5-4df0-b525-5e629ee284d0 ==============================
[0m20:11:29.123693 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:11:29.123693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s t_sales_funnel_monthly_rows', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:11:29.294448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12873b4d-3bc5-4df0-b525-5e629ee284d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCF6723D0>]}
[0m20:11:29.326572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12873b4d-3bc5-4df0-b525-5e629ee284d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCF4EB7F0>]}
[0m20:11:29.342294 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:11:29.524297 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:11:29.682659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:11:29.682659 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\marts\crm\crm.yml
[0m20:11:29.760676 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'rep_sales_funnel_monthly' in the 'models' section of file 'models\marts\crm\crm.yml'
[0m20:11:29.876967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12873b4d-3bc5-4df0-b525-5e629ee284d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCFEAB130>]}
[0m20:11:29.961521 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:11:29.961521 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:11:29.977229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12873b4d-3bc5-4df0-b525-5e629ee284d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCFD8AA90>]}
[0m20:11:29.977229 [info ] [MainThread]: Found 12 models, 2 snapshots, 6 sources, 428 macros
[0m20:11:29.977229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12873b4d-3bc5-4df0-b525-5e629ee284d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCFD67460>]}
[0m20:11:29.977229 [info ] [MainThread]: 
[0m20:11:29.977229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:11:29.977229 [info ] [MainThread]: 
[0m20:11:29.977229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:11:29.977229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:11:30.077227 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:11:30.077227 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:11:30.077227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:30.096791 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.027 seconds
[0m20:11:30.096791 [debug] [ThreadPool]: On list_postgres: Close
[0m20:11:30.112520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m20:11:30.112520 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:11:30.112520 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:11:30.112520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:30.128060 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:11:30.142632 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:11:30.142957 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:11:30.147861 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:11:30.148868 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:11:30.150861 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:11:30.151358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m20:11:30.153445 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:11:30.153445 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:11:30.153445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:30.170032 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m20:11:30.173501 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:11:30.174010 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:11:30.174010 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:11:30.174010 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:11:30.174010 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:11:30.174010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m20:11:30.174010 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:11:30.187619 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:11:30.188169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:30.194282 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:11:30.209227 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:11:30.209645 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:11:30.214156 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m20:11:30.215730 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:11:30.217355 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:11:30.220277 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.220277 [debug] [MainThread]: On master: BEGIN
[0m20:11:30.220277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:30.240672 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m20:11:30.243903 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.244423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:11:30.250252 [debug] [MainThread]: SQL status: SELECT 11 in 0.005 seconds
[0m20:11:30.253358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12873b4d-3bc5-4df0-b525-5e629ee284d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCFFB0760>]}
[0m20:11:30.253960 [debug] [MainThread]: On master: ROLLBACK
[0m20:11:30.255445 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.255445 [debug] [MainThread]: On master: BEGIN
[0m20:11:30.259583 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:11:30.260135 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.260428 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.260804 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.262909 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:11:30.263497 [debug] [MainThread]: On master: Close
[0m20:11:30.271980 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:11:30.272407 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_sales_funnel_monthly_rows ............. [RUN]
[0m20:11:30.272407 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows'
[0m20:11:30.272407 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:11:30.272407 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:11:30.272407 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:11:30.344778 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:11:30.344778 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:11:30.344778 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m20:11:30.344778 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:11:30.361341 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m20:11:30.377852 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:11:30.378064 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m20:11:30.385633 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m20:11:30.388028 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:11:30.388028 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp" rename to "t_sales_funnel_monthly_rows"
[0m20:11:30.392761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:11:30.403792 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:11:30.403792 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:11:30.403792 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:11:30.420008 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m20:11:30.420008 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup"
[0m20:11:30.420008 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:11:30.420008 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup" cascade
[0m20:11:30.420008 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:11:30.420008 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m20:11:30.435804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12873b4d-3bc5-4df0-b525-5e629ee284d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD0316880>]}
[0m20:11:30.436557 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_crm.t_sales_funnel_monthly_rows ........ [[32mCREATE VIEW[0m in 0.15s]
[0m20:11:30.437057 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:11:30.439833 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.439833 [debug] [MainThread]: On master: BEGIN
[0m20:11:30.439833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:30.475610 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m20:11:30.476155 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.476653 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.477656 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.479338 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:11:30.479670 [debug] [MainThread]: On master: Close
[0m20:11:30.480246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:30.480659 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:11:30.481156 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m20:11:30.481657 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' was properly closed.
[0m20:11:30.481657 [info ] [MainThread]: 
[0m20:11:30.482658 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m20:11:30.483655 [debug] [MainThread]: Command end result
[0m20:11:30.495007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:11:30.511456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:11:30.517145 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:11:30.517145 [info ] [MainThread]: 
[0m20:11:30.517145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:30.517145 [info ] [MainThread]: 
[0m20:11:30.517145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:11:30.517145 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:30.517145 after 1.44 seconds
[0m20:11:30.517145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCD722070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCF0D6FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCF65F280>]}
[0m20:11:30.517145 [debug] [MainThread]: Flushing usage events
[0m20:11:31.196068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:00.878754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F8EF0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FAE64760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FAE64820>]}


============================== 20:37:00.878754 | fbe961e6-50bf-4dc1-a75c-3dd887cf47e4 ==============================
[0m20:37:00.878754 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:37:00.878754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s t_deal_lost_reasons', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:37:01.028524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FAE441F0>]}
[0m20:37:01.076357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F825F0A0>]}
[0m20:37:01.076357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:37:01.258079 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:37:01.353482 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:37:01.353482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FA8E5520>]}
[0m20:37:02.528734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FC926130>]}
[0m20:37:02.610724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:37:02.610724 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:37:02.640164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FC8C1F40>]}
[0m20:37:02.641061 [info ] [MainThread]: Found 14 models, 2 snapshots, 6 sources, 428 macros
[0m20:37:02.642127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FB5F2B80>]}
[0m20:37:02.643227 [info ] [MainThread]: 
[0m20:37:02.643772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:02.643772 [info ] [MainThread]: 
[0m20:37:02.643772 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:37:02.643772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:37:02.712040 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:37:02.712040 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:37:02.712040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:02.757258 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.031 seconds
[0m20:37:02.758253 [debug] [ThreadPool]: On list_postgres: Close
[0m20:37:02.761379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m20:37:02.761379 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:37:02.761379 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:37:02.761379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:02.790312 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:37:02.791031 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:37:02.792031 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:37:02.796635 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m20:37:02.798036 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:37:02.800085 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:37:02.800638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m20:37:02.801529 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:37:02.801529 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:37:02.801529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:02.817214 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:37:02.826724 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:37:02.827234 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:37:02.831746 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:37:02.833229 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:37:02.834733 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:37:02.835871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m20:37:02.838235 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:37:02.838235 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:37:02.838235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:02.868587 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m20:37:02.872482 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:37:02.872788 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:37:02.872788 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:37:02.872788 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:37:02.872788 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:37:02.872788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_marts_crm)
[0m20:37:02.872788 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:37:02.872788 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m20:37:02.872788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:02.905464 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:37:02.906244 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:37:02.906742 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m20:37:02.911188 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:37:02.912280 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m20:37:02.913689 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m20:37:02.917189 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:02.917189 [debug] [MainThread]: On master: BEGIN
[0m20:37:02.917189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:02.933196 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m20:37:02.949899 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:02.950148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:37:02.955460 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m20:37:02.958429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225FACBB040>]}
[0m20:37:02.958970 [debug] [MainThread]: On master: ROLLBACK
[0m20:37:02.960574 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:02.960574 [debug] [MainThread]: On master: BEGIN
[0m20:37:02.960574 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:37:02.965234 [debug] [MainThread]: On master: COMMIT
[0m20:37:02.965748 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:02.966171 [debug] [MainThread]: On master: COMMIT
[0m20:37:02.967709 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:37:02.968260 [debug] [MainThread]: On master: Close
[0m20:37:02.973184 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:37:02.973184 [info ] [Thread-1  ]: 1 of 1 START sql view model public_crm.t_deal_lost_reasons ..................... [RUN]
[0m20:37:02.974878 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.t_deal_lost_reasons'
[0m20:37:02.974878 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:37:02.983272 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:37:02.985799 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:37:03.016517 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:37:03.018413 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:37:03.018413 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m20:37:03.018413 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:37:03.060622 [debug] [Thread-1  ]: SQL status: BEGIN in 0.041 seconds
[0m20:37:03.061499 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:37:03.062021 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m20:37:03.066985 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:37:03.072087 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:37:03.072087 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m20:37:03.072087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:37:03.129247 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m20:37:03.129247 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:37:03.130256 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m20:37:03.134162 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:37:03.141245 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m20:37:03.143742 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:37:03.143742 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m20:37:03.143742 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:37:03.143742 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m20:37:03.143742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbe961e6-50bf-4dc1-a75c-3dd887cf47e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F7786520>]}
[0m20:37:03.143742 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_crm.t_deal_lost_reasons ................ [[32mCREATE VIEW[0m in 0.17s]
[0m20:37:03.143742 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:37:03.143742 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:03.143742 [debug] [MainThread]: On master: BEGIN
[0m20:37:03.143742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:03.166070 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:37:03.176825 [debug] [MainThread]: On master: COMMIT
[0m20:37:03.177198 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:03.177837 [debug] [MainThread]: On master: COMMIT
[0m20:37:03.180266 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:37:03.180766 [debug] [MainThread]: On master: Close
[0m20:37:03.181264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:03.181765 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:37:03.182265 [debug] [MainThread]: Connection 'list_postgres_public_marts_crm' was properly closed.
[0m20:37:03.182265 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_deal_lost_reasons' was properly closed.
[0m20:37:03.182766 [info ] [MainThread]: 
[0m20:37:03.183768 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m20:37:03.184983 [debug] [MainThread]: Command end result
[0m20:37:03.212189 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:37:03.212189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:37:03.212189 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:37:03.212189 [info ] [MainThread]: 
[0m20:37:03.212189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:37:03.212189 [info ] [MainThread]: 
[0m20:37:03.212189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:37:03.212189 [debug] [MainThread]: Command `dbt run` succeeded at 20:37:03.212189 after 2.39 seconds
[0m20:37:03.227041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F8EF0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F8DB2DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F81F7C40>]}
[0m20:37:03.227041 [debug] [MainThread]: Flushing usage events
[0m20:37:03.725160 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:32.763980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E500EA0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E502E06790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E502E06850>]}


============================== 20:40:32.763980 | 6c49827d-1e96-42c5-b586-06b35685bd7b ==============================
[0m20:40:32.763980 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:40:32.763980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:40:32.912845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E57F751BE0>]}
[0m20:40:32.963327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5031B6250>]}
[0m20:40:32.963327 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:40:33.127437 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:40:33.302793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:40:33.302793 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\marts\crm\crm.yml
[0m20:40:33.302793 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformations\crm\crm.yml
[0m20:40:33.614097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503908130>]}
[0m20:40:33.707834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:40:33.707834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:40:33.754862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5038D1190>]}
[0m20:40:33.754862 [info ] [MainThread]: Found 14 models, 2 snapshots, 6 sources, 428 macros
[0m20:40:33.754862 [info ] [MainThread]: 
[0m20:40:33.754862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:33.754862 [info ] [MainThread]: 
[0m20:40:33.770982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:33.776746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:40:33.866130 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:40:33.866130 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:40:33.866130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:33.898687 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.032 seconds
[0m20:40:33.914324 [debug] [ThreadPool]: On list_postgres: Close
[0m20:40:33.914324 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:40:33.914324 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:40:33.914324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:33.945609 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.027 seconds
[0m20:40:33.945609 [debug] [ThreadPool]: On list_postgres: Close
[0m20:40:33.949109 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:40:33.949109 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:40:33.949109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:33.980459 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.030 seconds
[0m20:40:33.980459 [debug] [ThreadPool]: On list_postgres: Close
[0m20:40:33.980459 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:40:33.980459 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:40:33.980459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.012286 [debug] [ThreadPool]: SQL status: SELECT 39 in 0.027 seconds
[0m20:40:34.012286 [debug] [ThreadPool]: On list_postgres: Close
[0m20:40:34.012286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m20:40:34.012286 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m20:40:34.012286 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:40:34.012286 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m20:40:34.012286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.043652 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:40:34.044649 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:40:34.045141 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m20:40:34.047635 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:40:34.048634 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:40:34.048634 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:40:34.049134 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:40:34.054636 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m20:40:34.054636 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m20:40:34.054636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_staging, now create_postgres_public_crm)
[0m20:40:34.054636 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_crm"
"
[0m20:40:34.054636 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:40:34.054636 [debug] [ThreadPool]: On create_postgres_public_crm: BEGIN
[0m20:40:34.054636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.087084 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m20:40:34.088052 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:40:34.088052 [debug] [ThreadPool]: On create_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_crm"} */
create schema if not exists "public_crm"
[0m20:40:34.091059 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:40:34.091552 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:40:34.092052 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:40:34.092052 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:40:34.096554 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m20:40:34.097053 [debug] [ThreadPool]: On create_postgres_public_crm: Close
[0m20:40:34.098053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_crm, now create_postgres_public_marts_crm)
[0m20:40:34.098801 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_marts_crm"
"
[0m20:40:34.098996 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:40:34.098996 [debug] [ThreadPool]: On create_postgres_public_marts_crm: BEGIN
[0m20:40:34.098996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.130781 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m20:40:34.132891 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:40:34.132891 [debug] [ThreadPool]: On create_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_marts_crm"} */
create schema if not exists "public_marts_crm"
[0m20:40:34.135309 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:40:34.135803 [debug] [ThreadPool]: On create_postgres_public_marts_crm: COMMIT
[0m20:40:34.136302 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:40:34.136302 [debug] [ThreadPool]: On create_postgres_public_marts_crm: COMMIT
[0m20:40:34.141234 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m20:40:34.141234 [debug] [ThreadPool]: On create_postgres_public_marts_crm: Close
[0m20:40:34.142414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_marts_crm, now create_postgres_public)
[0m20:40:34.142920 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public"
"
[0m20:40:34.142920 [debug] [ThreadPool]: Using postgres connection "create_postgres_public"
[0m20:40:34.142920 [debug] [ThreadPool]: On create_postgres_public: BEGIN
[0m20:40:34.142920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.149069 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m20:40:34.164938 [debug] [ThreadPool]: Using postgres connection "create_postgres_public"
[0m20:40:34.165447 [debug] [ThreadPool]: On create_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public"} */
create schema if not exists "public"
[0m20:40:34.168093 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:40:34.169250 [debug] [ThreadPool]: On create_postgres_public: COMMIT
[0m20:40:34.170022 [debug] [ThreadPool]: Using postgres connection "create_postgres_public"
[0m20:40:34.170022 [debug] [ThreadPool]: On create_postgres_public: COMMIT
[0m20:40:34.174077 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m20:40:34.174630 [debug] [ThreadPool]: On create_postgres_public: Close
[0m20:40:34.176454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m20:40:34.180466 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:40:34.180466 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:40:34.180466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:34.197034 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:40:34.206051 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:40:34.206629 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:40:34.207583 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:40:34.207583 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:40:34.207583 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:40:34.207583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m20:40:34.207583 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:40:34.207583 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:40:34.207583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.238816 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:40:34.239553 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:40:34.239855 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:40:34.244361 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:40:34.245580 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:40:34.247266 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:40:34.248447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_marts_crm)
[0m20:40:34.250558 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:40:34.250558 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m20:40:34.250558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.268844 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m20:40:34.282250 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:40:34.282879 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m20:40:34.287735 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m20:40:34.289454 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m20:40:34.290725 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m20:40:34.291397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts_crm, now list_postgres_public)
[0m20:40:34.293037 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:40:34.293037 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:40:34.293037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.298697 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:40:34.314765 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:40:34.315789 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:34.324789 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m20:40:34.325875 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:40:34.325875 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:40:34.328972 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:34.328972 [debug] [MainThread]: On master: BEGIN
[0m20:40:34.328972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:34.349184 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m20:40:34.360129 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:34.361158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:34.365635 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:40:34.366639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503BAF670>]}
[0m20:40:34.367138 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:34.368638 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:34.369136 [debug] [MainThread]: On master: BEGIN
[0m20:40:34.371084 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:40:34.373056 [debug] [MainThread]: On master: COMMIT
[0m20:40:34.373566 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:34.374108 [debug] [MainThread]: On master: COMMIT
[0m20:40:34.375773 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:40:34.376281 [debug] [MainThread]: On master: Close
[0m20:40:34.380591 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m20:40:34.381163 [info ] [Thread-1  ]: 1 of 16 START sql view model public.calendar_ .................................. [RUN]
[0m20:40:34.382910 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m20:40:34.382910 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m20:40:34.384771 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m20:40:34.384771 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m20:40:34.425215 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m20:40:34.426213 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:40:34.427123 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m20:40:34.427123 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:40:34.465809 [debug] [Thread-1  ]: SQL status: BEGIN in 0.038 seconds
[0m20:40:34.467285 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:40:34.467765 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m20:40:34.471767 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:40:34.477823 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:40:34.477823 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m20:40:34.477823 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:40:34.477823 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:40:34.477823 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:40:34.493542 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:40:34.493542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:40:34.493542 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m20:40:34.509346 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:40:34.509346 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m20:40:34.509346 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:40:34.509346 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m20:40:34.509346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E504E867F0>]}
[0m20:40:34.509346 [info ] [Thread-1  ]: 1 of 16 OK created sql view model public.calendar_ ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m20:40:34.509346 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m20:40:34.509346 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:40:34.509346 [info ] [Thread-1  ]: 2 of 16 START sql table model public_marts_crm.rep_sales_funnel_monthly ........ [RUN]
[0m20:40:34.509346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m20:40:34.509346 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:40:34.509346 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:40:34.524985 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:40:34.548687 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:40:34.552009 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:40:34.552516 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m20:40:34.552516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.578069 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m20:40:34.578851 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:40:34.578917 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    SELECT
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,funnel_kpi
  ,COALESCE(CASE WHEN funnel_kpi IN ('avg_users_per_deal','conversion_rate')
     THEN ROUND(kpi_value::numeric, 2)
     ELSE kpi_value
   END,0) AS kpi_value
FROM public_crm.t_sales_funnel_monthly_rows
-- ORDER BY 
--    month 
--   ,stage_id
--   ,funnel_kpi
  );
  
[0m20:40:34.581339 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_crm.t_sales_funnel_monthly_rows" does not exist
LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
              ^

[0m20:40:34.581994 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: ROLLBACK
[0m20:40:34.584838 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m20:40:34.588334 [debug] [Thread-1  ]: Database Error in model rep_sales_funnel_monthly (models\marts\crm\rep_sales_funnel_monthly.sql)
  relation "public_crm.t_sales_funnel_monthly_rows" does not exist
  LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly.sql
[0m20:40:34.589335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E504EC4CD0>]}
[0m20:40:34.590335 [error] [Thread-1  ]: 2 of 16 ERROR creating sql table model public_marts_crm.rep_sales_funnel_monthly  [[31mERROR[0m in 0.08s]
[0m20:40:34.591338 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:40:34.591338 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:40:34.592422 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly' to be skipped because of status 'error'.  Reason: Database Error in model rep_sales_funnel_monthly (models\marts\crm\rep_sales_funnel_monthly.sql)
  relation "public_crm.t_sales_funnel_monthly_rows" does not exist
  LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly.sql.
[0m20:40:34.592422 [info ] [Thread-1  ]: 3 of 16 START sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [RUN]
[0m20:40:34.592422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly, now model.enpal_assessment_project.rep_sales_funnel_monthly_columns)
[0m20:40:34.593840 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:40:34.595834 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:40:34.596781 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:40:34.602215 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:40:34.603218 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:40:34.604215 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: BEGIN
[0m20:40:34.604215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.632048 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m20:40:34.632955 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:40:34.633778 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_tmp"
  
  
    as
  
  (
    SELECT 
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,COALESCE(deals_count, 0) AS deals_count
  ,COALESCE(ROUND(avg_users_per_deal::numeric, 2), 0) AS avg_users_per_deal
  ,COALESCE(ROUND(conversion_rate::numeric, 2), 0) AS converstion_rate
FROM public_crm.t_sales_funnel_monthly_columns
-- ORDER BY 
--    month 
--   ,stage_id
  );
  
[0m20:40:34.636650 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_crm.t_sales_funnel_monthly_columns" does not exist
LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
              ^

[0m20:40:34.637767 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: ROLLBACK
[0m20:40:34.640314 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: Close
[0m20:40:34.641770 [debug] [Thread-1  ]: Database Error in model rep_sales_funnel_monthly_columns (models\marts\crm\rep_sales_funnel_monthly_columns.sql)
  relation "public_crm.t_sales_funnel_monthly_columns" does not exist
  LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly_columns.sql
[0m20:40:34.642770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E502256DF0>]}
[0m20:40:34.643268 [error] [Thread-1  ]: 3 of 16 ERROR creating sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [[31mERROR[0m in 0.05s]
[0m20:40:34.644768 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:40:34.645364 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:40:34.646285 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly_columns' to be skipped because of status 'error'.  Reason: Database Error in model rep_sales_funnel_monthly_columns (models\marts\crm\rep_sales_funnel_monthly_columns.sql)
  relation "public_crm.t_sales_funnel_monthly_columns" does not exist
  LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly_columns.sql.
[0m20:40:34.645828 [info ] [Thread-1  ]: 4 of 16 START sql table model public_staging.stg_activity_types ................ [RUN]
[0m20:40:34.647313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly_columns, now model.enpal_assessment_project.stg_activity_types)
[0m20:40:34.647770 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:40:34.651244 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:40:34.651244 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:40:34.651244 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:40:34.651244 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:40:34.651244 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:40:34.651244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.682055 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m20:40:34.682795 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:40:34.684298 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m20:40:34.687006 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.activity_types" does not exist
LINE 17: FROM "postgres"."public"."activity_types"
              ^

[0m20:40:34.687916 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: ROLLBACK
[0m20:40:34.690424 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:40:34.691956 [debug] [Thread-1  ]: Database Error in model stg_activity_types (models\staging\pipedrive\stg_activity_types.sql)
  relation "public.activity_types" does not exist
  LINE 17: FROM "postgres"."public"."activity_types"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_activity_types.sql
[0m20:40:34.693019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E502256DF0>]}
[0m20:40:34.693418 [error] [Thread-1  ]: 4 of 16 ERROR creating sql table model public_staging.stg_activity_types ....... [[31mERROR[0m in 0.05s]
[0m20:40:34.694926 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:40:34.695417 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:40:34.696916 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.stg_activity_types' to be skipped because of status 'error'.  Reason: Database Error in model stg_activity_types (models\staging\pipedrive\stg_activity_types.sql)
  relation "public.activity_types" does not exist
  LINE 17: FROM "postgres"."public"."activity_types"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_activity_types.sql.
[0m20:40:34.696416 [info ] [Thread-1  ]: 5 of 16 START sql incremental model public_staging.stg_deal_changes ............ [RUN]
[0m20:40:34.697921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:40:34.697921 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:40:34.705797 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:40:34.706850 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:40:34.738641 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:40:34.738641 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:40:34.738641 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:40:34.738641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.751188 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:40:34.763756 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:40:34.764866 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_staging"."stg_deal_changes"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  );
  
  
[0m20:40:34.767603 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.deal_changes" does not exist
LINE 18: FROM "postgres"."public"."deal_changes"
              ^

[0m20:40:34.768259 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: ROLLBACK
[0m20:40:34.769934 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:40:34.772975 [debug] [Thread-1  ]: Database Error in model stg_deal_changes (models\staging\pipedrive\stg_deal_changes.sql)
  relation "public.deal_changes" does not exist
  LINE 18: FROM "postgres"."public"."deal_changes"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_deal_changes.sql
[0m20:40:34.773457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E504EC4CD0>]}
[0m20:40:34.774449 [error] [Thread-1  ]: 5 of 16 ERROR creating sql incremental model public_staging.stg_deal_changes ... [[31mERROR[0m in 0.08s]
[0m20:40:34.776012 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:40:34.776012 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m20:40:34.777206 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.stg_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_changes (models\staging\pipedrive\stg_deal_changes.sql)
  relation "public.deal_changes" does not exist
  LINE 18: FROM "postgres"."public"."deal_changes"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_deal_changes.sql.
[0m20:40:34.776646 [info ] [Thread-1  ]: 6 of 16 START sql table model public_staging.stg_fields ........................ [RUN]
[0m20:40:34.778260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m20:40:34.778935 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m20:40:34.779445 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m20:40:34.782624 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m20:40:34.788518 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m20:40:34.788518 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:40:34.788518 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m20:40:34.788518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.800252 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:40:34.811988 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:40:34.812637 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m20:40:34.814987 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.fields" does not exist
LINE 18: FROM "postgres"."public"."fields" 
              ^

[0m20:40:34.816039 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: ROLLBACK
[0m20:40:34.818420 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m20:40:34.820748 [debug] [Thread-1  ]: Database Error in model stg_fields (models\staging\pipedrive\stg_fields.sql)
  relation "public.fields" does not exist
  LINE 18: FROM "postgres"."public"."fields" 
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_fields.sql
[0m20:40:34.821747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5034D6F40>]}
[0m20:40:34.822246 [error] [Thread-1  ]: 6 of 16 ERROR creating sql table model public_staging.stg_fields ............... [[31mERROR[0m in 0.04s]
[0m20:40:34.823746 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m20:40:34.823746 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:40:34.825262 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.stg_fields' to be skipped because of status 'error'.  Reason: Database Error in model stg_fields (models\staging\pipedrive\stg_fields.sql)
  relation "public.fields" does not exist
  LINE 18: FROM "postgres"."public"."fields" 
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_fields.sql.
[0m20:40:34.824333 [info ] [Thread-1  ]: 7 of 16 START sql table model public_staging.stg_stages ........................ [RUN]
[0m20:40:34.825749 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m20:40:34.826332 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:40:34.827430 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:40:34.827430 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:40:34.835963 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:40:34.836974 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:40:34.837913 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:40:34.837913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.867683 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m20:40:34.868687 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:40:34.869687 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:40:34.871682 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.stages" does not exist
LINE 13: FROM "postgres"."public"."stages"
              ^

[0m20:40:34.872682 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: ROLLBACK
[0m20:40:34.875186 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:40:34.876682 [debug] [Thread-1  ]: Database Error in model stg_stages (models\staging\pipedrive\stg_stages.sql)
  relation "public.stages" does not exist
  LINE 13: FROM "postgres"."public"."stages"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_stages.sql
[0m20:40:34.877182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5034D6F40>]}
[0m20:40:34.878286 [error] [Thread-1  ]: 7 of 16 ERROR creating sql table model public_staging.stg_stages ............... [[31mERROR[0m in 0.05s]
[0m20:40:34.879187 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:40:34.879688 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m20:40:34.881185 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.stg_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_stages (models\staging\pipedrive\stg_stages.sql)
  relation "public.stages" does not exist
  LINE 13: FROM "postgres"."public"."stages"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_stages.sql.
[0m20:40:34.880187 [info ] [Thread-1  ]: 8 of 16 START sql view model public.test_model ................................. [RUN]
[0m20:40:34.882192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.test_model)
[0m20:40:34.882965 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m20:40:34.883495 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m20:40:34.883495 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m20:40:34.883495 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m20:40:34.883495 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:40:34.883495 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m20:40:34.883495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.916529 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:40:34.917719 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:40:34.918476 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  create view "postgres"."public"."test_model__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m20:40:34.921469 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.activity" does not exist
LINE 8: FROM "postgres"."public"."activity"
             ^

[0m20:40:34.922026 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: ROLLBACK
[0m20:40:34.923969 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m20:40:34.925664 [debug] [Thread-1  ]: Database Error in model test_model (models\test_model.sql)
  relation "public.activity" does not exist
  LINE 8: FROM "postgres"."public"."activity"
               ^
  compiled code at target\run\enpal_assessment_project\models\test_model.sql
[0m20:40:34.926807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E504F69B20>]}
[0m20:40:34.927331 [error] [Thread-1  ]: 8 of 16 ERROR creating sql view model public.test_model ........................ [[31mERROR[0m in 0.04s]
[0m20:40:34.929108 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m20:40:34.929656 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:40:34.930362 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.test_model' to be skipped because of status 'error'.  Reason: Database Error in model test_model (models\test_model.sql)
  relation "public.activity" does not exist
  LINE 8: FROM "postgres"."public"."activity"
               ^
  compiled code at target\run\enpal_assessment_project\models\test_model.sql.
[0m20:40:34.929729 [info ] [Thread-1  ]: 9 of 16 START snapshot public_staging.sn_activities ............................ [RUN]
[0m20:40:34.931999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now snapshot.enpal_assessment_project.sn_activities)
[0m20:40:34.931999 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:40:34.934038 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:40:34.984521 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:40:34.984521 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:40:34.984521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:35.016996 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.activity" does not exist
LINE 25: FROM "postgres"."public"."activity"
              ^

[0m20:40:35.018284 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:40:35.020769 [debug] [Thread-1  ]: Database Error in snapshot sn_activities (snapshots\sn_activities.sql)
  relation "public.activity" does not exist
  LINE 25: FROM "postgres"."public"."activity"
                ^
[0m20:40:35.021848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503891B80>]}
[0m20:40:35.022972 [error] [Thread-1  ]: 9 of 16 ERROR snapshotting public_staging.sn_activities ........................ [[31mERROR[0m in 0.09s]
[0m20:40:35.024468 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:40:35.024468 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m20:40:35.025468 [debug] [Thread-4  ]: Marking all children of 'snapshot.enpal_assessment_project.sn_activities' to be skipped because of status 'error'.  Reason: Database Error in snapshot sn_activities (snapshots\sn_activities.sql)
  relation "public.activity" does not exist
  LINE 25: FROM "postgres"."public"."activity"
                ^.
[0m20:40:35.024968 [info ] [Thread-1  ]: 10 of 16 START snapshot public_staging.sn_users ................................ [RUN]
[0m20:40:35.026475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m20:40:35.027248 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m20:40:35.030682 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m20:40:35.037424 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:40:35.037424 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:40:35.037424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:35.065688 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.users" does not exist
LINE 23: FROM "postgres"."public"."users"
              ^

[0m20:40:35.066731 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m20:40:35.069781 [debug] [Thread-1  ]: Database Error in snapshot sn_users (snapshots\sn_users.sql)
  relation "public.users" does not exist
  LINE 23: FROM "postgres"."public"."users"
                ^
[0m20:40:35.070773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c49827d-1e96-42c5-b586-06b35685bd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E503693940>]}
[0m20:40:35.072277 [error] [Thread-1  ]: 10 of 16 ERROR snapshotting public_staging.sn_users ............................ [[31mERROR[0m in 0.04s]
[0m20:40:35.073287 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m20:40:35.074317 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m20:40:35.075280 [debug] [Thread-4  ]: Marking all children of 'snapshot.enpal_assessment_project.sn_users' to be skipped because of status 'error'.  Reason: Database Error in snapshot sn_users (snapshots\sn_users.sql)
  relation "public.users" does not exist
  LINE 23: FROM "postgres"."public"."users"
                ^.
[0m20:40:35.074317 [info ] [Thread-1  ]: 11 of 16 SKIP relation public_crm.t_user_deal_events ........................... [[33mSKIP[0m]
[0m20:40:35.075866 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m20:40:35.076370 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:40:35.076895 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_user_deal_events' to be skipped because of status 'skipped'. 
[0m20:40:35.076895 [info ] [Thread-1  ]: 12 of 16 SKIP relation public_crm.t_deal_lost_reasons .......................... [[33mSKIP[0m]
[0m20:40:35.077783 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:40:35.078941 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:40:35.078941 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_lost_reasons' to be skipped because of status 'skipped'. 
[0m20:40:35.078941 [info ] [Thread-1  ]: 13 of 16 SKIP relation public_crm.t_activities ................................. [[33mSKIP[0m]
[0m20:40:35.079952 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:40:35.080950 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_activities' to be skipped because of status 'skipped'. 
[0m20:40:35.081952 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:40:35.082968 [info ] [Thread-1  ]: 14 of 16 SKIP relation public_crm.t_deal_funnel_events ......................... [[33mSKIP[0m]
[0m20:40:35.083951 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:40:35.084840 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_funnel_events' to be skipped because of status 'skipped'. 
[0m20:40:35.086857 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:40:35.086857 [info ] [Thread-1  ]: 15 of 16 SKIP relation public_crm.t_sales_funnel_monthly_columns ............... [[33mSKIP[0m]
[0m20:40:35.087857 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:40:35.088857 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:40:35.089854 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' to be skipped because of status 'skipped'. 
[0m20:40:35.088857 [info ] [Thread-1  ]: 16 of 16 SKIP relation public_crm.t_sales_funnel_monthly_rows .................. [[33mSKIP[0m]
[0m20:40:35.090912 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:40:35.090912 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' to be skipped because of status 'skipped'. 
[0m20:40:35.090912 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:35.090912 [debug] [MainThread]: On master: BEGIN
[0m20:40:35.090912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:35.117287 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m20:40:35.118670 [debug] [MainThread]: On master: COMMIT
[0m20:40:35.119457 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:35.120000 [debug] [MainThread]: On master: COMMIT
[0m20:40:35.122460 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:40:35.123051 [debug] [MainThread]: On master: Close
[0m20:40:35.123923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:35.123923 [debug] [MainThread]: Connection 'create_postgres_public' was properly closed.
[0m20:40:35.124452 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:40:35.125035 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.sn_users' was properly closed.
[0m20:40:35.125656 [info ] [MainThread]: 
[0m20:40:35.126819 [info ] [MainThread]: Finished running 1 incremental model, 2 snapshots, 5 table models, 8 view models in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m20:40:35.128936 [debug] [MainThread]: Command end result
[0m20:40:35.150824 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:40:35.150824 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:40:35.150824 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:40:35.150824 [info ] [MainThread]: 
[0m20:40:35.150824 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successs, and 0 warnings:[0m
[0m20:40:35.164776 [info ] [MainThread]: 
[0m20:40:35.165798 [error] [MainThread]:   Database Error in model rep_sales_funnel_monthly (models\marts\crm\rep_sales_funnel_monthly.sql)
  relation "public_crm.t_sales_funnel_monthly_rows" does not exist
  LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly.sql
[0m20:40:35.167455 [info ] [MainThread]: 
[0m20:40:35.167929 [error] [MainThread]:   Database Error in model rep_sales_funnel_monthly_columns (models\marts\crm\rep_sales_funnel_monthly_columns.sql)
  relation "public_crm.t_sales_funnel_monthly_columns" does not exist
  LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly_columns.sql
[0m20:40:35.170252 [info ] [MainThread]: 
[0m20:40:35.171300 [error] [MainThread]:   Database Error in model stg_activity_types (models\staging\pipedrive\stg_activity_types.sql)
  relation "public.activity_types" does not exist
  LINE 17: FROM "postgres"."public"."activity_types"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_activity_types.sql
[0m20:40:35.173128 [info ] [MainThread]: 
[0m20:40:35.174166 [error] [MainThread]:   Database Error in model stg_deal_changes (models\staging\pipedrive\stg_deal_changes.sql)
  relation "public.deal_changes" does not exist
  LINE 18: FROM "postgres"."public"."deal_changes"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_deal_changes.sql
[0m20:40:35.175581 [info ] [MainThread]: 
[0m20:40:35.176627 [error] [MainThread]:   Database Error in model stg_fields (models\staging\pipedrive\stg_fields.sql)
  relation "public.fields" does not exist
  LINE 18: FROM "postgres"."public"."fields" 
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_fields.sql
[0m20:40:35.176750 [info ] [MainThread]: 
[0m20:40:35.176750 [error] [MainThread]:   Database Error in model stg_stages (models\staging\pipedrive\stg_stages.sql)
  relation "public.stages" does not exist
  LINE 13: FROM "postgres"."public"."stages"
                ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\stg_stages.sql
[0m20:40:35.180564 [info ] [MainThread]: 
[0m20:40:35.181568 [error] [MainThread]:   Database Error in model test_model (models\test_model.sql)
  relation "public.activity" does not exist
  LINE 8: FROM "postgres"."public"."activity"
               ^
  compiled code at target\run\enpal_assessment_project\models\test_model.sql
[0m20:40:35.182550 [info ] [MainThread]: 
[0m20:40:35.183586 [error] [MainThread]:   Database Error in snapshot sn_activities (snapshots\sn_activities.sql)
  relation "public.activity" does not exist
  LINE 25: FROM "postgres"."public"."activity"
                ^
[0m20:40:35.185111 [info ] [MainThread]: 
[0m20:40:35.185111 [error] [MainThread]:   Database Error in snapshot sn_users (snapshots\sn_users.sql)
  relation "public.users" does not exist
  LINE 23: FROM "postgres"."public"."users"
                ^
[0m20:40:35.185111 [info ] [MainThread]: 
[0m20:40:35.185111 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=9 SKIP=6 TOTAL=16
[0m20:40:35.185111 [debug] [MainThread]: Command `dbt build` failed at 20:40:35.185111 after 2.48 seconds
[0m20:40:35.185111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E500EA0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50223B070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5038DE040>]}
[0m20:40:35.185111 [debug] [MainThread]: Flushing usage events
[0m20:40:35.781940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:28.395725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B7FD00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B9F3B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B9F3B970>]}


============================== 20:42:28.398725 | 506579a4-4b4a-4c1a-adb4-5ffbc3738027 ==============================
[0m20:42:28.398725 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:42:28.399726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:42:28.540076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B72E88B0>]}
[0m20:42:28.587443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B99A22E0>]}
[0m20:42:28.587443 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:42:28.771728 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:42:28.942956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:28.942956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:28.991364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BA672130>]}
[0m20:42:29.075742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:42:29.075742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:42:29.109698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BA650F70>]}
[0m20:42:29.109698 [info ] [MainThread]: Found 14 models, 2 snapshots, 6 sources, 428 macros
[0m20:42:29.109698 [info ] [MainThread]: 
[0m20:42:29.109698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:29.109698 [info ] [MainThread]: 
[0m20:42:29.109698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:42:29.127384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:42:29.198878 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:42:29.199791 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:42:29.199791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:29.226530 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m20:42:29.226530 [debug] [ThreadPool]: On list_postgres: Close
[0m20:42:29.226530 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:42:29.226530 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:42:29.226530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.243160 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m20:42:29.243160 [debug] [ThreadPool]: On list_postgres: Close
[0m20:42:29.243160 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:42:29.243160 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:42:29.243160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.259931 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m20:42:29.275577 [debug] [ThreadPool]: On list_postgres: Close
[0m20:42:29.275577 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:42:29.275577 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:42:29.275577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.291292 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m20:42:29.291292 [debug] [ThreadPool]: On list_postgres: Close
[0m20:42:29.291292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_marts_crm)
[0m20:42:29.291292 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_marts_crm"
"
[0m20:42:29.306908 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:42:29.306908 [debug] [ThreadPool]: On create_postgres_public_marts_crm: BEGIN
[0m20:42:29.306908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.338098 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m20:42:29.338659 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:42:29.339024 [debug] [ThreadPool]: On create_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_marts_crm"} */
create schema if not exists "public_marts_crm"
[0m20:42:29.341563 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:42:29.342525 [debug] [ThreadPool]: On create_postgres_public_marts_crm: COMMIT
[0m20:42:29.342525 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:42:29.343115 [debug] [ThreadPool]: On create_postgres_public_marts_crm: COMMIT
[0m20:42:29.348484 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m20:42:29.349291 [debug] [ThreadPool]: On create_postgres_public_marts_crm: Close
[0m20:42:29.349291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_marts_crm, now create_postgres_public_staging)
[0m20:42:29.349291 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m20:42:29.349291 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:42:29.349291 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m20:42:29.354120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.373743 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:42:29.374443 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:42:29.374443 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m20:42:29.375969 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:42:29.375969 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:42:29.375969 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:42:29.375969 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:42:29.375969 [debug] [ThreadPool]: SQL status: COMMIT in 0.009 seconds
[0m20:42:29.375969 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m20:42:29.389601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_staging, now create_postgres_public_crm)
[0m20:42:29.390425 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_crm"
"
[0m20:42:29.393427 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:42:29.394427 [debug] [ThreadPool]: On create_postgres_public_crm: BEGIN
[0m20:42:29.394427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.426038 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m20:42:29.427500 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:42:29.427920 [debug] [ThreadPool]: On create_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_crm"} */
create schema if not exists "public_crm"
[0m20:42:29.430421 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:42:29.431009 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:42:29.431502 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:42:29.431502 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:42:29.436421 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m20:42:29.436912 [debug] [ThreadPool]: On create_postgres_public_crm: Close
[0m20:42:29.437914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts_crm'
[0m20:42:29.437914 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:42:29.437914 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m20:42:29.437914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:29.471148 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:42:29.471148 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:42:29.472123 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m20:42:29.477131 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m20:42:29.478690 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m20:42:29.480631 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m20:42:29.481681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts_crm, now list_postgres_public_staging)
[0m20:42:29.483994 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:42:29.484988 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:42:29.484988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.504733 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:42:29.505731 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:42:29.506283 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:42:29.511172 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:42:29.513067 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:42:29.514944 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:42:29.515562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m20:42:29.516109 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:42:29.516109 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:42:29.516109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.539419 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:42:29.539893 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:42:29.540902 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:42:29.545401 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m20:42:29.546503 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:42:29.548536 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:42:29.549670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m20:42:29.552276 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:42:29.552276 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:42:29.553450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.573147 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:42:29.574267 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:42:29.574764 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:42:29.579278 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:42:29.580436 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:42:29.582333 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:42:29.585348 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.585348 [debug] [MainThread]: On master: BEGIN
[0m20:42:29.585348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:29.607516 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m20:42:29.608311 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.608496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:42:29.614011 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:42:29.615495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BACCE340>]}
[0m20:42:29.615996 [debug] [MainThread]: On master: ROLLBACK
[0m20:42:29.617497 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.617996 [debug] [MainThread]: On master: BEGIN
[0m20:42:29.619900 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:42:29.621260 [debug] [MainThread]: On master: COMMIT
[0m20:42:29.621497 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.622005 [debug] [MainThread]: On master: COMMIT
[0m20:42:29.624008 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:42:29.624505 [debug] [MainThread]: On master: Close
[0m20:42:29.633138 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m20:42:29.633138 [info ] [Thread-1  ]: 1 of 16 START sql view model public.calendar_ .................................. [RUN]
[0m20:42:29.635137 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m20:42:29.635137 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m20:42:29.641905 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m20:42:29.643782 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m20:42:29.708215 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m20:42:29.709794 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:42:29.710365 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m20:42:29.710764 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:42:29.727287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m20:42:29.741468 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:42:29.741928 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m20:42:29.745522 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:42:29.751521 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:42:29.752029 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m20:42:29.752941 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:29.752941 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:42:29.752941 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:42:29.752941 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:42:29.773067 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:42:29.779008 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m20:42:29.783065 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:42:29.783065 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m20:42:29.786502 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:29.789501 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m20:42:29.792632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BADDBC70>]}
[0m20:42:29.792632 [info ] [Thread-1  ]: 1 of 16 OK created sql view model public.calendar_ ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m20:42:29.792632 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m20:42:29.792632 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:42:29.792632 [info ] [Thread-1  ]: 2 of 16 START sql table model public_marts_crm.rep_sales_funnel_monthly ........ [RUN]
[0m20:42:29.792632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m20:42:29.792632 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:42:29.792632 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:42:29.792632 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:42:29.815491 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:42:29.815491 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:42:29.815491 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m20:42:29.815491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:29.843627 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:42:29.844816 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:42:29.845678 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    SELECT
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,funnel_kpi
  ,COALESCE(CASE WHEN funnel_kpi IN ('avg_users_per_deal','conversion_rate')
     THEN ROUND(kpi_value::numeric, 2)
     ELSE kpi_value
   END,0) AS kpi_value
FROM public_crm.t_sales_funnel_monthly_rows
-- ORDER BY 
--    month 
--   ,stage_id
--   ,funnel_kpi
  );
  
[0m20:42:29.848422 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_crm.t_sales_funnel_monthly_rows" does not exist
LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
              ^

[0m20:42:29.849733 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: ROLLBACK
[0m20:42:29.852008 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m20:42:29.857600 [debug] [Thread-1  ]: Database Error in model rep_sales_funnel_monthly (models\marts\crm\rep_sales_funnel_monthly.sql)
  relation "public_crm.t_sales_funnel_monthly_rows" does not exist
  LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly.sql
[0m20:42:29.858102 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BACB6340>]}
[0m20:42:29.859505 [error] [Thread-1  ]: 2 of 16 ERROR creating sql table model public_marts_crm.rep_sales_funnel_monthly  [[31mERROR[0m in 0.07s]
[0m20:42:29.860497 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:42:29.861605 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:42:29.863623 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly' to be skipped because of status 'error'.  Reason: Database Error in model rep_sales_funnel_monthly (models\marts\crm\rep_sales_funnel_monthly.sql)
  relation "public_crm.t_sales_funnel_monthly_rows" does not exist
  LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly.sql.
[0m20:42:29.862606 [info ] [Thread-1  ]: 3 of 16 START sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [RUN]
[0m20:42:29.863623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly, now model.enpal_assessment_project.rep_sales_funnel_monthly_columns)
[0m20:42:29.864680 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:42:29.866700 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:42:29.866700 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:42:29.866700 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:42:29.866700 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:42:29.866700 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: BEGIN
[0m20:42:29.866700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:29.892969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m20:42:29.893955 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:42:29.895457 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_tmp"
  
  
    as
  
  (
    SELECT 
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,COALESCE(deals_count, 0) AS deals_count
  ,COALESCE(ROUND(avg_users_per_deal::numeric, 2), 0) AS avg_users_per_deal
  ,COALESCE(ROUND(conversion_rate::numeric, 2), 0) AS converstion_rate
FROM public_crm.t_sales_funnel_monthly_columns
-- ORDER BY 
--    month 
--   ,stage_id
  );
  
[0m20:42:29.898588 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_crm.t_sales_funnel_monthly_columns" does not exist
LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
              ^

[0m20:42:29.899399 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: ROLLBACK
[0m20:42:29.901293 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: Close
[0m20:42:29.904020 [debug] [Thread-1  ]: Database Error in model rep_sales_funnel_monthly_columns (models\marts\crm\rep_sales_funnel_monthly_columns.sql)
  relation "public_crm.t_sales_funnel_monthly_columns" does not exist
  LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly_columns.sql
[0m20:42:29.905034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BA9308B0>]}
[0m20:42:29.906131 [error] [Thread-1  ]: 3 of 16 ERROR creating sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [[31mERROR[0m in 0.04s]
[0m20:42:29.907596 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:42:29.908207 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:42:29.909859 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly_columns' to be skipped because of status 'error'.  Reason: Database Error in model rep_sales_funnel_monthly_columns (models\marts\crm\rep_sales_funnel_monthly_columns.sql)
  relation "public_crm.t_sales_funnel_monthly_columns" does not exist
  LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly_columns.sql.
[0m20:42:29.908774 [info ] [Thread-1  ]: 4 of 16 START sql table model public_staging.stg_activity_types ................ [RUN]
[0m20:42:29.910505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly_columns, now model.enpal_assessment_project.stg_activity_types)
[0m20:42:29.912086 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:42:29.915308 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:42:29.916323 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:42:29.918518 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:42:29.918518 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:42:29.918518 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:42:29.918518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:29.949523 [debug] [Thread-1  ]: SQL status: BEGIN in 0.035 seconds
[0m20:42:29.958030 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:42:29.958993 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m20:42:29.963226 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m20:42:29.966818 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:42:29.967317 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:42:29.968771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:29.968771 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:42:29.968771 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:42:29.968771 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:42:29.978765 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:42:29.980846 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m20:42:29.983026 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:42:29.983026 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m20:42:29.983026 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:42:29.983026 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:42:29.988480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAD0AE50>]}
[0m20:42:29.988983 [info ] [Thread-1  ]: 4 of 16 OK created sql table model public_staging.stg_activity_types ........... [[32mSELECT 4[0m in 0.07s]
[0m20:42:29.988983 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:42:29.988983 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:42:29.988983 [info ] [Thread-1  ]: 5 of 16 START sql incremental model public_staging.stg_deal_changes ............ [RUN]
[0m20:42:29.992614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:42:29.993308 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:42:30.000459 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:42:30.001450 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:42:30.030340 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:42:30.031365 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:42:30.031365 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:42:30.032324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.059937 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m20:42:30.060636 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:42:30.061637 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_staging"."stg_deal_changes"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  );
  
  
[0m20:42:30.071189 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.010 seconds
[0m20:42:30.071189 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:42:30.071189 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:42:30.071189 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:42:30.086695 [debug] [Thread-1  ]: SQL status: COMMIT in 0.013 seconds
[0m20:42:30.087788 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:42:30.089312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BACB6340>]}
[0m20:42:30.089312 [info ] [Thread-1  ]: 5 of 16 OK created sql incremental model public_staging.stg_deal_changes ....... [[32mSELECT 15406[0m in 0.10s]
[0m20:42:30.090541 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:42:30.091633 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m20:42:30.092849 [info ] [Thread-1  ]: 6 of 16 START sql table model public_staging.stg_fields ........................ [RUN]
[0m20:42:30.093888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m20:42:30.093888 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m20:42:30.096887 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m20:42:30.096887 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m20:42:30.100886 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m20:42:30.101886 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:42:30.101886 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m20:42:30.102886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.132952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.038 seconds
[0m20:42:30.142823 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:42:30.143326 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m20:42:30.147988 [debug] [Thread-1  ]: SQL status: SELECT 16 in 0.004 seconds
[0m20:42:30.152718 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:42:30.152718 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m20:42:30.152718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.152718 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:42:30.152718 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:42:30.152718 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:42:30.161343 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:42:30.164438 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m20:42:30.165596 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:42:30.165596 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m20:42:30.165596 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:42:30.165596 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m20:42:30.165596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAD1EA30>]}
[0m20:42:30.165596 [info ] [Thread-1  ]: 6 of 16 OK created sql table model public_staging.stg_fields ................... [[32mSELECT 16[0m in 0.07s]
[0m20:42:30.165596 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m20:42:30.165596 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:42:30.165596 [info ] [Thread-1  ]: 7 of 16 START sql table model public_staging.stg_stages ........................ [RUN]
[0m20:42:30.165596 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m20:42:30.165596 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:42:30.180414 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:42:30.181336 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:42:30.184848 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:42:30.185904 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:42:30.186841 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:42:30.186841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.194736 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:42:30.208489 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:42:30.209466 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:42:30.213501 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m20:42:30.217000 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:42:30.217600 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m20:42:30.220015 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.220015 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:42:30.220015 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:42:30.220015 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:42:30.227206 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:42:30.230972 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m20:42:30.231972 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:42:30.231972 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m20:42:30.233247 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:42:30.233247 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:42:30.233247 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B9F17100>]}
[0m20:42:30.233247 [info ] [Thread-1  ]: 7 of 16 OK created sql table model public_staging.stg_stages ................... [[32mSELECT 9[0m in 0.07s]
[0m20:42:30.239439 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:42:30.239439 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m20:42:30.239439 [info ] [Thread-1  ]: 8 of 16 START sql view model public.test_model ................................. [RUN]
[0m20:42:30.239439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.test_model)
[0m20:42:30.239439 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m20:42:30.245332 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m20:42:30.247349 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m20:42:30.250606 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m20:42:30.250606 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:42:30.250606 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m20:42:30.250606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.261524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:42:30.274060 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:42:30.274581 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  create view "postgres"."public"."test_model__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m20:42:30.278256 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:42:30.282130 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:42:30.282726 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public"."test_model__dbt_tmp" rename to "test_model"
[0m20:42:30.284643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.284643 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m20:42:30.284643 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:42:30.284643 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m20:42:30.284643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:42:30.296986 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."test_model__dbt_backup"
[0m20:42:30.297970 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:42:30.297970 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop view if exists "postgres"."public"."test_model__dbt_backup" cascade
[0m20:42:30.300011 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:30.300011 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m20:42:30.300011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAE93EE0>]}
[0m20:42:30.300011 [info ] [Thread-1  ]: 8 of 16 OK created sql view model public.test_model ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m20:42:30.300011 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m20:42:30.300011 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:42:30.300011 [info ] [Thread-1  ]: 9 of 16 START snapshot public_staging.sn_activities ............................ [RUN]
[0m20:42:30.300011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now snapshot.enpal_assessment_project.sn_activities)
[0m20:42:30.300011 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:42:30.310838 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:42:30.415022 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:42:30.416027 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:42:30.416027 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.458665 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.047 seconds
[0m20:42:30.458665 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:42:30.458665 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:42:30.458665 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:42:30.474383 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m20:42:30.474383 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:42:30.474383 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m20:42:30.480721 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:42:30.481430 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:42:30.481937 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m20:42:30.505717 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.023 seconds
[0m20:42:30.507222 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:42:30.508221 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:42:30.508221 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:42:30.514558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m20:42:30.514558 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:42:30.514558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAE93EE0>]}
[0m20:42:30.514558 [info ] [Thread-1  ]: 9 of 16 OK snapshotted public_staging.sn_activities ............................ [[32mSELECT 4579[0m in 0.21s]
[0m20:42:30.514558 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:42:30.514558 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m20:42:30.514558 [info ] [Thread-1  ]: 10 of 16 START snapshot public_staging.sn_users ................................ [RUN]
[0m20:42:30.525936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m20:42:30.525936 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m20:42:30.532229 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m20:42:30.533433 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:42:30.533433 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:42:30.533433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.561815 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.021 seconds
[0m20:42:30.561815 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:42:30.561815 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:42:30.561815 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:42:30.561815 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m20:42:30.561815 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:42:30.561815 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m20:42:30.561815 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:42:30.571387 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:42:30.571837 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      
  
    

  create  table "postgres"."public_staging"."sn_users"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



  );
  
  
[0m20:42:30.578520 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.007 seconds
[0m20:42:30.581368 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m20:42:30.581368 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:42:30.582405 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m20:42:30.583463 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:42:30.583463 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m20:42:30.583463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAECBD60>]}
[0m20:42:30.583463 [info ] [Thread-1  ]: 10 of 16 OK snapshotted public_staging.sn_users ................................ [[32mSELECT 1787[0m in 0.07s]
[0m20:42:30.593068 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m20:42:30.593068 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m20:42:30.594183 [info ] [Thread-1  ]: 11 of 16 START sql view model public_crm.t_user_deal_events .................... [RUN]
[0m20:42:30.595146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_users, now model.enpal_assessment_project.t_user_deal_events)
[0m20:42:30.595146 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m20:42:30.597244 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:42:30.598250 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m20:42:30.602252 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:42:30.603237 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:42:30.603237 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m20:42:30.604197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.644221 [debug] [Thread-1  ]: SQL status: BEGIN in 0.039 seconds
[0m20:42:30.644721 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:42:30.645226 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m20:42:30.648890 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:42:30.652351 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:42:30.652351 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m20:42:30.654778 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.654778 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:42:30.654778 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:42:30.654778 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:42:30.661283 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:42:30.663378 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m20:42:30.664383 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:42:30.664383 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m20:42:30.666280 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:30.668366 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m20:42:30.669240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BACF0250>]}
[0m20:42:30.669788 [info ] [Thread-1  ]: 11 of 16 OK created sql view model public_crm.t_user_deal_events ............... [[32mCREATE VIEW[0m in 0.07s]
[0m20:42:30.671801 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m20:42:30.672809 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:42:30.672809 [info ] [Thread-1  ]: 12 of 16 START sql view model public_crm.t_deal_lost_reasons ................... [RUN]
[0m20:42:30.673810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m20:42:30.674806 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:42:30.678340 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:42:30.680311 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:42:30.683332 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:42:30.684317 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:42:30.685275 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m20:42:30.685275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.716153 [debug] [Thread-1  ]: SQL status: BEGIN in 0.040 seconds
[0m20:42:30.726444 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:42:30.726773 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m20:42:30.731341 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:42:30.735363 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:42:30.735863 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m20:42:30.736776 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.736776 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m20:42:30.736776 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:42:30.736776 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m20:42:30.744800 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:42:30.747910 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m20:42:30.748806 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:42:30.748806 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m20:42:30.749999 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:30.749999 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m20:42:30.749999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAEF1160>]}
[0m20:42:30.749999 [info ] [Thread-1  ]: 12 of 16 OK created sql view model public_crm.t_deal_lost_reasons .............. [[32mCREATE VIEW[0m in 0.08s]
[0m20:42:30.749999 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:42:30.749999 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:42:30.749999 [info ] [Thread-1  ]: 13 of 16 START sql view model public_crm.t_activities .......................... [RUN]
[0m20:42:30.749999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_activities)
[0m20:42:30.749999 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:42:30.760935 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:42:30.761936 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:42:30.765929 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:42:30.765929 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:42:30.766857 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:42:30.766857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.788536 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:42:30.789414 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:42:30.789907 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:42:30.795843 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:42:30.799327 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:42:30.799828 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:42:30.799828 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.799828 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:42:30.799828 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:42:30.799828 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:42:30.799828 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:42:30.812471 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:42:30.813508 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:42:30.813508 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:42:30.815612 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:30.815612 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:42:30.815612 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAF1FDF0>]}
[0m20:42:30.815612 [info ] [Thread-1  ]: 13 of 16 OK created sql view model public_crm.t_activities ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m20:42:30.815612 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:42:30.815612 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:42:30.815612 [info ] [Thread-1  ]: 14 of 16 START sql view model public_crm.t_deal_funnel_events .................. [RUN]
[0m20:42:30.815612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_funnel_events)
[0m20:42:30.815612 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m20:42:30.830015 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:42:30.832007 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m20:42:30.837105 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:42:30.838009 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:42:30.838009 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m20:42:30.839018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.877430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.038 seconds
[0m20:42:30.878182 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:42:30.878985 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM "postgres"."public_crm"."t_activities"
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN "postgres"."public_staging"."stg_stages" s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m20:42:30.884483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:42:30.887983 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:42:30.887983 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m20:42:30.888484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.892710 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:42:30.893212 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:42:30.893212 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:42:30.899412 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:42:30.899412 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m20:42:30.899412 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:42:30.899412 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m20:42:30.899412 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:30.899412 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m20:42:30.899412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BADC18E0>]}
[0m20:42:30.899412 [info ] [Thread-1  ]: 14 of 16 OK created sql view model public_crm.t_deal_funnel_events ............. [[32mCREATE VIEW[0m in 0.08s]
[0m20:42:30.909553 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:42:30.916893 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:42:30.917895 [info ] [Thread-1  ]: 15 of 16 START sql view model public_crm.t_sales_funnel_monthly_columns ........ [RUN]
[0m20:42:30.919895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_sales_funnel_monthly_columns)
[0m20:42:30.919895 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:42:30.928099 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:42:30.930098 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:42:30.945852 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:42:30.945852 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:42:30.945852 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: BEGIN
[0m20:42:30.945852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:30.976879 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m20:42:30.978280 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:42:30.978817 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,avg_users_per_deal
  ,conversion_rate -- ignoring [optional] steps
FROM funnel_with_conversion_rate
-- ORDER BY month, stage_id
  );
[0m20:42:30.984758 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:42:30.987273 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:42:30.987777 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp" rename to "t_sales_funnel_monthly_columns"
[0m20:42:30.989785 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:30.991241 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m20:42:30.991241 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:42:30.992698 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m20:42:30.996709 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:42:30.999404 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup"
[0m20:42:30.999404 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:42:30.999404 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup" cascade
[0m20:42:30.999404 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:30.999404 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: Close
[0m20:42:30.999404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAF3D070>]}
[0m20:42:30.999404 [info ] [Thread-1  ]: 15 of 16 OK created sql view model public_crm.t_sales_funnel_monthly_columns ... [[32mCREATE VIEW[0m in 0.08s]
[0m20:42:30.999404 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:42:30.999404 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:42:30.999404 [info ] [Thread-1  ]: 16 of 16 START sql view model public_crm.t_sales_funnel_monthly_rows ........... [RUN]
[0m20:42:31.008962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_columns, now model.enpal_assessment_project.t_sales_funnel_monthly_rows)
[0m20:42:31.008962 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:42:31.010508 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:42:31.010508 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:42:31.010508 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:42:31.010508 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:42:31.010508 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m20:42:31.010508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:42:31.032551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m20:42:31.042430 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:42:31.043431 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m20:42:31.050928 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m20:42:31.053443 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:42:31.053443 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp" rename to "t_sales_funnel_monthly_rows"
[0m20:42:31.053443 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:31.059643 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:42:31.060574 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:42:31.061099 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:42:31.065355 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:42:31.066604 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup"
[0m20:42:31.066604 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:42:31.066604 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup" cascade
[0m20:42:31.066604 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:42:31.066604 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m20:42:31.066604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506579a4-4b4a-4c1a-adb4-5ffbc3738027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BAF3D070>]}
[0m20:42:31.066604 [info ] [Thread-1  ]: 16 of 16 OK created sql view model public_crm.t_sales_funnel_monthly_rows ...... [[32mCREATE VIEW[0m in 0.06s]
[0m20:42:31.066604 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:42:31.076749 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:31.077237 [debug] [MainThread]: On master: BEGIN
[0m20:42:31.077237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:42:31.099449 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m20:42:31.107977 [debug] [MainThread]: On master: COMMIT
[0m20:42:31.108422 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:31.108422 [debug] [MainThread]: On master: COMMIT
[0m20:42:31.110533 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:42:31.110920 [debug] [MainThread]: On master: Close
[0m20:42:31.111921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:31.112422 [debug] [MainThread]: Connection 'create_postgres_public_crm' was properly closed.
[0m20:42:31.113423 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m20:42:31.113985 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' was properly closed.
[0m20:42:31.114615 [info ] [MainThread]: 
[0m20:42:31.115827 [info ] [MainThread]: Finished running 1 incremental model, 2 snapshots, 5 table models, 8 view models in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m20:42:31.119336 [debug] [MainThread]: Command end result
[0m20:42:31.142545 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:42:31.146366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:42:31.150611 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:42:31.150611 [info ] [MainThread]: 
[0m20:42:31.150611 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successs, and 0 warnings:[0m
[0m20:42:31.150611 [info ] [MainThread]: 
[0m20:42:31.150611 [error] [MainThread]:   Database Error in model rep_sales_funnel_monthly (models\marts\crm\rep_sales_funnel_monthly.sql)
  relation "public_crm.t_sales_funnel_monthly_rows" does not exist
  LINE 21: FROM public_crm.t_sales_funnel_monthly_rows
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly.sql
[0m20:42:31.159068 [info ] [MainThread]: 
[0m20:42:31.160256 [error] [MainThread]:   Database Error in model rep_sales_funnel_monthly_columns (models\marts\crm\rep_sales_funnel_monthly_columns.sql)
  relation "public_crm.t_sales_funnel_monthly_columns" does not exist
  LINE 19: FROM public_crm.t_sales_funnel_monthly_columns
                ^
  compiled code at target\run\enpal_assessment_project\models\marts\crm\rep_sales_funnel_monthly_columns.sql
[0m20:42:31.161666 [info ] [MainThread]: 
[0m20:42:31.163051 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=0 TOTAL=16
[0m20:42:31.164078 [debug] [MainThread]: Command `dbt build` failed at 20:42:31.164078 after 2.82 seconds
[0m20:42:31.165130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B7FD00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B7BE2FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B83860A0>]}
[0m20:42:31.165130 [debug] [MainThread]: Flushing usage events
[0m20:42:31.740816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:28.371579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779B325FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779D29A790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779D29A850>]}


============================== 20:51:28.371579 | 29e99852-a2c3-4ce9-b68d-5052d338d7cd ==============================
[0m20:51:28.371579 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:51:28.371579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:28.514769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779A650D90>]}
[0m20:51:28.562701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779D0F32E0>]}
[0m20:51:28.578817 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:51:28.738378 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:51:28.896724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:51:28.896724 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\marts\crm\rep_sales_funnel_monthly_columns.sql
[0m20:51:28.896724 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\marts\crm\rep_sales_funnel_monthly.sql
[0m20:51:29.202283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779DC79EB0>]}
[0m20:51:29.295816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:51:29.311434 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:51:29.342725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779DC8ABE0>]}
[0m20:51:29.342725 [info ] [MainThread]: Found 14 models, 2 snapshots, 6 sources, 428 macros
[0m20:51:29.358271 [info ] [MainThread]: 
[0m20:51:29.358271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:29.358271 [info ] [MainThread]: 
[0m20:51:29.362979 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:29.369033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:51:29.502036 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:51:29.502036 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:51:29.502036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:29.611443 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.110 seconds
[0m20:51:29.611443 [debug] [ThreadPool]: On list_postgres: Close
[0m20:51:29.611443 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:51:29.611443 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:51:29.611443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.643925 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m20:51:29.643925 [debug] [ThreadPool]: On list_postgres: Close
[0m20:51:29.643925 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:51:29.643925 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:51:29.643925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.660108 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m20:51:29.660108 [debug] [ThreadPool]: On list_postgres: Close
[0m20:51:29.672222 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:51:29.672222 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:51:29.672222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.703711 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m20:51:29.703711 [debug] [ThreadPool]: On list_postgres: Close
[0m20:51:29.703711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m20:51:29.703711 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m20:51:29.703711 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:51:29.703711 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m20:51:29.703711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.722927 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:51:29.736104 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:51:29.736704 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m20:51:29.738624 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:51:29.739710 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:51:29.740217 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m20:51:29.740217 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m20:51:29.746196 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m20:51:29.746703 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m20:51:29.746703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_staging, now create_postgres_public_marts_crm)
[0m20:51:29.746703 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_marts_crm"
"
[0m20:51:29.746703 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:51:29.746703 [debug] [ThreadPool]: On create_postgres_public_marts_crm: BEGIN
[0m20:51:29.746703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.771201 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:51:29.771977 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:51:29.772178 [debug] [ThreadPool]: On create_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_marts_crm"} */
create schema if not exists "public_marts_crm"
[0m20:51:29.774181 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:51:29.775265 [debug] [ThreadPool]: On create_postgres_public_marts_crm: COMMIT
[0m20:51:29.775265 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts_crm"
[0m20:51:29.775952 [debug] [ThreadPool]: On create_postgres_public_marts_crm: COMMIT
[0m20:51:29.780325 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m20:51:29.780914 [debug] [ThreadPool]: On create_postgres_public_marts_crm: Close
[0m20:51:29.781753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_marts_crm, now create_postgres_public_crm)
[0m20:51:29.782253 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_crm"
"
[0m20:51:29.784302 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:51:29.785359 [debug] [ThreadPool]: On create_postgres_public_crm: BEGIN
[0m20:51:29.785359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.812329 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m20:51:29.812930 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:51:29.813187 [debug] [ThreadPool]: On create_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_crm"} */
create schema if not exists "public_crm"
[0m20:51:29.815682 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:51:29.816179 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:51:29.816679 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_crm"
[0m20:51:29.817179 [debug] [ThreadPool]: On create_postgres_public_crm: COMMIT
[0m20:51:29.821186 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m20:51:29.821834 [debug] [ThreadPool]: On create_postgres_public_crm: Close
[0m20:51:29.823593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m20:51:29.832147 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:51:29.832147 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:51:29.833245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:29.852679 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:51:29.854131 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:51:29.854604 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:51:29.859142 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:51:29.860223 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:51:29.862292 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:51:29.863448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public)
[0m20:51:29.864939 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:51:29.864939 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:51:29.864939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.896886 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m20:51:29.897888 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:51:29.898414 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:29.903025 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m20:51:29.904229 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:51:29.906524 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:51:29.907338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_marts_crm)
[0m20:51:29.909529 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:51:29.909529 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m20:51:29.909529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.930082 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:51:29.931205 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:51:29.931727 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m20:51:29.936211 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:51:29.937749 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m20:51:29.939745 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m20:51:29.940745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts_crm, now list_postgres_public_crm)
[0m20:51:29.943069 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:51:29.944164 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:51:29.944164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.964620 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:51:29.965975 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:51:29.965975 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:51:29.970907 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:51:29.971997 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:51:29.973721 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:51:29.979278 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:29.980281 [debug] [MainThread]: On master: BEGIN
[0m20:51:29.980281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:30.009423 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m20:51:30.009854 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.010385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:30.016200 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:51:30.017423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779DDB47F0>]}
[0m20:51:30.018039 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:30.019734 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.019734 [debug] [MainThread]: On master: BEGIN
[0m20:51:30.020892 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:51:30.023702 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.024080 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.024689 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.026483 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:51:30.026988 [debug] [MainThread]: On master: Close
[0m20:51:30.030983 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m20:51:30.031984 [info ] [Thread-1  ]: 1 of 16 START sql view model public.calendar_ .................................. [RUN]
[0m20:51:30.033493 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m20:51:30.033783 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m20:51:30.038929 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m20:51:30.039900 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m20:51:30.064702 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m20:51:30.064702 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:51:30.064702 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m20:51:30.064702 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:51:30.110303 [debug] [Thread-1  ]: SQL status: BEGIN in 0.032 seconds
[0m20:51:30.111759 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:51:30.112704 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m20:51:30.116232 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:30.122164 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:51:30.122164 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m20:51:30.122164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.137923 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:51:30.138925 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:51:30.138925 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m20:51:30.145284 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:51:30.150968 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m20:51:30.154051 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m20:51:30.155059 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m20:51:30.156768 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.158857 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m20:51:30.161306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779DB17880>]}
[0m20:51:30.162301 [info ] [Thread-1  ]: 1 of 16 OK created sql view model public.calendar_ ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m20:51:30.163600 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m20:51:30.165891 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.165891 [info ] [Thread-1  ]: 2 of 16 START sql table model public_staging.stg_activity_types ................ [RUN]
[0m20:51:30.165891 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m20:51:30.165891 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.165891 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.165891 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.188285 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.188285 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.188285 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m20:51:30.188285 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.215399 [debug] [Thread-1  ]: SQL status: BEGIN in 0.036 seconds
[0m20:51:30.229744 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.230134 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m20:51:30.234635 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m20:51:30.237223 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.237722 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m20:51:30.239632 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.241178 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:51:30.241178 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.241178 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m20:51:30.251553 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:51:30.253922 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m20:51:30.257024 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m20:51:30.258017 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m20:51:30.259930 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:51:30.261927 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m20:51:30.263215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779B262550>]}
[0m20:51:30.263373 [info ] [Thread-1  ]: 2 of 16 OK created sql table model public_staging.stg_activity_types ........... [[32mSELECT 4[0m in 0.10s]
[0m20:51:30.265395 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:51:30.266452 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:51:30.266452 [info ] [Thread-1  ]: 3 of 16 START sql incremental model public_staging.stg_deal_changes ............ [RUN]
[0m20:51:30.267397 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:51:30.267397 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:51:30.273479 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:51:30.274493 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:51:30.302766 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:51:30.302766 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:51:30.302766 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m20:51:30.302766 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.328791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:51:30.329492 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:51:30.330125 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_staging"."stg_deal_changes"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  );
  
  
[0m20:51:30.340125 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.011 seconds
[0m20:51:30.340125 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:51:30.340125 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:51:30.340125 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:51:30.361493 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m20:51:30.362206 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:51:30.363575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779A683E80>]}
[0m20:51:30.363575 [info ] [Thread-1  ]: 3 of 16 OK created sql incremental model public_staging.stg_deal_changes ....... [[32mSELECT 15406[0m in 0.10s]
[0m20:51:30.366002 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:51:30.366002 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m20:51:30.367002 [info ] [Thread-1  ]: 4 of 16 START sql table model public_staging.stg_fields ........................ [RUN]
[0m20:51:30.367705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m20:51:30.368727 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m20:51:30.370710 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m20:51:30.371730 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m20:51:30.375711 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m20:51:30.377118 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.377516 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m20:51:30.377516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.397396 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m20:51:30.398233 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.398745 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m20:51:30.403742 [debug] [Thread-1  ]: SQL status: SELECT 16 in 0.004 seconds
[0m20:51:30.407827 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.408333 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m20:51:30.408829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.408829 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:51:30.408829 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.413270 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m20:51:30.418384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:51:30.420628 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m20:51:30.420628 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m20:51:30.420628 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m20:51:30.420628 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:51:30.420628 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m20:51:30.420628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779CD47370>]}
[0m20:51:30.420628 [info ] [Thread-1  ]: 4 of 16 OK created sql table model public_staging.stg_fields ................... [[32mSELECT 16[0m in 0.05s]
[0m20:51:30.420628 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m20:51:30.420628 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:51:30.429910 [info ] [Thread-1  ]: 5 of 16 START sql table model public_staging.stg_stages ........................ [RUN]
[0m20:51:30.430110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m20:51:30.431306 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:51:30.434303 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:51:30.435303 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:51:30.438303 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m20:51:30.439303 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.440303 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m20:51:30.440303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.452362 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:51:30.461703 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.462377 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:51:30.465859 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m20:51:30.470941 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.470941 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m20:51:30.472133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.472133 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:51:30.472133 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.472133 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m20:51:30.482136 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:51:30.484495 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m20:51:30.485499 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m20:51:30.485499 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m20:51:30.486675 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:51:30.486675 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m20:51:30.486675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779A736A30>]}
[0m20:51:30.486675 [info ] [Thread-1  ]: 5 of 16 OK created sql table model public_staging.stg_stages ................... [[32mSELECT 9[0m in 0.06s]
[0m20:51:30.491740 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:51:30.491740 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m20:51:30.491740 [info ] [Thread-1  ]: 6 of 16 START sql view model public.test_model ................................. [RUN]
[0m20:51:30.491740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.test_model)
[0m20:51:30.491740 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m20:51:30.497622 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m20:51:30.498608 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m20:51:30.503610 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m20:51:30.504622 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:51:30.504622 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m20:51:30.504622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.532344 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m20:51:30.533288 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:51:30.533731 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  create view "postgres"."public"."test_model__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m20:51:30.537225 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:30.541228 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:51:30.541745 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public"."test_model__dbt_tmp" rename to "test_model"
[0m20:51:30.544042 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.544042 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m20:51:30.544042 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:51:30.544042 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m20:51:30.551182 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:51:30.554414 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."test_model__dbt_backup"
[0m20:51:30.554414 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m20:51:30.554414 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop view if exists "postgres"."public"."test_model__dbt_backup" cascade
[0m20:51:30.554414 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.554414 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m20:51:30.554414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779E252F10>]}
[0m20:51:30.554414 [info ] [Thread-1  ]: 6 of 16 OK created sql view model public.test_model ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m20:51:30.554414 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m20:51:30.554414 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:51:30.563027 [info ] [Thread-1  ]: 7 of 16 START snapshot public_staging.sn_activities ............................ [RUN]
[0m20:51:30.564026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now snapshot.enpal_assessment_project.sn_activities)
[0m20:51:30.564874 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:51:30.564874 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:51:30.614717 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:51:30.614717 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:51:30.614717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.648090 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.020 seconds
[0m20:51:30.651021 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:51:30.651021 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:51:30.654021 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:51:30.654021 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m20:51:30.655107 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:51:30.655107 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m20:51:30.657023 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:51:30.658378 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:51:30.658887 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      
  
    

  create  table "postgres"."public_staging"."sn_activities"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."activity"

    ) sbq



  );
  
  
[0m20:51:30.675697 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.017 seconds
[0m20:51:30.678034 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:51:30.678034 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m20:51:30.678666 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m20:51:30.689596 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m20:51:30.689596 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m20:51:30.691511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779F2A83D0>]}
[0m20:51:30.691816 [info ] [Thread-1  ]: 7 of 16 OK snapshotted public_staging.sn_activities ............................ [[32mSELECT 4579[0m in 0.13s]
[0m20:51:30.693598 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:51:30.694628 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m20:51:30.694628 [info ] [Thread-1  ]: 8 of 16 START snapshot public_staging.sn_users ................................. [RUN]
[0m20:51:30.696449 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m20:51:30.696535 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m20:51:30.699625 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m20:51:30.706632 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:51:30.706632 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m20:51:30.707701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.747405 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.040 seconds
[0m20:51:30.749508 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:51:30.749508 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:51:30.749508 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:51:30.749508 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m20:51:30.749508 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:51:30.749508 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m20:51:30.749508 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m20:51:30.757440 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:51:30.757948 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      
  
    

  create  table "postgres"."public_staging"."sn_users"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to

    from (
          



SELECT * 
FROM "postgres"."public"."users"

    ) sbq



  );
  
  
[0m20:51:30.770292 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.012 seconds
[0m20:51:30.771789 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m20:51:30.771789 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m20:51:30.771789 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m20:51:30.779788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:51:30.780830 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m20:51:30.782015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779DB17970>]}
[0m20:51:30.782015 [info ] [Thread-1  ]: 8 of 16 OK snapshotted public_staging.sn_users ................................. [[32mSELECT 1787[0m in 0.09s]
[0m20:51:30.784210 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m20:51:30.784210 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m20:51:30.785291 [info ] [Thread-1  ]: 9 of 16 START sql view model public_crm.t_user_deal_events ..................... [RUN]
[0m20:51:30.785778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_users, now model.enpal_assessment_project.t_user_deal_events)
[0m20:51:30.785778 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m20:51:30.788792 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:51:30.788792 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m20:51:30.792792 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:51:30.793792 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:51:30.795025 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m20:51:30.795524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.815231 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m20:51:30.816237 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:51:30.817314 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m20:51:30.821395 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:51:30.824818 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:51:30.825343 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m20:51:30.826271 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.826271 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:51:30.826271 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:51:30.826271 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m20:51:30.833359 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:51:30.835408 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m20:51:30.836404 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m20:51:30.836404 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m20:51:30.837584 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.837584 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m20:51:30.837584 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779E2463D0>]}
[0m20:51:30.837584 [info ] [Thread-1  ]: 9 of 16 OK created sql view model public_crm.t_user_deal_events ................ [[32mCREATE VIEW[0m in 0.05s]
[0m20:51:30.837584 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m20:51:30.837584 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:51:30.837584 [info ] [Thread-1  ]: 10 of 16 START sql view model public_crm.t_deal_lost_reasons ................... [RUN]
[0m20:51:30.846446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m20:51:30.846446 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:51:30.848356 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:51:30.848356 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:51:30.848356 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:51:30.848356 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:51:30.848356 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m20:51:30.848356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.880706 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m20:51:30.881297 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:51:30.882298 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m20:51:30.886381 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:30.889882 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:51:30.890383 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m20:51:30.891806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.891806 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m20:51:30.891806 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:51:30.891806 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m20:51:30.898430 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:51:30.901952 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m20:51:30.903213 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:51:30.903213 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m20:51:30.903213 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.903213 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m20:51:30.903213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779E26BC10>]}
[0m20:51:30.903213 [info ] [Thread-1  ]: 10 of 16 OK created sql view model public_crm.t_deal_lost_reasons .............. [[32mCREATE VIEW[0m in 0.07s]
[0m20:51:30.903213 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:51:30.903213 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:51:30.903213 [info ] [Thread-1  ]: 11 of 16 START sql view model public_crm.t_activities .......................... [RUN]
[0m20:51:30.912895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_activities)
[0m20:51:30.913398 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:51:30.914393 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:51:30.914393 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:51:30.914393 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m20:51:30.914393 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:51:30.914393 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m20:51:30.914393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.936679 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:51:30.946282 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:51:30.946789 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m20:51:30.950301 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:51:30.953440 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:51:30.953440 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m20:51:30.953440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:30.953440 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:51:30.953440 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:51:30.953440 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m20:51:30.970042 [debug] [Thread-1  ]: SQL status: COMMIT in 0.011 seconds
[0m20:51:30.970042 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m20:51:30.970042 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m20:51:30.970042 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m20:51:30.970042 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:30.970042 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m20:51:30.970042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779F2C6FD0>]}
[0m20:51:30.979455 [info ] [Thread-1  ]: 11 of 16 OK created sql view model public_crm.t_activities ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m20:51:30.981510 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:51:30.982514 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:51:30.982514 [info ] [Thread-1  ]: 12 of 16 START sql view model public_crm.t_deal_funnel_events .................. [RUN]
[0m20:51:30.982514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_funnel_events)
[0m20:51:30.982514 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m20:51:30.982514 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:51:30.982514 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m20:51:30.982514 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:51:30.982514 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:51:30.982514 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m20:51:30.982514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:31.012704 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m20:51:31.013211 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:51:31.014212 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM "postgres"."public_crm"."t_activities"
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN "postgres"."public_staging"."stg_stages" s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m20:51:31.019389 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:51:31.022946 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:51:31.022946 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m20:51:31.023425 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:31.023425 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:51:31.023425 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:51:31.023425 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m20:51:31.032696 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:51:31.035791 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m20:51:31.036981 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:51:31.036981 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m20:51:31.036981 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:31.036981 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m20:51:31.041224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779DA4C5E0>]}
[0m20:51:31.042068 [info ] [Thread-1  ]: 12 of 16 OK created sql view model public_crm.t_deal_funnel_events ............. [[32mCREATE VIEW[0m in 0.05s]
[0m20:51:31.042068 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:51:31.042068 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:51:31.042068 [info ] [Thread-1  ]: 13 of 16 START sql view model public_crm.t_sales_funnel_monthly_columns ........ [RUN]
[0m20:51:31.046282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_sales_funnel_monthly_columns)
[0m20:51:31.046282 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:51:31.048008 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:51:31.048008 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:51:31.048008 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:51:31.048008 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:51:31.048008 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: BEGIN
[0m20:51:31.048008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:31.079612 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:51:31.080350 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:51:31.081673 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,avg_users_per_deal
  ,conversion_rate -- ignoring [optional] steps
FROM funnel_with_conversion_rate
-- ORDER BY month, stage_id
  );
[0m20:51:31.089114 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:51:31.091612 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:51:31.091612 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp" rename to "t_sales_funnel_monthly_columns"
[0m20:51:31.091612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:31.096256 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m20:51:31.097795 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:51:31.098790 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m20:51:31.103888 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:51:31.103888 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup"
[0m20:51:31.103888 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:51:31.103888 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup" cascade
[0m20:51:31.103888 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:51:31.103888 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: Close
[0m20:51:31.112831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779A6D2760>]}
[0m20:51:31.114477 [info ] [Thread-1  ]: 13 of 16 OK created sql view model public_crm.t_sales_funnel_monthly_columns ... [[32mCREATE VIEW[0m in 0.06s]
[0m20:51:31.114980 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:51:31.114980 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:51:31.114980 [info ] [Thread-1  ]: 14 of 16 START sql view model public_crm.t_sales_funnel_monthly_rows ........... [RUN]
[0m20:51:31.114980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_columns, now model.enpal_assessment_project.t_sales_funnel_monthly_rows)
[0m20:51:31.114980 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:51:31.114980 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:51:31.114980 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:51:31.114980 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:51:31.114980 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:51:31.114980 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m20:51:31.114980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:31.146723 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m20:51:31.147542 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:51:31.148045 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m20:51:31.155542 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:51:31.158040 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:51:31.158040 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp" rename to "t_sales_funnel_monthly_rows"
[0m20:51:31.158040 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:31.163355 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:51:31.164445 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:51:31.166706 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m20:51:31.171110 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:51:31.171110 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup"
[0m20:51:31.171110 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:51:31.171110 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup" cascade
[0m20:51:31.171110 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:31.171110 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m20:51:31.179576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779F34CDF0>]}
[0m20:51:31.180577 [info ] [Thread-1  ]: 14 of 16 OK created sql view model public_crm.t_sales_funnel_monthly_rows ...... [[32mCREATE VIEW[0m in 0.06s]
[0m20:51:31.181795 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:51:31.181795 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:51:31.181795 [info ] [Thread-1  ]: 15 of 16 START sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [RUN]
[0m20:51:31.181795 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_rows, now model.enpal_assessment_project.rep_sales_funnel_monthly_columns)
[0m20:51:31.181795 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:51:31.181795 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:51:31.181795 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:51:31.181795 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:51:31.181795 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:51:31.181795 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: BEGIN
[0m20:51:31.181795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:31.266631 [debug] [Thread-1  ]: SQL status: BEGIN in 0.072 seconds
[0m20:51:31.267220 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:51:31.267846 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_tmp"
  
  
    as
  
  (
    SELECT 
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,COALESCE(deals_count, 0) AS deals_count
  ,COALESCE(ROUND(avg_users_per_deal::numeric, 2), 0) AS avg_users_per_deal
  ,COALESCE(ROUND(conversion_rate::numeric, 2), 0) AS converstion_rate
FROM "postgres"."public_crm"."t_sales_funnel_monthly_columns"
-- ORDER BY 
--    month 
--   ,stage_id
  );
  
[0m20:51:31.366070 [debug] [Thread-1  ]: SQL status: SELECT 132 in 0.100 seconds
[0m20:51:31.366070 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:51:31.366070 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_tmp" rename to "rep_sales_funnel_monthly_columns"
[0m20:51:31.366070 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:31.366070 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: COMMIT
[0m20:51:31.366070 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:51:31.366070 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: COMMIT
[0m20:51:31.377670 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:51:31.377670 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_backup"
[0m20:51:31.377670 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:51:31.377670 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */
drop table if exists "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_backup" cascade
[0m20:51:31.377670 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:51:31.377670 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: Close
[0m20:51:31.377670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779F2CA460>]}
[0m20:51:31.377670 [info ] [Thread-1  ]: 15 of 16 OK created sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [[32mSELECT 132[0m in 0.20s]
[0m20:51:31.377670 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:51:31.391597 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:51:31.391790 [info ] [Thread-1  ]: 16 of 16 START sql table model public_marts_crm.rep_sales_funnel_monthly ....... [RUN]
[0m20:51:31.391790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly_columns, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m20:51:31.391790 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:51:31.391790 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:51:31.391790 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:51:31.391790 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:51:31.391790 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:51:31.391790 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m20:51:31.391790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:31.420451 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m20:51:31.425960 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:51:31.426677 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    SELECT
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,funnel_kpi
  ,COALESCE(CASE WHEN funnel_kpi IN ('avg_users_per_deal','conversion_rate')
     THEN ROUND(kpi_value::numeric, 2)
     ELSE kpi_value
   END,0) AS kpi_value
FROM "postgres"."public_crm"."t_sales_funnel_monthly_rows"
-- ORDER BY 
--    month 
--   ,stage_id
--   ,funnel_kpi
  );
  
[0m20:51:31.525016 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.098 seconds
[0m20:51:31.528709 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:51:31.530346 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m20:51:31.530346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:31.530346 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m20:51:31.530346 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:51:31.530346 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m20:51:31.530346 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:51:31.530346 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_backup"
[0m20:51:31.530346 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:51:31.530346 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m20:51:31.545415 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:51:31.545415 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m20:51:31.545415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e99852-a2c3-4ce9-b68d-5052d338d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779F36A880>]}
[0m20:51:31.545415 [info ] [Thread-1  ]: 16 of 16 OK created sql table model public_marts_crm.rep_sales_funnel_monthly .. [[32mSELECT 396[0m in 0.15s]
[0m20:51:31.545415 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:51:31.545415 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:31.545415 [debug] [MainThread]: On master: BEGIN
[0m20:51:31.545415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:31.577753 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m20:51:31.578897 [debug] [MainThread]: On master: COMMIT
[0m20:51:31.578897 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:31.579479 [debug] [MainThread]: On master: COMMIT
[0m20:51:31.581262 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:51:31.581578 [debug] [MainThread]: On master: Close
[0m20:51:31.582727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:31.583255 [debug] [MainThread]: Connection 'create_postgres_public_crm' was properly closed.
[0m20:51:31.583888 [debug] [MainThread]: Connection 'list_postgres_public_crm' was properly closed.
[0m20:51:31.584434 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m20:51:31.585066 [info ] [MainThread]: 
[0m20:51:31.585684 [info ] [MainThread]: Finished running 1 incremental model, 2 snapshots, 5 table models, 8 view models in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m20:51:31.588943 [debug] [MainThread]: Command end result
[0m20:51:31.603215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:51:31.615114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:51:31.620356 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:51:31.620356 [info ] [MainThread]: 
[0m20:51:31.620356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:31.620356 [info ] [MainThread]: 
[0m20:51:31.620356 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m20:51:31.620356 [debug] [MainThread]: Command `dbt build` succeeded at 20:51:31.620356 after 3.29 seconds
[0m20:51:31.629708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779B325FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779C6E2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779DC8A9A0>]}
[0m20:51:31.629708 [debug] [MainThread]: Flushing usage events
[0m20:51:32.226162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:52.370705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019E9F2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A094E8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A094E970>]}


============================== 20:53:52.386341 | 47fec783-d8b4-4f7e-8469-367f0c602a5f ==============================
[0m20:53:52.386341 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:53:52.386341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m20:53:52.535719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47fec783-d8b4-4f7e-8469-367f0c602a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019D2AA790>]}
[0m20:53:52.582578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47fec783-d8b4-4f7e-8469-367f0c602a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019DD38040>]}
[0m20:53:52.582578 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:53:52.754847 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m20:53:52.923063 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m20:53:52.923063 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\test_model.sql
[0m20:53:53.003837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47fec783-d8b4-4f7e-8469-367f0c602a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A10AC130>]}
[0m20:53:53.036089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47fec783-d8b4-4f7e-8469-367f0c602a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A10ECC40>]}
[0m20:53:53.036089 [info ] [MainThread]: Found 13 models, 2 snapshots, 6 sources, 428 macros
[0m20:53:53.036089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47fec783-d8b4-4f7e-8469-367f0c602a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A10ECB80>]}
[0m20:53:53.036089 [info ] [MainThread]: 
[0m20:53:53.036089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:53.036089 [info ] [MainThread]: 
[0m20:53:53.046228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:53.057269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_crm'
[0m20:53:53.127594 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:53:53.128597 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m20:53:53.128597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:53.342399 [debug] [ThreadPool]: SQL status: BEGIN in 0.217 seconds
[0m20:53:53.347678 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m20:53:53.348200 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m20:53:53.355092 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m20:53:53.356590 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m20:53:53.359290 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m20:53:53.359290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_staging)
[0m20:53:53.361296 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:53:53.363647 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:53:53.363647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:53.383396 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m20:53:53.384130 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:53:53.384824 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:53:53.390403 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m20:53:53.391902 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:53:53.394404 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:53:53.395404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts_crm)
[0m20:53:53.395404 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:53:53.395404 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m20:53:53.395404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:53.419202 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:53:53.420836 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m20:53:53.421344 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m20:53:53.426344 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m20:53:53.427957 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m20:53:53.429745 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m20:53:53.430850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts_crm, now list_postgres_public)
[0m20:53:53.433392 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:53.434478 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:53:53.434478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:53.471244 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m20:53:53.471873 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:53:53.472385 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:53:53.477210 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:53:53.478444 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:53:53.480104 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:53:53.486842 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:53.486842 [debug] [MainThread]: On master: BEGIN
[0m20:53:53.487397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:53.509390 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:53:53.510496 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:53.511004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:53:53.517504 [debug] [MainThread]: SQL status: SELECT 15 in 0.006 seconds
[0m20:53:53.521605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47fec783-d8b4-4f7e-8469-367f0c602a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019D32F9A0>]}
[0m20:53:53.522584 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:53.524595 [debug] [MainThread]: On master: Close
[0m20:53:53.536979 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m20:53:53.536979 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m20:53:53.537986 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m20:53:53.538606 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m20:53:53.538606 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m20:53:53.538606 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m20:53:53.538606 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m20:53:53.538606 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m20:53:53.538606 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m20:53:53.538606 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m20:53:53.538606 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m20:53:53.538606 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m20:53:53.538606 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:53:53.538606 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m20:53:53.538606 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:53:53.554342 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:53:53.554342 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:53:53.554342 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:53:53.554342 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m20:53:53.554342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m20:53:53.554342 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m20:53:53.554342 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m20:53:53.554342 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m20:53:53.554342 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m20:53:53.554342 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m20:53:53.554342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m20:53:53.554342 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m20:53:53.569871 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m20:53:53.569871 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m20:53:53.573296 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m20:53:53.573296 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m20:53:53.573296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now snapshot.enpal_assessment_project.sn_activities)
[0m20:53:53.573296 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m20:53:53.573296 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m20:53:53.573296 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m20:53:53.573296 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m20:53:53.573296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m20:53:53.573296 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m20:53:53.573296 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m20:53:53.573296 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m20:53:53.573296 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m20:53:53.573296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_users, now model.enpal_assessment_project.t_user_deal_events)
[0m20:53:53.573296 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m20:53:53.573296 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m20:53:53.573296 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m20:53:53.573296 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m20:53:53.573296 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:53:53.573296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m20:53:53.573296 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:53:53.589711 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m20:53:53.589711 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:53:53.589711 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m20:53:53.589711 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m20:53:53.589711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_activities)
[0m20:53:53.589711 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m20:53:53.589711 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m20:53:53.589711 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m20:53:53.589711 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m20:53:53.589711 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:53:53.589711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_funnel_events)
[0m20:53:53.589711 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m20:53:53.605457 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m20:53:53.605457 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m20:53:53.605457 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m20:53:53.605457 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:53:53.605457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_sales_funnel_monthly_columns)
[0m20:53:53.605457 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:53:53.605457 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m20:53:53.605457 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:53:53.605457 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m20:53:53.605457 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:53:53.605457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_columns, now model.enpal_assessment_project.t_sales_funnel_monthly_rows)
[0m20:53:53.605457 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:53:53.605457 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m20:53:53.605457 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:53:53.605457 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m20:53:53.621068 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:53:53.621068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_rows, now model.enpal_assessment_project.rep_sales_funnel_monthly_columns)
[0m20:53:53.621068 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:53:53.621068 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m20:53:53.621068 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:53:53.621068 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m20:53:53.621068 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:53:53.621068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly_columns, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m20:53:53.621068 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:53:53.621068 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m20:53:53.621068 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:53:53.621068 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m20:53:53.621068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:53.621068 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m20:53:53.621068 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m20:53:53.636693 [debug] [MainThread]: Command end result
[0m20:53:53.790708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:53.790708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:53.807074 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m20:53:53.807074 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:53:53.807074 [info ] [MainThread]: Building catalog
[0m20:53:53.824526 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m20:53:53.829391 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m20:53:53.829391 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m20:53:53.829391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:53.851352 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m20:53:53.851733 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m20:53:53.852235 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_fields')) or (upper(sch.nspname) = upper('public_crm') and
           upper(tbl.relname) = upper('t_activities')) or (upper(sch.nspname) = upper('public_crm') and
           upper(tbl.relname) = upper('t_deal_lost_reasons')) or (upper(sch.nspname) = upper('public_marts_crm') and
           upper(tbl.relname) = upper('rep_sales_funnel_monthly_columns')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('deal_changes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('activity_types')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('activity')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stages')) or (upper(sch.nspname) = upper('public_crm') and
           upper(tbl.relname) = upper('t_user_deal_events')) or (upper(sch.nspname) = upper('public_crm') and
           upper(tbl.relname) = upper('t_deal_funnel_events')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('sn_users')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_stages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('calendar_')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fields')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_deal_changes')) or (upper(sch.nspname) = upper('public_crm') and
           upper(tbl.relname) = upper('t_sales_funnel_monthly_rows')) or (upper(sch.nspname) = upper('public_marts_crm') and
           upper(tbl.relname) = upper('rep_sales_funnel_monthly')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_activity_types')) or (upper(sch.nspname) = upper('public_crm') and
           upper(tbl.relname) = upper('t_sales_funnel_monthly_columns')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('sn_activities')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:53:53.859231 [debug] [ThreadPool]: SQL status: SELECT 97 in 0.006 seconds
[0m20:53:53.866857 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m20:53:53.867843 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m20:53:53.884904 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\catalog.json
[0m20:53:53.905533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m20:53:53.906032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m20:53:53.906032 [info ] [MainThread]: Catalog written to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\catalog.json
[0m20:53:53.906032 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:53:53.906032 after 1.57 seconds
[0m20:53:53.906032 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:53:53.906032 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m20:53:53.906032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019E9F2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A0E8BA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019FE3A1C0>]}
[0m20:53:53.906032 [debug] [MainThread]: Flushing usage events
[0m20:53:54.371869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:59.393680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F29371FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2B2F16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2B2F1760>]}


============================== 20:53:59.409371 | b4e66944-a0b1-47db-bd1d-2e865755c267 ==============================
[0m20:53:59.409371 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m20:53:59.409371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:53:59.568309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4e66944-a0b1-47db-bd1d-2e865755c267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F27C3A6D0>]}
[0m20:53:59.616553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4e66944-a0b1-47db-bd1d-2e865755c267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2B140940>]}
[0m10:12:42.265922 [error] [MainThread]: Encountered an error:

[0m10:12:42.266415 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m10:12:42.284800 [debug] [MainThread]: Command `dbt docs serve` failed at 10:12:42.284800 after 47933.05 seconds
[0m10:12:42.284800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F29371FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2B6FB640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2B6FB6A0>]}
[0m10:12:42.284800 [debug] [MainThread]: Flushing usage events
[0m10:12:42.989041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:27.669364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69E535FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A04A6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A04A68E0>]}


============================== 10:22:27.673149 | 5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040 ==============================
[0m10:22:27.673149 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m10:22:27.673149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:22:27.913263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69D852970>]}
[0m10:22:27.962923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69D889B80>]}
[0m10:22:27.962923 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:22:28.163079 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m10:22:28.359038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:22:28.359038 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m10:22:28.783792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A0F52130>]}
[0m10:22:28.895455 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:22:28.895455 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:22:29.022017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A0BA9220>]}
[0m10:22:29.022017 [info ] [MainThread]: Found 13 models, 2 snapshots, 4 data tests, 6 sources, 428 macros
[0m10:22:29.022017 [info ] [MainThread]: 
[0m10:22:29.033576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:29.033975 [info ] [MainThread]: 
[0m10:22:29.033975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:22:29.033975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:22:29.131592 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:22:29.131592 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:22:29.131592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:29.183419 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.048 seconds
[0m10:22:29.183419 [debug] [ThreadPool]: On list_postgres: Close
[0m10:22:29.183419 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:22:29.183419 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:22:29.183419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:29.203642 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m10:22:29.212986 [debug] [ThreadPool]: On list_postgres: Close
[0m10:22:29.212986 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:22:29.212986 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:22:29.212986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:29.233751 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m10:22:29.243135 [debug] [ThreadPool]: On list_postgres: Close
[0m10:22:29.243135 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:22:29.243135 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:22:29.243135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:29.262977 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m10:22:29.272967 [debug] [ThreadPool]: On list_postgres: Close
[0m10:22:29.272967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m10:22:29.272967 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:22:29.272967 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m10:22:29.272967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:29.313017 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m10:22:29.313974 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:22:29.314610 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:22:29.319121 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:22:29.320620 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m10:22:29.322119 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m10:22:29.323074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m10:22:29.326619 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:22:29.327120 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m10:22:29.327120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:29.354306 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m10:22:29.354819 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:22:29.355220 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m10:22:29.358732 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m10:22:29.359733 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m10:22:29.361233 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m10:22:29.362489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m10:22:29.365084 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:22:29.365084 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:22:29.365714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:29.393383 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m10:22:29.394229 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:22:29.394344 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:22:29.398882 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m10:22:29.399881 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:22:29.401881 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:22:29.402881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_marts_crm)
[0m10:22:29.405470 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:22:29.405470 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m10:22:29.405470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:29.435012 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m10:22:29.435724 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:22:29.435724 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m10:22:29.435724 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m10:22:29.435724 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m10:22:29.435724 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m10:22:29.443071 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:29.443071 [debug] [MainThread]: On master: BEGIN
[0m10:22:29.443071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:29.473692 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m10:22:29.474196 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:29.474992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:22:29.480220 [debug] [MainThread]: SQL status: SELECT 15 in 0.005 seconds
[0m10:22:29.484016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A2377B50>]}
[0m10:22:29.484016 [debug] [MainThread]: On master: ROLLBACK
[0m10:22:29.485207 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:29.485207 [debug] [MainThread]: On master: BEGIN
[0m10:22:29.485207 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:22:29.488726 [debug] [MainThread]: On master: COMMIT
[0m10:22:29.489756 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:29.489899 [debug] [MainThread]: On master: COMMIT
[0m10:22:29.492289 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:22:29.492409 [debug] [MainThread]: On master: Close
[0m10:22:29.498990 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m10:22:29.499579 [info ] [Thread-1  ]: 1 of 19 START sql view model public.calendar_ .................................. [RUN]
[0m10:22:29.500025 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m10:22:29.500949 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m10:22:29.500949 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m10:22:29.500949 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m10:22:29.533691 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m10:22:29.533691 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:22:29.533691 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m10:22:29.533691 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:22:29.556786 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:22:29.558477 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:22:29.558743 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m10:22:29.561745 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:22:29.567842 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:22:29.567842 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m10:22:29.567842 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:29.567842 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:22:29.567842 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m10:22:29.567842 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:29.583556 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:22:29.583556 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:22:29.583556 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:22:29.595316 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m10:22:29.598443 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m10:22:29.598443 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:22:29.598443 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m10:22:29.598443 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.006 seconds
[0m10:22:29.598443 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m10:22:29.614676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69FFBEA90>]}
[0m10:22:29.614676 [info ] [Thread-1  ]: 1 of 19 OK created sql view model public.calendar_ ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m10:22:29.614676 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m10:22:29.614676 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m10:22:29.614676 [info ] [Thread-1  ]: 2 of 19 START sql table model public_staging.stg_activity_types ................ [RUN]
[0m10:22:29.614676 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m10:22:29.614676 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m10:22:29.623287 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.623287 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m10:22:29.631273 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.643513 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.643913 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m10:22:29.644623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:29.676155 [debug] [Thread-1  ]: SQL status: BEGIN in 0.033 seconds
[0m10:22:29.679034 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.679034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m10:22:29.682261 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:22:29.686470 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.686971 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m10:22:29.688468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:22:29.689967 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.689967 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m10:22:29.689967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:29.689967 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:22:29.689967 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.698541 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:22:29.703333 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:22:29.703333 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m10:22:29.703333 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:22:29.703333 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m10:22:29.714509 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m10:22:29.714509 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m10:22:29.714509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69FFBEA90>]}
[0m10:22:29.714509 [info ] [Thread-1  ]: 2 of 19 OK created sql table model public_staging.stg_activity_types ........... [[32mSELECT 4[0m in 0.10s]
[0m10:22:29.714509 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m10:22:29.714509 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m10:22:29.714509 [info ] [Thread-1  ]: 3 of 19 START sql incremental model public_staging.stg_deal_changes ............ [RUN]
[0m10:22:29.714509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m10:22:29.714509 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m10:22:29.723148 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.723148 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m10:22:29.749345 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.749345 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp102229743454"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m10:22:29.749345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:29.775700 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.024 seconds
[0m10:22:29.783633 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.783633 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m10:22:29.795317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m10:22:29.796131 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.796243 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp102229743454'
        
      order by ordinal_position

  
[0m10:22:29.797727 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.006 seconds
[0m10:22:29.805837 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.805837 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:29.805837 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:22:29.813729 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.813729 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:29.821947 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:22:29.833346 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.833346 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.833346 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp102229743454"
            where (
                
                    "stg_deal_changes__dbt_tmp102229743454".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp102229743454".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp102229743454".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp102229743454"
    )
  
[0m10:22:29.843221 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m10:22:29.843724 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:22:29.843724 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:22:29.843724 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:22:29.843724 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:22:29.843724 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m10:22:29.852796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A2315250>]}
[0m10:22:29.852796 [info ] [Thread-1  ]: 3 of 19 OK created sql incremental model public_staging.stg_deal_changes ....... [[32mINSERT 0 0[0m in 0.14s]
[0m10:22:29.852796 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m10:22:29.852796 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m10:22:29.852796 [info ] [Thread-1  ]: 4 of 19 START sql table model public_staging.stg_fields ........................ [RUN]
[0m10:22:29.852796 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m10:22:29.852796 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m10:22:29.852796 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m10:22:29.852796 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m10:22:29.864390 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m10:22:29.864390 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:22:29.864390 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m10:22:29.864390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:29.890090 [debug] [Thread-1  ]: SQL status: BEGIN in 0.028 seconds
[0m10:22:29.897722 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:22:29.898295 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m10:22:29.902815 [debug] [Thread-1  ]: SQL status: SELECT 16 in 0.004 seconds
[0m10:22:29.905863 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:22:29.906372 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m10:22:29.907778 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:29.908869 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:22:29.908869 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m10:22:29.908869 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:29.908869 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m10:22:29.908869 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:22:29.914795 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m10:22:29.915931 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:22:29.915931 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m10:22:29.915931 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:22:29.915931 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m10:22:29.924018 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m10:22:29.924018 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m10:22:29.924018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A0CE3370>]}
[0m10:22:29.924018 [info ] [Thread-1  ]: 4 of 19 OK created sql table model public_staging.stg_fields ................... [[32mSELECT 16[0m in 0.07s]
[0m10:22:29.931892 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m10:22:29.931892 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m10:22:29.933182 [info ] [Thread-1  ]: 5 of 19 START sql table model public_staging.stg_stages ........................ [RUN]
[0m10:22:29.933826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m10:22:29.933826 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m10:22:29.933826 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m10:22:29.933826 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m10:22:29.933826 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m10:22:29.933826 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:22:29.933826 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m10:22:29.933826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:29.963096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m10:22:29.963910 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:22:29.964435 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m10:22:29.968115 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m10:22:29.972377 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:22:29.973005 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m10:22:29.974849 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:22:29.975943 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:22:29.975943 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m10:22:29.975943 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:22:29.982726 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:22:29.982726 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:22:29.982726 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:22:29.982726 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m10:22:29.982726 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m10:22:29.982726 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:22:29.982726 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m10:22:29.998027 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m10:22:29.998027 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m10:22:29.998027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A0BFD9A0>]}
[0m10:22:29.998027 [info ] [Thread-1  ]: 5 of 19 OK created sql table model public_staging.stg_stages ................... [[32mSELECT 9[0m in 0.06s]
[0m10:22:29.998027 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m10:22:29.998027 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m10:22:29.998027 [info ] [Thread-1  ]: 6 of 19 START snapshot public_staging.sn_activities ............................ [RUN]
[0m10:22:29.998027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now snapshot.enpal_assessment_project.sn_activities)
[0m10:22:29.998027 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m10:22:30.006077 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m10:22:30.053325 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.053325 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m10:22:30.053325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.067134 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.023 seconds
[0m10:22:30.081265 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.081265 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m10:22:30.084486 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m10:22:30.084992 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.085315 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:30.091824 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.006 seconds
[0m10:22:30.096509 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.096509 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:30.096509 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:22:30.123143 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.123143 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp102230123143"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m10:22:30.140261 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.018 seconds
[0m10:22:30.148466 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.149070 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102230123143'
        
      order by ordinal_position

  
[0m10:22:30.150506 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.004 seconds
[0m10:22:30.150506 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.150506 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:30.159178 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:22:30.159178 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.159178 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102230123143'
        
      order by ordinal_position

  
[0m10:22:30.164654 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m10:22:30.164654 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.164654 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:30.174160 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:22:30.174160 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.174160 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102230123143'
        
      order by ordinal_position

  
[0m10:22:30.183803 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.004 seconds
[0m10:22:30.183803 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.183803 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m10:22:30.199688 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:22:30.203372 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.203372 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m10:22:30.203372 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m10:22:30.203372 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.203372 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.203372 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp102230123143" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp102230123143" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m10:22:30.203372 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:22:30.203372 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m10:22:30.203372 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:22:30.203372 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m10:22:30.213130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:22:30.213130 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m10:22:30.213130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A2457250>]}
[0m10:22:30.213130 [info ] [Thread-1  ]: 6 of 19 OK snapshotted public_staging.sn_activities ............................ [[32mINSERT 0 0[0m in 0.22s]
[0m10:22:30.213130 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m10:22:30.213130 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m10:22:30.213130 [info ] [Thread-1  ]: 7 of 19 START snapshot public_staging.sn_users ................................. [RUN]
[0m10:22:30.213130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m10:22:30.213130 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m10:22:30.223171 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m10:22:30.223171 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.223171 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m10:22:30.223171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.253044 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m10:22:30.254044 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.254875 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:30.261237 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m10:22:30.265897 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.265897 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp102230264470"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m10:22:30.265897 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m10:22:30.265897 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.265897 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102230264470'
        
      order by ordinal_position

  
[0m10:22:30.265897 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:22:30.283856 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.283856 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:30.283856 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m10:22:30.292793 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.293271 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102230264470'
        
      order by ordinal_position

  
[0m10:22:30.293271 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:22:30.297918 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.297918 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:22:30.303203 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m10:22:30.303203 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.303203 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102230264470'
        
      order by ordinal_position

  
[0m10:22:30.303203 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:22:30.311949 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.313471 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m10:22:30.313471 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:22:30.313471 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.313471 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m10:22:30.313471 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m10:22:30.313471 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.313471 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.321484 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp102230264470" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp102230264470" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m10:22:30.322896 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:22:30.322896 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m10:22:30.322896 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:22:30.322896 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m10:22:30.322896 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:22:30.330933 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m10:22:30.331702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A2457250>]}
[0m10:22:30.332202 [info ] [Thread-1  ]: 7 of 19 OK snapshotted public_staging.sn_users ................................. [[32mINSERT 0 0[0m in 0.12s]
[0m10:22:30.334365 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m10:22:30.334365 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:22:30.335363 [info ] [Thread-1  ]: 8 of 19 START test accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call  [RUN]
[0m10:22:30.337172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_users, now test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe)
[0m10:22:30.337172 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:22:30.342648 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:22:30.342648 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:22:30.348123 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:22:30.348123 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:22:30.348123 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: BEGIN
[0m10:22:30.348123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.379143 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m10:22:30.379931 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:22:30.380381 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        type as value_field,
        count(*) as n_records

    from "postgres"."public_staging"."stg_activity_types"
    group by type

)

select *
from all_values
where value_field not in (
    'meeting','sc2','follow_up','after_close_call'
)



      
    ) dbt_internal_test
[0m10:22:30.383954 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m10:22:30.387456 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: ROLLBACK
[0m10:22:30.389453 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: Close
[0m10:22:30.389953 [error] [Thread-1  ]: 8 of 19 FAIL 1 accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call  [[31mFAIL 1[0m in 0.05s]
[0m10:22:30.391599 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:22:30.391599 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80
[0m10:22:30.392786 [debug] [Thread-4  ]: Marking all children of 'test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m10:22:30.392786 [info ] [Thread-1  ]: 9 of 19 START test not_null_stg_activity_types_assigned_to_user ................ [RUN]
[0m10:22:30.392786 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe, now test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80)
[0m10:22:30.392786 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80
[0m10:22:30.401320 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80"
[0m10:22:30.401320 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80
[0m10:22:30.401320 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80"
[0m10:22:30.409507 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80"
[0m10:22:30.410478 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80: BEGIN
[0m10:22:30.410478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.416494 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m10:22:30.428631 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80"
[0m10:22:30.429131 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select assigned_to_user
from "postgres"."public_staging"."stg_activity_types"
where assigned_to_user is null



      
    ) dbt_internal_test
[0m10:22:30.430633 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "assigned_to_user" does not exist
LINE 13: select assigned_to_user
                ^

[0m10:22:30.431681 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80: ROLLBACK
[0m10:22:30.434230 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80: Close
[0m10:22:30.444632 [debug] [Thread-1  ]: Database Error in test not_null_stg_activity_types_assigned_to_user (models\staging\pipedrive\pipedrive.yml)
  column "assigned_to_user" does not exist
  LINE 13: select assigned_to_user
                  ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\pipedrive.yml\not_null_stg_activity_types_assigned_to_user.sql
[0m10:22:30.444632 [error] [Thread-1  ]: 9 of 19 ERROR not_null_stg_activity_types_assigned_to_user ..................... [[31mERROR[0m in 0.05s]
[0m10:22:30.444632 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80
[0m10:22:30.444632 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:22:30.452718 [debug] [Thread-4  ]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_activity_types_assigned_to_user (models\staging\pipedrive\pipedrive.yml)
  column "assigned_to_user" does not exist
  LINE 13: select assigned_to_user
                  ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\pipedrive.yml\not_null_stg_activity_types_assigned_to_user.sql.
[0m10:22:30.453219 [info ] [Thread-1  ]: 10 of 19 START test not_null_stg_deal_changes_change_time ...................... [RUN]
[0m10:22:30.453219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_assigned_to_user.e1002cec80, now test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d)
[0m10:22:30.453219 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:22:30.453219 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:22:30.453219 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:22:30.463309 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:22:30.463309 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:22:30.463309 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: BEGIN
[0m10:22:30.463309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.484078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m10:22:30.486886 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:22:30.487305 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_staging"."stg_deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m10:22:30.490843 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m10:22:30.492149 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: ROLLBACK
[0m10:22:30.494485 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: Close
[0m10:22:30.495074 [info ] [Thread-1  ]: 10 of 19 PASS not_null_stg_deal_changes_change_time ............................ [[32mPASS[0m in 0.04s]
[0m10:22:30.496141 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:22:30.497287 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:22:30.497789 [info ] [Thread-1  ]: 11 of 19 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m10:22:30.497789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m10:22:30.497789 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:22:30.499842 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:22:30.499842 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:22:30.499842 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:22:30.509116 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:22:30.509116 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m10:22:30.509116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.545247 [debug] [Thread-1  ]: SQL status: BEGIN in 0.034 seconds
[0m10:22:30.545719 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:22:30.546251 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_staging"."stg_deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m10:22:30.548726 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m10:22:30.551241 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m10:22:30.553229 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m10:22:30.554226 [info ] [Thread-1  ]: 11 of 19 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.06s]
[0m10:22:30.555227 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:22:30.556227 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m10:22:30.557299 [info ] [Thread-1  ]: 12 of 19 SKIP relation public_crm.t_activities ................................. [[33mSKIP[0m]
[0m10:22:30.557544 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m10:22:30.557544 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:22:30.557544 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_activities' to be skipped because of status 'skipped'. 
[0m10:22:30.557544 [info ] [Thread-1  ]: 13 of 19 START sql view model public_crm.t_deal_lost_reasons ................... [RUN]
[0m10:22:30.560349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m10:22:30.560349 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:22:30.560349 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:22:30.560349 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:22:30.566799 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:22:30.566799 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:22:30.566799 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m10:22:30.566799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.591071 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:22:30.591741 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:22:30.592376 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m10:22:30.595659 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:22:30.598158 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:22:30.598658 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m10:22:30.601171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:22:30.602659 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m10:22:30.602659 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:22:30.602659 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m10:22:30.602659 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:22:30.602659 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m10:22:30.602659 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:22:30.602659 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m10:22:30.602659 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m10:22:30.614619 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m10:22:30.615799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A2602760>]}
[0m10:22:30.616117 [info ] [Thread-1  ]: 13 of 19 OK created sql view model public_crm.t_deal_lost_reasons .............. [[32mCREATE VIEW[0m in 0.05s]
[0m10:22:30.616117 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:22:30.616117 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m10:22:30.616117 [info ] [Thread-1  ]: 14 of 19 START sql view model public_crm.t_user_deal_events .................... [RUN]
[0m10:22:30.616117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_user_deal_events)
[0m10:22:30.616117 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m10:22:30.616117 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.616117 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m10:22:30.625064 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.625064 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.625064 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m10:22:30.625064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:30.633688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m10:22:30.645781 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.646687 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m10:22:30.649579 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:22:30.653579 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.654081 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events" rename to "t_user_deal_events__dbt_backup"
[0m10:22:30.655579 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:30.657079 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.657079 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m10:22:30.657079 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:30.657079 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:22:30.657079 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.657079 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:22:30.664393 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:22:30.666152 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m10:22:30.666152 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:22:30.666152 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m10:22:30.674184 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m10:22:30.674401 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m10:22:30.674401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b1a5e-40f8-4fe5-a5ae-bda6d1db0040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A24C0340>]}
[0m10:22:30.674401 [info ] [Thread-1  ]: 14 of 19 OK created sql view model public_crm.t_user_deal_events ............... [[32mCREATE VIEW[0m in 0.06s]
[0m10:22:30.674401 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m10:22:30.674401 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:22:30.674401 [info ] [Thread-1  ]: 15 of 19 SKIP relation public_crm.t_deal_funnel_events ......................... [[33mSKIP[0m]
[0m10:22:30.674401 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:22:30.674401 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_funnel_events' to be skipped because of status 'skipped'. 
[0m10:22:30.681003 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:22:30.681003 [info ] [Thread-1  ]: 16 of 19 SKIP relation public_crm.t_sales_funnel_monthly_columns ............... [[33mSKIP[0m]
[0m10:22:30.682078 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:22:30.683399 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:22:30.683920 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' to be skipped because of status 'skipped'. 
[0m10:22:30.683920 [info ] [Thread-1  ]: 17 of 19 SKIP relation public_crm.t_sales_funnel_monthly_rows .................. [[33mSKIP[0m]
[0m10:22:30.683920 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:22:30.683920 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' to be skipped because of status 'skipped'. 
[0m10:22:30.683920 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:22:30.683920 [info ] [Thread-1  ]: 18 of 19 SKIP relation public_marts_crm.rep_sales_funnel_monthly_columns ....... [[33mSKIP[0m]
[0m10:22:30.683920 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:22:30.683920 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:22:30.683920 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly_columns' to be skipped because of status 'skipped'. 
[0m10:22:30.683920 [info ] [Thread-1  ]: 19 of 19 SKIP relation public_marts_crm.rep_sales_funnel_monthly ............... [[33mSKIP[0m]
[0m10:22:30.683920 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:22:30.683920 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly' to be skipped because of status 'skipped'. 
[0m10:22:30.683920 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:30.683920 [debug] [MainThread]: On master: BEGIN
[0m10:22:30.683920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:30.707619 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:22:30.708444 [debug] [MainThread]: On master: COMMIT
[0m10:22:30.708709 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:30.709368 [debug] [MainThread]: On master: COMMIT
[0m10:22:30.711025 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:22:30.711025 [debug] [MainThread]: On master: Close
[0m10:22:30.711555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:30.712076 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:22:30.712622 [debug] [MainThread]: Connection 'list_postgres_public_marts_crm' was properly closed.
[0m10:22:30.713142 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_user_deal_events' was properly closed.
[0m10:22:30.713710 [info ] [MainThread]: 
[0m10:22:30.714765 [info ] [MainThread]: Finished running 1 incremental model, 2 snapshots, 5 table models, 4 data tests, 7 view models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m10:22:30.718550 [debug] [MainThread]: Command end result
[0m10:22:30.742021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:22:30.743561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:22:30.753380 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m10:22:30.753380 [info ] [MainThread]: 
[0m10:22:30.753380 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successs, and 0 warnings:[0m
[0m10:22:30.753380 [info ] [MainThread]: 
[0m10:22:30.753380 [error] [MainThread]: [31mFailure in test accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call (models\staging\pipedrive\pipedrive.yml)[0m
[0m10:22:30.753380 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:22:30.753380 [info ] [MainThread]: 
[0m10:22:30.753380 [info ] [MainThread]:   compiled code at target\compiled\enpal_assessment_project\models\staging\pipedrive\pipedrive.yml\accepted_values_stg_activity_t_132db2580fce30ab445b22841035ae0b.sql
[0m10:22:30.753380 [info ] [MainThread]: 
[0m10:22:30.753380 [error] [MainThread]:   Database Error in test not_null_stg_activity_types_assigned_to_user (models\staging\pipedrive\pipedrive.yml)
  column "assigned_to_user" does not exist
  LINE 13: select assigned_to_user
                  ^
  compiled code at target\run\enpal_assessment_project\models\staging\pipedrive\pipedrive.yml\not_null_stg_activity_types_assigned_to_user.sql
[0m10:22:30.761109 [info ] [MainThread]: 
[0m10:22:30.761899 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=6 TOTAL=19
[0m10:22:30.763017 [debug] [MainThread]: Command `dbt build` failed at 10:22:30.763017 after 3.14 seconds
[0m10:22:30.763017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69E535FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69DA99FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69F8E7610>]}
[0m10:22:30.763017 [debug] [MainThread]: Flushing usage events
[0m10:22:31.491307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:54.933756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961A0F1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961C06A7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961C06A8B0>]}


============================== 10:23:54.944098 | b2591488-fd5c-4fc6-b121-617c5d72361c ==============================
[0m10:23:54.944098 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m10:23:54.945799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:55.090651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296194998E0>]}
[0m10:23:55.143358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029619417460>]}
[0m10:23:55.143358 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:23:55.313297 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m10:23:55.493321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:23:55.493321 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m10:23:55.909982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961CAD1130>]}
[0m10:23:56.014359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:23:56.023389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:23:56.087165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961CA13A00>]}
[0m10:23:56.087165 [info ] [MainThread]: Found 13 models, 2 snapshots, 3 data tests, 6 sources, 428 macros
[0m10:23:56.087165 [info ] [MainThread]: 
[0m10:23:56.087165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:56.087165 [info ] [MainThread]: 
[0m10:23:56.087165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:23:56.087165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:23:56.160606 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:23:56.160606 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:23:56.160606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:56.201527 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.037 seconds
[0m10:23:56.201527 [debug] [ThreadPool]: On list_postgres: Close
[0m10:23:56.201527 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:23:56.201527 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:23:56.201527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:56.237329 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.031 seconds
[0m10:23:56.237329 [debug] [ThreadPool]: On list_postgres: Close
[0m10:23:56.237329 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:23:56.242563 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:23:56.243176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:56.273593 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.030 seconds
[0m10:23:56.273593 [debug] [ThreadPool]: On list_postgres: Close
[0m10:23:56.278333 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:23:56.278333 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:23:56.278333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:56.293761 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.016 seconds
[0m10:23:56.293761 [debug] [ThreadPool]: On list_postgres: Close
[0m10:23:56.300477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m10:23:56.304578 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:23:56.304578 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m10:23:56.304578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:56.343336 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m10:23:56.346326 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:23:56.347062 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:23:56.350997 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:23:56.352513 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m10:23:56.354013 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m10:23:56.354619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_crm)
[0m10:23:56.357437 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:23:56.357437 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m10:23:56.357437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:56.359388 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:23:56.375197 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:23:56.375698 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m10:23:56.379322 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m10:23:56.380558 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m10:23:56.382087 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m10:23:56.382728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public)
[0m10:23:56.386168 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:23:56.386168 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:23:56.386679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:56.401754 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:23:56.404024 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:23:56.404499 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:23:56.408007 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m10:23:56.409505 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:23:56.411507 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:23:56.412006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_marts_crm)
[0m10:23:56.415007 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:23:56.415007 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m10:23:56.415007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:56.433934 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:23:56.434685 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:23:56.434810 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m10:23:56.439253 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:23:56.440364 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m10:23:56.442255 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m10:23:56.445254 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:56.445254 [debug] [MainThread]: On master: BEGIN
[0m10:23:56.445254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:56.459974 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:23:56.466696 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:56.467094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:23:56.468133 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m10:23:56.468133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296194B5580>]}
[0m10:23:56.468133 [debug] [MainThread]: On master: ROLLBACK
[0m10:23:56.468133 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:56.468133 [debug] [MainThread]: On master: BEGIN
[0m10:23:56.468133 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:23:56.478565 [debug] [MainThread]: On master: COMMIT
[0m10:23:56.479090 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:56.479253 [debug] [MainThread]: On master: COMMIT
[0m10:23:56.480799 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:23:56.481804 [debug] [MainThread]: On master: Close
[0m10:23:56.485985 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m10:23:56.486418 [info ] [Thread-1  ]: 1 of 18 START sql view model public.calendar_ .................................. [RUN]
[0m10:23:56.487810 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m10:23:56.487810 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m10:23:56.493555 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m10:23:56.493555 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m10:23:56.526515 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m10:23:56.526515 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:23:56.526515 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m10:23:56.526515 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:23:56.546420 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m10:23:56.547267 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:23:56.547783 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m10:23:56.550307 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:23:56.556364 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:23:56.556861 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m10:23:56.557776 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:23:56.561076 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:23:56.561076 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m10:23:56.561076 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:56.576755 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:23:56.576755 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:23:56.576755 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:23:56.584422 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:23:56.584422 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m10:23:56.593298 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:23:56.593599 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m10:23:56.593599 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m10:23:56.593599 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m10:23:56.601683 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961E013F70>]}
[0m10:23:56.601683 [info ] [Thread-1  ]: 1 of 18 OK created sql view model public.calendar_ ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m10:23:56.601683 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m10:23:56.601683 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m10:23:56.601683 [info ] [Thread-1  ]: 2 of 18 START sql table model public_staging.stg_activity_types ................ [RUN]
[0m10:23:56.601683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m10:23:56.601683 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m10:23:56.601683 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.609646 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m10:23:56.627583 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.627583 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.633455 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m10:23:56.633610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:56.663933 [debug] [Thread-1  ]: SQL status: BEGIN in 0.033 seconds
[0m10:23:56.666993 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.667637 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m10:23:56.671000 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:23:56.674500 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.674500 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m10:23:56.676501 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:56.678001 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.678001 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m10:23:56.678001 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:23:56.684795 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:23:56.684795 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.684795 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:23:56.684795 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:23:56.693413 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m10:23:56.693413 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:23:56.693413 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m10:23:56.702737 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m10:23:56.702737 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m10:23:56.702737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961B4A76D0>]}
[0m10:23:56.702737 [info ] [Thread-1  ]: 2 of 18 OK created sql table model public_staging.stg_activity_types ........... [[32mSELECT 4[0m in 0.10s]
[0m10:23:56.702737 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m10:23:56.702737 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m10:23:56.702737 [info ] [Thread-1  ]: 3 of 18 START sql incremental model public_staging.stg_deal_changes ............ [RUN]
[0m10:23:56.702737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m10:23:56.702737 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m10:23:56.710219 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.718351 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m10:23:56.745954 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.745954 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp102356743206"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m10:23:56.745954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:56.773033 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.020 seconds
[0m10:23:56.785942 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.785942 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m10:23:56.785942 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m10:23:56.791637 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.792217 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp102356743206'
        
      order by ordinal_position

  
[0m10:23:56.797306 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.007 seconds
[0m10:23:56.803892 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.803892 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:56.803892 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:23:56.812004 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.812004 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:56.812004 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:23:56.826566 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.826566 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.826566 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp102356743206"
            where (
                
                    "stg_deal_changes__dbt_tmp102356743206".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp102356743206".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp102356743206".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp102356743206"
    )
  
[0m10:23:56.834025 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:23:56.834025 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:23:56.834025 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:23:56.834025 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:23:56.834025 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:23:56.834025 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m10:23:56.842935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961B4A76D0>]}
[0m10:23:56.843702 [info ] [Thread-1  ]: 3 of 18 OK created sql incremental model public_staging.stg_deal_changes ....... [[32mINSERT 0 0[0m in 0.13s]
[0m10:23:56.844787 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m10:23:56.845314 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m10:23:56.845845 [info ] [Thread-1  ]: 4 of 18 START sql table model public_staging.stg_fields ........................ [RUN]
[0m10:23:56.846371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m10:23:56.847014 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m10:23:56.849424 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m10:23:56.850586 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m10:23:56.854752 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m10:23:56.855886 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:23:56.855886 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m10:23:56.856508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:56.871981 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m10:23:56.872767 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:23:56.873295 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m10:23:56.877166 [debug] [Thread-1  ]: SQL status: SELECT 16 in 0.003 seconds
[0m10:23:56.881171 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:23:56.881669 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m10:23:56.883829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:23:56.883829 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:23:56.883829 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m10:23:56.883829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:56.883829 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m10:23:56.883829 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:23:56.883829 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m10:23:56.894355 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:23:56.894355 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m10:23:56.894355 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:23:56.894355 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m10:23:56.903567 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m10:23:56.903567 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m10:23:56.903567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961B4A76D0>]}
[0m10:23:56.903567 [info ] [Thread-1  ]: 4 of 18 OK created sql table model public_staging.stg_fields ................... [[32mSELECT 16[0m in 0.06s]
[0m10:23:56.903567 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m10:23:56.903567 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m10:23:56.903567 [info ] [Thread-1  ]: 5 of 18 START sql table model public_staging.stg_stages ........................ [RUN]
[0m10:23:56.909675 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m10:23:56.909675 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m10:23:56.913479 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m10:23:56.913479 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m10:23:56.913479 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m10:23:56.913479 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:23:56.913479 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m10:23:56.913479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:56.944894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.031 seconds
[0m10:23:56.951215 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:23:56.952075 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m10:23:56.954988 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.002 seconds
[0m10:23:56.957487 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:23:56.957988 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m10:23:56.959299 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:56.963098 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:23:56.963421 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m10:23:56.963421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:56.963421 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:23:56.963421 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:23:56.963421 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:23:56.963421 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:23:56.963421 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m10:23:56.963421 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:23:56.963421 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m10:23:56.976725 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m10:23:56.976725 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m10:23:56.976725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961E0F2CA0>]}
[0m10:23:56.976725 [info ] [Thread-1  ]: 5 of 18 OK created sql table model public_staging.stg_stages ................... [[32mSELECT 9[0m in 0.07s]
[0m10:23:56.983505 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m10:23:56.984016 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m10:23:56.984153 [info ] [Thread-1  ]: 6 of 18 START snapshot public_staging.sn_activities ............................ [RUN]
[0m10:23:56.984153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now snapshot.enpal_assessment_project.sn_activities)
[0m10:23:56.984153 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m10:23:56.984153 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m10:23:57.027968 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.027968 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m10:23:57.027968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:57.052020 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.022 seconds
[0m10:23:57.052020 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.060125 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m10:23:57.062225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m10:23:57.062941 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.063189 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:57.070177 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.006 seconds
[0m10:23:57.073459 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.073459 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:57.073459 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:23:57.101301 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.101301 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp102357101301"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m10:23:57.122787 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.018 seconds
[0m10:23:57.122787 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.122787 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102357101301'
        
      order by ordinal_position

  
[0m10:23:57.122787 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m10:23:57.122787 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.122787 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:57.122787 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:23:57.138550 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.138550 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102357101301'
        
      order by ordinal_position

  
[0m10:23:57.143224 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m10:23:57.143224 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.143224 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:57.143224 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:23:57.153355 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.153355 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102357101301'
        
      order by ordinal_position

  
[0m10:23:57.153355 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m10:23:57.169387 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.169387 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m10:23:57.169387 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:23:57.169387 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.169387 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m10:23:57.169387 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m10:23:57.169387 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.169387 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.169387 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp102357101301" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp102357101301" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m10:23:57.169387 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:23:57.169387 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m10:23:57.169387 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:23:57.169387 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m10:23:57.183558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:23:57.183558 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m10:23:57.183558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961E10D760>]}
[0m10:23:57.183558 [info ] [Thread-1  ]: 6 of 18 OK snapshotted public_staging.sn_activities ............................ [[32mINSERT 0 0[0m in 0.20s]
[0m10:23:57.193334 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m10:23:57.193833 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m10:23:57.194349 [info ] [Thread-1  ]: 7 of 18 START snapshot public_staging.sn_users ................................. [RUN]
[0m10:23:57.194349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m10:23:57.194349 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m10:23:57.194349 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m10:23:57.194349 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.194349 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m10:23:57.194349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:57.222915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m10:23:57.228116 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.229123 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:57.237624 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.008 seconds
[0m10:23:57.239212 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.239212 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp102357239212"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m10:23:57.245314 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m10:23:57.245314 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.245314 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102357239212'
        
      order by ordinal_position

  
[0m10:23:57.245314 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:23:57.260011 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.260011 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:57.260011 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m10:23:57.268408 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.268408 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102357239212'
        
      order by ordinal_position

  
[0m10:23:57.268408 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m10:23:57.268408 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.276809 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:23:57.276809 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m10:23:57.276809 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.284880 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102357239212'
        
      order by ordinal_position

  
[0m10:23:57.284880 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:23:57.284880 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.284880 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m10:23:57.293206 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:23:57.294127 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.294127 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m10:23:57.294127 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:23:57.294127 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.294127 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.294127 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp102357239212" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp102357239212" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m10:23:57.294127 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:23:57.294127 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m10:23:57.294127 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:23:57.294127 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m10:23:57.294127 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:23:57.294127 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m10:23:57.294127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961E10D760>]}
[0m10:23:57.310105 [info ] [Thread-1  ]: 7 of 18 OK snapshotted public_staging.sn_users ................................. [[32mINSERT 0 0[0m in 0.10s]
[0m10:23:57.310105 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m10:23:57.310105 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:23:57.310105 [info ] [Thread-1  ]: 8 of 18 START test accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call  [RUN]
[0m10:23:57.313178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_users, now test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe)
[0m10:23:57.313178 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:23:57.313178 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:23:57.313178 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:23:57.327475 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:23:57.327475 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:23:57.327475 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: BEGIN
[0m10:23:57.327475 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:57.353901 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:23:57.354313 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"
[0m10:23:57.355313 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        type as value_field,
        count(*) as n_records

    from "postgres"."public_staging"."stg_activity_types"
    group by type

)

select *
from all_values
where value_field not in (
    'meeting','sc2','follow_up','after_close_call'
)



      
    ) dbt_internal_test
[0m10:23:57.358313 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m10:23:57.362900 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: ROLLBACK
[0m10:23:57.364812 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe: Close
[0m10:23:57.365311 [error] [Thread-1  ]: 8 of 18 FAIL 1 accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call  [[31mFAIL 1[0m in 0.05s]
[0m10:23:57.365311 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe
[0m10:23:57.365311 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:23:57.365311 [debug] [Thread-4  ]: Marking all children of 'test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m10:23:57.365311 [info ] [Thread-1  ]: 9 of 18 START test not_null_stg_deal_changes_change_time ....................... [RUN]
[0m10:23:57.365311 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call.7817abecbe, now test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d)
[0m10:23:57.365311 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:23:57.379198 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:23:57.379198 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:23:57.379198 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:23:57.379198 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:23:57.379198 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: BEGIN
[0m10:23:57.379198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:57.395133 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m10:23:57.408888 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:23:57.409573 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_staging"."stg_deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m10:23:57.414363 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m10:23:57.416341 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: ROLLBACK
[0m10:23:57.418200 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: Close
[0m10:23:57.418813 [info ] [Thread-1  ]: 9 of 18 PASS not_null_stg_deal_changes_change_time ............................. [[32mPASS[0m in 0.05s]
[0m10:23:57.419905 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:23:57.420458 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:23:57.420458 [info ] [Thread-1  ]: 10 of 18 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m10:23:57.420458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m10:23:57.420458 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:23:57.425287 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:23:57.428777 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:23:57.429425 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:23:57.429425 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:23:57.429425 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m10:23:57.429425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:57.474182 [debug] [Thread-1  ]: SQL status: BEGIN in 0.039 seconds
[0m10:23:57.474790 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:23:57.475294 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_staging"."stg_deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m10:23:57.478819 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m10:23:57.480612 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m10:23:57.481934 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m10:23:57.482569 [info ] [Thread-1  ]: 10 of 18 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.06s]
[0m10:23:57.483915 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:23:57.484194 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m10:23:57.484769 [info ] [Thread-1  ]: 11 of 18 SKIP relation public_crm.t_activities ................................. [[33mSKIP[0m]
[0m10:23:57.485236 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m10:23:57.485236 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:23:57.485236 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_activities' to be skipped because of status 'skipped'. 
[0m10:23:57.485236 [info ] [Thread-1  ]: 12 of 18 START sql view model public_crm.t_deal_lost_reasons ................... [RUN]
[0m10:23:57.485236 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m10:23:57.485236 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:23:57.485236 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:23:57.493264 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:23:57.494212 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:23:57.494212 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:23:57.494212 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m10:23:57.494212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:57.526508 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m10:23:57.527120 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:23:57.527656 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m10:23:57.532148 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:23:57.535732 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:23:57.536245 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m10:23:57.537367 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:23:57.537367 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m10:23:57.537367 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:23:57.537367 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m10:23:57.543256 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:23:57.543256 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m10:23:57.543256 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:23:57.543256 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m10:23:57.543256 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m10:23:57.551374 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m10:23:57.551374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961E170F40>]}
[0m10:23:57.553475 [info ] [Thread-1  ]: 12 of 18 OK created sql view model public_crm.t_deal_lost_reasons .............. [[32mCREATE VIEW[0m in 0.07s]
[0m10:23:57.553475 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:23:57.553475 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m10:23:57.553475 [info ] [Thread-1  ]: 13 of 18 START sql view model public_crm.t_user_deal_events .................... [RUN]
[0m10:23:57.553475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_user_deal_events)
[0m10:23:57.553475 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m10:23:57.553475 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.553475 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m10:23:57.564726 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.564726 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.564726 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m10:23:57.564726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:57.605279 [debug] [Thread-1  ]: SQL status: BEGIN in 0.039 seconds
[0m10:23:57.608362 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.609012 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m10:23:57.612448 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:23:57.616031 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.616031 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events" rename to "t_user_deal_events__dbt_backup"
[0m10:23:57.618475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:23:57.619533 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.619533 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m10:23:57.623529 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:57.624293 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:23:57.624293 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.624293 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:23:57.624293 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:23:57.632911 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m10:23:57.632911 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:23:57.632911 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m10:23:57.632911 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m10:23:57.641009 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m10:23:57.642893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2591488-fd5c-4fc6-b121-617c5d72361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961E170F40>]}
[0m10:23:57.643678 [info ] [Thread-1  ]: 13 of 18 OK created sql view model public_crm.t_user_deal_events ............... [[32mCREATE VIEW[0m in 0.09s]
[0m10:23:57.643678 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m10:23:57.643678 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:23:57.643678 [info ] [Thread-1  ]: 14 of 18 SKIP relation public_crm.t_deal_funnel_events ......................... [[33mSKIP[0m]
[0m10:23:57.643678 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:23:57.643678 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_deal_funnel_events' to be skipped because of status 'skipped'. 
[0m10:23:57.648276 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:23:57.648276 [info ] [Thread-1  ]: 15 of 18 SKIP relation public_crm.t_sales_funnel_monthly_columns ............... [[33mSKIP[0m]
[0m10:23:57.649212 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:23:57.649774 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:23:57.649774 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_columns' to be skipped because of status 'skipped'. 
[0m10:23:57.649774 [info ] [Thread-1  ]: 16 of 18 SKIP relation public_crm.t_sales_funnel_monthly_rows .................. [[33mSKIP[0m]
[0m10:23:57.649774 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:23:57.652058 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:23:57.652571 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.t_sales_funnel_monthly_rows' to be skipped because of status 'skipped'. 
[0m10:23:57.652571 [info ] [Thread-1  ]: 17 of 18 SKIP relation public_marts_crm.rep_sales_funnel_monthly_columns ....... [[33mSKIP[0m]
[0m10:23:57.652571 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:23:57.652571 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:23:57.652571 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly_columns' to be skipped because of status 'skipped'. 
[0m10:23:57.652571 [info ] [Thread-1  ]: 18 of 18 SKIP relation public_marts_crm.rep_sales_funnel_monthly ............... [[33mSKIP[0m]
[0m10:23:57.656123 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:23:57.656663 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly' to be skipped because of status 'skipped'. 
[0m10:23:57.657107 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:57.657107 [debug] [MainThread]: On master: BEGIN
[0m10:23:57.657107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:57.678789 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m10:23:57.683582 [debug] [MainThread]: On master: COMMIT
[0m10:23:57.684156 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:57.684517 [debug] [MainThread]: On master: COMMIT
[0m10:23:57.686686 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:23:57.686686 [debug] [MainThread]: On master: Close
[0m10:23:57.687297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:57.687856 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:23:57.687856 [debug] [MainThread]: Connection 'list_postgres_public_marts_crm' was properly closed.
[0m10:23:57.688381 [debug] [MainThread]: Connection 'model.enpal_assessment_project.t_user_deal_events' was properly closed.
[0m10:23:57.688902 [info ] [MainThread]: 
[0m10:23:57.689423 [info ] [MainThread]: Finished running 1 incremental model, 2 snapshots, 5 table models, 3 data tests, 7 view models in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m10:23:57.692563 [debug] [MainThread]: Command end result
[0m10:23:57.712110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:23:57.712110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:23:57.726398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m10:23:57.726398 [info ] [MainThread]: 
[0m10:23:57.726398 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m10:23:57.728322 [info ] [MainThread]: 
[0m10:23:57.728322 [error] [MainThread]: [31mFailure in test accepted_values_stg_activity_types_type__meeting__sc2__follow_up__after_close_call (models\staging\pipedrive\pipedrive.yml)[0m
[0m10:23:57.728322 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:23:57.728322 [info ] [MainThread]: 
[0m10:23:57.728322 [info ] [MainThread]:   compiled code at target\compiled\enpal_assessment_project\models\staging\pipedrive\pipedrive.yml\accepted_values_stg_activity_t_132db2580fce30ab445b22841035ae0b.sql
[0m10:23:57.728322 [info ] [MainThread]: 
[0m10:23:57.733699 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=6 TOTAL=18
[0m10:23:57.733699 [debug] [MainThread]: Command `dbt build` failed at 10:23:57.733699 after 2.84 seconds
[0m10:23:57.733699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961A0F1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961C577430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002961B4832B0>]}
[0m10:23:57.733699 [debug] [MainThread]: Flushing usage events
[0m10:23:58.735462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:28.435161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25F7D00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2617368B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A261736970>]}


============================== 10:25:28.435161 | 40301787-56fe-46b2-b8ae-c4e583b508eb ==============================
[0m10:25:28.435161 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m10:25:28.435161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:28.589501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25EAE88B0>]}
[0m10:25:28.634097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2611A22E0>]}
[0m10:25:28.634097 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:25:28.809415 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m10:25:28.984535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:25:28.984535 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\staging\pipedrive\pipedrive.yml
[0m10:25:29.406317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2621A19A0>]}
[0m10:25:29.509831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:25:29.513763 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:25:29.564042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25F699D90>]}
[0m10:25:29.564042 [info ] [MainThread]: Found 13 models, 2 snapshots, 3 data tests, 6 sources, 428 macros
[0m10:25:29.581326 [info ] [MainThread]: 
[0m10:25:29.581326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:29.581326 [info ] [MainThread]: 
[0m10:25:29.584062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:25:29.589535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:25:29.654205 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:25:29.654205 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:25:29.654205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:29.677003 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.027 seconds
[0m10:25:29.677003 [debug] [ThreadPool]: On list_postgres: Close
[0m10:25:29.677003 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:25:29.677003 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:25:29.677003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:29.693550 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.019 seconds
[0m10:25:29.709337 [debug] [ThreadPool]: On list_postgres: Close
[0m10:25:29.709337 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:25:29.709337 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:25:29.709337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:29.733994 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.024 seconds
[0m10:25:29.733994 [debug] [ThreadPool]: On list_postgres: Close
[0m10:25:29.733994 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:25:29.733994 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:25:29.733994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:29.833599 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.106 seconds
[0m10:25:29.849618 [debug] [ThreadPool]: On list_postgres: Close
[0m10:25:29.853545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m10:25:29.853820 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:25:29.853820 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:25:29.853820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:29.882121 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m10:25:29.882640 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:25:29.883106 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:25:29.888556 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m10:25:29.890121 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:25:29.892047 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:25:29.893046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m10:25:29.894447 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:25:29.894447 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m10:25:29.894447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:29.913247 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:25:29.914674 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:25:29.915455 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m10:25:29.915597 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m10:25:29.915597 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m10:25:29.915597 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m10:25:29.923206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_marts_crm)
[0m10:25:29.923619 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:25:29.923619 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m10:25:29.923619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:29.943468 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:25:29.944201 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:25:29.944455 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m10:25:29.948467 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m10:25:29.949543 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m10:25:29.950971 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m10:25:29.951954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts_crm, now list_postgres_public_staging)
[0m10:25:29.955013 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:25:29.955013 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m10:25:29.955013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:29.971929 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:25:29.974026 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:25:29.974598 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:25:29.978504 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m10:25:29.979690 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m10:25:29.981081 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m10:25:29.984269 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:29.984269 [debug] [MainThread]: On master: BEGIN
[0m10:25:29.988232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:30.004856 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:25:30.005203 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:30.005758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:25:30.010550 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m10:25:30.012387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A261A99340>]}
[0m10:25:30.012910 [debug] [MainThread]: On master: ROLLBACK
[0m10:25:30.014386 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:30.014923 [debug] [MainThread]: On master: BEGIN
[0m10:25:30.016398 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:25:30.017822 [debug] [MainThread]: On master: COMMIT
[0m10:25:30.018330 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:30.018480 [debug] [MainThread]: On master: COMMIT
[0m10:25:30.020999 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:25:30.021496 [debug] [MainThread]: On master: Close
[0m10:25:30.025497 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m10:25:30.025996 [info ] [Thread-1  ]: 1 of 18 START sql view model public.calendar_ .................................. [RUN]
[0m10:25:30.026997 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m10:25:30.027763 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m10:25:30.029582 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m10:25:30.029582 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m10:25:30.056046 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m10:25:30.056046 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:25:30.056046 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m10:25:30.056046 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:25:30.084376 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:25:30.084975 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:25:30.085592 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m10:25:30.088197 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:25:30.094294 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:25:30.094788 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m10:25:30.095699 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:25:30.095699 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:25:30.095699 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m10:25:30.095699 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:25:30.113436 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:25:30.113436 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:25:30.113436 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:25:30.121685 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m10:25:30.121685 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m10:25:30.121685 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:25:30.137411 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m10:25:30.137411 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m10:25:30.137411 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m10:25:30.137411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2636E58E0>]}
[0m10:25:30.137411 [info ] [Thread-1  ]: 1 of 18 OK created sql view model public.calendar_ ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m10:25:30.137411 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m10:25:30.137411 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m10:25:30.137411 [info ] [Thread-1  ]: 2 of 18 START sql table model public_staging.stg_activity_types ................ [RUN]
[0m10:25:30.137411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m10:25:30.137411 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m10:25:30.153365 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.153365 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m10:25:30.173965 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.173965 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.173965 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m10:25:30.173965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.206054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.041 seconds
[0m10:25:30.221804 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.222823 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m10:25:30.225996 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:25:30.229104 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.229612 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m10:25:30.231359 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:30.232526 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.232526 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m10:25:30.232526 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:30.237880 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:25:30.237880 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.237880 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:25:30.245922 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:25:30.245922 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m10:25:30.245922 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:25:30.245922 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m10:25:30.253938 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m10:25:30.253938 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m10:25:30.253938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A261736DF0>]}
[0m10:25:30.253938 [info ] [Thread-1  ]: 2 of 18 OK created sql table model public_staging.stg_activity_types ........... [[32mSELECT 4[0m in 0.12s]
[0m10:25:30.253938 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m10:25:30.262009 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m10:25:30.262009 [info ] [Thread-1  ]: 3 of 18 START sql incremental model public_staging.stg_deal_changes ............ [RUN]
[0m10:25:30.263862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m10:25:30.263862 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m10:25:30.263862 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.271665 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m10:25:30.290704 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.299256 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp102530290704"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m10:25:30.299741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.333429 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.038 seconds
[0m10:25:30.346387 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.346387 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m10:25:30.346387 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m10:25:30.352481 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.353141 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp102530290704'
        
      order by ordinal_position

  
[0m10:25:30.355050 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.006 seconds
[0m10:25:30.364316 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.364815 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.364815 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:25:30.373543 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.373543 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.373543 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:25:30.388411 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.388411 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.388411 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp102530290704"
            where (
                
                    "stg_deal_changes__dbt_tmp102530290704".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp102530290704".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp102530290704".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp102530290704"
    )
  
[0m10:25:30.396678 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:25:30.396678 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:25:30.396678 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:25:30.396678 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:25:30.404996 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:25:30.404996 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m10:25:30.404996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A261736DF0>]}
[0m10:25:30.404996 [info ] [Thread-1  ]: 3 of 18 OK created sql incremental model public_staging.stg_deal_changes ....... [[32mINSERT 0 0[0m in 0.14s]
[0m10:25:30.404996 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m10:25:30.404996 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m10:25:30.404996 [info ] [Thread-1  ]: 4 of 18 START sql table model public_staging.stg_fields ........................ [RUN]
[0m10:25:30.404996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m10:25:30.404996 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m10:25:30.404996 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m10:25:30.404996 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m10:25:30.404996 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m10:25:30.421038 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:25:30.422049 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m10:25:30.422590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.444156 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m10:25:30.444794 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:25:30.445303 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."public_staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,field_key
  ,name
  ,opt->>'id' AS option_id
  ,opt->>'label' AS option
FROM "postgres"."public"."fields" 
 LEFT JOIN LATERAL jsonb_array_elements(field_value_options) opt ON 3=3
  );
  
[0m10:25:30.449304 [debug] [Thread-1  ]: SQL status: SELECT 16 in 0.003 seconds
[0m10:25:30.452814 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:25:30.453304 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m10:25:30.454956 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:30.454956 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:25:30.454956 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m10:25:30.463083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:30.463758 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m10:25:30.463758 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:25:30.463758 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m10:25:30.463758 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:25:30.471930 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_fields__dbt_backup"
[0m10:25:30.471930 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m10:25:30.471930 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_staging"."stg_fields__dbt_backup" cascade
[0m10:25:30.479816 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m10:25:30.479816 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m10:25:30.479816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A261736DF0>]}
[0m10:25:30.479816 [info ] [Thread-1  ]: 4 of 18 OK created sql table model public_staging.stg_fields ................... [[32mSELECT 16[0m in 0.07s]
[0m10:25:30.479816 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m10:25:30.479816 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m10:25:30.479816 [info ] [Thread-1  ]: 5 of 18 START sql table model public_staging.stg_stages ........................ [RUN]
[0m10:25:30.479816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m10:25:30.479816 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m10:25:30.488245 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m10:25:30.488245 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m10:25:30.488245 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m10:25:30.488245 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:25:30.488245 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m10:25:30.488245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.515837 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m10:25:30.516267 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:25:30.516806 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m10:25:30.520165 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m10:25:30.526319 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:25:30.526319 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m10:25:30.526319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:30.532096 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:25:30.532366 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m10:25:30.532366 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:30.532366 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:25:30.532366 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:25:30.532366 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:25:30.538843 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:25:30.538843 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m10:25:30.538843 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:25:30.538843 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m10:25:30.538843 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m10:25:30.538843 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m10:25:30.554034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2637C0D60>]}
[0m10:25:30.555108 [info ] [Thread-1  ]: 5 of 18 OK created sql table model public_staging.stg_stages ................... [[32mSELECT 9[0m in 0.06s]
[0m10:25:30.555620 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m10:25:30.555620 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_activities
[0m10:25:30.555620 [info ] [Thread-1  ]: 6 of 18 START snapshot public_staging.sn_activities ............................ [RUN]
[0m10:25:30.555620 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now snapshot.enpal_assessment_project.sn_activities)
[0m10:25:30.555620 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_activities
[0m10:25:30.560034 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_activities
[0m10:25:30.606631 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.613838 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select done from (
                  



SELECT * 
FROM "postgres"."public"."activity"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m10:25:30.614432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.632659 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.018 seconds
[0m10:25:30.633291 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.633291 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: BEGIN
[0m10:25:30.637403 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m10:25:30.638332 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.638540 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.639656 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.006 seconds
[0m10:25:30.647746 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.647746 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.655298 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m10:25:30.671733 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.671733 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

        
  
    

  create temporary table "sn_activities__dbt_tmp102530671733"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m10:25:30.696037 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.017 seconds
[0m10:25:30.696037 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.696037 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102530671733'
        
      order by ordinal_position

  
[0m10:25:30.696037 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m10:25:30.704028 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.704028 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.704028 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:25:30.704028 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.704028 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102530671733'
        
      order by ordinal_position

  
[0m10:25:30.704028 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.003 seconds
[0m10:25:30.720315 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.720315 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.720315 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m10:25:30.720315 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.720315 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_activities__dbt_tmp102530671733'
        
      order by ordinal_position

  
[0m10:25:30.720315 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.004 seconds
[0m10:25:30.736565 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.736565 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."activity"


    ),

    snapshotted_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from "postgres"."public_staging"."sn_activities"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(activity_id as varchar ), '')
         || '|' || coalesce(cast(deal_id as varchar ), '')
         || '|' || coalesce(cast(due_to as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            activity_id as dbt_unique_key_1 ,
        
            deal_id as dbt_unique_key_2 ,
        
            due_to as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

        where (
            (snapshotted_data."done" != source_data."done"
        or
        (
            ((snapshotted_data."done" is null) and not (source_data."done" is null))
            or
            ((not snapshotted_data."done" is null) and (source_data."done" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
            snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1 and
        
            snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2 and
        
            snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3
        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m10:25:30.736565 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:25:30.752998 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.752998 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m10:25:30.752998 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:25:30.752998 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.752998 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.752998 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_activities"} */

      update "postgres"."public_staging"."sn_activities"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_activities__dbt_tmp102530671733" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_activities".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_activities".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_activities" ("activity_id", "type", "assigned_to_user", "deal_id", "done", "due_to", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."activity_id",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."assigned_to_user",DBT_INTERNAL_SOURCE."deal_id",DBT_INTERNAL_SOURCE."done",DBT_INTERNAL_SOURCE."due_to",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_activities__dbt_tmp102530671733" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m10:25:30.752998 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:25:30.752998 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m10:25:30.752998 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_activities"
[0m10:25:30.752998 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: COMMIT
[0m10:25:30.768663 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:25:30.768663 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_activities: Close
[0m10:25:30.772562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A26379F310>]}
[0m10:25:30.773649 [info ] [Thread-1  ]: 6 of 18 OK snapshotted public_staging.sn_activities ............................ [[32mINSERT 0 0[0m in 0.22s]
[0m10:25:30.773649 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_activities
[0m10:25:30.773649 [debug] [Thread-1  ]: Began running node snapshot.enpal_assessment_project.sn_users
[0m10:25:30.773649 [info ] [Thread-1  ]: 7 of 18 START snapshot public_staging.sn_users ................................. [RUN]
[0m10:25:30.773649 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_activities, now snapshot.enpal_assessment_project.sn_users)
[0m10:25:30.773649 [debug] [Thread-1  ]: Began compiling node snapshot.enpal_assessment_project.sn_users
[0m10:25:30.773649 [debug] [Thread-1  ]: Began executing node snapshot.enpal_assessment_project.sn_users
[0m10:25:30.773649 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.789664 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: BEGIN
[0m10:25:30.790341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.807166 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m10:25:30.811391 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.811944 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.818802 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m10:25:30.823698 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.823698 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

        
  
    

  create temporary table "sn_users__dbt_tmp102530822891"
  
  
    as
  
  (
    

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m10:25:30.832134 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m10:25:30.833132 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.833132 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102530822891'
        
      order by ordinal_position

  
[0m10:25:30.839275 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m10:25:30.839275 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.839275 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.839275 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m10:25:30.847676 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.847676 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102530822891'
        
      order by ordinal_position

  
[0m10:25:30.847676 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m10:25:30.855254 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.855254 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sn_users'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:25:30.855254 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m10:25:30.863540 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.863540 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sn_users__dbt_tmp102530822891'
        
      order by ordinal_position

  
[0m10:25:30.863540 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m10:25:30.863540 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.863540 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        

    with snapshot_query as (

          



SELECT * 
FROM "postgres"."public"."users"


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."public_staging"."sn_users"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.modified))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m10:25:30.871653 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:25:30.871653 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.871653 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m10:25:30.871653 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m10:25:30.871653 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.871653 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.871653 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.sn_users"} */

      update "postgres"."public_staging"."sn_users"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sn_users__dbt_tmp102530822891" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public_staging"."sn_users".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public_staging"."sn_users".dbt_valid_to is null;

    insert into "postgres"."public_staging"."sn_users" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sn_users__dbt_tmp102530822891" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m10:25:30.879790 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:25:30.879790 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m10:25:30.879790 [debug] [Thread-1  ]: Using postgres connection "snapshot.enpal_assessment_project.sn_users"
[0m10:25:30.879790 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: COMMIT
[0m10:25:30.879790 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m10:25:30.879790 [debug] [Thread-1  ]: On snapshot.enpal_assessment_project.sn_users: Close
[0m10:25:30.879790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2637C0D60>]}
[0m10:25:30.879790 [info ] [Thread-1  ]: 7 of 18 OK snapshotted public_staging.sn_users ................................. [[32mINSERT 0 0[0m in 0.11s]
[0m10:25:30.893946 [debug] [Thread-1  ]: Finished running node snapshot.enpal_assessment_project.sn_users
[0m10:25:30.893946 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1
[0m10:25:30.893946 [info ] [Thread-1  ]: 8 of 18 START test accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call  [RUN]
[0m10:25:30.893946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.sn_users, now test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1)
[0m10:25:30.893946 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1
[0m10:25:30.893946 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1"
[0m10:25:30.893946 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1
[0m10:25:30.917305 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1"
[0m10:25:30.917305 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1"
[0m10:25:30.917305 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1: BEGIN
[0m10:25:30.917305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.942028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m10:25:30.942787 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1"
[0m10:25:30.943390 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        type as value_field,
        count(*) as n_records

    from "postgres"."public_staging"."stg_activity_types"
    group by type

)

select *
from all_values
where value_field not in (
    'meeting','sc_2','follow_up','after_close_call'
)



      
    ) dbt_internal_test
[0m10:25:30.946910 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m10:25:30.949891 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1: ROLLBACK
[0m10:25:30.951435 [debug] [Thread-1  ]: On test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1: Close
[0m10:25:30.952342 [info ] [Thread-1  ]: 8 of 18 PASS accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call  [[32mPASS[0m in 0.06s]
[0m10:25:30.953799 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1
[0m10:25:30.954658 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:25:30.954658 [info ] [Thread-1  ]: 9 of 18 START test not_null_stg_deal_changes_change_time ....................... [RUN]
[0m10:25:30.954658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_types_type__meeting__sc_2__follow_up__after_close_call.84eb3832a1, now test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d)
[0m10:25:30.954658 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:25:30.954658 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:25:30.962956 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:25:30.962956 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:25:30.962956 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:25:30.962956 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: BEGIN
[0m10:25:30.962956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.984271 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:25:30.986760 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"
[0m10:25:30.987331 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_staging"."stg_deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m10:25:30.990632 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m10:25:30.992843 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: ROLLBACK
[0m10:25:30.994812 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d: Close
[0m10:25:30.996261 [info ] [Thread-1  ]: 9 of 18 PASS not_null_stg_deal_changes_change_time ............................. [[32mPASS[0m in 0.04s]
[0m10:25:30.998038 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d
[0m10:25:30.998484 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:25:30.998484 [info ] [Thread-1  ]: 10 of 18 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m10:25:30.998484 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m10:25:30.998484 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:25:30.998484 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:25:30.998484 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:25:31.007243 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:25:31.007243 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:25:31.007243 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m10:25:31.007243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.023216 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m10:25:31.029790 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m10:25:31.030452 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_staging"."stg_deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m10:25:31.033565 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m10:25:31.035057 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m10:25:31.036614 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m10:25:31.037561 [info ] [Thread-1  ]: 10 of 18 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.04s]
[0m10:25:31.038977 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m10:25:31.039677 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m10:25:31.040479 [info ] [Thread-1  ]: 11 of 18 START sql view model public_crm.t_activities .......................... [RUN]
[0m10:25:31.041063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now model.enpal_assessment_project.t_activities)
[0m10:25:31.041063 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m10:25:31.041063 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m10:25:31.041063 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m10:25:31.050363 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m10:25:31.050363 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:25:31.050363 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m10:25:31.050363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.056826 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:25:31.071269 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:25:31.071900 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m10:25:31.076013 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:25:31.078926 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:25:31.079536 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m10:25:31.082019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.082521 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m10:25:31.082521 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:25:31.082521 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m10:25:31.088370 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:25:31.090768 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m10:25:31.090768 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:25:31.090768 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m10:25:31.090768 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m10:25:31.090768 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m10:25:31.090768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2638BBD90>]}
[0m10:25:31.098528 [info ] [Thread-1  ]: 11 of 18 OK created sql view model public_crm.t_activities ..................... [[32mCREATE VIEW[0m in 0.05s]
[0m10:25:31.098528 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m10:25:31.098528 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:25:31.098528 [info ] [Thread-1  ]: 12 of 18 START sql view model public_crm.t_deal_lost_reasons ................... [RUN]
[0m10:25:31.098528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_deal_lost_reasons)
[0m10:25:31.098528 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:25:31.105922 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:25:31.105922 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:25:31.105922 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:25:31.105922 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:25:31.105922 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: BEGIN
[0m10:25:31.105922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.131811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m10:25:31.132462 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:25:31.132971 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */

  create view "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp"
    
    
  as (
    SELECT
   dc.deal_id
  ,dc.change_time 
  ,f.option AS lost_reason    
FROM "postgres"."public_staging"."stg_deal_changes" dc
LEFT JOIN "postgres"."public_staging"."stg_fields" f ON dc.changed_field_key = f.field_key 
  AND dc.new_value = f.option_id 
WHERE changed_field_key = 'lost_reason'
  );
[0m10:25:31.136552 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:25:31.140064 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:25:31.141085 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
alter table "postgres"."public_crm"."t_deal_lost_reasons__dbt_tmp" rename to "t_deal_lost_reasons"
[0m10:25:31.142454 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.142454 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m10:25:31.142454 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:25:31.142454 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: COMMIT
[0m10:25:31.148759 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:25:31.148759 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup"
[0m10:25:31.148759 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_lost_reasons"
[0m10:25:31.148759 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_lost_reasons"} */
drop view if exists "postgres"."public_crm"."t_deal_lost_reasons__dbt_backup" cascade
[0m10:25:31.156859 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:25:31.156859 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_lost_reasons: Close
[0m10:25:31.156859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2638BBD90>]}
[0m10:25:31.156859 [info ] [Thread-1  ]: 12 of 18 OK created sql view model public_crm.t_deal_lost_reasons .............. [[32mCREATE VIEW[0m in 0.06s]
[0m10:25:31.156859 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_lost_reasons
[0m10:25:31.156859 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m10:25:31.156859 [info ] [Thread-1  ]: 13 of 18 START sql view model public_crm.t_user_deal_events .................... [RUN]
[0m10:25:31.156859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_lost_reasons, now model.enpal_assessment_project.t_user_deal_events)
[0m10:25:31.156859 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m10:25:31.156859 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.156859 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m10:25:31.156859 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.156859 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.171816 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m10:25:31.172343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.189672 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m10:25:31.193105 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.193683 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m10:25:31.197160 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:25:31.201425 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.201934 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events" rename to "t_user_deal_events__dbt_backup"
[0m10:25:31.204220 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.206087 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.206087 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m10:25:31.206087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.206087 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:25:31.206087 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.206087 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:25:31.221377 [debug] [Thread-1  ]: SQL status: COMMIT in 0.011 seconds
[0m10:25:31.221377 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m10:25:31.221377 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:25:31.221377 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m10:25:31.229620 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m10:25:31.229620 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m10:25:31.229620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2638BFA60>]}
[0m10:25:31.229620 [info ] [Thread-1  ]: 13 of 18 OK created sql view model public_crm.t_user_deal_events ............... [[32mCREATE VIEW[0m in 0.07s]
[0m10:25:31.229620 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m10:25:31.229620 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:25:31.229620 [info ] [Thread-1  ]: 14 of 18 START sql view model public_crm.t_deal_funnel_events .................. [RUN]
[0m10:25:31.238164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_deal_funnel_events)
[0m10:25:31.238164 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m10:25:31.238164 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:25:31.238164 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m10:25:31.247327 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:25:31.247327 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:25:31.247327 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m10:25:31.247327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.273325 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m10:25:31.280749 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:25:31.281367 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM "postgres"."public_crm"."t_activities"
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN "postgres"."public_staging"."stg_stages" s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m10:25:31.285858 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:25:31.289667 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:25:31.290193 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m10:25:31.291953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.293820 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m10:25:31.293820 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:25:31.293820 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m10:25:31.293820 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:25:31.293820 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m10:25:31.293820 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:25:31.293820 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m10:25:31.293820 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:25:31.305793 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m10:25:31.306289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A263795880>]}
[0m10:25:31.307489 [info ] [Thread-1  ]: 14 of 18 OK created sql view model public_crm.t_deal_funnel_events ............. [[32mCREATE VIEW[0m in 0.07s]
[0m10:25:31.309170 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:25:31.310265 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:25:31.310265 [info ] [Thread-1  ]: 15 of 18 START sql view model public_crm.t_sales_funnel_monthly_columns ........ [RUN]
[0m10:25:31.311341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_sales_funnel_monthly_columns)
[0m10:25:31.312171 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:25:31.315644 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m10:25:31.316823 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:25:31.320696 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m10:25:31.323097 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m10:25:31.323701 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: BEGIN
[0m10:25:31.324439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.341947 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:25:31.342954 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m10:25:31.343450 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,avg_users_per_deal
  ,conversion_rate -- ignoring [optional] steps
FROM funnel_with_conversion_rate
-- ORDER BY month, stage_id
  );
[0m10:25:31.349492 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:25:31.352965 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m10:25:31.352965 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_tmp" rename to "t_sales_funnel_monthly_columns"
[0m10:25:31.354713 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.356720 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m10:25:31.356720 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m10:25:31.356720 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: COMMIT
[0m10:25:31.356720 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:25:31.364942 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup"
[0m10:25:31.364942 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_columns"
[0m10:25:31.364942 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_columns"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_columns__dbt_backup" cascade
[0m10:25:31.364942 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:25:31.364942 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_columns: Close
[0m10:25:31.371294 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A263920CD0>]}
[0m10:25:31.371294 [info ] [Thread-1  ]: 15 of 18 OK created sql view model public_crm.t_sales_funnel_monthly_columns ... [[32mCREATE VIEW[0m in 0.05s]
[0m10:25:31.373810 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_columns
[0m10:25:31.374313 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:25:31.374313 [info ] [Thread-1  ]: 16 of 18 START sql view model public_crm.t_sales_funnel_monthly_rows ........... [RUN]
[0m10:25:31.374313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_columns, now model.enpal_assessment_project.t_sales_funnel_monthly_rows)
[0m10:25:31.374313 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:25:31.374313 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:25:31.374313 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:25:31.383616 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:25:31.383616 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:25:31.383616 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m10:25:31.383616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.405420 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m10:25:31.406276 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:25:31.407060 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m10:25:31.413550 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:25:31.416549 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:25:31.416549 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp" rename to "t_sales_funnel_monthly_rows"
[0m10:25:31.416549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.416549 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m10:25:31.416549 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:25:31.416549 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m10:25:31.421545 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:25:31.421545 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup"
[0m10:25:31.421545 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:25:31.421545 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup" cascade
[0m10:25:31.429833 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:25:31.429974 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m10:25:31.429974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A263920CD0>]}
[0m10:25:31.429974 [info ] [Thread-1  ]: 16 of 18 OK created sql view model public_crm.t_sales_funnel_monthly_rows ...... [[32mCREATE VIEW[0m in 0.06s]
[0m10:25:31.429974 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:25:31.434220 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:25:31.434220 [info ] [Thread-1  ]: 17 of 18 START sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [RUN]
[0m10:25:31.434220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_rows, now model.enpal_assessment_project.rep_sales_funnel_monthly_columns)
[0m10:25:31.434220 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:25:31.434220 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.434220 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:25:31.443827 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.445301 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.445301 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: BEGIN
[0m10:25:31.445301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.485833 [debug] [Thread-1  ]: SQL status: BEGIN in 0.038 seconds
[0m10:25:31.486741 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.486741 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_tmp"
  
  
    as
  
  (
    SELECT 
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,COALESCE(deals_count, 0) AS deals_count
  ,COALESCE(ROUND(avg_users_per_deal::numeric, 2), 0) AS avg_users_per_deal
  ,COALESCE(ROUND(conversion_rate::numeric, 2), 0) AS converstion_rate
FROM "postgres"."public_crm"."t_sales_funnel_monthly_columns"
-- ORDER BY 
--    month 
--   ,stage_id
  );
  
[0m10:25:31.584921 [debug] [Thread-1  ]: SQL status: SELECT 132 in 0.099 seconds
[0m10:25:31.584921 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.584921 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns" rename to "rep_sales_funnel_monthly_columns__dbt_backup"
[0m10:25:31.584921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.595940 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.595940 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_tmp" rename to "rep_sales_funnel_monthly_columns"
[0m10:25:31.599384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:25:31.599384 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: COMMIT
[0m10:25:31.599384 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.599384 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: COMMIT
[0m10:25:31.599384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:25:31.599384 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_backup"
[0m10:25:31.599384 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"
[0m10:25:31.599384 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly_columns"} */
drop table if exists "postgres"."public_marts_crm"."rep_sales_funnel_monthly_columns__dbt_backup" cascade
[0m10:25:31.599384 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m10:25:31.615295 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly_columns: Close
[0m10:25:31.615295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A263827670>]}
[0m10:25:31.615295 [info ] [Thread-1  ]: 17 of 18 OK created sql table model public_marts_crm.rep_sales_funnel_monthly_columns  [[32mSELECT 132[0m in 0.18s]
[0m10:25:31.615295 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly_columns
[0m10:25:31.615295 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:25:31.615295 [info ] [Thread-1  ]: 18 of 18 START sql table model public_marts_crm.rep_sales_funnel_monthly ....... [RUN]
[0m10:25:31.615295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly_columns, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m10:25:31.615295 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:25:31.615295 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.615295 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:25:31.615295 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.615295 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.615295 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m10:25:31.615295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:31.639110 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m10:25:31.648186 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.648684 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    SELECT
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,funnel_kpi
  ,COALESCE(CASE WHEN funnel_kpi IN ('avg_users_per_deal','conversion_rate')
     THEN ROUND(kpi_value::numeric, 2)
     ELSE kpi_value
   END,0) AS kpi_value
FROM "postgres"."public_crm"."t_sales_funnel_monthly_rows"
-- ORDER BY 
--    month 
--   ,stage_id
--   ,funnel_kpi
  );
  
[0m10:25:31.742141 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.098 seconds
[0m10:25:31.742141 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.742141 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m10:25:31.752663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:25:31.754055 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.754055 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m10:25:31.754055 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:25:31.754055 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m10:25:31.754055 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.754055 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m10:25:31.754055 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:25:31.754055 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_backup"
[0m10:25:31.754055 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:25:31.770017 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m10:25:31.770017 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m10:25:31.770017 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m10:25:31.770017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40301787-56fe-46b2-b8ae-c4e583b508eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A261CB9370>]}
[0m10:25:31.770017 [info ] [Thread-1  ]: 18 of 18 OK created sql table model public_marts_crm.rep_sales_funnel_monthly .. [[32mSELECT 396[0m in 0.15s]
[0m10:25:31.770017 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:25:31.770017 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:31.770017 [debug] [MainThread]: On master: BEGIN
[0m10:25:31.770017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:31.814849 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m10:25:31.815650 [debug] [MainThread]: On master: COMMIT
[0m10:25:31.816073 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:31.816573 [debug] [MainThread]: On master: COMMIT
[0m10:25:31.818683 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:25:31.819277 [debug] [MainThread]: On master: Close
[0m10:25:31.819890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:31.820417 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:25:31.821013 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m10:25:31.821013 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m10:25:31.821526 [info ] [MainThread]: 
[0m10:25:31.823005 [info ] [MainThread]: Finished running 1 incremental model, 2 snapshots, 5 table models, 3 data tests, 7 view models in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m10:25:31.826787 [debug] [MainThread]: Command end result
[0m10:25:31.889499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:25:31.889499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:25:31.889499 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m10:25:31.889499 [info ] [MainThread]: 
[0m10:25:31.904789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:25:31.904789 [info ] [MainThread]: 
[0m10:25:31.904789 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m10:25:31.904789 [debug] [MainThread]: Command `dbt build` succeeded at 10:25:31.904789 after 3.52 seconds
[0m10:25:31.904789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25F7D00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25FB6F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25F3B6A30>]}
[0m10:25:31.904789 [debug] [MainThread]: Flushing usage events
[0m10:25:32.944410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:05.816818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EB6230040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EB81A4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EB81A47C0>]}


============================== 10:26:05.816818 | 113622f2-2ef2-43aa-b16f-eaa31e222147 ==============================
[0m10:26:05.816818 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m10:26:05.832661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s rep_sales_funnel_monthly', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:05.855803 [error] [MainThread]: Encountered an error:

[0m10:26:05.866202 [error] [MainThread]: Traceback (most recent call last):
  File "<frozen importlib._bootstrap_external>", line 1288, in _path_importer_cache
KeyError: 'c:\\users\\lucia\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\dbt\\adapters\\postgres\\relation_configs'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 232, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\config\runtime.py", line 79, in load_profile
    profile = Profile.render(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 790, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\adapters\postgres\__init__.py", line 5, in <module>
    from dbt.adapters.postgres.impl import PostgresAdapter
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\adapters\postgres\impl.py", line 26, in <module>
    from dbt.adapters.postgres.relation import PostgresRelation
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\adapters\postgres\relation.py", line 12, in <module>
    from dbt.adapters.postgres.relation_configs import (
  File "c:\users\lucia\appdata\local\programs\python\python39\lib\site-packages\dbt\adapters\postgres\relation_configs\__init__.py", line 1, in <module>
    from dbt.adapters.postgres.relation_configs.constants import (
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 982, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 925, in _find_spec
  File "<frozen importlib._bootstrap_external>", line 1349, in find_spec
  File "<frozen importlib._bootstrap_external>", line 1318, in _get_spec
  File "<frozen importlib._bootstrap_external>", line 1290, in _path_importer_cache
  File "<frozen importlib._bootstrap_external>", line 1268, in _path_hooks
KeyboardInterrupt

[0m10:26:05.876898 [debug] [MainThread]: Command `dbt run` failed at 10:26:05.876898 after 0.10 seconds
[0m10:26:05.876898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EB6230040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EB7CACB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EB551C520>]}
[0m10:26:05.876898 [debug] [MainThread]: Flushing usage events
[0m10:26:06.434578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:12.421637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD0A45F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD29B4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD29B4940>]}


============================== 10:26:12.425791 | 3796bbb2-1466-4603-bd54-38aab1f4131a ==============================
[0m10:26:12.425791 [info ] [MainThread]: Running with dbt=1.9.0-b4
[0m10:26:12.427290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Lucia\\Documents\\Git\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s +rep_sales_funnel_monthly', 'send_anonymous_usage_stats': 'True'}
[0m10:26:12.597320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCF30A9D0>]}
[0m10:26:12.654342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD297B850>]}
[0m10:26:12.654342 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:26:12.873757 [debug] [MainThread]: checksum: 0d3acddb5afbce98f9888b13248063cae3d09e6e329263e3ffe4b2a6aa072c8d, vars: {}, profile: , target: , version: 1.9.0b4
[0m10:26:13.079600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:26:13.079600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:26:13.153825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD311D130>]}
[0m10:26:13.264230 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:26:13.273549 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:26:13.284293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD3131C70>]}
[0m10:26:13.284293 [info ] [MainThread]: Found 13 models, 2 snapshots, 3 data tests, 6 sources, 428 macros
[0m10:26:13.284293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD30CF070>]}
[0m10:26:13.284293 [info ] [MainThread]: 
[0m10:26:13.294167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:13.294167 [info ] [MainThread]: 
[0m10:26:13.294167 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:13.304354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:26:13.373982 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:26:13.373982 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:26:13.373982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:13.403368 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.030 seconds
[0m10:26:13.410941 [debug] [ThreadPool]: On list_postgres: Close
[0m10:26:13.413887 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:26:13.413887 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:26:13.413887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:13.426537 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.022 seconds
[0m10:26:13.426537 [debug] [ThreadPool]: On list_postgres: Close
[0m10:26:13.443810 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:26:13.444566 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:26:13.445357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:13.466114 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.021 seconds
[0m10:26:13.467607 [debug] [ThreadPool]: On list_postgres: Close
[0m10:26:13.472112 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:26:13.472615 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:26:13.473152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:13.494271 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.021 seconds
[0m10:26:13.495606 [debug] [ThreadPool]: On list_postgres: Close
[0m10:26:13.504274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m10:26:13.510581 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:26:13.510581 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:26:13.511315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:13.529359 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:26:13.530162 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:26:13.530361 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:26:13.535862 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m10:26:13.537362 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:26:13.538948 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:26:13.539861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_crm)
[0m10:26:13.542018 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:26:13.542750 [debug] [ThreadPool]: On list_postgres_public_crm: BEGIN
[0m10:26:13.543333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:13.560141 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:26:13.561314 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_crm"
[0m10:26:13.561816 [debug] [ThreadPool]: On list_postgres_public_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_crm'
  
[0m10:26:13.565815 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:26:13.566990 [debug] [ThreadPool]: On list_postgres_public_crm: ROLLBACK
[0m10:26:13.568467 [debug] [ThreadPool]: On list_postgres_public_crm: Close
[0m10:26:13.569358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_crm, now list_postgres_public_marts_crm)
[0m10:26:13.573461 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:26:13.573961 [debug] [ThreadPool]: On list_postgres_public_marts_crm: BEGIN
[0m10:26:13.574692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:13.601209 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m10:26:13.601957 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts_crm"
[0m10:26:13.602570 [debug] [ThreadPool]: On list_postgres_public_marts_crm: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts_crm"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts_crm'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts_crm'
  
[0m10:26:13.607363 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:26:13.608361 [debug] [ThreadPool]: On list_postgres_public_marts_crm: ROLLBACK
[0m10:26:13.609860 [debug] [ThreadPool]: On list_postgres_public_marts_crm: Close
[0m10:26:13.610983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts_crm, now list_postgres_public_staging)
[0m10:26:13.614721 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:26:13.615395 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m10:26:13.615395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:13.642576 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m10:26:13.643228 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m10:26:13.643584 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:26:13.647578 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:26:13.649273 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m10:26:13.650544 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m10:26:13.657682 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:13.658184 [debug] [MainThread]: On master: BEGIN
[0m10:26:13.658184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:13.674556 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:26:13.674928 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:13.675436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:26:13.679940 [debug] [MainThread]: SQL status: SELECT 15 in 0.004 seconds
[0m10:26:13.685726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCF38F970>]}
[0m10:26:13.685726 [debug] [MainThread]: On master: ROLLBACK
[0m10:26:13.687635 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:13.687635 [debug] [MainThread]: On master: BEGIN
[0m10:26:13.689858 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:26:13.690238 [debug] [MainThread]: On master: COMMIT
[0m10:26:13.690942 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:13.691452 [debug] [MainThread]: On master: COMMIT
[0m10:26:13.692971 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:26:13.693454 [debug] [MainThread]: On master: Close
[0m10:26:13.697521 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.calendar_
[0m10:26:13.698156 [info ] [Thread-1  ]: 1 of 9 START sql view model public.calendar_ ................................... [RUN]
[0m10:26:13.699454 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.calendar_'
[0m10:26:13.699964 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.calendar_
[0m10:26:13.707230 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.calendar_"
[0m10:26:13.708731 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.calendar_
[0m10:26:13.745455 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.calendar_"
[0m10:26:13.746438 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:26:13.746438 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: BEGIN
[0m10:26:13.746438 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:26:13.767411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m10:26:13.767966 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:26:13.768305 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */

  create view "postgres"."public"."calendar___dbt_tmp"
    
    
  as (
    WITH generate_series AS (
SELECT 
   DATE(GENERATE_SERIES(DATE('2023-01-01'), DATE('2030-12-31'), '1 day')) AS day
)
SELECT 
   day
  ,DATE(DATE_TRUNC('month', day)) AS month
FROM generate_series
  );
[0m10:26:13.771306 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:26:13.778308 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:26:13.778859 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar_" rename to "calendar___dbt_backup"
[0m10:26:13.780961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:13.785629 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:26:13.786852 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
alter table "postgres"."public"."calendar___dbt_tmp" rename to "calendar_"
[0m10:26:13.788783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:13.805776 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:26:13.806417 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:26:13.806921 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: COMMIT
[0m10:26:13.810214 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:26:13.819348 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."calendar___dbt_backup"
[0m10:26:13.823896 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.calendar_"
[0m10:26:13.824298 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.calendar_"} */
drop view if exists "postgres"."public"."calendar___dbt_backup" cascade
[0m10:26:13.828621 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m10:26:13.831795 [debug] [Thread-1  ]: On model.enpal_assessment_project.calendar_: Close
[0m10:26:13.836155 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCF2E7460>]}
[0m10:26:13.837017 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.calendar_ .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m10:26:13.838867 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.calendar_
[0m10:26:13.839368 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m10:26:13.839424 [info ] [Thread-1  ]: 2 of 9 START sql table model public_staging.stg_activity_types ................. [RUN]
[0m10:26:13.840215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.calendar_, now model.enpal_assessment_project.stg_activity_types)
[0m10:26:13.840959 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m10:26:13.884774 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.886291 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m10:26:13.908732 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.910324 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.910519 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m10:26:13.911312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:13.935100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m10:26:13.935816 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.936271 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."public_staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    SELECT
   id
  ,name
  ,CASE WHEN active = 'Yes' THEN TRUE ELSE FALSE END AS active
  ,type
FROM "postgres"."public"."activity_types"
  );
  
[0m10:26:13.939400 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m10:26:13.942790 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.943792 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m10:26:13.945371 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:13.948674 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.948674 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m10:26:13.950642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:13.956569 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:26:13.956569 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.956569 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m10:26:13.961111 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:26:13.964086 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_activity_types__dbt_backup"
[0m10:26:13.966834 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m10:26:13.967338 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_staging"."stg_activity_types__dbt_backup" cascade
[0m10:26:13.969807 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m10:26:13.973603 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m10:26:13.974609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD36035E0>]}
[0m10:26:13.975548 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public_staging.stg_activity_types ............ [[32mSELECT 4[0m in 0.13s]
[0m10:26:13.976634 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m10:26:13.976634 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m10:26:13.976634 [info ] [Thread-1  ]: 3 of 9 START sql incremental model public_staging.stg_deal_changes ............. [RUN]
[0m10:26:13.979230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m10:26:13.979768 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m10:26:13.990673 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:13.992202 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m10:26:14.024370 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.025063 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp102614016764"
  
  
    as
  
  (
    SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,new_value
FROM "postgres"."public"."deal_changes"


  WHERE change_time > (SELECT MAX(change_time) FROM "postgres"."public_staging"."stg_deal_changes")

  );
  
  
[0m10:26:14.025063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:14.047392 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.022 seconds
[0m10:26:14.066888 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.066888 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m10:26:14.069579 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m10:26:14.070405 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.070940 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp102614016764'
        
      order by ordinal_position

  
[0m10:26:14.078422 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.007 seconds
[0m10:26:14.084548 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.085156 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:26:14.089693 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m10:26:14.098532 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.099270 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m10:26:14.103276 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m10:26:14.120656 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.122201 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.122869 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
            delete from "postgres"."public_staging"."stg_deal_changes"
            using "stg_deal_changes__dbt_tmp102614016764"
            where (
                
                    "stg_deal_changes__dbt_tmp102614016764".deal_id = "postgres"."public_staging"."stg_deal_changes".deal_id
                    and 
                
                    "stg_deal_changes__dbt_tmp102614016764".change_time = "postgres"."public_staging"."stg_deal_changes".change_time
                    and 
                
                    "stg_deal_changes__dbt_tmp102614016764".changed_field_key = "postgres"."public_staging"."stg_deal_changes".changed_field_key
                    
                
                
            );
        
    

    insert into "postgres"."public_staging"."stg_deal_changes" ("deal_id", "change_time", "changed_field_key", "new_value")
    (
        select "deal_id", "change_time", "changed_field_key", "new_value"
        from "stg_deal_changes__dbt_tmp102614016764"
    )
  
[0m10:26:14.125306 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:26:14.126849 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:26:14.127351 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m10:26:14.127622 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m10:26:14.132634 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:26:14.134210 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m10:26:14.135281 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD2962A30>]}
[0m10:26:14.136062 [info ] [Thread-1  ]: 3 of 9 OK created sql incremental model public_staging.stg_deal_changes ........ [[32mINSERT 0 0[0m in 0.16s]
[0m10:26:14.137324 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m10:26:14.138221 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m10:26:14.138951 [info ] [Thread-1  ]: 4 of 9 START sql table model public_staging.stg_stages ......................... [RUN]
[0m10:26:14.140255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_stages)
[0m10:26:14.140842 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m10:26:14.144041 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m10:26:14.145466 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m10:26:14.153827 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m10:26:14.155925 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:26:14.156725 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m10:26:14.157424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:14.177626 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m10:26:14.178626 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:26:14.179098 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."public_staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m10:26:14.181690 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.002 seconds
[0m10:26:14.186633 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:26:14.187216 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m10:26:14.189750 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:26:14.193669 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:26:14.194468 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m10:26:14.196392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:14.198089 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:26:14.198656 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:26:14.199154 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m10:26:14.202141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:26:14.206043 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."stg_stages__dbt_backup"
[0m10:26:14.206702 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m10:26:14.207310 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_staging"."stg_stages__dbt_backup" cascade
[0m10:26:14.211386 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m10:26:14.212942 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m10:26:14.213809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD36A7C70>]}
[0m10:26:14.214938 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public_staging.stg_stages .................... [[32mSELECT 9[0m in 0.07s]
[0m10:26:14.215483 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m10:26:14.215483 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_activities
[0m10:26:14.217455 [info ] [Thread-1  ]: 5 of 9 START sql view model public_crm.t_activities ............................ [RUN]
[0m10:26:14.217792 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.t_activities)
[0m10:26:14.217792 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_activities
[0m10:26:14.222016 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_activities"
[0m10:26:14.222961 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_activities
[0m10:26:14.226608 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_activities"
[0m10:26:14.228379 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:26:14.228885 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: BEGIN
[0m10:26:14.229503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:14.248110 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m10:26:14.248611 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:26:14.249611 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */

  create view "postgres"."public_crm"."t_activities__dbt_tmp"
    
    
  as (
    SELECT 
   a.activity_id
  ,ty.name AS activity_name
  ,a.assigned_to_user 
  ,a.deal_id 
  ,a.done AS is_done
  ,a.due_to
--  ,ty.active 
FROM "postgres"."public_staging"."sn_activities" a
  LEFT JOIN "postgres"."public_staging"."stg_activity_types" ty ON a.type = ty.type
  );
[0m10:26:14.252620 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:26:14.257111 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:26:14.257629 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
alter table "postgres"."public_crm"."t_activities__dbt_tmp" rename to "t_activities"
[0m10:26:14.259092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:14.260860 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m10:26:14.261464 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:26:14.261964 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: COMMIT
[0m10:26:14.265977 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:26:14.270259 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_activities__dbt_backup"
[0m10:26:14.271715 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_activities"
[0m10:26:14.271715 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_activities"} */
drop view if exists "postgres"."public_crm"."t_activities__dbt_backup" cascade
[0m10:26:14.273851 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:26:14.275625 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_activities: Close
[0m10:26:14.276686 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD2937850>]}
[0m10:26:14.277146 [info ] [Thread-1  ]: 5 of 9 OK created sql view model public_crm.t_activities ....................... [[32mCREATE VIEW[0m in 0.06s]
[0m10:26:14.278530 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_activities
[0m10:26:14.278530 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_user_deal_events
[0m10:26:14.279985 [info ] [Thread-1  ]: 6 of 9 START sql view model public_crm.t_user_deal_events ...................... [RUN]
[0m10:26:14.280608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_activities, now model.enpal_assessment_project.t_user_deal_events)
[0m10:26:14.280976 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_user_deal_events
[0m10:26:14.283286 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.284418 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_user_deal_events
[0m10:26:14.290314 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.291755 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.293050 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: BEGIN
[0m10:26:14.293050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:14.333185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.039 seconds
[0m10:26:14.333972 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.334446 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */

  create view "postgres"."public_crm"."t_user_deal_events__dbt_tmp"
    
    
  as (
    SELECT
   deal_id
  ,change_time
  ,new_value AS user_id
FROM "postgres"."public_staging"."stg_deal_changes" dc
WHERE changed_field_key = 'user_id'
  );
[0m10:26:14.338167 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:26:14.342847 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.342979 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events" rename to "t_user_deal_events__dbt_backup"
[0m10:26:14.344525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:14.347491 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.347996 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
alter table "postgres"."public_crm"."t_user_deal_events__dbt_tmp" rename to "t_user_deal_events"
[0m10:26:14.349199 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:14.351639 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:26:14.351947 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.352450 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: COMMIT
[0m10:26:14.356647 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:26:14.359632 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_user_deal_events__dbt_backup"
[0m10:26:14.360544 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_user_deal_events"
[0m10:26:14.361047 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_user_deal_events"} */
drop view if exists "postgres"."public_crm"."t_user_deal_events__dbt_backup" cascade
[0m10:26:14.364264 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m10:26:14.366784 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_user_deal_events: Close
[0m10:26:14.367967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD36CDEE0>]}
[0m10:26:14.367967 [info ] [Thread-1  ]: 6 of 9 OK created sql view model public_crm.t_user_deal_events ................. [[32mCREATE VIEW[0m in 0.09s]
[0m10:26:14.370645 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_user_deal_events
[0m10:26:14.370854 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:26:14.371524 [info ] [Thread-1  ]: 7 of 9 START sql view model public_crm.t_deal_funnel_events .................... [RUN]
[0m10:26:14.372718 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_user_deal_events, now model.enpal_assessment_project.t_deal_funnel_events)
[0m10:26:14.373219 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_deal_funnel_events
[0m10:26:14.377100 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:26:14.378514 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_deal_funnel_events
[0m10:26:14.385189 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:26:14.388001 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:26:14.389111 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: BEGIN
[0m10:26:14.389648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:14.408258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m10:26:14.409261 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:26:14.410259 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */

  create view "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp"
    
    
  as (
    WITH deals AS (
    -- loading data to use
SELECT *
FROM "postgres"."public_staging"."stg_deal_changes"
)

, deal_creation AS (
    -- date of the deal creation
SELECT
   deal_id
  ,change_time
  ,changed_field_key
  ,TO_TIMESTAMP(REPLACE(new_value, 'T', ' '), 'YYYY-MM-DD HH24:MI:SS') AS new_value
FROM deals d
WHERE changed_field_key = 'add_time'
)

, activities_substeps AS (
    -- getting the Sales calls from the activities table
    -- should only 'is_done' be considered...?
SELECT
   deal_id
  ,due_to AS change_time
  ,CASE
     WHEN activity_name = 'Sales Call 1' THEN 2.1
   	 WHEN activity_name = 'Sales Call 2' THEN 3.1
   END stage_id
  ,activity_name AS stage_name
FROM "postgres"."public_crm"."t_activities"
WHERE activity_name IN ('Sales Call 1', 'Sales Call 2')
--  AND is_done IS TRUE
)

, stage_events AS (
SELECT
   d.deal_id 
  ,d.change_time
  ,d.new_value::FLOAT AS stage_id
  ,s.stage_name
FROM deals d
 LEFT JOIN "postgres"."public_staging"."stg_stages" s ON d.new_value::NUMERIC = s.stage_id::NUMERIC
WHERE changed_field_key = 'stage_id'
)

SELECT
   deal_id
  ,new_value AS change_time -- adding the official deal creation date, although they seem to be always the same
  ,0.0 AS stage_id
  ,'Deal creation' AS stage_name
FROM deal_creation 
UNION ALL
SELECT 
   deal_id
  ,change_time
  ,stage_id
  ,stage_name
FROM stage_events
UNION ALL
-- adding only activities that exist in deal_changes
SELECT
   deal_id
  ,change_time
  ,stage_id::FLOAT
  ,stage_name
FROM activities_substeps
WHERE deal_id IN (SELECT DISTINCT deal_id FROM stage_events)
  );
[0m10:26:14.415271 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:26:14.419258 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:26:14.420663 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
alter table "postgres"."public_crm"."t_deal_funnel_events__dbt_tmp" rename to "t_deal_funnel_events"
[0m10:26:14.423245 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:26:14.424465 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m10:26:14.425495 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:26:14.425992 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: COMMIT
[0m10:26:14.429019 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:26:14.431223 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_deal_funnel_events__dbt_backup"
[0m10:26:14.432829 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_deal_funnel_events"
[0m10:26:14.433009 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_deal_funnel_events"} */
drop view if exists "postgres"."public_crm"."t_deal_funnel_events__dbt_backup" cascade
[0m10:26:14.433512 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:26:14.436305 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_deal_funnel_events: Close
[0m10:26:14.436806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD372EBB0>]}
[0m10:26:14.438883 [info ] [Thread-1  ]: 7 of 9 OK created sql view model public_crm.t_deal_funnel_events ............... [[32mCREATE VIEW[0m in 0.06s]
[0m10:26:14.440245 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_deal_funnel_events
[0m10:26:14.440963 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:26:14.441468 [info ] [Thread-1  ]: 8 of 9 START sql view model public_crm.t_sales_funnel_monthly_rows ............. [RUN]
[0m10:26:14.442709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_deal_funnel_events, now model.enpal_assessment_project.t_sales_funnel_monthly_rows)
[0m10:26:14.442709 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:26:14.447174 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:26:14.447987 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:26:14.452872 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:26:14.455091 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:26:14.456178 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: BEGIN
[0m10:26:14.456613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:14.474597 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m10:26:14.475340 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:26:14.475839 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */

  create view "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp"
    
    
  as (
    WITH calendar_ AS (
-- creating a time dimension
SELECT DISTINCT
   month
FROM "postgres"."public"."calendar_" --public.calendar_
WHERE month BETWEEN '2024-01-01' AND DATE_TRUNC('month', current_date)
)
, funnel_steps AS (
-- getting the current funnel steps
SELECT DISTINCT stage_id, stage_name 
FROM "postgres"."public_crm"."t_deal_funnel_events" 
)
, funnel_events AS (
-- all the funnel events
SELECT DISTINCT
   deal_id
  ,change_time AS event_time
  ,LEAD(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_event_time
  ,DATE_TRUNC('month', DATE(change_time)) AS event_month
  ,stage_id 
  ,stage_name
FROM "postgres"."public_crm"."t_deal_funnel_events"
)
, cross_join_days_steps AS (
-- building the catalog of month and funnel step
SELECT *
FROM calendar_
CROSS JOIN funnel_steps
)
, kpi_deal_count AS (
SELECT
   event_month
  ,stage_id
  ,stage_name
  ,COUNT(DISTINCT deal_id) deals_count
FROM funnel_events 
GROUP BY
  event_month
 ,stage_id
 ,stage_name
)
, kpi_avg_users AS (
SELECT
   stage_id
  ,event_month
  ,AVG(users_count) AS avg_users_per_deal
FROM (
    SELECT
       fe.deal_id,
       fe.stage_id,
       fe.event_month,
       COUNT(DISTINCT ud.user_id) AS users_count
    FROM funnel_events fe
    LEFT JOIN "postgres"."public_crm"."t_user_deal_events" ud
      ON ud.deal_id = fe.deal_id  AND ud.change_time BETWEEN fe.event_time AND fe.next_event_time
    GROUP BY 
       fe.deal_id
      ,fe.stage_id
      ,fe.event_month
) users_per_deal
GROUP BY 
   stage_id
  ,event_month
)
, draft_funnel AS (
SELECT DISTINCT
   s.month 
  ,s.stage_id
  ,s.stage_name 
  ,dc.deals_count::FLOAT AS deals_count
  ,COALESCE(au.avg_users_per_deal, 0) AS avg_users_per_deal
FROM cross_join_days_steps s
LEFT JOIN funnel_events fe ON s.month = fe.event_month  AND s.stage_id = fe.stage_id
LEFT JOIN kpi_deal_count dc ON s.month = dc.event_month AND s.stage_name = dc.stage_name
LEFT JOIN kpi_avg_users au ON s.month = au.event_month AND s.stage_id = au.stage_id
)
, funnel_with_conversion_rate AS (
-- calculating conversion rate but not taking into consideration steps 2.1 and 3.1 (they are optional?)
SELECT
   month 
  ,stage_id
  ,stage_name
  ,deals_count
  ,prev_deals_count
  ,avg_users_per_deal
  ,CASE
     WHEN stage_id NOT IN (2.1, 3.1) 
       THEN deals_count / NULLIF(prev_deals_count,0) * 100 
   END AS conversion_rate
FROM (
	SELECT *, 
	  LAG(CASE WHEN stage_id NOT IN (2.1, 3.1) THEN deals_count ELSE NULL END)  
	    OVER (PARTITION BY month /* IGNORE NULLS */ 
	    -- ordering the stages to get the previous steps ignoring 2.1 and 3.1
	            ORDER BY
	              CASE WHEN stage_id IN (2.1, 3.1) THEN NULL ELSE stage_id END 
	  ) prev_deals_count
	FROM draft_funnel
)
)
SELECT
   month,
   stage_id,
   stage_name,
   'deals_count' AS funnel_kpi,
   deals_count AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'avg_users_per_deal' AS funnel_kpi,
   avg_users_per_deal AS kpi_value
FROM funnel_with_conversion_rate
UNION ALL
SELECT
   month,
   stage_id,
   stage_name,
   'conversion_rate' AS funnel_kpi,
   conversion_rate AS kpi_value
FROM funnel_with_conversion_rate
ORDER BY month, stage_id, funnel_kpi
  );
[0m10:26:14.482562 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:26:14.485839 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:26:14.486851 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
alter table "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_tmp" rename to "t_sales_funnel_monthly_rows"
[0m10:26:14.490071 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:26:14.490071 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m10:26:14.490071 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:26:14.490071 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: COMMIT
[0m10:26:14.528567 [debug] [Thread-1  ]: SQL status: COMMIT in 0.033 seconds
[0m10:26:14.532674 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup"
[0m10:26:14.532674 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.t_sales_funnel_monthly_rows"
[0m10:26:14.532674 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.t_sales_funnel_monthly_rows"} */
drop view if exists "postgres"."public_crm"."t_sales_funnel_monthly_rows__dbt_backup" cascade
[0m10:26:14.537071 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:26:14.545836 [debug] [Thread-1  ]: On model.enpal_assessment_project.t_sales_funnel_monthly_rows: Close
[0m10:26:14.549145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD36D0AF0>]}
[0m10:26:14.550547 [info ] [Thread-1  ]: 8 of 9 OK created sql view model public_crm.t_sales_funnel_monthly_rows ........ [[32mCREATE VIEW[0m in 0.11s]
[0m10:26:14.550547 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.t_sales_funnel_monthly_rows
[0m10:26:14.550547 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:26:14.550547 [info ] [Thread-1  ]: 9 of 9 START sql table model public_marts_crm.rep_sales_funnel_monthly ......... [RUN]
[0m10:26:14.550547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.t_sales_funnel_monthly_rows, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m10:26:14.550547 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:26:14.571104 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.576364 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:26:14.583529 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.585296 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.587927 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m10:26:14.588981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:26:14.608076 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m10:26:14.608493 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.609133 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    SELECT
   TO_CHAR(month, 'YYYY-MM') AS month
  ,stage_id AS funnel_step_id
  ,stage_name AS funnel_step
  ,funnel_kpi
  ,COALESCE(CASE WHEN funnel_kpi IN ('avg_users_per_deal','conversion_rate')
     THEN ROUND(kpi_value::numeric, 2)
     ELSE kpi_value
   END,0) AS kpi_value
FROM "postgres"."public_crm"."t_sales_funnel_monthly_rows"
-- ORDER BY 
--    month 
--   ,stage_id
--   ,funnel_kpi
  );
  
[0m10:26:14.719411 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.115 seconds
[0m10:26:14.729742 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.730618 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m10:26:14.731259 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:26:14.736469 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.736963 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m10:26:14.738662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:26:14.739202 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m10:26:14.739202 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.741747 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m10:26:14.745051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:26:14.747996 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_backup"
[0m10:26:14.748796 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m10:26:14.749351 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.9.0b4", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_marts_crm"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m10:26:14.752900 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m10:26:14.753811 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m10:26:14.755118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3796bbb2-1466-4603-bd54-38aab1f4131a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD35C8F10>]}
[0m10:26:14.755712 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public_marts_crm.rep_sales_funnel_monthly .... [[32mSELECT 396[0m in 0.20s]
[0m10:26:14.757116 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m10:26:14.758334 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:14.758884 [debug] [MainThread]: On master: BEGIN
[0m10:26:14.759171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:14.776777 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:26:14.777384 [debug] [MainThread]: On master: COMMIT
[0m10:26:14.777915 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:14.777915 [debug] [MainThread]: On master: COMMIT
[0m10:26:14.779386 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:26:14.779386 [debug] [MainThread]: On master: Close
[0m10:26:14.780413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:14.780413 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:26:14.780917 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m10:26:14.781487 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m10:26:14.782166 [info ] [MainThread]: 
[0m10:26:14.782913 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 5 view models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m10:26:14.785413 [debug] [MainThread]: Command end result
[0m10:26:14.812845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\manifest.json
[0m10:26:14.814403 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\semantic_manifest.json
[0m10:26:14.825609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lucia\Documents\Git\dbt_enpal_assessment\target\run_results.json
[0m10:26:14.826202 [info ] [MainThread]: 
[0m10:26:14.827064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:14.827652 [info ] [MainThread]: 
[0m10:26:14.827652 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m10:26:14.829634 [debug] [MainThread]: Command `dbt run` succeeded at 10:26:14.828878 after 2.46 seconds
[0m10:26:14.829634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD0A45F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD0691DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD0E078E0>]}
[0m10:26:14.830560 [debug] [MainThread]: Flushing usage events
[0m10:26:15.650712 [debug] [MainThread]: An error was encountered while trying to flush usage events
